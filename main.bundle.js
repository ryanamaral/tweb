!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=105)}([function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFilesFromEvent=t.getElementByPoint=t.handleScrollSideEvent=t.isSelectionSingle=t.getSelectedNodes=t.detachClickEvent=t.attachClickEvent=t.CLICK_EVENT_NAME=t.blurActiveElement=t.getSelectedText=t.cancelSelection=t.positionElementByIndex=t.calcImageInBox=t.fillPropertyValue=t.whichChild=t.findUpAttribute=t.findUpTag=t.findUpClassName=t.generatePathData=t.serializeNodes=t.isInputEmpty=t.getRichElementValue=t.markdownTags=t.getRichValue=t.placeCaretAtEnd=t.cancelEvent=t.isInDOM=void 0;const a=s(2),o=n(s(3)),r=s(11);function d(e,t){if(!e)return"";const s=[],i=[];l(e,s,i,void 0,void 0,t),i.length&&s.push(i.join(""));let n=s.join("\n");return n=n.replace(/\u00A0/g," "),t&&o.default.combineSameEntities(t),n}function l(e,s,i,n,a,o,r={offset:0}){if(3==e.nodeType){if(n===e){const t=e.nodeValue;i.push(t.substr(0,a)+""+t.substr(a))}else{const s=e.nodeValue;if(i.push(s),o&&s.trim()&&e.parentNode){const i=e.parentElement;for(const e in t.markdownTags){const n=t.markdownTags[e],a=i.closest(n.match+", [contenteditable]");a&&null===a.getAttribute("contenteditable")&&("messageEntityTextUrl"===n.entityName?o.push({_:n.entityName,url:i.href,offset:r.offset,length:s.length}):o.push({_:n.entityName,offset:r.offset,length:s.length}))}}r.offset+=s.length}return}if(1!=e.nodeType)return;const d=n===e,c="DIV"==e.tagName||"P"==e.tagName;if(c&&i.length||"BR"==e.tagName)s.push(i.join("")),i.splice(0,i.length);else if("IMG"==e.tagName){const t=e.alt;t&&(i.push(t),r.offset+=t.length)}d&&!a&&i.push("");let f=e.firstChild;for(;f;)l(f,s,i,n,a,o,r),f=f.nextSibling;d&&a&&i.push(""),c&&i.length&&(s.push(i.join("")),i.splice(0,i.length))}function c(e){return e.reduce((e,t)=>"object"==typeof t&&t.textContent?e+t.textContent:t.innerText?e+t.innerText:"IMG"==t.tagName&&t.classList&&t.classList.contains("emoji")?e+t.getAttribute("alt"):e,"")}t.isInDOM=function(e){return null==e?void 0:e.isConnected},t.cancelEvent=function(e){if(e=e||window.event){e=e.originalEvent||e;try{e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1,e.cancelBubble=!0}catch(e){}}return!1},t.placeCaretAtEnd=function(e){if(e.focus(),void 0!==window.getSelection&&void 0!==document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var s=window.getSelection();s.removeAllRanges(),s.addRange(t)}else if(void 0!==document.body.createTextRange){var i=document.body.createTextRange();i.moveToElementText(e),i.collapse(!1),i.select()}},t.getRichValue=d,a.MOUNT_CLASS_TO&&(a.MOUNT_CLASS_TO.getRichValue=d),t.markdownTags={bold:{match:'[style*="font-weight"], b',entityName:"messageEntityBold"},underline:{match:'[style*="underline"], u',entityName:"messageEntityUnderline"},italic:{match:'[style*="italic"], i',entityName:"messageEntityItalic"},monospace:{match:'[style*="monospace"], [face="monospace"]',entityName:"messageEntityPre"},strikethrough:{match:'[style*="line-through"], strike',entityName:"messageEntityStrike"},link:{match:"A",entityName:"messageEntityTextUrl"}},t.getRichElementValue=l,t.isInputEmpty=function(e){if(e.hasAttribute("contenteditable")||"INPUT"!=e.tagName){return!e.innerText.trim()&&!c(Array.from(e.childNodes)).trim()}return!e.value.trim().length},t.serializeNodes=c;var f=function(e,t,s,i,n,a,o){return[e,",",t," ",s," ",i,",",n," ",a,",",o].join("")};function h(e,t,s,i,n,a,o,r){const d=[];return d.push("M"+(e+s/2)+","+t),d.push("H"+(e+s-a)),a>0&&d.push("A"+f(a,a,0,0,1,e+s,t+a)),d.push("V"+(t+i-o)),o>0&&d.push("A"+f(o,o,0,0,1,e+s-o,t+i)),d.push("H"+(e+r)),r>0&&d.push("A"+f(r,r,0,0,1,e+0,t+i-r)),d.push("V"+(t+n)),n>0&&d.push("A"+f(n,n,0,0,1,e+n,t+0)),d.push("Z"),d.join(" ")}function u(e){if(!e.parentNode)return-1;let t=0;for(;null!=(e=e.previousElementSibling);)++t;return t}t.generatePathData=h,a.MOUNT_CLASS_TO&&(a.MOUNT_CLASS_TO.generatePathData=h),t.findUpClassName=function(e,t){return e.closest("."+t)},t.findUpTag=function(e,t){return e.closest(t)},t.findUpAttribute=function(e,t){return e.closest(`[${t}]`)},t.whichChild=u,t.fillPropertyValue=function(e){let t=e.split(" ");if(4!=t.length){t[0]||(t[0]="0px");for(let e=t.length;e<4;++e)t[e]=t[e%2]||t[0]||"0px"}return t},t.calcImageInBox=function(e,t,s,i,n){if(e<s&&t<i)return{w:e,h:t};var a=s,o=i;return e/t>s/i?o=t*s/e|0:(a=e*i/t|0)>s&&(o=o*s/a|0,a=s),n&&a>=e&&o>=t&&(a=e,o=t),{w:a,h:o}},t.positionElementByIndex=function(e,t,s){const i=e.parentElement===t?u(e):-1;return i!==s&&(-1!==i&&i<s&&(s+=1),t.childElementCount>s?t.insertBefore(e,t.children[s]):t.append(e),!0)},t.cancelSelection=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},t.getSelectedText=function(){return window.getSelection?window.getSelection().toString():document.selection?document.selection.createRange().text:""},t.blurActiveElement=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur()},t.CLICK_EVENT_NAME=r.isTouchSupported?"mousedown":"click",t.attachClickEvent=(e,s,i={})=>{const n=i.listenerSetter?i.listenerSetter.add.bind(i.listenerSetter,e):e.addEventListener.bind(e);i.listenerSetter?i.listenerSetter.removeManual.bind(i.listenerSetter,e):e.removeEventListener.bind(e);i.touchMouseDown=!0,n(t.CLICK_EVENT_NAME,s,i)},t.detachClickEvent=(e,s,i)=>{"touchend"==t.CLICK_EVENT_NAME?e.removeEventListener("touchstart",s,i):e.removeEventListener(t.CLICK_EVENT_NAME,s,i)},t.getSelectedNodes=()=>{const e=[],t=window.getSelection();for(let s=0;s<t.rangeCount;++s){const i=t.getRangeAt(s);let{startContainer:n,endContainer:a}=i;for(3!=a.nodeType&&(a=a.firstChild);n&&n!=a;)e.push(3==n.nodeType?n:n.firstChild),n=n.nextSibling;e[e.length-1]!=a&&e.push(a)}return e.filter(e=>!!e)},t.isSelectionSingle=(e=document.activeElement)=>{const s=t.getSelectedNodes();let i=!0;if([...new Set(s.map(e=>e.parentNode))].length>1)i=!1;else{const t=s[0];t&&t.parentNode!=e&&t.parentNode.parentNode!=e&&(i=!1)}return i},t.handleScrollSideEvent=(e,t,s,i)=>{if(r.isTouchSupported){let n;const a={passive:!0};i.add(e,"touchstart",t=>{t.touches.length>1?r():(n=t.touches[0].clientY,i.add(e,"touchmove",o,a),i.add(e,"touchend",r,a))},a);const o=e=>{const i=e.touches[0].clientY,a=i<n;"bottom"==t&&a?s():"top"!=t||a||s(),n=i},r=()=>{i.removeManual(e,"touchmove",o,a),i.removeManual(e,"touchend",r,a)}}else i.add(e,"wheel",e=>{const i=e.deltaY>0;"bottom"==t&&i?s():"top"!=t||i||s()},{passive:!0})},t.getElementByPoint=(e,t)=>{const s=e.getBoundingClientRect(),i=Math.ceil(s.left+(s.right-s.left)/2+1),n="bottom"==t?Math.floor(s.top+s.height-1):Math.ceil(s.top+1);return document.elementFromPoint(i,n)},t.getFilesFromEvent=function(e,t=!1){return i(this,void 0,void 0,(function*(){const s=[],n=e=>i(this,void 0,void 0,(function*(){if(e.isDirectory){const t=e.createReader();yield new Promise((e,s)=>{t.readEntries(t=>i(this,void 0,void 0,(function*(){for(const e of t)yield n(e);e()})))})}else if(e)if(t)s.push(e.type);else{const t=e instanceof File?e:e instanceof DataTransferItem?e.getAsFile():yield new Promise((t,s)=>e.file(t,s));if(!t)return;s.push(t)}}));if(e instanceof DragEvent&&e.dataTransfer.files&&!e.dataTransfer.items)for(let i=0;i<e.dataTransfer.files.length;i++){const n=e.dataTransfer.files[i];s.push(t?n.type:n)}else{const s=(e.dataTransfer||e.clipboardData||e.originalEvent.clipboardData).items,i=[];for(let e=0;e<s.length;++e){const a=s[e];if("file"===a.kind){const e=(t?a:a.webkitGetAsEntry())||a.getAsFile();i.push(n(e))}}yield Promise.all(i)}return s}))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);const n=new class{constructor(){this.overlayIsActive=!1,this.myId=0,this.idle={isIDLE:!1},this.connectionStatus={},this.broadcast=(e,t)=>{const s=new CustomEvent(e,{detail:t});document.dispatchEvent(s)},this.on=(e,t)=>{document.addEventListener(e,t)},this.addEventListener=this.on,this.off=(e,t)=>{document.removeEventListener(e,t)},this.removeEventListener=this.off,this.on("user_auth",e=>{this.myId=e.detail}),this.on("connection_status_change",e=>{const t=e.detail;this.connectionStatus[e.detail.name]=t})}};i.MOUNT_CLASS_TO&&(i.MOUNT_CLASS_TO.rootScope=n),t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MOUNT_CLASS_TO=t.DEBUG=t.Modes=t.App=t.REPLIES_PEER_ID=void 0,t.REPLIES_PEER_ID=1271266957,t.App={id:1025907,hash:"452b0359b988148995f22ff0f4229750",version:"0.4.0",domains:[],baseDcId:2},t.Modes={test:location.search.indexOf("test=1")>0,debug:location.search.indexOf("debug=1")>0,http:!1,ssl:!0,multipleConnections:!0},t.DEBUG=!1,t.MOUNT_CLASS_TO=t.DEBUG?"undefined"!=typeof window?window:self:null},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RichTextProcessor=void 0;const n=i(s(67)),a=i(s(111)),o=s(82),r=s(2),d=s(33),l=s(12),c={emojiMap:e=>e,shortcuts:[],emojis:[]},f=n.default.Emoji,h="a-z\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0100-\\u024f\\u0253\\u0254\\u0256\\u0257\\u0259\\u025b\\u0263\\u0268\\u026f\\u0272\\u0289\\u028b\\u02bb\\u0300-\\u036f\\u1e00-\\u1eff\\u0400-\\u04ff\\u0500-\\u0527\\u2de0-\\u2dff\\ua640-\\ua69f\\u0591-\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u05d0-\\u05ea\\u05f0-\\u05f4\\ufb1d-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufb4f\\u0610-\\u061a\\u0620-\\u065f\\u066e-\\u06d3\\u06d5-\\u06dc\\u06de-\\u06e8\\u06ea-\\u06ef\\u06fa-\\u06fc\\u06ff\\u0750-\\u077f\\u08a0\\u08a2-\\u08ac\\u08e4-\\u08fe\\ufb50-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\u200c\\u0e01-\\u0e3a\\u0e40-\\u0e4e\\u1100-\\u11ff\\u3130-\\u3185\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF\\u3003\\u3005\\u303b\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uff9f\\uffa1-\\uffdc",u="((?:https?|ftp)://|mailto:)?(?:\\S{1,64}(?::\\S{0,64})?@)?(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}|["+h+"0-9]["+h+"·0-9-]{0,64}(?:\\.["+h+"0-9]["+h+"·0-9-]{0,64}){0,10}(?:\\.(xn--[0-9a-z]{2,16}|["+h+"]{2,24})))(?::\\d{2,5})?(?:/(?:\\S{0,255}[^\\s.;,(\\[\\]{}<>\"'])?)?",p=new RegExp("(^| )(@)([a-zA-Z\\d_]{5,32})|("+u+")|(\\n)|("+a.default+")|(^|[\\s\\(\\]])(#[0-9_a-z\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0100-\\u024f\\u0253\\u0254\\u0256\\u0257\\u0259\\u025b\\u0263\\u0268\\u026f\\u0272\\u0289\\u028b\\u02bb\\u0300-\\u036f\\u1e00-\\u1eff\\u0400-\\u04ff\\u0500-\\u0527\\u2de0-\\u2dff\\ua640-\\ua69f\\u0591-\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u05d0-\\u05ea\\u05f0-\\u05f4\\ufb1d-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufb4f\\u0610-\\u061a\\u0620-\\u065f\\u066e-\\u06d3\\u06d5-\\u06dc\\u06de-\\u06e8\\u06ea-\\u06ef\\u06fa-\\u06fc\\u06ff\\u0750-\\u077f\\u08a0\\u08a2-\\u08ac\\u08e4-\\u08fe\\ufb50-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\u200c\\u0e01-\\u0e3a\\u0e40-\\u0e4e\\u1100-\\u11ff\\u3130-\\u3185\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF\\u3003\\u3005\\u303b\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uff9f\\uffa1-\\uffdc]{2,64})|(^|\\s)\\/([a-zA-Z\\d_]{1,32})(?:@([a-zA-Z\\d_]{5,32}))?(\\b|$)","i"),g=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,m=/(^|\s|\n)(````?)([\s\S]+?)(````?)([\s\n\.,:?!;]|$)|(^|\s|\x01)(`|~~|\*\*|__|_-_)([^\n]+?)\7([\x01\s\.,:?!;]|$)|@(\d+)\s*\((.+?)\)|(\[(.+?)\]\((.+?)\))/m,b={Telegram:"tg://search_hashtag?hashtag={1}",Twitter:"https://twitter.com/hashtag/{1}",Instagram:"https://instagram.com/explore/tags/{1}/","Google Plus":"https://plus.google.com/explore/{1}"},v={Telegram:"#/im?p=%40{1}",Twitter:"https://twitter.com/{1}",Instagram:"https://instagram.com/{1}/",GitHub:"https://github.com/{1}"},y={"`":"messageEntityCode","``":"messageEntityPre","**":"messageEntityBold",__:"messageEntityItalic","~~":"messageEntityStrike","_-_":"messageEntityUnderline"};var M;!function(e){function t(e){let t=o.encodeEmoji(e);return"1f441-200d-1f5e8"==t&&(t="1f441-fe0f-200d-1f5e8-fe0f"),f.hasOwnProperty(t)?t.replace(/(-fe0f|fe0f)/g,""):null}function s(e){var s,i=e;const a=[];let o;for(var r=0;s=i.match(p);){if(o=r+s.index,s[3])a.push({_:"messageEntityMention",offset:o+s[1].length,length:s[2].length+s[3].length});else if(s[4])if(g.test(s[4]))a.push({_:"messageEntityEmail",offset:o,length:s[4].length});else{var d=!1,l=s[5],c=s[6];if(c){if(l||"xn--"!==c.substr(0,4)&&-1===n.default.TLD.indexOf(c.toLowerCase())||(l="http://"),l){var f=h(s[4]);f.length!==s[4].length&&(s[4].substring(f.length),s[4]=f),d=(s[5]?"":l)+s[4]}}else d=(s[5]?"":"http://")+s[4];d&&a.push({_:"messageEntityUrl",offset:o,length:s[4].length})}else if(s[7])a.push({_:"messageEntityLinebreak",offset:o,length:1});else if(s[8]){let e=t(s[8]);e&&a.push({_:"messageEntityEmoji",offset:o,length:s[8].length,unicode:e})}else s[11]?a.push({_:"messageEntityHashtag",offset:o+(s[10]?s[10].length:0),length:s[11].length}):s[12]&&a.push({_:"messageEntityBotCommand",offset:o+(s[11]?s[11].length:0),length:1+s[12].length+(s[13]?1+s[13].length:0)});i=i.substr(s.index+s[0].length),r+=s.index+s[0].length}return a}function i(e,t){e=e.slice();const s=t.filter(t=>!e.find(e=>t._==e._&&t.offset==e.offset&&t.length==e.length));return e.push(...s),e.sort((e,t)=>e.offset-t.offset),e}function a(e){for(let t=0;t<e.length;++t){const s=e[t];let i=-1;do{if(i=e.findIndex((e,i)=>i!==t&&e._===s._&&e.offset-s.length===s.offset),-1!==i){const t=e[i];s.length+=t.length,e.splice(i,1)}}while(-1!==i)}}function r(t,i={}){if(!t||!t.length)return"";const n=[],a=i.entities||s(t),o=i.passEntities||{},r=i.contextSite||"Telegram",c="Telegram"!=r,f=(e,t,s)=>{n.push({part:t,offset:e.offset}),s&&n.unshift({part:s,offset:e.offset+e.length})};for(const s of a)switch(s._){case"messageEntityBold":i.noTextFormat||(i.wrappingDraft?f(s,'<span style="font-weight: bold;">',"</span>"):f(s,"<strong>","</strong>"));break;case"messageEntityItalic":i.noTextFormat||(i.wrappingDraft?f(s,'<span style="font-style: italic;">',"</span>"):f(s,"<em>","</em>"));break;case"messageEntityStrike":if(i.wrappingDraft){f(s,`<span style="${l.isSafari?"text-decoration":"text-decoration-line"}: line-through;">`,"</span>")}else f(s,"<del>","</del>");break;case"messageEntityUnderline":if(i.wrappingDraft){f(s,`<span style="${l.isSafari?"text-decoration":"text-decoration-line"}: underline;">`,"</span>")}else f(s,"<u>","</u>");break;case"messageEntityCode":i.wrappingDraft?f(s,'<span style="font-family: monospace;">',"</span>"):f(s,"<code>","</code>");break;case"messageEntityPre":i.noTextFormat||f(s,`<pre><code${s.language?' class="language-'+d.encodeEntities(s.language)+'"':""}>`,"</code></pre>");break;case"messageEntityHighlight":f(s,"<i>","</i>");break;case"messageEntityBotCommand":if(!(i.noLinks||i.noCommands||c)){let e,n,a=t.substr(s.offset,s.length).substr(1);-1!=(n=a.indexOf("@"))?(e=a.substr(n+1),a=a.substr(0,n)):e=i.fromBot,f(s,`<a href="${d.encodeEntities("tg://bot_command?command="+encodeURIComponent(a)+(e?"&bot="+encodeURIComponent(e):""))}">`,"</a>")}break;case"messageEntityEmoji":i.wrappingDraft&&e.emojiSupported||(e.emojiSupported?f(s,'<span class="emoji">',"</span>"):f(s,`<img src="assets/img/emoji/${s.unicode}.png" alt="`,'" class="emoji">'));break;case"messageEntityUrl":case"messageEntityTextUrl":if(!i.noLinks||o[s._]){const e=t.substr(s.offset,s.length);let i;"messageEntityTextUrl"==s._?(i=s.url,i=_(i,!0)):i=_(e,!1);const n="#"===i[0];f(s,`<a href="${d.encodeEntities(i)}"${n?"":' target="_blank" rel="noopener noreferrer"'}>`,"</a>")}break;case"messageEntityEmail":if(!i.noLinks){const e=t.substr(s.offset,s.length);f(s,`<a href="${d.encodeEntities("mailto:"+e)}" target="_blank" rel="noopener noreferrer">`,"</a>")}break;case"messageEntityHashtag":{const e=!i.noLinks&&b[r];if(e){const i=t.substr(s.offset,s.length).substr(1);f(s,`<a href="${e.replace("{1}",encodeURIComponent(i))}"${c?' target="_blank" rel="noopener noreferrer"':""}>`,"</a>")}break}case"messageEntityMentionName":i.noLinks||f(s,`<a href="#/im?p=u${encodeURIComponent(s.user_id)}" class="follow" data-follow="${s.user_id}">`,"</a>");break;case"messageEntityMention":{const e=!i.noLinks&&v[r];if(e){const i=t.substr(s.offset,s.length).substr(1);f(s,`<a class="mention" href="${e.replace("{1}",encodeURIComponent(i))}"${c?' target="_blank" rel="noopener noreferrer"':""}>`,"</a>")}break}}n.sort((e,t)=>e.offset-t.offset);let h="",u=0;for(const{part:e,offset:s}of n)s>u&&(h+=d.encodeEntities(t.slice(u,s)),u=s),h+=e;return u<t.length&&(h+=d.encodeEntities(t.slice(u))),h}function h(e){for(var t=e.length,s=e.split("(").length-1,i=e.split(")").length-1;i>s&&")"===e.charAt(t-1);)e=e.substr(0,t-1),i--,t--;return s>i&&(e=e.replace(/\)+$/,"")),e}function M(e){if(!e)return"";return r(e,{entities:s(e).filter(e=>"messageEntityEmoji"==e._)})}function _(e,t){var s,i;if(e.match(/^https?:\/\//i)||(e="https://"+e),s=e.match(/^https?:\/\/t(?:elegram)?\.me\/(.+)/)){var n=s[1].split("/");switch(n[0]){case"joinchat":e="tg://join?invite="+n[1];break;case"addstickers":e="tg://addstickers?set="+n[1];break;default:if(n[1]&&n[1].match(/^\d+$/))e=v.Telegram.replace("{1}",n[0]+"&post="+n[1]);else if(1==n.length){var a=n[0].split("?"),o=a[0],r=a[1];if("iv"==o){var d=(r||"").match(/url=([^&=]+)/);if(d){e=d[1];try{e=decodeURIComponent(e)}catch(e){}return _(e,t)}}e=v.Telegram.replace("{1}",o+(r?"&"+r:""))}}}else(i=e.match(/^https?:\/\/telesco\.pe\/([^/?]+)\/(\d+)/))&&(e="tg://resolve?domain="+i[1]+"&post="+i[2]);return e}e.emojiSupported=-1!=navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i),e.getEmojiSpritesheetCoords=t,e.parseEntities=s,e.parseMarkdown=function(e,t,s){const n=[];let o,r=e,d=[],l=0;for(;o=r.match(m);){const e=l+o.index;d.push(r.substr(0,o.index));let t=o[3]||o[8]||o[11]||o[14];if(l-=t.length,l+=t.length,t.match(/^`*$/))d.push(o[0]);else if(o[3])"\n"==o[5]&&(o[5]="",l-=1),d.push(o[1]+t+o[5]),n.push({_:"messageEntityPre",language:"",offset:e+o[1].length,length:t.length}),l-=o[2].length+o[4].length;else if(o[7]){const s=""==o[6];s?d.push(t):d.push(o[6]+t+o[9]),n.push({_:y[o[7]],offset:e+(s?0:o[6].length),length:t.length}),l-=2*o[7].length+(s?2:0)}else o[11]?(d.push(t),n.push({_:"messageEntityMentionName",user_id:+o[10],offset:e,length:t.length}),l-=o[0].length-t.length):o[12]&&(d.push(t),n.push({_:"messageEntityTextUrl",url:o[13],offset:e,length:t.length}),l-=o[12].length-t.length);r=r.substr(o.index+o[0].length),l+=o.index+o[0].length}return d.push(r),d=d.join(""),d.replace(/\s+/g,"").length||(d=e,n.splice(0,n.length)),n.length||s||(d=d.trim()),i(t,n),a(t),d},e.mergeEntities=i,e.combineSameEntities=a,e.wrapRichText=r,e.wrapDraftText=function(e,t={}){return e?r(e,{entities:(t.entities||[]).slice(),noLinks:!0,wrappingDraft:!0,passEntities:{messageEntityTextUrl:!0}}):""},e.checkBrackets=h,e.replaceUrlEncodings=function(e){return e.replace(/(%[A-Z\d]{2})+/g,e=>{try{return decodeURIComponent(e)}catch(t){return e}})},e.wrapPlainText=function(t){if(e.emojiSupported)return t;if(!t||!t.length)return"";var s,i,n=t=t.replace(/\ufe0f/g,"",t);for(t=[];s=n.match(p);){if(t.push(n.substr(0,s.index)),s[8]){const e=c.emojiMap[s[8]];e&&(i=f[e][1][0])?t.push(":"+i+":"):t.push(s[0])}else t.push(s[0]);n=n.substr(s.index+s[0].length)}return t.push(n),t.join("")},e.wrapEmojiText=M,e.wrapUrl=_,e.matchUrl=function(e){return e?e.match(u):null},e.getAbbreviation=function(e,t=!1){const s=e.trim().split(" ");if(!s[0])return"";const i=[...s[0]][0];return t||1==s.length?M(i):M(i+[...s[s.length-1]][0])}}(M||(M={})),t.RichTextProcessor=M,r.MOUNT_CLASS_TO&&(r.MOUNT_CLASS_TO.RichTextProcessor=M),t.default=M},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.attachContextMenuListener=t.positionMenu=t.openBtnMenu=t.closeBtnMenu=t.parseMenuButtonsTo=t.formatPhoneNumber=t.putPreloader=t.renderImageFromUrl=t.loadedURLs=void 0;const r=a(s(81)),d=s(0),l=o(s(9)),c=s(11),f=s(12);t.loadedURLs={};const h=(e,t)=>{e instanceof HTMLImageElement||e instanceof HTMLVideoElement?e.src=t:e instanceof SVGImageElement?e.setAttributeNS(null,"href",t):e.style.backgroundImage="url("+t+")"};let u;t.renderImageFromUrl=function(e,s,i){if(t.loadedURLs[s]||e instanceof HTMLVideoElement)return h(e,s),i&&i(),!0;{const n=e instanceof HTMLImageElement,a=n?e:new Image;return a.src=s,a.addEventListener("load",()=>{n||h(e,s),t.loadedURLs[s]=!0,i&&i()}),i&&a.addEventListener("error",i),!1}},t.putPreloader=function(e,t=!1){const s='\n  <svg xmlns="http://www.w3.org/2000/svg" class="preloader-circular" viewBox="25 25 50 50">\n  <circle class="preloader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n  </svg>';if(t){let t=document.createElement("div");return t.classList.add("preloader"),t.innerHTML=s,e&&e.appendChild(t),t}e.innerHTML+=s},t.formatPhoneNumber=function(e){let t=(e=e.replace(/\D/g,"")).slice(0,6);u||(u=r.default.slice().sort((e,t)=>t.phoneCode.length-e.phoneCode.length));let s=u.find(e=>e.phoneCode.split(" and ").find(e=>0==t.indexOf(e.replace(/\D/g,""))));return s?(s=r.PhoneCodesMain[s.phoneCode]||s,(s.pattern||s.phoneCode).split("").forEach((t,s)=>{" "==t&&" "!=e[s]&&e.length>s&&(e=e.slice(0,s)+" "+e.slice(s))}),{formatted:e,country:s}):{formatted:e,country:s}},t.parseMenuButtonsTo=function(e,t){Array.from(t).forEach(t=>{const s=t.className.match(/(?:^|\s)menu-(.+?)(?:$|\s)/);s&&(e[s[1]]=t)})};let p=e=>{let s=b.getBoundingClientRect(),{clientX:i,clientY:n}=e,a=i>=s.right?i-s.right:s.left-i,o=n>=s.bottom?n-s.bottom:s.top-n;(a>=100||o>=100)&&t.closeBtnMenu()};const g=e=>{t.closeBtnMenu()},m=e=>{"Escape"==e.key&&(t.closeBtnMenu(),d.cancelEvent(e))};t.closeBtnMenu=()=>{b&&(b.classList.remove("active"),b.parentElement.classList.remove("menu-open"),y&&y.remove(),b=null),v&&(v(),v=null),c.isTouchSupported||(window.removeEventListener("mousemove",p),window.removeEventListener("keydown",m,{capture:!0}),window.removeEventListener("contextmenu",g)),document.removeEventListener(d.CLICK_EVENT_NAME,g)},window.addEventListener("resize",()=>{b&&t.closeBtnMenu()});let b=null,v=null,y=null;t.openBtnMenu=function(e,s){t.closeBtnMenu(),b=e,b.classList.add("active"),b.parentElement.classList.add("menu-open"),y||(y=document.createElement("div"),y.classList.add("btn-menu-overlay"),y.addEventListener(d.CLICK_EVENT_NAME,e=>{d.cancelEvent(e),g()})),b.parentElement.insertBefore(y,b),v=s,c.isTouchSupported||(window.addEventListener("mousemove",p),window.addEventListener("keydown",m,{capture:!0}),window.addEventListener("contextmenu",g,{once:!0})),document.addEventListener(d.CLICK_EVENT_NAME,g)};t.positionMenu=function({pageX:e,pageY:t},s,i){let{scrollWidth:n,scrollHeight:a}=s;const o=document.body.getBoundingClientRect(),r=o.width,d=o.height;i=l.default.isMobile?"right":"left";let c="top";const f={x:{left:e,right:e-n},intermediateX:"right"==i?8:r-n-8,y:{top:t,bottom:t-a},intermediateY:t<d/2?8:d-a-8},h={left:f.x.left+n+8<=r,right:f.x.right>=8},u={top:f.y.top+a+8<=d,bottom:f.y.bottom-8>=8};{let e;e=h[i]?f.x[i]:(i="center",f.intermediateX),s.style.left=e+"px"}{let e;e=u[c]?f.y[c]:(c="center",f.intermediateY),s.style.top=e+"px"}s.className=s.className.replace(/(top|center|bottom)-(left|center|right)/g,""),s.classList.add(("center"==c?c:"bottom")+"-"+("center"==i?i:"left"==i?"right":"left"))},t.attachContextMenuListener=function(e,t,s){const i=s?s.add.bind(s,e):e.addEventListener.bind(e),n=s?s.removeManual.bind(s,e):e.removeEventListener.bind(e);if(f.isApple&&c.isTouchSupported){let s;const a={capture:!0},o=()=>{clearTimeout(s),n("touchmove",o,a),n("touchend",o,a),n("touchcancel",o,a)};i("touchstart",n=>{n.touches.length>1?o():(i("touchmove",o,a),i("touchend",o,a),i("touchcancel",o,a),s=window.setTimeout(()=>{t(n.touches[0]),o(),b&&e.addEventListener("touchend",d.cancelEvent,{once:!0})},400))})}else i("contextmenu",c.isTouchSupported?s=>{t(s),b&&e.addEventListener("touchend",d.cancelEvent,{once:!0})}:t)}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ApiManagerProxy=void 0;const n=i(s(113)),a=s(14),o=i(s(114)),r=s(16),d=i(s(1)),l=i(s(68)),c=s(2),f=i(s(45));class h extends o.default{constructor(){super(),this.afterMessageIdTemp=0,this.taskId=0,this.awaiting={},this.pending=[],this.updatesProcessor=null,this.log=r.logger("API-PROXY"),this.hashes={},this.log("constructor"),this.registerServiceWorker(),this.registerWorker()}registerServiceWorker(){"serviceWorker"in navigator&&(navigator.serviceWorker.register("./sw.js",{scope:"./"}).then(e=>{},e=>{this.log.error("SW registration failed!",e)}),navigator.serviceWorker.ready.then(e=>{this.log("set SW"),this.releasePending()}),navigator.serviceWorker.addEventListener("controllerchange",()=>{this.log.warn("controllerchange"),this.releasePending(),navigator.serviceWorker.controller.addEventListener("error",e=>{this.log.error("controller error:",e)})}),navigator.serviceWorker.addEventListener("message",e=>{const t=e.data;a.isObject(t)&&this.postMessage(t)}),navigator.serviceWorker.addEventListener("messageerror",e=>{this.log.error("SW messageerror:",e)}))}registerWorker(){const e=new n.default;e.addEventListener("message",t=>{if(!this.worker){this.worker=e,this.log("set webWorker"),this.postMessage=this.worker.postMessage.bind(this.worker);const t=l.default.isWebpSupported();this.log("WebP supported:",t),this.postMessage({type:"webpSupport",payload:t}),this.releasePending()}const s=t.data;if(a.isObject(s))if(s.update)this.updatesProcessor&&this.updatesProcessor(s.update.obj,s.update.bool);else if(s.progress)d.default.broadcast("download_progress",s.progress);else if("reload"==s.type)location.reload();else if("connectionStatusChange"==s.type)d.default.broadcast("connection_status_change",s.payload);else if("convertWebp"==s.type)l.default.postMessage(s);else if("requestFilePart"==s.type){const e=s;if(e.error){const t=i=>{if("FILE_REFERENCE_EXPIRED"==(null==i?void 0:i.type)){const s=e.originalPayload[1].file_reference;f.default.refreshReference(s).then(()=>{e.originalPayload[1].file_reference=f.default.getReferenceByLink(s);const t={type:e.type,id:e.id,payload:e.originalPayload};this.postMessage(t)}).catch(t)}else navigator.serviceWorker.controller.postMessage(s)};t(e.error)}else navigator.serviceWorker.controller.postMessage(s)}else this.finalizeTask(s.taskId,s.result,s.error)})}finalizeTask(e,t,s){const i=this.awaiting[e];void 0!==i&&(this.log.debug("done",i.taskName,t,s),s?i.reject(s):i.resolve(t),delete this.awaiting[e])}performTaskWorker(e,...t){return this.log.debug("start",e,t),new Promise((s,i)=>{this.awaiting[this.taskId]={resolve:s,reject:i,taskName:e};const n={task:e,taskId:this.taskId,args:t};this.pending.push(n),this.releasePending(),this.taskId++})}releasePending(){this.postMessage&&(this.log.debug("releasing tasks, length:",this.pending.length),this.pending.forEach(e=>{this.postMessage(e)}),this.log.debug("released tasks"),this.pending.length=0)}setUpdatesProcessor(e){this.updatesProcessor=e}invokeApi(e,t={},s={}){return this.performTaskWorker("invokeApi",e,t,s)}invokeApiAfter(e,t={},s={}){let i=s;return i.prepareTempMessageId=""+ ++this.afterMessageIdTemp,i=Object.assign({},s),s.messageId=i.prepareTempMessageId,this.performTaskWorker("invokeApi",e,t,i)}invokeApiHashable(e,t={},s={}){const i=JSON.stringify(t);let n;return this.hashes[e]&&(n=this.hashes[e][i],n&&(t.hash=n.hash)),this.performTaskWorker("invokeApi",e,t,s).then(t=>{if(t._.includes("NotModified"))return this.log.warn("NotModified saved!",e,i),n.result;if(t.hash){const s=t.hash;this.hashes[e]||(this.hashes[e]={}),this.hashes[e][i]={hash:s,result:t}}return t})}setBaseDcId(e){return this.performTaskWorker("setBaseDcId",e)}setQueueId(e){return this.performTaskWorker("setQueueId",e)}setUserAuth(e){return d.default.broadcast("user_auth",e),this.performTaskWorker("setUserAuth",e)}getNetworker(e,t){return this.performTaskWorker("getNetworker",e,t)}logOut(){return this.performTaskWorker("logOut")}cancelDownload(e){return this.performTaskWorker("cancelDownload",e)}downloadFile(e){return this.performTaskWorker("downloadFile",e)}uploadFile(e){return this.performTaskWorker("uploadFile",e)}}t.ApiManagerProxy=h;const u=new h;c.MOUNT_CLASS_TO&&(c.MOUNT_CLASS_TO.apiManagerProxy=u),t.default=u},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollableX=t.ScrollableBase=void 0;const o=s(30),r=s(11),d=s(16),l=a(s(112));window.__forceSmoothScrollPolyfill__=!0,l.default();class c{constructor(e,t="",s=document.createElement("div")){this.el=e,this.container=s,this.scrollLocked=0,this.scrollLockedPromise=Promise.resolve(),this.container.classList.add("scrollable"),this.log=d.logger("SCROLL"+(t?"-"+t:""),d.LogLevels.error),e&&(Array.from(e.children).forEach(e=>this.container.append(e)),e.append(this.container))}setListeners(){window.addEventListener("resize",this.onScroll,{passive:!0}),this.container.addEventListener("scroll",this.onScroll,{passive:!0,capture:!0})}append(e){this.container.append(e)}scrollTo(e,t,s=!0,i=!1,n=l.SCROLL_TIME){if(this.scrollLocked&&!i)return;if(this.getScrollValue()==Math.floor(e))return;const a=!!this.scrollLocked;a&&clearTimeout(this.scrollLocked),s?(a||(this.scrollLockedPromise=o.deferredPromise()),this.scrollLocked=window.setTimeout(()=>{this.scrollLocked=0,this.scrollLockedPromise.resolve(),this.container.dispatchEvent(new CustomEvent("scroll"))},n)):a&&this.scrollLockedPromise.resolve();const r={behavior:s?"smooth":"auto",scrollTime:n};r[t]=e,this.container.scrollTo(r),s||this.container.dispatchEvent(new CustomEvent("scroll"))}}t.ScrollableBase=c;t.default=class extends c{constructor(e,t="",s=300){super(e,t),this.onScrollOffset=s,this.onAdditionalScroll=null,this.onScrolledTop=null,this.onScrolledBottom=null,this.onScrollMeasure=null,this.lastScrollTop=0,this.lastScrollDirection=0,this.loadedAll={top:!0,bottom:!1},this.onScroll=()=>{(!this.scrollLocked&&(this.onScrolledTop||this.onScrolledBottom)||this.splitUp||this.onAdditionalScroll)&&(this.onScrollMeasure&&window.cancelAnimationFrame(this.onScrollMeasure),this.onScrollMeasure=window.requestAnimationFrame(()=>{this.onScrollMeasure=0;const e=this.container.scrollTop;this.lastScrollDirection=this.lastScrollTop==e?0:this.lastScrollTop<e?1:-1,this.lastScrollTop=e,this.onAdditionalScroll&&0!==this.lastScrollDirection&&this.onAdditionalScroll(),this.checkForTriggers&&this.checkForTriggers()}))},this.checkForTriggers=()=>{if(this.scrollLocked||!this.onScrolledTop&&!this.onScrolledBottom)return;const e=this.container.scrollHeight;if(!e)return;const t=e-this.container.clientHeight,s=this.lastScrollTop;this.onScrolledTop&&s<=this.onScrollOffset&&this.lastScrollDirection<=0&&this.onScrolledTop(),this.onScrolledBottom&&t-s<=this.onScrollOffset&&this.lastScrollDirection>=0&&this.onScrolledBottom()},this.getScrollValue=()=>this.scrollTop,this.container.classList.add("scrollable-y"),this.setListeners()}setVirtualContainer(e){this.splitUp=e,this.log("setVirtualContainer:",e,this)}prepend(e){(this.splitUp||this.container).prepend(e)}append(e){(this.splitUp||this.container).append(e)}scrollIntoView(e,t=!0){if(e.parentElement&&!this.scrollLocked){const s=e.classList.contains("is-first-unread");let i=e.getBoundingClientRect().top-this.container.getBoundingClientRect().top;if(i=this.scrollTop+i,!t&&s)return void this.scrollTo(i,"top",!1);const n=this.container.clientHeight,a=e.scrollHeight;i-=a>=n?0:(n-a)/2,this.scrollTo(i,"top",t)}}get isScrolledDown(){return this.scrollHeight-Math.round(this.scrollTop+this.container.offsetHeight)<=1}set scrollTop(e){this.container.scrollTop=e}get scrollTop(){return this.container.scrollTop}get scrollHeight(){return this.container.scrollHeight}};t.ScrollableX=class extends c{constructor(e,t="",s=300,i=15,n=document.createElement("div")){if(super(e,t,n),this.onScrollOffset=s,this.splitCount=i,this.container=n,this.getScrollValue=()=>this.container.scrollLeft,this.container.classList.add("scrollable-x"),!r.isTouchSupported){const e=e=>{if(1==(e=window.event||e).which)return;const t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));this.container.scrollLeft-=20*t,e.preventDefault()};this.container.addEventListener?(this.container.addEventListener("mousewheel",e,!1),this.container.addEventListener("DOMMouseScroll",e,!1)):this.container.attachEvent("onmousewheel",e)}this.setListeners()}scrollIntoView(e,t=!0,s){if(e.parentElement&&!this.scrollLocked){let i=e.getBoundingClientRect().left-this.container.getBoundingClientRect().left;i=this.getScrollValue()+i;const n=this.container.clientWidth,a=e.scrollWidth;i-=a>=n?0:(n-a)/2,this.scrollTo(i,"left",t,void 0,s)}}}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppMessagesManager=void 0;const a=s(25),o=n(s(46)),r=s(30),d=s(18),l=s(83),c=s(14),f=s(65),h=s(33),u=s(84),p=s(16),g=n(s(5)),m=s(2),b=n(s(45)),v=n(s(57)),y=s(3),M=n(s(1)),_=n(s(69)),w=n(s(55)),S=n(s(117)),I=n(s(118)),L=n(s(35)),E=n(s(19)),C=n(s(21)),T=n(s(40)),P=n(s(10)),k=n(s(20)),x=n(s(58)),A=n(s(13)),D=n(s(8)),X=n(s(86));class F{constructor(){this.messagesStorageByPeerId={},this.groupedMessagesStorage={},this.scheduledMessagesStorage={},this.historiesStorage={},this.threadsStorage={},this.searchesStorage={},this.pinnedMessages={},this.threadsServiceMessagesIdsStorage={},this.threadsToReplies={},this.pendingByRandomId={},this.pendingByMessageId={},this.pendingAfterMsgs={},this.pendingTopMsgs={},this.sendFilePromise=Promise.resolve(),this.tempNum=0,this.tempFinalizeCallbacks={},this.sendSmthLazyLoadQueue=new a.LazyLoadQueueBase(1),this.needSingleMessages={},this.fetchSingleMessagesPromise=null,this.maxSeenId=0,this.migratedFromTo={},this.migratedToFrom={},this.newMessagesHandlePromise=0,this.newMessagesToHandle={},this.newDialogsHandlePromise=0,this.newDialogsToHandle={},this.newUpdatesAfterReloadToHandle={},this.reloadConversationsPeers=[],this.dialogsIndex=_.default.createIndex(),this.cachedResults={query:"",count:0,dialogs:[],folderId:0},this.log=p.logger("MESSAGES",p.LogLevels.error|p.LogLevels.debug|p.LogLevels.log|p.LogLevels.warn),this.handleNewMessages=()=>{clearTimeout(this.newMessagesHandlePromise),this.newMessagesHandlePromise=0,M.default.broadcast("history_multiappend",this.newMessagesToHandle),this.newMessagesToHandle={}},this.handleNewDialogs=()=>{clearTimeout(this.newDialogsHandlePromise),this.newDialogsHandlePromise=0;let e=0;for(const t in this.newDialogsToHandle){const s=this.newDialogsToHandle[t];"reload"in s?(this.reloadConversation(+t),delete this.newDialogsToHandle[t]):(this.dialogsStorage.pushDialog(s),P.default.isChannel(+t)||(e=Math.max(e,s.top_message||0)))}0!=e&&this.incrementMaxSeenId(e),M.default.broadcast("dialogs_multiupdate",this.newDialogsToHandle),this.newDialogsToHandle={}},this.dialogsStorage=new S.default(this,E.default,P.default,v.default),this.filtersStorage=new I.default(P.default,D.default,M.default),M.default.on("apiUpdate",e=>{this.handleUpdate(e.detail)}),M.default.on("webpage_updated",e=>{const t=e.detail;t.msgs.forEach(e=>{const s=this.getMessageById(e);if(!s)return;s.media={_:"messageMediaWebPage",webpage:X.default.getWebPage(t.id)};const i=this.getMessagePeer(s),n=this.getMessagesStorage(i);M.default.broadcast("message_edit",{storage:n,peerId:i,mid:e})})}),A.default.addListener("save",()=>{const e=[],t=[],s=[],i=s=>{const i=this.getHistoryStorage(s.peerId),n=[].concat(i.history);s=c.copy(s);let a=0;for(const t of n){const i=this.getMessageByPeer(s.peerId,t);if(!i.pFlags.is_outgoing){e.push(i),i.fromId!=s.peerId&&A.default.setPeer(i.fromId,P.default.getPeer(i.fromId)),s.top_message=i.mid,this.setDialogIndexByMessage(s,i);break}i.pFlags&&i.pFlags.unread&&++a}a&&s.unread_count&&(s.unread_count-=a),s.unread_count=Math.max(0,s.unread_count),t.push(s),A.default.setPeer(s.peerId,P.default.getPeer(s.peerId))};for(const e in this.dialogsStorage.byFolders){const t=this.dialogsStorage.getFolder(+e);for(let e of t)s.push(e)}return new Promise(e=>function(e,t,s,i){if(!e.length)return i(e);const n=e.slice(),a=()=>{const o=+new Date;do{t.call(s,n.shift())}while(n.length>0&&+new Date-o<50);n.length>0?setTimeout(a,25):i(e)};setTimeout(a,25)}(s,i,this,e)).then(()=>{A.default.pushToState("dialogs",t),A.default.pushToState("messages",e),A.default.pushToState("filters",this.filtersStorage.filters),A.default.pushToState("allDialogsLoaded",this.dialogsStorage.allDialogsLoaded),A.default.pushToState("maxSeenMsgId",this.maxSeenId)})}),A.default.getState().then(e=>{e.maxSeenMsgId&&(this.maxSeenId=e.maxSeenMsgId);const t=e.messages;if(t&&this.saveMessages(t),e.dialogs&&Object.keys(e.dialogs).length||(e.allDialogsLoaded={}),e.allDialogsLoaded&&(this.dialogsStorage.allDialogsLoaded=e.allDialogsLoaded),e.filters)for(const t in e.filters)this.filtersStorage.saveDialogFilter(e.filters[t],!1);e.dialogs&&e.dialogs.forEachReverse(e=>{this.saveConversation(e);this.getMessageByPeer(e.peerId,e.top_message).deleted&&this.reloadConversation(e.peerId)})})}getInputEntities(e){var t=c.copy(e);return t.forEach(e=>{"messageEntityMentionName"==e._&&(e._="inputMessageEntityMentionName",e.user_id=D.default.getUserInput(e.user_id))}),t}invokeAfterMessageIsSent(e,t,s){var i,n;const a=null!==(i=this.tempFinalizeCallbacks[e])&&void 0!==i?i:this.tempFinalizeCallbacks[e]={},o=null!==(n=a[t])&&void 0!==n?n:a[t]={deferred:r.deferredPromise()};return o.callback=s,o.deferred}editMessage(e,t,s={}){const{mid:i,peerId:n}=e;if(e.pFlags.is_outgoing)return this.invokeAfterMessageIsSent(i,"edit",e=>(this.log("invoke editMessage callback",e),this.editMessage(e,t,s)));let a=s.entities||[];t&&(t=y.RichTextProcessor.parseMarkdown(t,a));const o=s.scheduleDate||(e.pFlags.is_scheduled?e.date:void 0);return g.default.invokeApi("messages.editMessage",{peer:P.default.getInputPeerById(n),id:e.id,message:t,media:s.newMedia,entities:a.length?this.getInputEntities(a):void 0,no_webpage:s.noWebPage,schedule_date:o}).then(e=>{L.default.processUpdateMessage(e)},e=>{if(this.log.error("editMessage error:",e),!e||"MESSAGE_NOT_MODIFIED"!=e.type)return e&&"MESSAGE_EMPTY"==e.type&&(e.handled=!0),Promise.reject(e);e.handled=!0})}sendText(e,t,s={}){if("string"!=typeof t||!t.length)return;if(t.length>4096){const i=h.splitStringByLength(t,4096);t=i[0],i.length>1&&delete s.webPage;for(let t=1;t<i.length;++t)setTimeout(()=>{this.sendText(e,i[t],s)},t)}e=P.default.getPeerMigratedTo(e)||e;let i=s.entities||[];s.viaBotId||(t=y.RichTextProcessor.parseMarkdown(t,i));let n=this.getInputEntities(i);n.length||(n=void 0);const a=this.generateTempMessageId(e),o=f.randomLong(),r=s.replyToMsgId?this.getLocalMessageId(s.replyToMsgId):void 0,l=P.default.isChannel(e),c=P.default.isBroadcast(e),u={_:"message",id:a,from_id:this.generateFromId(e),peer_id:P.default.getOutputPeer(e),pFlags:this.generateFlags(e),date:s.scheduleDate||d.tsNow(!0)+v.default.serverTimeOffset,message:t,random_id:o,reply_to:this.generateReplyHeader(s.replyToMsgId,s.threadId),via_bot_id:s.viaBotId,reply_markup:s.reply_markup,entities:i,views:c&&1,pending:!0};s.webPage&&(u.media={_:"messageMediaWebPage",webpage:s.webPage});const p=e=>{e?u.error=!0:delete u.error,M.default.broadcast("messages_pending")};u.send=()=>{p(!1);const i={};let a;this.pendingAfterMsgs[e]&&(i.afterMessageId=this.pendingAfterMsgs[e].messageId),a=s.viaBotId?g.default.invokeApiAfter("messages.sendInlineBotResult",{peer:P.default.getInputPeerById(e),random_id:o,reply_to_msg_id:r||void 0,query_id:s.queryId,id:s.resultId,clear_draft:s.clearDraft},i):g.default.invokeApiAfter("messages.sendMessage",{no_webpage:s.noWebPage,peer:P.default.getInputPeerById(e),message:t,random_id:o,reply_to_msg_id:r||void 0,entities:n,clear_draft:s.clearDraft,schedule_date:s.scheduleDate||void 0,silent:s.silent},i),a.then(e=>{"updateShortSentMessage"==e._?(u.date=e.date,u.id=e.id,u.media=e.media,u.entities=e.entities,e={_:"updates",users:[],chats:[],seq:0,updates:[{_:"updateMessageID",random_id:o,id:e.id},{_:s.scheduleDate?"updateNewScheduledMessage":l?"updateNewChannelMessage":"updateNewMessage",message:u,pts:e.pts,pts_count:e.pts_count}]}):e.updates&&e.updates.forEach(e=>{"updateDraftMessage"==e._&&(e.local=!0)}),L.default.processUpdateMessage(e)},()=>{p(!0)}).finally(()=>{this.pendingAfterMsgs[e]===i&&delete this.pendingAfterMsgs[e]}),this.pendingAfterMsgs[e]=i},this.beforeMessageSending(u,{isScheduled:!!s.scheduleDate||void 0,threadId:s.threadId})}sendFile(e,t,s={}){e=P.default.getPeerMigratedTo(e)||e;const n=this.generateTempMessageId(e),a=f.randomLong(),h=this.generateFlags(e),u=s.replyToMsgId?this.getLocalMessageId(s.replyToMsgId):void 0,p=P.default.isChannel(e),m=p&&P.default.isMegagroup(e),b=!(!p||m);let _,w;const S="mime_type"in t?t.mime_type:t.type,I=t instanceof File?t.name:"",E=!(t instanceof File||t instanceof Blob);let x=s.caption||"";const A=s.scheduleDate||d.tsNow(!0)+v.default.serverTimeOffset;this.log("sendFile",t,S);const D=s.entities||[];x&&(x=y.RichTextProcessor.parseMarkdown(x,D));const X=[],F=["image/jpeg","image/png","image/bmp"].indexOf(S)>=0;let O,R,B="";if(E)_="document",w="";else if(0===S.indexOf("audio/")||["video/ogg"].indexOf(S)>=0){_="audio",w="audio."+("ogg"==S.split("/")[1]?"ogg":"mp3"),B="sendMessageUploadAudioAction",s.isVoiceMessage&&(_="voice",h.media_unread=!0);let e={_:"documentAttributeAudio",pFlags:{voice:s.isVoiceMessage},waveform:s.waveform,duration:s.duration||0};X.push(e)}else if(s.isMedia)if(F)_="photo",w="photo."+S.split("/")[1],B="sendMessageUploadPhotoAction",O={_:"photo",id:""+n,sizes:[{_:"photoSize",w:s.width,h:s.height,type:"full",location:null,size:t.size}],w:s.width,h:s.height},c.defineNotNumerableProperties(O,["downloaded","url"]),O.downloaded=t.size,O.url=s.objectURL||"",k.default.savePhoto(O);else if(0===S.indexOf("video/")){_="video",w="video.mp4",B="sendMessageUploadVideoAction";let e={_:"documentAttributeVideo",pFlags:{round_message:s.isRoundMessage},duration:s.duration,w:s.width,h:s.height};X.push(e)}else _="document",w="document."+S.split("/")[1],B="sendMessageUploadDocumentAction";else _="document",w="document."+S.split("/")[1],B="sendMessageUploadDocumentAction";if(X.push({_:"documentAttributeFilename",file_name:I||w}),-1!==["document","video","audio","voice"].indexOf(_)&&!E){const e=[];if(R={_:"document",id:""+n,duration:s.duration,attributes:X,w:s.width,h:s.height,thumbs:e,mime_type:S,size:t.size},c.defineNotNumerableProperties(R,["downloaded","url"]),R.downloaded=t.size,R.url=s.objectURL||"",F)X.push({_:"documentAttributeImageSize",w:s.width,h:s.height}),e.push({_:"photoSize",w:s.width,h:s.height,type:"full",location:null,size:t.size,url:s.objectURL});else if("video"===_){s.thumbURL&&e.push({_:"photoSize",w:s.width,h:s.height,type:"full",location:null,size:s.thumbBlob.size,url:s.thumbURL});const t=e[0],i=k.default.getDocumentCachedThumb(R.id);i.downloaded=t.size,i.url=t.url}C.default.saveDoc(R)}this.log("AMM: sendFile",_,w,t.type,s);const j=new o.default(null,!0,!1,"prepend"),U={_:O?"messageMediaPhoto":"messageMediaDocument",pFlags:{},preloader:j,photo:O,document:R},N={_:"message",id:n,from_id:this.generateFromId(e),peer_id:P.default.getOutputPeer(e),entities:D,pFlags:h,date:A,message:x,media:E?{_:"messageMediaDocument",pFlags:{},document:t}:U,random_id:a,reply_to:this.generateReplyHeader(s.replyToMsgId,s.threadId),views:b&&1,pending:!0},H=e=>{e?N.error=!0:delete N.error,M.default.broadcast("messages_pending")};let z=!1,q=null;const W=r.deferredPromise();return N.send=()=>{if(E){const{id:e,access_hash:s,file_reference:i}=t,n={_:"inputMediaDocument",id:{_:"inputDocument",id:e,access_hash:s,file_reference:i}};W.resolve(n)}else if(t instanceof File||t instanceof Blob){const n=()=>{let n;return z&&!N.error||(z=!1,q=T.default.upload(t),j.attachPromise(q)),"video"===_&&s.objectURL&&(n=new Promise((e,t)=>{(s.thumbBlob?Promise.resolve(s.thumbBlob):l.createPosterForVideo(s.objectURL)).then(s=>{s?T.default.upload(s).then(e,t):e(null)},t)})),q&&q.then(e=>i(this,void 0,void 0,(function*(){let t;switch(this.log("appMessagesManager: sendFile uploaded:",e),delete N.media.preloader,e.name=w,z=!0,_){case"photo":t={_:"inputMediaUploadedPhoto",file:e};break;default:t={_:"inputMediaUploadedDocument",file:e,mime_type:S,attributes:X}}if(n)try{const e=yield n;t.thumb=e}catch(e){this.log.error("sendFile thumb upload error:",e)}W.resolve(t)})),()=>{H(!0)}),q.addNotifyListener(t=>{this.log("upload progress",t);const s=Math.max(1,Math.floor(100*t.done/t.total));this.setTyping(e,{_:B,progress:0|s})}),q.catch(t=>{"AbortError"!==t.name||z||(this.log("cancelling upload",U),W.reject(t),this.cancelPendingMessage(a),this.setTyping(e,"sendMessageCancelAction"))}),W};s.isGroupedItem?n():this.sendSmthLazyLoadQueue.push({load:n})}return W},this.beforeMessageSending(N,{isGroupedItem:s.isGroupedItem,isScheduled:!!s.scheduleDate||void 0,threadId:s.threadId}),s.isGroupedItem||W.then(t=>(this.setTyping(e,"sendMessageCancelAction"),g.default.invokeApi("messages.sendMedia",{background:s.background,peer:P.default.getInputPeerById(e),media:t,message:x,random_id:a,reply_to_msg_id:u,schedule_date:s.scheduleDate,silent:s.silent,entities:D}).then(e=>{L.default.processUpdateMessage(e)},e=>{if("photo"==_&&400==e.code&&("PHOTO_INVALID_DIMENSIONS"==e.type||"PHOTO_SAVE_FILE_INVALID"==e.type))return e.handled=!0,_="document",void N.send();H(!0)}))),{message:N,promise:W}}sendAlbum(e,t,s={}){return i(this,void 0,void 0,(function*(){if(1===t.length)return this.sendFile(e,t[0],Object.assign(Object.assign({},s),s.sendFileDetails[0]));e=P.default.getPeerMigratedTo(e)||e;const i=s.replyToMsgId?this.getLocalMessageId(s.replyToMsgId):void 0;let n=s.caption||"",a=s.entities||[];n&&(n=y.RichTextProcessor.parseMarkdown(n,a)),this.log("AMM: sendAlbum",t,s);const o=t.map((t,o)=>{const r=s.sendFileDetails[o],d=Object.assign({isGroupedItem:!0,isMedia:s.isMedia,scheduleDate:s.scheduleDate,silent:s.silent,replyToMsgId:i,threadId:s.threadId},r);return 0===o&&(d.caption=n,d.entities=a),this.sendFile(e,t,d).message}),r=o[o.length-1],d=r.id;o.forEach(e=>{e.grouped_id=d});const l=s.scheduleDate?this.getScheduledMessagesStorage(e):this.getMessagesStorage(e);s.scheduleDate?(this.saveMessages(o,{storage:l,isScheduled:!0,isOutgoing:!0}),M.default.broadcast("scheduled_new",{peerId:e,mid:d})):(this.saveMessages(o,{storage:l,isOutgoing:!0}),M.default.broadcast("history_append",{peerId:e,messageId:d,my:!0}),this.setDialogTopMessage(r));const c=(e,t)=>{t?e.error=!0:delete e.error,M.default.broadcast("messages_pending")},f=P.default.getInputPeerById(e),h=t=>{this.setTyping(e,"sendMessageCancelAction"),this.sendSmthLazyLoadQueue.push({load:()=>g.default.invokeApi("messages.sendMultiMedia",{peer:f,multi_media:t,reply_to_msg_id:i,schedule_date:s.scheduleDate,silent:s.silent}).then(e=>{L.default.processUpdateMessage(e)},e=>{o.forEach(e=>c(e,!0))})})},u=o.map((e,t)=>e.send().then(e=>g.default.invokeApi("messages.uploadMedia",{peer:f,media:e})).then(t=>{let s;if("messageMediaPhoto"==t._){const e=k.default.savePhoto(t.photo);s=k.default.getInput(e)}else if("messageMediaDocument"==t._){const e=C.default.saveDoc(t.document);s=C.default.getMediaInput(e)}const i={_:"inputSingleMedia",media:s,random_id:e.random_id,message:n,entities:a};return n&&(n="",a=[]),i}).catch(t=>{if("AbortError"===t.name)return null;throw this.log.error("sendAlbum upload item error:",t,e),c(e,!0),t}));Promise.all(u).then(e=>{h(e.filter(Boolean))})}))}sendOther(e,t,s={}){e=P.default.getPeerMigratedTo(e)||e;const i=this.generateTempMessageId(e),n=f.randomLong(),a=s.replyToMsgId?this.getLocalMessageId(s.replyToMsgId):void 0,o=P.default.isChannel(e),r=o&&P.default.isMegagroup(e),l=!(!o||r);let c;switch(t._){case"inputMediaPoll":{t.poll.id=i,x.default.savePoll(t.poll,{_:"pollResults",flags:4,total_voters:0,pFlags:{}});const{poll:e,results:s}=x.default.getPoll(""+i);c={_:"messageMediaPoll",poll:e,results:s};break}}const h={_:"message",id:i,from_id:this.generateFromId(e),peer_id:P.default.getOutputPeer(e),pFlags:this.generateFlags(e),date:s.scheduleDate||d.tsNow(!0)+v.default.serverTimeOffset,message:"",media:c,random_id:n,reply_to:this.generateReplyHeader(s.replyToMsgId,s.threadId),via_bot_id:s.viaBotId,reply_markup:s.reply_markup,views:l&&1,pending:!0};h.send=()=>{const i={};let o;this.pendingAfterMsgs[e]&&(i.afterMessageId=this.pendingAfterMsgs[e].messageId),o=s.viaBotId?g.default.invokeApiAfter("messages.sendInlineBotResult",{peer:P.default.getInputPeerById(e),random_id:n,reply_to_msg_id:a||void 0,query_id:s.queryId,id:s.resultId,clear_draft:s.clearDraft},i):g.default.invokeApiAfter("messages.sendMedia",{peer:P.default.getInputPeerById(e),media:t,random_id:n,reply_to_msg_id:a||void 0,message:"",clear_draft:s.clearDraft,schedule_date:s.scheduleDate,silent:s.silent},i),o.then(e=>{e.updates&&e.updates.forEach(e=>{"updateDraftMessage"==e._&&(e.local=!0)}),L.default.processUpdateMessage(e)},e=>{M.default.broadcast("messages_pending")}).finally(()=>{this.pendingAfterMsgs[e]===i&&delete this.pendingAfterMsgs[e]}),this.pendingAfterMsgs[e]=i},this.beforeMessageSending(h,{isScheduled:!!s.scheduleDate||void 0,threadId:s.threadId})}beforeMessageSending(e,t={}){const s=e.id,i=this.getMessagePeer(e),n=t.isScheduled?this.getScheduledMessagesStorage(i):this.getMessagesStorage(i);if(t.isScheduled)t.isGroupedItem||(this.saveMessages([e],{storage:n,isScheduled:!0,isOutgoing:!0}),M.default.broadcast("scheduled_new",{peerId:i,mid:s}));else{t.threadId&&this.threadsStorage[i]&&delete this.threadsStorage[i][t.threadId];this.getHistoryStorage(i).history.unshift(s),t.isGroupedItem||(this.saveMessages([e],{storage:n,isOutgoing:!0}),M.default.broadcast("history_append",{peerId:i,messageId:s,my:!0}),this.setDialogTopMessage(e))}this.pendingByRandomId[e.random_id]={peerId:i,tempId:s,storage:n},t.isGroupedItem||setTimeout(e.send,0)}generateReplyHeader(e,t){const s={_:"messageReplyHeader",reply_to_msg_id:e};return t&&t!==e&&(s.reply_to_top_id=t),s}generateFromId(e){var t,s;return e<0&&(P.default.isBroadcast(e)||(null===(s=null===(t=P.default.getPeer(e).admin_rights)||void 0===t?void 0:t.pFlags)||void 0===s?void 0:s.anonymous))?void 0:P.default.getOutputPeer(D.default.getSelf().id)}generateFlags(e){const t={};return e!==D.default.getSelf().id&&(t.out=!0,P.default.isChannel(e)||D.default.isBot(e)||(t.unread=!0)),P.default.isBroadcast(e)&&(t.post=!0),t}setDialogIndexByMessage(e,t){e.pFlags.pinned&&e.index||(e.index=this.dialogsStorage.generateDialogIndex(t.date))}setDialogTopMessage(e,t=this.getDialogByPeerId(e.peerId)[0]){if(t){t.top_message=e.mid;this.getHistoryStorage(e.peerId).maxId=e.mid,this.setDialogIndexByMessage(t,e),this.newDialogsToHandle[e.peerId]=t,this.scheduleHandleNewDialogs()}}cancelPendingMessage(e){const t=this.pendingByRandomId[e];if(this.log("cancelPendingMessage",e,t),t){const{peerId:s,tempId:i,storage:n}=t,a=this.getHistoryStorage(s),o=a.history.indexOf(i);return L.default.processUpdateMessage({_:"updateShort",update:{_:"updateDeleteMessages",messages:[i]}}),-1!==o&&a.history.splice(o,1),delete this.pendingByRandomId[e],delete n[i],!0}return!1}getConversationsAll(e="",t=0){return i(this,void 0,void 0,(function*(){const s=[];for(;t<2;++t){let i=0;for(;;){const{dialogs:n}=yield O.getConversations(e,i,100,t);if(!n.length)break;s.push(...n),i=n[n.length-1].index||0}}return s}))}getConversations(e="",t,s=20,i=0){const n=i>1?0:i;let a=this.dialogsStorage.getFolder(i);if(e){if(!s||this.cachedResults.query!==e||this.cachedResults.folderId!=i){this.cachedResults.query=e,this.cachedResults.folderId=i;const t=_.default.search(e,this.dialogsIndex);this.cachedResults.dialogs=[];for(const e in this.dialogsStorage.dialogs){const s=this.dialogsStorage.dialogs[e];t[s.peerId]&&s.folder_id==i&&this.cachedResults.dialogs.push(s)}this.cachedResults.dialogs.sort((e,t)=>t.index-e.index),this.cachedResults.count=this.cachedResults.dialogs.length}a=this.cachedResults.dialogs}else this.cachedResults.query="";let o=0;if(t>0)for(;o<a.length&&!(t>a[o].index);o++);return e||this.dialogsStorage.allDialogsLoaded[n]||a.length>=o+s?Promise.resolve({dialogs:a.slice(o,o+s),count:this.dialogsStorage.allDialogsLoaded[n]?a.length:null,isEnd:this.dialogsStorage.allDialogsLoaded[n]&&o+s>=a.length}):this.getTopMessages(s,n).then(e=>{if(o=0,t>0)for(;o<a.length&&!(t>a[o].index);o++);return{dialogs:a.slice(o,o+s),count:e,isEnd:this.dialogsStorage.allDialogsLoaded[n]&&o+s>=a.length}})}isHistoryUnread(e,t){const s=this.getHistoryStorage(e,t);if(t){const t=this.getHistoryStorage(e),i=Math.max(t.readMaxId,s.readMaxId);return!this.getMessageByPeer(e,s.maxId).pFlags.out&&i<s.maxId}return!this.getMessageByPeer(e,s.maxId).pFlags.out&&(e>0?Math.max(s.readMaxId,s.readOutboxMaxId):s.readMaxId)<s.maxId}getTopMessages(e,t){const s=this.dialogsStorage.getFolder(t);let i=0,n=0,a=0;return this.dialogsStorage.dialogsOffsetDate[t]&&(i=this.dialogsStorage.dialogsOffsetDate[t]+v.default.serverTimeOffset,n=65536*this.dialogsStorage.dialogsOffsetDate[t]),a|=2,g.default.invokeApi("messages.getDialogs",{flags:2,folder_id:t,offset_date:i,offset_id:0,offset_peer:P.default.getInputPeerById(0),limit:e,hash:0},{noErrorBox:!0}).then(e=>{if("messages.dialogsNotModified"==e._)return null;D.default.saveApiUsers(e.users),E.default.saveApiChats(e.chats),this.saveMessages(e.messages);let a=!!i,o=!1;const r={};e.dialogs.forEachReverse(e=>{var s;this.saveConversation(e,null!==(s=e.folder_id)&&void 0!==s?s:t),n&&e.index>n&&(this.newDialogsToHandle[e.peerId]=e,o=!0),this.getLocalMessageId(e.read_inbox_max_id)||this.getLocalMessageId(e.read_outbox_max_id)||(r[e.peerId]=e,this.log.error("noIdsDialogs",e)),a||P.default.isChannel(P.default.getPeerId(e.peer))||(this.incrementMaxSeenId(e.top_message),a=!0)}),Object.keys(r).length&&this.reloadConversation(Object.keys(r).map(e=>+e)).then(()=>{M.default.broadcast("dialogs_multiupdate",r);for(let e in r)M.default.broadcast("dialog_unread",{peerId:+e})});const d=e.count;return(!e.dialogs.length||!d||s.length>=d)&&(this.dialogsStorage.allDialogsLoaded[t]=!0),o?this.scheduleHandleNewDialogs():M.default.broadcast("dialogs_multiupdate",{}),d})}forwardMessages(e,t,s,i={}){e=P.default.getPeerMigratedTo(e)||e;const n=(s=s.slice().sort((e,t)=>e-t).map(e=>this.getLocalMessageId(e))).map(()=>f.randomLong()),a={};this.pendingAfterMsgs[e]&&(a.afterMessageId=this.pendingAfterMsgs[e].messageId);const o=g.default.invokeApiAfter("messages.forwardMessages",{from_peer:P.default.getInputPeerById(t),id:s,random_id:n,to_peer:P.default.getInputPeerById(e),with_my_score:i.withMyScore,silent:i.silent,schedule_date:i.scheduleDate},a).then(e=>{L.default.processUpdateMessage(e)}).finally(()=>{this.pendingAfterMsgs[e]===a&&delete this.pendingAfterMsgs[e]});return this.pendingAfterMsgs[e]=a,o}getMessageFromStorage(e,t){return e&&e[t]||{_:"messageEmpty",id:t,deleted:!0,pFlags:{}}}createMessageStorage(){return{}}getMessagesStorage(e){var t;return null!==(t=this.messagesStorageByPeerId[e])&&void 0!==t?t:this.messagesStorageByPeerId[e]=this.createMessageStorage()}getMessageById(e){for(const t in this.messagesStorageByPeerId){if(P.default.isChannel(+t))continue;const s=this.messagesStorageByPeerId[t][e];if(s)return s}return this.getMessageFromStorage(null,e)}getMessageByPeer(e,t){return e?this.getMessageFromStorage(this.getMessagesStorage(e),t):this.getMessageById(t)}getMessagePeer(e){return e.peer_id&&P.default.getPeerId(e.peer_id)||0}getDialogByPeerId(e){return this.dialogsStorage.getDialog(e)}reloadConversation(e){return[].concat(e).forEach(e=>{this.reloadConversationsPeers.includes(e)||(this.reloadConversationsPeers.push(e),this.log("will reloadConversation",e))}),this.reloadConversationsPromise?this.reloadConversationsPromise:this.reloadConversationsPromise=new Promise((e,t)=>{setTimeout(()=>{const s=this.reloadConversationsPeers.map(e=>P.default.getInputDialogPeerById(e));this.reloadConversationsPeers.length=0,g.default.invokeApi("messages.getPeerDialogs",{peers:s}).then(t=>{this.applyConversations(t),e()},t).finally(()=>{this.reloadConversationsPromise=null})},0)})}doFlushHistory(e,t){return g.default.invokeApi("messages.deleteHistory",{just_clear:t,peer:e,max_id:0}).then(s=>(L.default.processUpdateMessage({_:"updateShort",update:{_:"updatePts",pts:s.pts,pts_count:s.pts_count}}),!s.offset||this.doFlushHistory(e,t)))}flushHistory(e,t){return i(this,void 0,void 0,(function*(){if(P.default.isChannel(e)){const t=this.getHistory(e,0,1),s=t instanceof Promise?yield t:t,i=-e,n=s.history[0]||0;return g.default.invokeApi("channels.deleteHistory",{channel:E.default.getChannelInput(i),max_id:n}).then(()=>(L.default.processUpdateMessage({_:"updateShort",update:{_:"updateChannelAvailableMessages",channel_id:i,available_min_id:n}}),!0))}return this.doFlushHistory(P.default.getInputPeerById(e),t).then(()=>{delete this.historiesStorage[e],delete this.messagesStorageByPeerId[e],t?M.default.broadcast("dialog_flush",{peerId:e}):(this.dialogsStorage.dropDialog(e),M.default.broadcast("dialog_drop",{peerId:e}))})}))}hidePinnedMessages(e){return Promise.all([A.default.getState(),this.getPinnedMessage(e)]).then(([t,s])=>{t.hiddenPinnedMessages[e]=s.maxId,M.default.broadcast("peer_pinned_hidden",{peerId:e,maxId:s.maxId})})}getPinnedMessage(e){var t;const s=null!==(t=this.pinnedMessages[e])&&void 0!==t?t:this.pinnedMessages[e]={};return s.promise?s.promise:s.maxId?Promise.resolve(s):s.promise=this.getSearch({peerId:e,inputFilter:{_:"inputMessagesFilterPinned"},maxId:0,limit:1}).then(e=>{var t;return s.count=e.count,s.maxId=null===(t=e.history[0])||void 0===t?void 0:t.mid,s}).finally(()=>{delete s.promise})}updatePinnedMessage(e,t,s,i,n){return g.default.invokeApi("messages.updatePinnedMessage",{peer:P.default.getInputPeerById(e),unpin:s,silent:i,pm_oneside:n,id:this.getLocalMessageId(t)}).then(e=>{this.log("pinned updates:",e),L.default.processUpdateMessage(e)})}unpinAllMessages(e){return g.default.invokeApi("messages.unpinAllMessages",{peer:P.default.getInputPeerById(e)}).then(t=>{if(L.default.processUpdateMessage({_:"updateShort",update:{_:"updatePts",pts:t.pts,pts_count:t.pts_count}}),!t.offset){const t=this.getMessagesStorage(e);for(const e in t){const s=t[e];s.pFlags.pinned&&delete s.pFlags.pinned}return M.default.broadcast("peer_pinned_messages",{peerId:e,unpinAll:!0}),delete this.pinnedMessages[e],!0}return this.unpinAllMessages(e)})}getAlbumText(e){const t=this.groupedMessagesStorage[e];let s,i,n,a=0;for(const e in t){const o=t[e];if(o.message){if(++a>1)break;s=o.message,i=o.totalEntities,n=o.entities}}return a>1&&(s=void 0,i=void 0,n=void 0),{message:s,entities:n,totalEntities:i}}getMidsByAlbum(e){return c.getObjectKeysAndSort(this.groupedMessagesStorage[e],"asc")}getMidsByMessage(e){return(null==e?void 0:e.grouped_id)?this.getMidsByAlbum(e.grouped_id):[e.mid]}filterMessages(e,t){const s=[];if(e.grouped_id){const i=this.groupedMessagesStorage[e.grouped_id];for(const e in i){const n=i[e];t(n)&&s.push(n)}}else t(e)&&s.push(e);return s}generateTempMessageId(e){const t=this.getDialogByPeerId(e)[0];return this.generateMessageId((null==t?void 0:t.top_message)||0,!0)}generateMessageId(e,t=!1){const s=F.MESSAGE_ID_OFFSET,i=t?++this.tempNum:0;return e>=s?t?e+(i&F.MESSAGE_ID_INCREMENT-1):e:s+(e*F.MESSAGE_ID_INCREMENT+(i&F.MESSAGE_ID_INCREMENT-1))}getLocalMessageId(e){const t=F.MESSAGE_ID_OFFSET;if(e<=t)return e;const s=F.MESSAGE_ID_INCREMENT-1,i=e&s;return i!==s&&(e-=i+1),(e-t)/F.MESSAGE_ID_INCREMENT}incrementMessageId(e,t){return this.generateMessageId(this.getLocalMessageId(e)+t)}saveMessages(e,t={}){let s;if(e.forEach(e=>{var i;if(void 0===e.pFlags&&(e.pFlags={}),"messageEmpty"==e._)return;const n=this.getMessagePeer(e),a=t.storage||this.getMessagesStorage(n),o="peerChannel"==e.peer_id._,r=o?-n:0,d=o&&E.default.isBroadcast(r);t.isScheduled&&(e.pFlags.is_scheduled=!0),t.isOutgoing&&(e.pFlags.is_outgoing=!0);const l=this.generateMessageId(e.id);if(e.mid=l,e.grouped_id){(null!==(i=this.groupedMessagesStorage[e.grouped_id])&&void 0!==i?i:this.groupedMessagesStorage[e.grouped_id]={})[l]=e}const c=this.getDialogByPeerId(n)[0];c&&l&&l>c[e.pFlags.out?"read_outbox_max_id":"read_inbox_max_id"]&&(e.pFlags.unread=!0),e.reply_to&&(e.reply_to.reply_to_msg_id&&(e.reply_to.reply_to_msg_id=e.reply_to_mid=this.generateMessageId(e.reply_to.reply_to_msg_id)),e.reply_to.reply_to_top_id&&(e.reply_to.reply_to_top_id=this.generateMessageId(e.reply_to.reply_to_top_id))),e.replies&&(e.replies.max_id&&(e.replies.max_id=this.generateMessageId(e.replies.max_id)),e.replies.read_max_id&&(e.replies.read_max_id=this.generateMessageId(e.replies.read_max_id)));const f=!!e.peerId;f||(e.date-=v.default.serverTimeOffset);const h=D.default.getSelf().id;e.peerId=n,e.peerId==h?e.fromId=e.fwd_from?e.fwd_from.from_id?P.default.getPeerId(e.fwd_from.from_id):0:h:e.fromId=e.pFlags.post||!e.from_id?n:P.default.getPeerId(e.from_id);const u=e.fwd_from;if(u){if(u.saved_from_peer&&u.saved_from_msg_id){const t=P.default.getPeerId(u.saved_from_peer),s=u.saved_from_msg_id=this.generateMessageId(u.saved_from_msg_id);e.savedFrom=t+"_"+s}e.fwdFromId=P.default.getPeerId(u.from_id),f||(u.date-=v.default.serverTimeOffset)}e.via_bot_id>0&&(e.viaBotId=e.via_bot_id);const p={type:"message",peerId:n,messageId:l};if(e.media)switch(e.media._){case"messageMediaEmpty":delete e.media;break;case"messageMediaPhoto":e.media.ttl_seconds?e.media={_:"messageMediaUnsupportedWeb"}:e.media.photo=k.default.savePhoto(e.media.photo,p);break;case"messageMediaPoll":e.media.poll=x.default.savePoll(e.media.poll,e.media.results);break;case"messageMediaDocument":e.media.ttl_seconds?e.media={_:"messageMediaUnsupportedWeb"}:e.media.document=C.default.saveDoc(e.media.document,p);break;case"messageMediaWebPage":e.media.webpage=X.default.saveWebPage(e.media.webpage,e.mid,p);break;case"messageMediaInvoice":e.media={_:"messageMediaUnsupportedWeb"};break;case"messageMediaGeoLive":e.media._="messageMediaGeo"}if(e.action){let t,s;switch(e.action._){case"messageActionChatEditPhoto":e.action.photo=k.default.savePhoto(e.action.photo,p),d&&(e.action._="messageActionChannelEditPhoto");break;case"messageActionChatEditTitle":d&&(e.action._="messageActionChannelEditTitle");break;case"messageActionChatDeletePhoto":d&&(e.action._="messageActionChannelDeletePhoto");break;case"messageActionChatAddUser":1==e.action.users.length?(e.action.user_id=e.action.users[0],e.fromId==e.action.user_id&&(e.action._=o?"messageActionChatJoined":"messageActionChatReturn")):e.action.users.length>1&&(e.action._="messageActionChatAddUsers");break;case"messageActionChatDeleteUser":e.fromId==e.action.user_id&&(e.action._="messageActionChatLeave");break;case"messageActionChannelMigrateFrom":t=-e.action.chat_id,s=-r;break;case"messageActionChatMigrateTo":t=-r,s=-e.action.channel_id;break;case"messageActionHistoryClear":e.clear_history=!0,delete e.pFlags.out,delete e.pFlags.unread;break;case"messageActionPhoneCall":delete e.fromId,e.action.type=(e.pFlags.out?"out_":"in_")+("phoneCallDiscardReasonMissed"==e.action.reason._||"phoneCallDiscardReasonBusy"==e.action.reason._?"missed":"ok")}t&&s&&!this.migratedFromTo[t]&&!this.migratedToFrom[s]&&this.migrateChecks(t,s)}if(e.grouped_id?(s||(s=new Set),s.add(e.grouped_id)):e.rReply=this.getRichReplyText(e),e.message&&e.message.length&&!e.totalEntities){const t=y.RichTextProcessor.parseEntities(e.message),s=e.entities||[];e.totalEntities=y.RichTextProcessor.mergeEntities(s,t)}a[l]=e}),s)for(const e of s){const t=this.groupedMessagesStorage[e];for(const s in t){const t=this.groupedMessagesStorage[e][s];t.rReply=this.getRichReplyText(t)}}}getRichReplyText(e,t=e.message,s){let i="";if(e.media){let n=!0;if(e.grouped_id){if(s){const t=this.getMidsByMessage(e);if(s.length===t.length){for(const e of t)if(!s.includes(e)){n=!1;break}}else n=!1}n&&(i+="<i>Album"+((t=this.getAlbumText(e.grouped_id).message)?", ":"")+"</i>")}else n=!1;if(!n){const s=e.media;switch(s._){case"messageMediaPhoto":i+="<i>Photo"+(e.message?", ":"")+"</i>";break;case"messageMediaDice":i+=y.RichTextProcessor.wrapEmojiText(s.emoticon);break;case"messageMediaGeo":i+="<i>Geolocation</i>";break;case"messageMediaPoll":i+="<i>"+s.poll.rReply+"</i>";break;case"messageMediaContact":i+="<i>Contact</i>";break;case"messageMediaDocument":let n=s.document;"video"==n.type?i="<i>Video"+(e.message?", ":"")+"</i>":"voice"==n.type?i="<i>Voice message</i>":"gif"==n.type?i="<i>GIF"+(e.message?", ":"")+"</i>":"round"==n.type?i="<i>Video message"+(e.message?", ":"")+"</i>":"sticker"==n.type?(i=(n.stickerEmoji||"")+"<i>Sticker</i>",t=""):i="<i>"+n.file_name+(e.message?", ":"")+"</i>"}}}if(e.action){const t=this.wrapMessageActionText(e);i=t?"<i>"+t+"</i>":""}let n="";if(t){t=h.limitSymbols(t,100);const e=y.RichTextProcessor.parseEntities(t.replace(/\n/g," "));n=y.RichTextProcessor.wrapRichText(t,{noLinebreaks:!0,entities:e,noLinks:!0,noTextFormat:!0})}return i+n}getSenderToPeerText(e){let t,s="";return s=e.pFlags.out?"You":P.default.getPeerTitle(e.fromId,!1,!1),t=P.default.isAnyGroup(e.peerId)||e.pFlags.out&&e.peerId!==M.default.myId?P.default.getPeerTitle(e.peerId,!1,!1):"",t&&(s+=" ➝ "+t),s}wrapMessageActionText(e){const t=e.action;let s="";if(t.message)s=y.RichTextProcessor.wrapRichText(t.message,{noLinebreaks:!0});else{let i=t._,n="",a="";const o=e=>{const t=P.default.getPeerTitle(e);return t?`<div class="name inline" data-peer-id="${e}">${t}</div> `:""};switch(t._){case"messageActionPhoneCall":{i+="."+t.type;const e=t.duration;if(e){const t=[];t.push(e%60+" s"),e>=60&&t.push((e/60|0)+" min"),n=" ("+t.reverse().join(" ")+")"}return u.langPack[i]+n}case"messageActionChatDeleteUser":case"messageActionChatAddUsers":case"messageActionChatAddUser":{const e=t.users||[t.user_id];a=u.langPack[i].replace("{}",e.map(e=>o(e)).join(", "));break}case"messageActionBotAllowed":{const e=y.RichTextProcessor.wrapRichText(t.domain,{entities:[{_:"messageEntityUrl",length:t.domain.length,offset:0}]});a=u.langPack[i].replace("{}",e);break}default:s=u.langPack[i]||`[${t._}]`}a||(a=u.langPack[i],a||(a="["+i+"]")),s=a[0].toUpperCase()==a[0]?a:o(e.fromId)+a+(n?" ":"")}return s}editPeerFolders(e,t){g.default.invokeApi("folders.editPeerFolders",{folder_peers:e.map(e=>({_:"inputFolderPeer",peer:P.default.getInputPeerById(e),folder_id:t}))}).then(e=>{this.log("editPeerFolders updates:",e),L.default.processUpdateMessage(e)})}toggleDialogPin(e,t){var s;if(t>1)return void this.filtersStorage.toggleDialogPin(e,t);const i=this.getDialogByPeerId(e)[0];if(!i)return Promise.reject();const n=!(null===(s=i.pFlags)||void 0===s?void 0:s.pinned)||void 0;return g.default.invokeApi("messages.toggleDialogPin",{peer:P.default.getInputDialogPeerById(e),pinned:n}).then(s=>{if(s){const s=n?{pinned:n}:{};this.handleUpdate({_:"updateDialogPinned",peer:P.default.getDialogPeer(e),folder_id:t,pFlags:s})}})}markDialogUnread(e,t){var s;const i=this.getDialogByPeerId(e)[0];if(!i)return Promise.reject();const n=!t&&!(null===(s=i.pFlags)||void 0===s?void 0:s.unread_mark)||void 0;return g.default.invokeApi("messages.markDialogUnread",{peer:P.default.getInputDialogPeerById(e),unread:n}).then(t=>{if(t){const t=n?{unread:n}:{};this.handleUpdate({_:"updateDialogUnreadMark",peer:P.default.getDialogPeer(e),pFlags:t})}})}migrateChecks(e,t){if(!this.migratedFromTo[e]&&!this.migratedToFrom[t]&&E.default.hasChat(-t)){const s=E.default.getChat(-e);s&&s.migrated_to&&s.migrated_to.channel_id==-t&&(this.migratedFromTo[e]=t,this.migratedToFrom[t]=e,setTimeout(()=>{const s=this.dialogsStorage.dropDialog(e);s.length&&M.default.broadcast("dialog_drop",{peerId:e,dialog:s[0]}),M.default.broadcast("dialog_migrate",{migrateFrom:e,migrateTo:t})},100))}}canMessageBeEdited(e,t){const s=["messageMediaPhoto","messageMediaDocument","messageMediaWebPage"];return"poll"==t&&s.push("messageMediaPoll"),!("message"!=e._||e.deleted||e.fwd_from||e.via_bot_id||e.media&&-1==s.indexOf(e.media._)||e.fromId&&D.default.isBot(e.fromId))&&(!e.media||"messageMediaDocument"!=e.media._||!e.media.document.sticker)}canEditMessage(e,t="text"){var s;return!(!e||!this.canMessageBeEdited(e,t))&&(!(!e.pFlags.out&&this.getMessagePeer(e)!=D.default.getSelf().id)||!(e.date<d.tsNow(!0)-172800&&"messageMediaPoll"!=(null===(s=e.media)||void 0===s?void 0:s._)||!e.pFlags.out))}canDeleteMessage(e){return e&&(e.peerId>0||e.fromId==M.default.myId||"chat"==E.default.getChat(e.peerId)._||E.default.hasRights(e.peerId,"deleteRevoke"))}applyConversations(e){e.dialogs.forEachReverse((t,s)=>{"dialogFolder"==t._&&e.dialogs.splice(s,1)}),D.default.saveApiUsers(e.users),E.default.saveApiChats(e.chats),this.saveMessages(e.messages);const t={};e.dialogs.forEach(e=>{const s=P.default.getPeerId(e.peer);let i=e.top_message;const n=this.pendingTopMsgs[s];if(n&&(!i||this.getMessageByPeer(s,n).date>this.getMessageByPeer(s,i).date)&&(e.top_message=i=n,this.getHistoryStorage(s).maxId=n),i)this.saveConversation(e),t[s]=e;else{const e=this.dialogsStorage.dropDialog(s);e.length&&M.default.broadcast("dialog_drop",{peerId:s,dialog:e[0]})}if(void 0!==this.newUpdatesAfterReloadToHandle[s]){for(const e in this.newUpdatesAfterReloadToHandle[s]){const t=this.newUpdatesAfterReloadToHandle[s][e];this.handleUpdate(t)}delete this.newUpdatesAfterReloadToHandle[s]}}),Object.keys(t).length&&M.default.broadcast("dialogs_multiupdate",t)}saveConversation(e,t=0){const s=P.default.getPeerId(e.peer);if(!s)return!1;"dialog"!=e._&&console.error("saveConversation not regular dialog",e,Object.assign({},e));const i=P.default.isChannel(s)?-s:0,n=P.default.getPeerSearchText(s);let a,o;if(_.default.indexObject(s,n,this.dialogsIndex),e.top_message?(a=this.generateMessageId(e.top_message),o=this.getMessageByPeer(s,a)):(a=this.generateTempMessageId(s),o={_:"message",id:a,mid:a,from_id:P.default.getOutputPeer(D.default.getSelf().id),peer_id:P.default.getOutputPeer(s),deleted:!0,pFlags:{out:!0},date:0,message:""},this.saveMessages([o],{isOutgoing:!0})),(null==o?void 0:o.pFlags)||this.log.error("saveConversation no message:",e,o),!i&&s<0){const e=E.default.getChat(-s);if(e&&e.migrated_to&&e.pFlags.deactivated){const t=P.default.getPeerId(e.migrated_to);return this.migratedFromTo[s]=t,void(this.migratedToFrom[t]=s)}}const r=this.getDialogByPeerId(s)[0];e.top_message=a,e.read_inbox_max_id=r&&!e.read_inbox_max_id?r.read_inbox_max_id:this.generateMessageId(e.read_inbox_max_id),e.read_outbox_max_id=r&&!e.read_outbox_max_id?r.read_outbox_max_id:this.generateMessageId(e.read_outbox_max_id),e.hasOwnProperty("folder_id")||"dialog"==e._&&(e.folder_id=r?r.folder_id:t),e.peerId=s,o.pFlags.is_outgoing&&(a>e[o.pFlags.out?"read_outbox_max_id":"read_inbox_max_id"]?o.pFlags.unread=!0:delete o.pFlags.unread);let d=this.getHistoryStorage(s);void 0===d?(d.history.push(a),this.mergeReplyKeyboard(d,o)&&M.default.broadcast("history_reply_markup",{peerId:s})):d.history.length||d.history.push(a),d.maxId=a,d.readMaxId=e.read_inbox_max_id,d.readOutboxMaxId=e.read_outbox_max_id,i&&e.pts&&L.default.addChannelState(i,e.pts),this.dialogsStorage.generateIndexForDialog(e),this.dialogsStorage.pushDialog(e,o.date)}mergeReplyKeyboard(e,t){var s;if(!t.reply_markup&&!(null===(s=t.pFlags)||void 0===s?void 0:s.out)&&!t.action)return!1;if(t.reply_markup&&"replyInlineMarkup"==t.reply_markup._)return!1;var i=t.reply_markup,n=e.reply_markup;if(i)return!(n&&n.mid>=t.mid)&&(!i.pFlags.selective&&(e.maxOutId&&t.mid<e.maxOutId&&i.pFlags.single_use&&(i.pFlags.hidden=!0),"replyKeyboardHide"!=(i=Object.assign({mid:t.mid},i))._&&(i.fromId=P.default.getPeerId(t.from_id)),e.reply_markup=i,!0));if(t.pFlags.out)if(n){if(n.pFlags.single_use&&!n.pFlags.hidden&&(t.mid>n.mid||t.pFlags.is_outgoing)&&t.message)return n.pFlags.hidden=!0,!0}else(!e.maxOutId||t.mid>e.maxOutId)&&(e.maxOutId=t.mid);return!(!t.action||"messageActionChatDeleteUser"!=t.action._||!(n?t.action.user_id==n.fromId:D.default.isBot(t.action.user_id)))&&(e.reply_markup={_:"replyKeyboardHide",mid:t.mid,pFlags:{}},!0)}getSearchStorage(e,t){return this.searchesStorage[e]||(this.searchesStorage[e]={}),this.searchesStorage[e][t]||(this.searchesStorage[e][t]={history:[]}),this.searchesStorage[e][t]}getSearchCounters(e,t){return g.default.invokeApi("messages.getSearchCounters",{peer:P.default.getInputPeerById(e),filters:t})}getSearch({peerId:e,query:t,inputFilter:s,maxId:i,limit:n,nextRate:a,backLimit:o,threadId:r,folderId:d,minDate:l,maxDate:c}){e||(e=0),t||(t=""),s||(s={_:"inputMessagesFilterEmpty"}),n||(n=20),a||(a=0),o||(o=0),l=l?l/1e3|0:0,c=c?c/1e3|0:0;const f=[];o&&(n+=o);let h,u;if(e&&!o&&!i&&!t&&1!==n&&!r){h=this.getHistoryStorage(e);let t=!0;const a=i?h.history.slice(h.history.indexOf(i)+1):h.history;if(void 0!==h&&a.length){const i={},o=[],r=[];switch(s._){case"inputMessagesFilterPhotos":i.messageMediaPhoto=!0;break;case"inputMessagesFilterPhotoVideo":i.messageMediaPhoto=!0,i.messageMediaDocument=!0,o.push("video");break;case"inputMessagesFilterVideo":i.messageMediaDocument=!0,o.push("video");break;case"inputMessagesFilterDocument":i.messageMediaDocument=!0,r.push("video");break;case"inputMessagesFilterVoice":i.messageMediaDocument=!0,o.push("voice");break;case"inputMessagesFilterRoundVoice":i.messageMediaDocument=!0,o.push("round","voice");break;case"inputMessagesFilterRoundVideo":i.messageMediaDocument=!0,o.push("round");break;case"inputMessagesFilterMusic":i.messageMediaDocument=!0,o.push("audio");break;case"inputMessagesFilterUrl":i.url=!0;break;case"inputMessagesFilterChatPhotos":i.avatar=!0;break;default:t=!1}if(t){const t=this.getMessagesStorage(e);for(let e=0,s=a.length;e<s;e++){const s=t[a[e]];let d=!1;if(s.media&&i[s.media._]&&!s.fwd_from){if("messageMediaDocument"==s.media._&&(o.length&&!o.includes(s.media.document.type)||r.includes(s.media.document.type)))continue;d=!0}else if(i.url&&s.message){const e=["messageEntityTextUrl","messageEntityUrl"];(s.totalEntities.find(t=>e.includes(t._))||y.RichTextProcessor.matchUrl(s.message))&&(d=!0)}else i.avatar&&s.action&&["messageActionChannelEditPhoto","messageActionChatEditPhoto"].includes(s.action._)&&(d=!0);if(d&&(f.push(s),f.length>=n))break}}}}if(f.length){if(!(f.length<n))return Promise.resolve({count:0,next_rate:0,offset_id_offset:0,history:f});i=f[f.length-1].mid,n-=f.length}else 0;if(e&&!a&&void 0===d)u=g.default.invokeApi("messages.search",{peer:P.default.getInputPeerById(e),q:t||"",filter:s,min_date:l,max_date:c,limit:n,offset_id:this.getLocalMessageId(i)||0,add_offset:o?-o:0,max_id:0,min_id:0,hash:0,top_msg_id:this.getLocalMessageId(r)||0},{noErrorBox:!0});else{let o=0,r=0,f=i&&this.getMessageByPeer(e,i);f&&f.date&&(r=f.id,o=this.getMessagePeer(f)),u=g.default.invokeApi("messages.searchGlobal",{q:t,filter:s,min_date:l,max_date:c,offset_rate:a,offset_peer:P.default.getInputPeerById(o),offset_id:r,limit:n,folder_id:d},{noErrorBox:!0})}return u.then(e=>{D.default.saveApiUsers(e.users),E.default.saveApiChats(e.chats),this.saveMessages(e.messages),this.log("getSearch result:",s,e);const t=e.count||f.length+e.messages.length;return e.messages.forEach(e=>{const t=this.getMessagePeer(e);if(t<0){const e=E.default.getChat(-t);e.migrated_to&&this.migrateChecks(t,-e.migrated_to.channel_id)}f.push(e)}),{count:t,offset_id_offset:e.offset_id_offset||0,next_rate:e.next_rate,history:f}})}subscribeRepliesThread(e,t){const s=e+"_"+t;for(const e in this.threadsToReplies)if(this.threadsToReplies[e]===s)return;this.getDiscussionMessage(e,t)}generateThreadServiceStartMessage(e){const t=e.peerId+"_"+e.mid;if(this.threadsServiceMessagesIdsStorage[t])return;const s={_:"messageService",id:this.generateMessageId(e.id,!0),date:e.date,from_id:e.from_id,peer_id:e.peer_id,action:{_:"messageActionCustomAction",message:"Discussion started"},reply_to:this.generateReplyHeader(e.id)};this.saveMessages([s],{isOutgoing:!0}),this.threadsServiceMessagesIdsStorage[t]=s.mid}getDiscussionMessage(e,t){return g.default.invokeApi("messages.getDiscussionMessage",{peer:P.default.getInputPeerById(e),msg_id:this.getLocalMessageId(t)}).then(s=>{E.default.saveApiChats(s.chats),D.default.saveApiUsers(s.users),this.saveMessages(s.messages);const i=this.filterMessages(s.messages[0],e=>!!e.replies)[0],n=i.peerId+"_"+i.mid;this.generateThreadServiceStartMessage(i);const a=this.getHistoryStorage(i.peerId,i.mid);return s.max_id=a.maxId=this.generateMessageId(s.max_id)||0,s.read_inbox_max_id=a.readMaxId=this.generateMessageId(s.read_inbox_max_id)||0,s.read_outbox_max_id=a.readOutboxMaxId=this.generateMessageId(s.read_outbox_max_id)||0,this.threadsToReplies[n]=e+"_"+t,i})}scheduleHandleNewDialogs(){this.newDialogsHandlePromise||(this.newDialogsHandlePromise=window.setTimeout(this.handleNewDialogs,0))}deleteMessages(e,t,s){let i;const n=t.map(e=>this.getLocalMessageId(e));if(e<0&&P.default.isChannel(e)){const s=-e,a=E.default.getChat(s);if(!(a.pFlags.creator||a.pFlags.editor&&a.pFlags.megagroup)){const s=[];if((a.pFlags.editor||a.pFlags.megagroup)&&t.forEach((i,n)=>{this.getMessageByPeer(e,t[n]).pFlags.out&&s.push(i)}),!s.length)return;t=s}i=g.default.invokeApi("channels.deleteMessages",{channel:E.default.getChannelInput(s),id:n}).then(e=>{L.default.processUpdateMessage({_:"updateShort",update:{_:"updateDeleteChannelMessages",channel_id:s,messages:t,pts:e.pts,pts_count:e.pts_count}})})}else i=g.default.invokeApi("messages.deleteMessages",{revoke:s,id:n}).then(e=>{L.default.processUpdateMessage({_:"updateShort",update:{_:"updateDeleteMessages",messages:t,pts:e.pts,pts_count:e.pts_count}})});return i}readHistory(e,t=0,s){if(!this.isHistoryUnread(e,s))return Promise.resolve();const i=P.default.isChannel(e),n=this.getHistoryStorage(e,s);if((!n.readMaxId||t>n.readMaxId)&&(n.readMaxId=t),n.readPromise)return n.readPromise;let a;return a=s?g.default.invokeApi("messages.readDiscussion",{peer:P.default.getInputPeerById(e),msg_id:this.getLocalMessageId(s),read_max_id:this.getLocalMessageId(t)}).then(i=>{L.default.processUpdateMessage({_:"updateShort",update:{_:"updateReadChannelDiscussionInbox",channel_id:-e,top_msg_id:s,read_max_id:t}})}):i?g.default.invokeApi("channels.readHistory",{channel:E.default.getChannelInput(-e),max_id:this.getLocalMessageId(t)}).then(s=>{L.default.processUpdateMessage({_:"updateShort",update:{_:"updateReadChannelInbox",max_id:t,channel_id:-e}})}):g.default.invokeApi("messages.readHistory",{peer:P.default.getInputPeerById(e),max_id:this.getLocalMessageId(t)}).then(s=>{L.default.processUpdateMessage({_:"updateShort",update:{_:"updatePts",pts:s.pts,pts_count:s.pts_count}}),L.default.processUpdateMessage({_:"updateShort",update:{_:"updateReadHistoryInbox",max_id:t,peer:P.default.getOutputPeer(e)}})}),a.finally(()=>{delete n.readPromise,n.readMaxId>t&&this.readHistory(e,n.readMaxId)}),n.readPromise=a}readMessages(e,t){if(t=t.map(e=>this.getLocalMessageId(e)),e<0&&P.default.isChannel(e)){const s=-e;g.default.invokeApi("channels.readMessageContents",{channel:E.default.getChannelInput(s),id:t}).then(()=>{L.default.processUpdateMessage({_:"updateShort",update:{_:"updateChannelReadMessagesContents",channel_id:s,messages:t}})})}else g.default.invokeApi("messages.readMessageContents",{id:t}).then(e=>{L.default.processUpdateMessage({_:"updateShort",update:{_:"updateReadMessagesContents",messages:t,pts:e.pts,pts_count:e.pts_count}})})}getHistoryStorage(e,t){var s,i;return t?(this.threadsStorage[e]||(this.threadsStorage[e]={}),null!==(s=this.threadsStorage[e][t])&&void 0!==s?s:this.threadsStorage[e][t]={count:null,history:[]}):null!==(i=this.historiesStorage[e])&&void 0!==i?i:this.historiesStorage[e]={count:null,history:[]}}handleUpdate(e){var t,s;switch(this.log.debug("handleUpdate",e._,e),e._){case"updateMessageID":{const t=e.random_id,s=this.pendingByRandomId[t];if(s){const{peerId:i,tempId:n,storage:a}=s,o=this.generateMessageId(e.id);if(this.getMessageFromStorage(a,o).deleted)this.pendingByMessageId[o]=t;else{const e=this.getHistoryStorage(i),t=e.history.indexOf(n);-1!==t&&e.history.splice(t,1),this.finalizePendingMessageCallbacks(a,n,o)}}break}case"updateNewMessage":case"updateNewChannelMessage":{const t=e.message,s=this.getMessagePeer(t),i=this.getMessagesStorage(s),n=this.getDialogByPeerId(s);if(!n.length&&(s>0||!E.default.getChat(-s).pFlags.left)){this.newDialogsToHandle[s]={reload:!0},this.scheduleHandleNewDialogs(),void 0===this.newUpdatesAfterReloadToHandle[s]&&(this.newUpdatesAfterReloadToHandle[s]=[]),this.newUpdatesAfterReloadToHandle[s].push(e);break}this.saveMessages([t],{storage:i});const a=this.checkPendingMessage(t),o=this.getHistoryStorage(s);this.updateMessageRepliesIfNeeded(t);const r=o.history;if(-1!==r.indexOf(t.mid))return!1;const d=r[0];r.unshift(t.mid),t.mid<d&&r.sort((e,t)=>t-e),null!==o.count&&o.count++,this.mergeReplyKeyboard(o,t)&&M.default.broadcast("history_reply_markup",{peerId:s}),t.fromId>0&&!t.pFlags.out&&t.from_id&&D.default.forceUserOnline(t.fromId,t.date),a||(void 0===this.newMessagesToHandle[s]&&(this.newMessagesToHandle[s]=[]),this.newMessagesToHandle[s].push(t.mid),this.newMessagesHandlePromise||(this.newMessagesHandlePromise=window.setTimeout(this.handleNewMessages,0)));const l=n[0];if(l){const e=!t.pFlags.out&&t.pFlags.unread;this.setDialogTopMessage(t,l),e&&l.unread_count++}break}case"updateDialogUnreadMark":{this.log("updateDialogUnreadMark",e);const t=P.default.getPeerId(e.peer.peer),s=this.getDialogByPeerId(t);if(s.length){const t=s[0];e.pFlags.unread?t.pFlags.unread_mark=!0:delete t.pFlags.unread_mark,M.default.broadcast("dialogs_multiupdate",{peerId:t})}else this.newDialogsToHandle[t]={reload:!0},this.scheduleHandleNewDialogs();break}case"updateFolderPeers":{this.log("updateFolderPeers",e);const t=e.folder_peers;this.scheduleHandleNewDialogs(),t.forEach(e=>{var t;const{folder_id:s,peer:i}=e,n=P.default.getPeerId(i),a=this.dialogsStorage.dropDialog(n);if(a.length){const e=a[0];this.newDialogsToHandle[n]=e,(null===(t=e.pFlags)||void 0===t?void 0:t.pinned)&&(delete e.pFlags.pinned,this.dialogsStorage.pinnedOrders[s].findAndSplice(t=>t==e.peerId)),e.folder_id=s,this.dialogsStorage.generateIndexForDialog(e),this.dialogsStorage.pushDialog(e)}else this.newDialogsToHandle[n]={reload:!0}});break}case"updateDialogPinned":{const s=null!==(t=e.folder_id)&&void 0!==t?t:0;this.log("updateDialogPinned",e);const i=P.default.getPeerId(e.peer.peer),n=this.getDialogByPeerId(i);if(this.scheduleHandleNewDialogs(),n.length){const t=n[0];this.newDialogsToHandle[i]=t,e.pFlags.pinned?t.pFlags.pinned=!0:(delete t.pFlags.pinned,this.dialogsStorage.pinnedOrders[s].findAndSplice(e=>e==t.peerId)),this.dialogsStorage.generateIndexForDialog(t)}else this.newDialogsToHandle[i]={reload:!0};break}case"updatePinnedDialogs":{const t=null!==(s=e.folder_id)&&void 0!==s?s:0,i=e=>{this.dialogsStorage.pinnedOrders[t].length=0;let s=!1;e.reverse(),e.forEach(e=>{n[e]=!0;const t=this.getDialogByPeerId(e);if(!t.length)return this.newDialogsToHandle[e]={reload:!0},void(s=!0);const i=t[0];i.pFlags.pinned=!0,this.dialogsStorage.generateIndexForDialog(i),this.newDialogsToHandle[e]=i,s=!0}),this.dialogsStorage.getFolder(t).forEach(e=>{const t=e.peerId;e.pFlags.pinned&&!n[t]&&(this.newDialogsToHandle[t]={reload:!0},s=!0)}),s&&this.scheduleHandleNewDialogs()};this.log("updatePinnedDialogs",e);const n={};if(!e.order){g.default.invokeApi("messages.getPinnedDialogs",{folder_id:t}).then(e=>{this.applyConversations(e),i(e.dialogs.map(e=>e.peerId))});break}i(e.order.map(e=>P.default.getPeerId(e.peer)));break}case"updateEditMessage":case"updateEditChannelMessage":{const t=e.message,s=this.getMessagePeer(t),i=this.generateMessageId(t.id),n=this.getMessagesStorage(s);if(void 0===n[i])break;const a=this.getMessageFromStorage(n,i);this.saveMessages([t],{storage:n});const o=this.getMessageFromStorage(n,i);this.handleEditedMessage(a,o);const r=this.getDialogByPeerId(s)[0],d=r&&r.top_message==i;if(t.clear_history)d&&M.default.broadcast("dialog_flush",{peerId:s});else if(M.default.broadcast("message_edit",{storage:n,peerId:s,mid:i}),d||t.grouped_id){const e={};e[s]=r,M.default.broadcast("dialogs_multiupdate",e)}break}case"updateReadChannelDiscussionInbox":case"updateReadChannelDiscussionOutbox":case"updateReadHistoryInbox":case"updateReadHistoryOutbox":case"updateReadChannelInbox":case"updateReadChannelOutbox":{const t=e.channel_id,s=this.generateMessageId(e.max_id||e.read_max_id),i=this.generateMessageId(e.top_msg_id),n=t?-t:P.default.getPeerId(e.peer),a="updateReadHistoryOutbox"===e._||"updateReadChannelOutbox"===e._||"updateReadChannelDiscussionOutbox"===e._||void 0,o=this.getMessagesStorage(n),r=c.getObjectKeysAndSort(o,"desc"),d=this.getDialogByPeerId(n)[0],l=e.still_unread_count;let f=0,h=!1;const u=this.getHistoryStorage(n,i);if(n>0&&a&&D.default.forceUserOnline(n),i){const e=this.threadsToReplies[n+"_"+i];if(e){const[t,s]=e.split("_").map(e=>+e);this.updateMessage(t,s,"replies_updated")}}for(let e=0,t=r.length;e<t;e++){const t=r[e];if(t>s)continue;const n=o[t];if(n.pFlags.out==a){if(!n.pFlags.unread)break;if(i){const e=n.reply_to;if(!e||(e.reply_to_top_id||e.reply_to_msg_id)!==i)continue}n.pFlags.unread&&(delete n.pFlags.unread,h||(h=!0),n.pFlags.out||i||void 0!==l||(f=--d.unread_count))}}if(a?u.readOutboxMaxId=s:u.readMaxId=s,!i&&d&&(a?d.read_outbox_max_id=s:d.read_inbox_max_id=s,a||(f<0||!this.isHistoryUnread(n)?d.unread_count=0:f&&d.top_message>s&&(d.unread_count=f)),M.default.broadcast("dialog_unread",{peerId:n})),h&&M.default.broadcast("messages_read"),!i&&t){const e=n+"_";for(const t in this.threadsToReplies)if(0===t.indexOf(e)){const[e,s]=this.threadsToReplies[t].split("_").map(e=>+e);M.default.broadcast("replies_updated",this.getMessageByPeer(e,s))}}break}case"updateChannelReadMessagesContents":case"updateReadMessagesContents":{const t=e.channel_id,s=t?-t:this.getMessageById(e.messages[0]).peerId,i=e.messages;for(const e of i){const t=this.getMessageByPeer(s,e);t.deleted||delete t.pFlags.media_unread}M.default.broadcast("messages_media_read",{peerId:s,mids:i.map(e=>this.generateMessageId(e))});break}case"updateChannelAvailableMessages":{const t=e.channel_id,s=[],i=-t,n=this.getHistoryStorage(i).history;n.length&&n.forEach(t=>{(!e.available_min_id||t<=e.available_min_id)&&s.push(t)}),e.messages=s}case"updateDeleteMessages":case"updateDeleteChannelMessages":{const t=e.channel_id,s=e.messages.map(e=>this.generateMessageId(e)),i=t?-t:this.getMessageById(s[0]).peerId;if(!i)break;const n=this.handleDeletedMessages(i,this.getMessagesStorage(i),s),a=this.getHistoryStorage(i),o=a.history.filter(e=>!n.msgs[e]);a.history=o,n.count&&null!==a.count&&a.count>0&&(a.count-=n.count,a.count<0&&(a.count=0)),M.default.broadcast("history_delete",{peerId:i,msgs:n.msgs});const r=this.getDialogByPeerId(i)[0];r&&(n.unread&&(r.unread_count-=n.unread,M.default.broadcast("dialog_unread",{peerId:i})),n.msgs[r.top_message]&&this.reloadConversation(i));break}case"updateChannel":{const t=e.channel_id,s=-t,i=E.default.getChat(t),n="channel"==i._&&!i.pFlags.left&&!i.pFlags.kicked,a=this.getDialogByPeerId(s),o=a.length>0;("channel"==i._&&(i.username||!i.pFlags.left&&!i.pFlags.kicked))!=(void 0!==this.historiesStorage[s])&&(delete this.historiesStorage[s],M.default.broadcast("history_forbidden",s)),o!=n&&(n?this.reloadConversation(-t):a[0]&&(this.dialogsStorage.dropDialog(s),M.default.broadcast("dialog_drop",{peerId:s,dialog:a[0]})));break}case"updateChannelReload":{const t=e.channel_id,s=-t;this.dialogsStorage.dropDialog(s),delete this.historiesStorage[s],this.reloadConversation(-t).then(()=>{M.default.broadcast("history_reload",s)});break}case"updateChannelMessageViews":{const t=e.views,s=this.generateMessageId(e.id),i=this.getMessageByPeer(-e.channel_id,s);!i.deleted&&i.views&&i.views<t&&(i.views=t,M.default.broadcast("message_views",{mid:s,views:t}));break}case"updateServiceNotification":{this.log("updateServiceNotification",e);const t=777e3,s=t,i=this.generateTempMessageId(s),n={_:"message",id:i,from_id:P.default.getOutputPeer(t),peer_id:P.default.getOutputPeer(s),pFlags:{unread:!0},date:(e.inbox_date||d.tsNow(!0))+v.default.serverTimeOffset,message:e.message,media:e.media,entities:e.entities};D.default.hasUser(t)||D.default.saveApiUsers([{_:"user",id:t,pFlags:{verified:!0},access_hash:0,first_name:"Telegram",phone:"42777"}]),this.saveMessages([n],{isOutgoing:!0}),e.inbox_date&&(this.pendingTopMsgs[s]=i,this.handleUpdate({_:"updateNewMessage",message:n}));break}case"updatePinnedMessages":case"updatePinnedChannelMessages":{const t="updatePinnedChannelMessages"==e._?e.channel_id:void 0,s=t?-t:P.default.getPeerId(e.peer),i=e.messages.map(e=>this.generateMessageId(e)),n=this.getMessagesStorage(s),a=i.filter(e=>!n[e]);(a.length?Promise.all(a.map(e=>this.wrapSingleMessage(s,e))):Promise.resolve()).finally(()=>{var t;const a=null===(t=e.pFlags)||void 0===t?void 0:t.pinned;if(a)for(const e of i){n[e].pFlags.pinned=!0}else for(const e of i){delete n[e].pFlags.pinned}delete this.pinnedMessages[s],A.default.getState().then(e=>{delete e.hiddenPinnedMessages[s],M.default.broadcast("peer_pinned_messages",{peerId:s,mids:i,pinned:a})})});break}case"updateNotifySettings":{const{peer:t,notify_settings:s}=e,i=P.default.getPeerId(t.peer),n=this.getDialogByPeerId(i)[0];n&&(n.notify_settings=s,M.default.broadcast("dialog_notify_settings",i));break}case"updateNewScheduledMessage":{const t=e.message,s=this.getMessagePeer(t),i=this.scheduledMessagesStorage[s];if(i){const e=this.generateMessageId(t.id),n=this.getMessageFromStorage(i,e);this.saveMessages([t],{storage:i,isScheduled:!0});const a=this.getMessageFromStorage(i,e);if(n.deleted){this.checkPendingMessage(t)||M.default.broadcast("scheduled_new",{peerId:s,mid:t.mid})}else this.handleEditedMessage(n,a),M.default.broadcast("message_edit",{storage:i,peerId:s,mid:t.mid})}break}case"updateDeleteScheduledMessages":{const t=P.default.getPeerId(e.peer),s=this.scheduledMessagesStorage[t];if(s){const i=e.messages.map(e=>this.generateMessageId(e));this.handleDeletedMessages(t,s,i),M.default.broadcast("scheduled_delete",{peerId:t,mids:i})}break}}}updateMessageRepliesIfNeeded(e){try{if(e.peerId<0&&e.reply_to){const t=e.reply_to.reply_to_top_id||e.reply_to.reply_to_msg_id,s=e.peerId+"_"+t,i=this.threadsToReplies[s];if(i){const[e,t]=i.split("_").map(e=>+e);this.updateMessage(e,t,"replies_updated")}}}catch(t){this.log.error("incrementMessageReplies err",t,e)}}updateMessage(e,t,s){return this.wrapSingleMessage(e,t,!0).then(()=>{const i=this.getMessageByPeer(e,t);return s&&M.default.broadcast(s,i),i})}checkPendingMessage(e){const t=this.pendingByMessageId[e.mid];let s;if(t){const i=this.pendingByRandomId[t];(s=this.finalizePendingMessage(t,e))&&M.default.broadcast("history_update",{storage:i.storage,peerId:e.peerId,mid:e.mid}),delete this.pendingByMessageId[e.mid]}return s}isPeerMuted(e){if(e==M.default.myId)return!1;const t=this.getDialogByPeerId(e)[0];let s=!1;return t&&t.notify_settings&&t.notify_settings.mute_until&&(s=new Date(1e3*t.notify_settings.mute_until)>new Date),s}mutePeer(e){let t={_:"inputNotifyPeer",peer:P.default.getInputPeerById(e)},s={_:"inputPeerNotifySettings"},i=O.getDialogByPeerId(e)[0],n=!0;i&&i.notify_settings&&(n=i.notify_settings.mute_until>(Date.now()/1e3|0)),n||(s.mute_until=2147483647),g.default.invokeApi("account.updateNotifySettings",{peer:t,settings:s}).then(t=>{t&&this.handleUpdate({_:"updateNotifySettings",peer:{_:"notifyPeer",peer:P.default.getOutputPeer(e)},notify_settings:Object.assign(Object.assign({},s),{_:"peerNotifySettings"})})})}canWriteToPeer(e){if(e<0){const t=P.default.isChannel(e),s=t&&E.default.hasRights(-e,"send");return!t||s}return D.default.canSendToUser(e)}finalizePendingMessage(e,t){const s=this.pendingByRandomId[e];if(s){const{peerId:i,tempId:n,storage:a}=s,o=this.getHistoryStorage(i),r=o.history.indexOf(n);-1!==r&&o.history.splice(r,1);const d=this.getMessageFromStorage(a,n);return d.deleted||(delete d.pFlags.is_outgoing,delete d.pending,delete d.error,delete d.random_id,delete d.send,M.default.broadcast("messages_pending")),delete this.pendingByRandomId[e],this.finalizePendingMessageCallbacks(a,n,t.mid),d}return!1}finalizePendingMessageCallbacks(e,t,s){const i=this.getMessageFromStorage(e,s),n=this.tempFinalizeCallbacks[t];if(this.log.warn(n,t),void 0!==n){for(const e in n){const{deferred:t,callback:s}=n[e];this.log(`finalizePendingMessageCallbacks: will invoke ${e} callback`),s(i).then(t.resolve,t.reject)}delete this.tempFinalizeCallbacks[t]}if(i.media)if(i.media.photo){const e=k.default.getPhoto(""+t);if(e){const t=i.media.photo;c.defineNotNumerableProperties(t,["downloaded","url"]),t.downloaded=e.downloaded,t.url=e.url}}else if(i.media.document){const e=C.default.getDoc(""+t);if((null==e?void 0:e.type)&&"sticker"!==e.type){const t=i.media.document;t.downloaded=e.downloaded,t.url=e.url}}else i.media.poll&&(delete x.default.polls[t],delete x.default.results[t]);const a=this.getMessageFromStorage(e,t);delete e[t],M.default.broadcast("message_sent",{storage:e,tempId:t,tempMessage:a,mid:s})}incrementMaxSeenId(e){if(!e||this.maxSeenId&&!(e>this.maxSeenId))return!1;this.maxSeenId=e,w.default.set({max_seen_msg:e}),g.default.invokeApi("messages.receivedMessages",{max_id:this.getLocalMessageId(e)})}getScheduledMessagesStorage(e){var t;return null!==(t=this.scheduledMessagesStorage[e])&&void 0!==t?t:this.scheduledMessagesStorage[e]=this.createMessageStorage()}getScheduledMessages(e){if(!this.canWriteToPeer(e))return Promise.resolve([]);const t=this.getScheduledMessagesStorage(e);return Object.keys(t).length?Promise.resolve(Object.keys(t).map(e=>+e)):g.default.invokeApi("messages.getScheduledHistory",{peer:P.default.getInputPeerById(e),hash:0}).then(t=>{if("messages.messagesNotModified"!==t._){D.default.saveApiUsers(t.users),E.default.saveApiChats(t.chats);const s=this.getScheduledMessagesStorage(e);return this.saveMessages(t.messages,{storage:s,isScheduled:!0}),Object.keys(s).map(e=>+e)}return[]})}sendScheduledMessages(e,t){return g.default.invokeApi("messages.sendScheduledMessages",{peer:P.default.getInputPeerById(e),id:t.map(e=>this.getLocalMessageId(e))}).then(e=>{L.default.processUpdateMessage(e)})}deleteScheduledMessages(e,t){return g.default.invokeApi("messages.deleteScheduledMessages",{peer:P.default.getInputPeerById(e),id:t.map(e=>this.getLocalMessageId(e))}).then(e=>{L.default.processUpdateMessage(e)})}getHistory(e,t=0,s,i,n){this.migratedFromTo[e]&&(e=this.migratedFromTo[e]);const a=this.getHistoryStorage(e,n);let o=0,r=!1,d=!1,l=e;if(this.migratedToFrom[e]&&(d=!0),t)for(r=!0;o<a.history.length;o++)if(t>a.history[o]){r=!1;break}if(!r&&(null!==a.count&&a.history.length==a.count||a.history.length>=o+s)){i?(i=Math.min(o,i),o=Math.max(0,o-i),s+=i):s=s;const e=a.history.slice(o,o+s);return{count:a.count,history:e,offsetIdOffset:o}}return r&&(o=0),(i||t)&&-1===a.history.indexOf(t)?(i&&(o=-i,s+=i),this.requestHistory(l,t,s,o,void 0,n).then(e=>{a.count=e.count||e.messages.length,d&&a.count++;const t=e.messages.map(e=>e.mid);return{count:a.count,history:t,offsetIdOffset:e.offset_id_offset||0}})):this.fillHistoryStorage(e,t,s,a,n).then(()=>{let e=0;if(t)for(;e<a.history.length&&!(t>a.history[e]);e++);const n=a.history.slice(i?Math.max(e-i,0):e,e+s);return{count:a.count,history:n,offsetIdOffset:e}})}fillHistoryStorage(e,t,s,i,n){const a=this.migratedFromTo[e]&&!t?1:0;return this.requestHistory(e,t,s,a,void 0,n).then(a=>{i.count=a.count||a.messages.length,!t&&a.messages.length&&(t=this.incrementMessageId(a.messages[0].mid,1));let o=0;if(t)for(;o<i.history.length&&!(t>i.history[o]);o++);const r=i.history.length;i.history.splice(o,i.history.length-o),a.messages.forEach(t=>{this.mergeReplyKeyboard(i,t)&&M.default.broadcast("history_reply_markup",{peerId:e}),i.history.push(t.mid)});const d=i.history.length;s-=d-r;const l=this.migratedFromTo[e],c=this.migratedToFrom[e],f=void 0!==l||void 0!==c;if(f&&(i.count=Math.max(i.count,d)+1),s>0){if(t=i.history[d-1],f){if(!a.messages.length){if(!c)return i.count=d,!0;t=0,e=c}return this.fillHistoryStorage(e,t,s,i,n)}if(d<i.count)return this.fillHistoryStorage(e,t,s,i,n)}return!0})}requestHistory(e,t,s=0,i=0,n=0,a=0){const o=P.default.isChannel(e),r={peer:P.default.getInputPeerById(e),msg_id:this.getLocalMessageId(a)||0,offset_id:this.getLocalMessageId(t)||0,offset_date:n,add_offset:i,limit:s,max_id:0,min_id:0,hash:0};return g.default.invokeApi(a?"messages.getReplies":"messages.getHistory",r,{noErrorBox:!0}).then(r=>{this.log("requestHistory result:",e,r,t,s,i),D.default.saveApiUsers(r.users),E.default.saveApiChats(r.chats),this.saveMessages(r.messages),o&&L.default.addChannelState(-e,r.pts);let d=r.messages.length;d&&r.messages[d-1].deleted&&(r.messages.splice(d-1,1),d--,r.count--);const l=this.getHistoryStorage(e,a);return d&&r.messages[d-1].grouped_id&&l.history.length+r.messages.length<r.count?this.requestHistory(e,r.messages[d-1].mid,10,0,n,a).then(e=>r):r},t=>{switch(t.type){case"CHANNEL_PRIVATE":let t=E.default.getChat(-e);t={_:"channelForbidden",access_hash:t.access_hash,title:t.title},L.default.processUpdateMessage({_:"updates",updates:[{_:"updateChannel",channel_id:-e}],chats:[t],users:[]})}throw t})}fetchSingleMessages(){return this.fetchSingleMessagesPromise?this.fetchSingleMessagesPromise:this.fetchSingleMessagesPromise=new Promise(e=>{setTimeout(()=>{let t=[];for(const e in this.needSingleMessages){const s=this.needSingleMessages[e];delete this.needSingleMessages[e];const i=s.map(e=>({_:"inputMessageID",id:this.getLocalMessageId(e)}));let n;n=+e<0&&P.default.isChannel(+e)?g.default.invokeApi("channels.getMessages",{channel:E.default.getChannelInput(-+e),id:i}):g.default.invokeApi("messages.getMessages",{id:i}),t.push(n.then(t=>{"messages.messagesNotModified"!=t._&&(D.default.saveApiUsers(t.users),E.default.saveApiChats(t.chats),this.saveMessages(t.messages)),M.default.broadcast("messages_downloaded",{peerId:+e,mids:s})}))}Promise.all(t).finally(()=>{this.fetchSingleMessagesPromise=null,Object.keys(this.needSingleMessages).length&&this.fetchSingleMessages(),e()})},0)})}wrapSingleMessage(e,t,s=!1){var i;return this.getMessageByPeer(e,t).deleted||s?this.needSingleMessages[e]&&-1!==this.needSingleMessages[e].indexOf(t)?this.fetchSingleMessagesPromise?this.fetchSingleMessagesPromise:void 0:((null!==(i=this.needSingleMessages[e])&&void 0!==i?i:this.needSingleMessages[e]=[]).push(t),this.fetchSingleMessages()):(M.default.broadcast("messages_downloaded",{peerId:e,mids:[t]}),Promise.resolve())}setTyping(e,t){if(!M.default.myId||!e||!this.canWriteToPeer(e))return Promise.resolve(!1);const s="string"==typeof t?{_:t}:t;return g.default.invokeApi("messages.setTyping",{peer:P.default.getInputPeerById(e),action:s})}handleDeletedMessages(e,t,s){const i={count:0,unread:0,msgs:{}};for(const n of s){const s=this.getMessageFromStorage(t,n);if(s.deleted)continue;if(s.media){const t=s.media.webpage||s.media,i=t.photo||t.document;(null==i?void 0:i.file_reference)&&b.default.deleteContext(i.file_reference,{type:"message",peerId:e,messageId:n}),s.media.webpage&&X.default.deleteWebPageFromPending(s.media.webpage,n)}if(this.updateMessageRepliesIfNeeded(s),!s.pFlags.out&&s.pFlags.unread&&i.unread++,i.count++,i.msgs[n]=!0,s.deleted=!0,"messageService"!=s._&&s.grouped_id){const e=this.groupedMessagesStorage[s.grouped_id];e&&(delete e[n],i.albums||(i.albums={}),(i.albums[s.grouped_id]||(i.albums[s.grouped_id]=new Set)).add(n),Object.keys(e).length||(delete i.albums,delete this.groupedMessagesStorage[s.grouped_id]))}delete t[n];const a=this.newMessagesToHandle[e];if(a&&a.length){const e=a.indexOf(n);-1!=e&&a.splice(e)}}if(i.albums)for(const t in i.albums)M.default.broadcast("album_edit",{peerId:e,groupId:t,deletedMids:[...i.albums[t]]});return i}handleEditedMessage(e,t){var s;(null===(s=e.media)||void 0===s?void 0:s.webpage)&&X.default.deleteWebPageFromPending(e.media.webpage,e.mid)}}t.AppMessagesManager=F,F.MESSAGE_ID_INCREMENT=65536,F.MESSAGE_ID_OFFSET=4294967295;const O=new F;m.MOUNT_CLASS_TO&&(m.MOUNT_CLASS_TO.appMessagesManager=O),t.default=O},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppUsersManager=void 0;const a=s(4),o=s(18),r=s(14),d=n(s(5)),l=s(2),c=n(s(57)),f=s(3),h=n(s(1)),u=n(s(69)),p=n(s(35)),g=n(s(19)),m=n(s(10)),b=n(s(13));class v{constructor(){this.users={},this.usernames={},this.cachedPhotoLocations={},this.contactsIndex=u.default.createIndex(),this.contactsList=new Set,this.updatedContactsList=!1,this.updateUsersStatuses=()=>{const e=o.tsNow(!0);for(const t in this.users){const s=this.users[t];s.status&&"userStatusOnline"==s.status._&&s.status.expires<e&&(s.status={_:"userStatusOffline",was_online:s.status.expires},h.default.broadcast("user_update",s.id))}},setInterval(this.updateUsersStatuses,6e4),h.default.on("state_synchronized",this.updateUsersStatuses),h.default.on("apiUpdate",e=>{const t=e.detail;switch(t._){case"updateUserStatus":const e=t.user_id,s=this.users[e];s&&(s.status=t.status,s.status&&("expires"in s.status&&(s.status.expires-=c.default.serverTimeOffset),"was_online"in s.status&&(s.status.was_online-=c.default.serverTimeOffset)),s.sortStatus=this.getUserStatusForSort(s.status),h.default.broadcast("user_update",e));break;case"updateUserPhoto":{const e=t.user_id,s=this.users[e];s?(this.forceUserOnline(e),s.photo?r.safeReplaceObject(s.photo,t.photo):s.photo=t.photo,void 0!==this.cachedPhotoLocations[e]&&r.safeReplaceObject(this.cachedPhotoLocations[e],t.photo?t.photo:{empty:!0}),h.default.broadcast("user_update",e),h.default.broadcast("avatar_update",e)):console.warn("No user by id:",e);break}}}),b.default.addListener("save",()=>i(this,void 0,void 0,(function*(){const e=[...this.contactsList];for(const t of e)b.default.setPeer(t,this.getUser(t));b.default.pushToState("contactsList",e)}))),b.default.getState().then(e=>{this.users=e.users;const t=e.contactsList;t&&Array.isArray(t)&&(t.forEach(e=>{this.pushContact(e)}),this.contactsFillPromise=Promise.resolve(this.contactsList))})}fillContacts(){if(this.contactsFillPromise&&this.updatedContactsList)return this.contactsFillPromise;this.updatedContactsList=!0;const e=d.default.invokeApi("contacts.getContacts").then(t=>("contacts.contacts"==t._&&(this.saveApiUsers(t.users),t.contacts.forEach(e=>{this.pushContact(e.user_id)})),this.contactsFillPromise=e,this.contactsList));return this.contactsFillPromise||(this.contactsFillPromise=e)}resolveUsername(e){return"@"==e[0]&&(e=e.slice(1)),e=e.toLowerCase(),this.usernames[e]?Promise.resolve(this.users[this.usernames[e]]):d.default.invokeApi("contacts.resolveUsername",{username:e}).then(e=>(this.saveApiUsers(e.users),g.default.saveApiChats(e.chats),m.default.getPeer(m.default.getPeerId(e.peer))))}pushContact(e){this.contactsList.add(e),u.default.indexObject(e,this.getUserSearchText(e),this.contactsIndex)}getUserSearchText(e){const t=this.users[e];if(!t)return"";const s=t.pFlags.self?"user_name_saved_msgs_raw":"";return(t.first_name||"")+" "+(t.last_name||"")+" "+(t.phone||"")+" "+(t.username||"")+" "+s}getContacts(e,t=!1){return this.fillContacts().then(s=>{let i=[...s];if(e){const t=u.default.search(e,this.contactsIndex);i=[...i].filter(e=>!!t[e])}if(i.sort((e,t)=>{const s=(this.users[e]||{}).sortName||"",i=(this.users[t]||{}).sortName||"";return s.localeCompare(i)}),t){("saved messages".includes(e.toLowerCase())||y.getUser(h.default.myId).sortName.includes(e.toLowerCase()))&&(i.findAndSplice(e=>e==h.default.myId),i.unshift(h.default.myId))}return i})}saveApiUsers(e){e.forEach(e=>this.saveApiUser(e))}saveApiUser(e,t){if("userEmpty"==e._)return;const s=e;if(t&&r.isObject(this.users[s.id])&&this.users[s.id].first_name)return;const i=s.id;if(void 0===s.pFlags&&(s.pFlags={}),s.pFlags.min&&void 0!==this.users[i])return;s.phone&&(s.rPhone="+"+a.formatPhoneNumber(s.phone).formatted);const n=s.first_name+" "+(s.last_name||"");if(s.first_name?(s.rFirstName=f.RichTextProcessor.wrapRichText(s.first_name,{noLinks:!0,noLinebreaks:!0}),s.rFullName=s.last_name?f.RichTextProcessor.wrapRichText(n,{noLinks:!0,noLinebreaks:!0}):s.rFirstName):(s.rFirstName=f.RichTextProcessor.wrapRichText(s.last_name,{noLinks:!0,noLinebreaks:!0})||s.rPhone||"user_first_name_deleted",s.rFullName=f.RichTextProcessor.wrapRichText(s.last_name,{noLinks:!0,noLinebreaks:!0})||s.rPhone||"user_name_deleted"),s.username){const e=u.default.cleanUsername(s.username);this.usernames[e]=i}s.sortName=s.pFlags.deleted?"":u.default.cleanSearchText(n,!1),s.initials=f.RichTextProcessor.getAbbreviation(n),s.status&&(s.status.expires&&(s.status.expires-=c.default.serverTimeOffset),s.status.was_online&&(s.status.was_online-=c.default.serverTimeOffset)),s.pFlags.bot?s.sortStatus=-1:s.sortStatus=this.getUserStatusForSort(s.status);const o=this.users[i];void 0===o?this.users[i]=s:r.safeReplaceObject(o,s),h.default.broadcast("user_update",i),void 0!==this.cachedPhotoLocations[i]&&r.safeReplaceObject(this.cachedPhotoLocations[i],s&&s.photo?s.photo:{empty:!0})}getUserStatusForSort(e){if(e){const t="userStatusOnline"==e._?e.expires:"userStatusOffline"==e._?e.was_online:0;if(t)return t;const s=o.tsNow(!0);switch(e._){case"userStatusRecently":return s-259200;case"userStatusLastWeek":return s-604800;case"userStatusLastMonth":return s-2592e3}}return 0}getUser(e){return r.isObject(e)?e:this.users[e]||{id:e,pFlags:{deleted:!0},access_hash:""}}getSelf(){return this.getUser(h.default.myId)}getUserStatusString(e){var t;switch(e){case l.REPLIES_PEER_ID:return"reply notifications";case 777e3:return"service notifications"}if(this.isBot(e))return"bot";const s=this.getUser(e);if(!s)return"";if(s.pFlags.support)return"support";let i="";switch(null===(t=s.status)||void 0===t?void 0:t._){case"userStatusRecently":i="last seen recently";break;case"userStatusLastWeek":i="last seen last week";break;case"userStatusLastMonth":i="last seen last month";break;case"userStatusOffline":{i="last seen ";const e=s.status.was_online,t=Date.now()/1e3;if(t-e<60)i+=" just now";else if(t-e<3600){const s=(t-e)/60|0;i+=s+" "+(1==s?"minute":"minutes")+" ago"}else if(t-e<86400){const s=(t-e)/3600|0;i+=s+" "+(1==s?"hour":"hours")+" ago"}else{const t=new Date(1e3*e);i+=("0"+t.getDate()).slice(-2)+"."+("0"+(t.getMonth()+1)).slice(-2)+" at "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)}break}case"userStatusOnline":i="online";break;default:i="last seen a long time ago"}return i}isBot(e){return this.users[e]&&this.users[e].pFlags.bot}isContact(e){return this.contactsList.has(e)}isRegularUser(e){const t=this.users[e];return t&&!this.isBot(e)&&!t.pFlags.deleted&&!t.pFlags.support}isNonContactUser(e){return this.isRegularUser(e)&&!this.isContact(e)&&e!=h.default.myId}hasUser(e,t){var s=this.users[e];return r.isObject(s)&&(t||!s.pFlags.min)}canSendToUser(e){const t=this.getUser(e);return!t.pFlags.deleted&&"replies"!==t.username}getUserPhoto(e){var t=this.getUser(e);return void 0===this.cachedPhotoLocations[e]&&(this.cachedPhotoLocations[e]=t&&t.photo?t.photo:{empty:!0}),this.cachedPhotoLocations[e]}getUserInput(e){const t=this.getUser(e);return t.pFlags&&t.pFlags.self?{_:"inputUserSelf"}:{_:"inputUser",user_id:e,access_hash:t.access_hash}}forceUserOnline(e,t){if(this.isBot(e))return;const s=o.tsNow(!0);if(t){if(s-t>=60)return}else if(p.default.updatesState.syncLoading)return;const i=this.getUser(e);i&&i.status&&"userStatusOnline"!=i.status._&&"userStatusEmpty"!=i.status._&&!i.pFlags.support&&!i.pFlags.deleted&&(i.status={_:"userStatusOnline",expires:s+60},i.sortStatus=this.getUserStatusForSort(i.status),h.default.broadcast("user_update",e))}getTopPeers(){return this.getTopPeersPromise?this.getTopPeersPromise:this.getTopPeersPromise=b.default.getState().then(e=>{var t;return(null===(t=null==e?void 0:e.topPeers)||void 0===t?void 0:t.length)?e.topPeers:d.default.invokeApi("contacts.getTopPeers",{correspondents:!0,offset:0,limit:30,hash:0}).then(e=>{let t;return"contacts.topPeers"==e._&&(this.saveApiUsers(e.users),g.default.saveApiChats(e.chats),t=e.categories[0].peers.map(e=>{const t=m.default.getPeerId(e.peer);return b.default.setPeer(t,this.getUser(t)),t})),b.default.pushToState("topPeers",t),t})})}searchContacts(e,t=20){return d.default.invokeApi("contacts.search",{q:e,limit:t}).then(e=>{this.saveApiUsers(e.users),g.default.saveApiChats(e.chats);return{my_results:[...new Set(e.my_results.map(e=>m.default.getPeerId(e)))],results:e.results.map(e=>m.default.getPeerId(e))}})}setUserStatus(e,t){if(this.isBot(e))return;const s=this.users[e];if(s){const i=t?{_:"userStatusOffline",was_online:o.tsNow(!0)}:{_:"userStatusOnline",expires:o.tsNow(!0)+500};s.status=i,s.sortStatus=this.getUserStatusForSort(s.status),h.default.broadcast("user_update",e)}}}t.AppUsersManager=v;const y=new v;l.MOUNT_CLASS_TO&&(l.MOUNT_CLASS_TO.appUsersManager=y),t.default=y},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenSize=void 0;const n=s(2),a=i(s(54));var o;!function(e){e[e.mobile=0]="mobile",e[e.medium=1]="medium",e[e.large=2]="large"}(o=t.ScreenSize||(t.ScreenSize={}));class r extends a.default{constructor(){super(),this.screenSizes=[{key:o.mobile,value:600},{key:o.medium,value:1275},{key:o.large,value:1680}],this.sizes={handhelds:{regular:{width:293,height:293},webpage:{width:293,height:213},album:{width:293,height:0},esgSticker:{}},desktop:{regular:{width:480,height:480},webpage:{width:480,height:400},album:{width:451,height:0},esgSticker:{}}},this.isMobile=!1,this.handleResize=()=>{const e=window.innerWidth;let t=this.screenSizes[0].key;for(let s=this.screenSizes.length-1;s>=0;--s)if(this.screenSizes[s].value<e){t=(this.screenSizes[s+1]||this.screenSizes[s]).key;break}const s=this.activeScreen;this.activeScreen=t,this.isMobile=this.activeScreen==o.mobile,this.active=this.isMobile?this.sizes.handhelds:this.sizes.desktop;const i=window.getComputedStyle(document.documentElement);this.active.esgSticker.width=parseFloat(i.getPropertyValue("--esg-sticker-size")),s!=t&&void 0!==s&&this.setListenerResult("changeScreen",this.activeScreen,t)},window.addEventListener("resize",this.handleResize),this.handleResize()}}const d=new r;n.MOUNT_CLASS_TO&&(n.MOUNT_CLASS_TO.mediaSizes=d),t.default=d},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppPeersManager=void 0;const n=s(14),a=s(2),o=s(3),r=i(s(1)),d=i(s(19)),l=i(s(8)),c=["#c03d33","#4fad2d","#d09306","#168acd","#8544d6","#cd4073","#2996ad","#ce671b"],f=["#e17076","#7bc862","#e5ca77","#65AADD","#a695e7","#ee7aae","#6ec9cb","#faa774"],h=[0,7,4,1,6,3,5];class u{canPinMessage(e){return e>0||d.default.hasRights(-e,"pin")}getPeerPhoto(e){return e>0?l.default.getUserPhoto(e):d.default.getChatPhoto(-e)}getPeerMigratedTo(e){if(e>=0)return!1;let t=d.default.getChat(-e);return!!(t&&t.migrated_to&&t.pFlags.deactivated)&&this.getPeerId(t.migrated_to)}getPeerTitle(e,t=!1,s=!1){e||(e=r.default.myId);let i={};i=n.isObject(e)?e:this.getPeer(e);let a="";return e>0?(i.first_name&&(a+=i.first_name),i.last_name&&(a+=" "+i.last_name),a=a?a.trim():i.pFlags.deleted?"Deleted Account":i.username):a=i.title,s&&(a=a.split(" ")[0]),t?a:o.RichTextProcessor.wrapEmojiText(a)}getOutputPeer(e){if(e>0)return{_:"peerUser",user_id:e};let t=-e;return d.default.isChannel(t)?{_:"peerChannel",channel_id:t}:{_:"peerChat",chat_id:t}}getPeerUsername(e){return e>0?l.default.getUser(e).username||"":d.default.getChat(-e).username||""}getPeer(e){return e>0?l.default.getUser(e):d.default.getChat(-e)}getPeerId(e){if("number"==typeof e)return e;if(n.isObject(e))return e.user_id?e.user_id:-(e.channel_id||e.chat_id);if(!e)return 0;const t="u"==e.charAt(0),s=e.substr(1).split("_");return t?s[0]:-s[0]||0}getDialogPeer(e){return{_:"dialogPeer",peer:this.getOutputPeer(e)}}isChannel(e){return e<0&&d.default.isChannel(-e)}isMegagroup(e){return e<0&&d.default.isMegagroup(-e)}isAnyGroup(e){return e<0&&!d.default.isBroadcast(-e)}isBroadcast(e){return this.isChannel(e)&&!this.isMegagroup(e)}isBot(e){return e>0&&l.default.isBot(e)}getInputPeerById(e){if(!e)return{_:"inputPeerEmpty"};if(e<0){const t=-e;return d.default.isChannel(t)?d.default.getChannelInputPeer(t):d.default.getChatInputPeer(t)}return{_:"inputPeerUser",user_id:e,access_hash:l.default.getUser(e).access_hash}}getInputDialogPeerById(e){return{_:"inputDialogPeer",peer:this.getInputPeerById(e)}}getPeerColorById(e,t=!0){if(!e)return"";return(t?f:c)[h[(e<0?-e:e)%7]]}getPeerSearchText(e){let t;if(e>0)t="%pu "+l.default.getUserSearchText(e);else if(e<0){t="%pg "+(d.default.getChat(-e).title||"")}return t}getDialogType(e){return p.isMegagroup(e)?"megagroup":p.isChannel(e)?"channel":e<0?"group":e==r.default.myId?"saved":"chat"}getDeleteButtonText(e){switch(this.getDialogType(e)){case"megagroup":case"channel":return"Leave";default:return"Delete"}}}t.AppPeersManager=u;const p=new u;a.MOUNT_CLASS_TO&&(a.MOUNT_CLASS_TO.appPeersManager=p),t.default=p},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTouchSupported=void 0,t.isTouchSupported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSafari=t.isAppleMobile=t.isChromium=t.isAndroid=t.isApple=t.userAgent=void 0,t.userAgent=navigator?navigator.userAgent:null,t.isApple=-1!=navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i),t.isAndroid=-1!=navigator.userAgent.toLowerCase().indexOf("android"),t.isChromium=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);const i="undefined"!=typeof window?window:self;t.isAppleMobile=(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!i.MSStream,t.isSafari=!!("safari"in i)||!(!t.userAgent||!(/\b(iPad|iPhone|iPod)\b/.test(t.userAgent)||t.userAgent.match("Safari")&&!t.userAgent.match("Chrome")))},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppStateManager=void 0;const n=s(2),a=i(s(54)),o=i(s(1)),r=i(s(55)),d=s(16),l=n.App.version,c=["dialogs","allDialogsLoaded","chats","users","messages","contactsList","updates","filters","maxSeenMsgId","stateCreatedTime","recentEmoji","topPeers","recentSearch","stickerSets","version","authState","hiddenPinnedMessages"],f=["dialogs","allDialogsLoaded","messages","contactsList","stateCreatedTime","updates","maxSeenMsgId","filters","topPeers"];class h extends a.default{constructor(){super(),this.log=d.logger("STATE"),this.tempId=0,this.loadSavedState()}loadSavedState(){return this.loaded?this.loaded:this.loaded=new Promise(e=>{r.default.get(...c,"user_auth").then(t=>{let s={};c.forEach((e,i)=>{const n=t[i];!1!==n&&(s[e]=n)});const i=Date.now();s&&(s.version!=l?s={}:(s.stateCreatedTime||0)+864e5<i&&(this.log("will refresh state",s.stateCreatedTime,i),f.forEach(e=>{delete s[e]}))),this.state=s||{},this.state.chats=s.chats||{},this.state.users=s.users||{},this.state.hiddenPinnedMessages=this.state.hiddenPinnedMessages||{},this.state.version=l,this.state.hasOwnProperty("stateCreatedTime")||(this.state.stateCreatedTime=Date.now()),this.log("state res",s);const n=t[t.length-1];n?(this.state.authState={_:"authStateSignedIn"},o.default.broadcast("user_auth","number"!=typeof n?n.id:n)):this.state.authState||(this.state.authState={_:"authStateSignIn"}),e(this.state)}).catch(e).finally(()=>{setInterval(()=>{this.tempId++,this.saveState()},1e4)})})}getState(){return void 0===this.state?this.loadSavedState():Promise.resolve(this.state)}saveState(){if(void 0===this.state||this.savePromise)return;const e=this.tempId;this.savePromise=Promise.all(this.setListenerResult("save",this.state)).then(()=>r.default.set(this.state)).then(()=>{this.savePromise=null,this.tempId!==e&&this.saveState()})}pushToState(e,t){this.state[e]=t}setPeer(e,t){const s=e>0?this.state.users:this.state.chats;s.hasOwnProperty(e)||(s[e]=t)}resetState(){for(let e in this.state)this.state[e]=!1;r.default.set(this.state).then(()=>{location.reload()})}}t.AppStateManager=h;const u=new h;n.MOUNT_CLASS_TO&&(n.MOUNT_CLASS_TO.appStateManager=u),t.default=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=t.safeReplaceArrayInObject=t.safeReplaceObject=t.getObjectKeysAndSort=t.defineNotNumerableProperties=t.deepEqual=t.copy=void 0,t.copy=function e(t){if(null===t||"object"!=typeof t)return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t)){return t.map(t=>e(t))}let s=new t.constructor;for(var i in t)t.hasOwnProperty(i)&&(s[i]=e(t[i]));return s},t.deepEqual=function e(t,s){const i=Object.keys,n=typeof t;return t&&s&&"object"===n&&n===typeof s?i(t).length===i(s).length&&i(t).every(i=>e(t[i],s[i])):t===s},t.defineNotNumerableProperties=function(e,t){const s={writable:!0,configurable:!0},i={};t.forEach(t=>{void 0===e[t]&&(i[t]=s)}),Object.defineProperties(e,i)},t.getObjectKeysAndSort=function(e,t="asc"){if(!e)return[];const s=Object.keys(e).map(e=>+e);return"asc"==t?s.sort((e,t)=>e-t):s.sort((e,t)=>t-e)},t.safeReplaceObject=function(e,t){for(var s in e)t.hasOwnProperty(s)||"$"==s.charAt(0)||delete e[s];for(var s in t)e[s]=t[s]},t.safeReplaceArrayInObject=function(e,t,s){"byteLength"in s[e]&&(s[e]=[...s[e]]),t&&t[e]!=s[e]&&(t[e].length=s[e].length,s[e].forEach((s,i)=>{t[e][i]=s}),s[e]=t[e])},t.isObject=function(e){return"object"==typeof e&&null!==e}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppImManager=t.CHAT_ANIMATION_GROUP=void 0;const d=r(s(22)),l=r(s(27)),c=a(s(29)),f=a(s(9)),h=s(16),u=r(s(5)),p=s(2),g=r(s(1)),m=r(s(35)),b=r(s(8)),v=r(s(140)),y=r(s(19)),M=r(s(21)),_=r(s(95)),w=r(s(7)),S=r(s(10)),I=r(s(20)),L=r(s(39)),E=r(s(51)),C=r(s(86)),T=s(0),P=r(s(101)),k=s(26),x=r(s(161)),A=s(11),D=r(s(58)),X=r(s(63)),F=r(s(162)),O=s(34);l.default;t.CHAT_ANIMATION_GROUP="chat";const R=A.isTouchSupported?"touchstart":"mousemove";class B{constructor(){this.columnEl=document.getElementById("column-center"),this.offline=!1,this.updateStatusInterval=0,this.setPeerPromise=null,this.tabId=-1,this.hideRightSidebar=!1,this.chats=[],this.onDocumentPaste=(e,t)=>{if(this.canDrag()){if(e instanceof DragEvent){const t=e.dataTransfer.types;(t.contains?t.contains("Files"):t.indexOf("Files")>=0)&&T.cancelEvent(e)}T.getFilesFromEvent(e).then(e=>{if(e.length){"media"==t&&e.find(e=>!["image","video"].includes(e.type.split("/")[0]))&&(t="document");const s=this.chat.input;s.willAttachType=t||(0===e[0].type.indexOf("image/")?"media":"document"),new P.default(this.chat,e,s.willAttachType)}})}},m.default.attach(),this.log=h.logger("IM",h.LogLevels.log|h.LogLevels.warn|h.LogLevels.debug|h.LogLevels.error),this.selectTab(0),window.addEventListener("blur",()=>{d.default.checkAnimations(!0),this.offline=g.default.idle.isIDLE=!0,this.updateStatus(),clearInterval(this.updateStatusInterval),window.addEventListener("focus",()=>{this.offline=g.default.idle.isIDLE=!1,this.updateStatus(),this.updateStatusInterval=window.setInterval(()=>this.updateStatus(),5e4),d.default.checkAnimations(!1)},{once:!0})}),window.addEventListener(R,()=>{this.updateStatusInterval=window.setInterval(()=>this.updateStatus(),5e4),this.updateStatus()},{once:!0,passive:!0}),this.chatsContainer=document.createElement("div"),this.chatsContainer.classList.add("chats-container","tabs-container"),this.columnEl.append(this.chatsContainer),this.chatsSelectTabDebounced=O.debounce(()=>{const e=this.chat.topbar;e.pinnedMessage&&e.pinnedMessage.setCorrectIndex(0),u.default.setQueueId(this.chat.bubbles.lazyLoadQueue.queueId)},250,!1,!0),this.createNewChat(),this.chatsSelectTab(this.chat.container),window.addEventListener("hashchange",e=>{const t=location.hash.split("?");if(!t[1])return;const s={};switch(t[1].split("&").forEach(e=>{s[e.split("=")[0]]=decodeURIComponent(e.split("=")[1])}),this.log("hashchange",t[0],s),t[0]){case"#/im":{const e=s.p;if("@"===e[0]){let t=void 0!==s.post?w.default.generateMessageId(+s.post):void 0;b.default.resolveUsername(e).then(e=>{const s="user"==e._?e.id:-e.id;this.setInnerPeer(s,t)})}}}location.hash=""})}get myId(){return g.default.myId}get chat(){return this.chats[this.chats.length-1]}chatsSelectTab(e){this.prevTab!==e&&(this.prevTab&&(this.prevTab.classList.remove("active"),this.chatsSelectTabDebounced()),e.classList.add("active"),this.prevTab=e)}init(){document.addEventListener("paste",this.onDocumentPaste,!0);document.body.addEventListener("keydown",e=>{var t,s;if(g.default.overlayIsActive)return;const i=e.target,n=this.chat;if("Escape"===e.key){let i=!0;(null===(s=null===(t=this.markupTooltip)||void 0===t?void 0:t.container)||void 0===s?void 0:s.classList.contains("is-visible"))?this.markupTooltip.hide():n.selection.isSelecting?n.selection.cancelSelection():n.container.classList.contains("is-helper-active")?n.input.replyElements.cancelBtn.click():0!==n.peerId?this.setPeer(0):i=!1,i&&T.cancelEvent(e)}else{if("Meta"===e.key||"Control"===e.key)return;if("KeyC"===e.code&&(e.ctrlKey||e.metaKey)&&"INPUT"!==i.tagName)return;if("ArrowUp"===e.code&&!n.input.editMsgId){const t=w.default.getHistoryStorage(n.peerId);if(t.history.length){let s;for(const e of t.history){const t=w.default.getMessageByPeer(n.peerId,e);if((this.myId===n.peerId?t.fromId===this.myId:t.pFlags.out)&&w.default.canEditMessage(n.getMessage(e),"text")){s=e;break}}s&&(n.input.initMessageEditing(s),T.cancelEvent(e))}}}n.input.messageInput&&e.target!==n.input.messageInput&&"INPUT"!==i.tagName&&!i.hasAttribute("contenteditable")&&(n.input.messageInput.focus(),T.placeCaretAtEnd(n.input.messageInput))}),g.default.addEventListener("history_multiappend",e=>{const t=e.detail;for(const e in t)c.default.sharedMediaTab.renderNewMessages(+e,t[e])}),g.default.addEventListener("history_delete",e=>{const{peerId:t,msgs:s}=e.detail,i=Object.keys(s).map(e=>+e);c.default.sharedMediaTab.deleteDeletedMessages(t,i)}),g.default.addEventListener("message_sent",e=>{const{storage:t,tempId:s,mid:i}=e.detail,n=w.default.getMessageFromStorage(t,i);c.default.sharedMediaTab.renderNewMessages(n.peerId,[i])}),A.isTouchSupported||this.attachDragAndDropListeners(),this.markupTooltip=new x.default(this),this.markupTooltip.handleSelection()}attachDragAndDropListeners(){const e=[];let t=!1;const s=(a,r)=>o(this,void 0,void 0,(function*(){if(r==t)return;const o=a.dataTransfer.types,d=o.contains?o.contains("Files"):o.indexOf("Files")>=0;if(d&&this.canDrag()){if(r&&!e.length){const t=yield T.getFilesFromEvent(a,!0),i=d&&!t.length,o=t.filter(e=>["image","video"].includes(e.split("/")[0])).length,r=t.length-o;this.log("drag files",t),(t.length||i)&&e.push(new F.default(n,{icon:"dragfiles",header:"Drop files here to send them",subtitle:"without compression",onDrop:e=>{s(e,!1),j.log("drop",e),j.onDocumentPaste(e,"document")}})),(o&&!r||i)&&e.push(new F.default(n,{icon:"dragmedia",header:"Drop files here to send them",subtitle:"in a quick way",onDrop:e=>{s(e,!1),j.log("drop",e),j.onDocumentPaste(e,"media")}})),this.chat.container.append(n)}X.default(n,"is-visible",r,200,()=>{r||(e.forEach(e=>{e.destroy()}),e.length=0)}),r?e.forEach(e=>{e.setPath()}):i=0,document.body.classList.toggle("is-dragging",r),t=r}else i=0}));let i=0;document.body.addEventListener("dragenter",e=>{i++}),document.body.addEventListener("dragover",e=>{s(e,!0),T.cancelEvent(e)}),document.body.addEventListener("dragleave",e=>{i--,0===i&&s(e,!1)});const n=document.createElement("div");n.classList.add("drops-container")}canDrag(){var e;const t=null===(e=this.chat)||void 0===e?void 0:e.peerId;return!(!t||g.default.overlayIsActive||t<0&&!y.default.hasRights(t,"send","send_media"))}selectTab(e){document.body.classList.toggle("is-left-column-shown",0===e);const t=this.tabId;this.tabId=e,f.default.isMobile&&2===t&&1===e&&document.body.classList.remove(c.RIGHT_COLUMN_ACTIVE_CLASSNAME)}updateStatus(){return this.myId?(b.default.setUserStatus(this.myId,this.offline),u.default.invokeApi("account.updateStatus",{offline:this.offline})):Promise.resolve()}createNewChat(){const e=new v.default(this,y.default,M.default,_.default,w.default,S.default,I.default,L.default,E.default,b.default,C.default,D.default,u.default);this.chats.push(e)}spliceChats(e,t=!0){if(e>=this.chats.length)return;const s=this.chats.splice(e,this.chats.length-e);s.length>1&&s.slice(0,-1).forEach(e=>{e.container.remove()}),this.chatsSelectTab(this.chat.container),t&&(g.default.broadcast("peer_changed",this.chat.peerId),c.default.historyTabIds[c.default.historyTabIds.length-1]===c.AppSidebarRight.SLIDERITEMSIDS.search&&c.default.closeTab(c.AppSidebarRight.SLIDERITEMSIDS.search),c.default.sharedMediaTab.setPeer(this.chat.peerId,this.chat.threadId),c.default.sharedMediaTab.loadSidebarMedia(!0),c.default.sharedMediaTab.fillProfileElements()),setTimeout(()=>{s.forEach(e=>{e.destroy()})},250)}setPeer(e,t){this.init&&(this.init(),this.init=null);const s=this.chat,i=this.chats.indexOf(s);if(e){if(i>0&&s.peerId&&s.peerId!==e)return this.spliceChats(1,!1),this.setPeer(e,t)}else{if(i>0)return void this.spliceChats(i);if(f.default.activeScreen===f.ScreenSize.medium){const e=document.body.classList.toggle("is-left-column-shown");return void(e&&document.body.classList.contains(c.RIGHT_COLUMN_ACTIVE_CLASSNAME)?(c.default.toggleSidebar(!1,!1),this.selectTab(0),this.hideRightSidebar=e):this.hideRightSidebar&&c.default.toggleSidebar(!0))}}if(e===s.peerId&&f.default.activeScreen===f.ScreenSize.mobile&&document.body.classList.contains("is-left-column-shown"))return this.selectTab(1),!1;if(e||f.default.activeScreen!==f.ScreenSize.mobile){const i=s.setPeer(e,t),n=(null==i?void 0:i.cached)?i.promise:Promise.resolve();e&&n.then(()=>{setTimeout(()=>{this.hideRightSidebar&&(c.default.toggleSidebar(!0),this.hideRightSidebar=!1),setTimeout(()=>{this.chatsSelectTab(this.chat.container)},0),this.selectTab(1)},0)})}return e?void 0:(this.selectTab(0),!1)}setInnerPeer(e,t,s="chat",i){const n=this.chats.findIndex(t=>t.peerId==e&&t.type==s);if(-1!==n)return this.spliceChats(n+1),this.setPeer(e,t);return this.chat.init||this.createNewChat(),s&&(this.chat.setType(s),i&&(this.chat.threadId=i)),this.setPeer(e,t)}openScheduled(e){this.setInnerPeer(e,void 0,"scheduled")}getPeerStatus(e){return o(this,void 0,void 0,(function*(){let t="";if(!e)return t;if(e<0){const s=S.default.getPeer(e),i=yield L.default.getChatFull(s.id);this.chat.log("chatInfo res:",i);const n=i.participants_count||i.participants&&i.participants.participants&&i.participants.participants.length||1;if(t=y.default.getChatMembersString(-e),n<2)return t;const a=yield y.default.getOnlines(s.id);return a>1&&(t+=", "+k.numberWithCommas(a)+" online"),t}{const s=b.default.getUser(e);if(g.default.myId==e)return"";if(s){if(t=b.default.getUserStatusString(s.id),b.default.isBot(e))return t;{const s=y.default.typingsInPeer[e];return s&&s.length?'<span class="online">typing...</span>':"online"==t?`<span class="online">${t}</span>`:t}}}}))}}t.AppImManager=B;const j=new B;p.MOUNT_CLASS_TO&&(p.MOUNT_CLASS_TO.appImManager=j),t.default=j},function(e,t,s){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.LogLevels=void 0,function(e){e[e.log=1]="log",e[e.warn=2]="warn",e[e.error=4]="error",e[e.debug=8]="debug"}(i=t.LogLevels||(t.LogLevels={}));const n=Date.now();function a(){return"["+((Date.now()-n)/1e3).toFixed(3)+"]"}t.logger=function(e,t=i.log|i.warn|i.error){function s(...s){return t&i.log&&console.log(a(),e,...s)}return t=i.error,s.warn=function(...s){return t&i.warn&&console.warn(a(),e,...s)},s.info=function(...s){return t&i.log&&console.info(a(),e,...s)},s.error=function(...s){return t&i.error&&console.error(a(),e,...s)},s.trace=function(...s){return t&i.log&&console.trace(a(),e,...s)},s.debug=function(...s){return t&i.debug&&console.debug(a(),e,...s)},s.setPrefix=function(t){e="["+t+"]:"},s.setPrefix(e),s}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ripple=void 0;const i=s(11),n=s(0);let a=0;t.ripple=function(e,t=(()=>Promise.resolve()),s=null){if(e.querySelector(".c-ripple"))return;e.classList.add("rp");let o,r=document.createElement("div");r.classList.add("c-ripple"),e.classList.contains("rp-square")&&r.classList.add("is-square"),e.append(r);const d=(e,n)=>{const d=Date.now(),c=document.createElement("span"),f=a++,h=1e3*+window.getComputedStyle(r).getPropertyValue("--ripple-duration").replace("s","");o=()=>{let e=Date.now()-d;if(e<h){let t=Math.max(h-e,h/2);setTimeout(()=>c.classList.add("hiding"),Math.max(t-h/2,0)),setTimeout(()=>{c.remove(),s&&s(f)},t)}else c.classList.add("hiding"),setTimeout(()=>{c.remove(),s&&s(f)},h/2);i.isTouchSupported||window.removeEventListener("contextmenu",o),o=null,l=!1},t&&t(f),window.requestAnimationFrame(()=>{let t=r.getBoundingClientRect();c.classList.add("c-ripple__circle");let s,i,a=e-t.left,o=n-t.top;t.width>t.height?(s=t.width,i=a):(s=t.height,i=o),s-=i>s/2?s-i:i,s*=1.1;let d=a-s/2,l=o-s/2;c.style.width=c.style.height=s+"px",c.style.left=d+"px",c.style.top=l+"px",r.append(c)})};let l=!1;if(i.isTouchSupported){let t=()=>{o&&o()};e.addEventListener("touchstart",s=>{if(s.touches.length>1||l||"BUTTON"==s.target.tagName&&s.target!=e||n.findUpClassName(s.target,"c-ripple")!=r)return;l=!0;let{clientX:i,clientY:a}=s.touches[0];d(i,a),e.addEventListener("touchend",t,{once:!0}),window.addEventListener("touchmove",s=>{s.cancelBubble=!0,s.stopPropagation(),t(),e.removeEventListener("touchend",t)},{once:!0})},{passive:!0})}else e.addEventListener("mousedown",t=>{if("0"==e.dataset.ripple||n.findUpClassName(t.target,"c-ripple")!=r)return!1;if(l)return l=!1,!1;let{clientX:s,clientY:i}=t;d(s,i),window.addEventListener("mouseup",o,{once:!0}),window.addEventListener("contextmenu",o,{once:!0})})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillTipDates=t.tsNow=t.getFullDate=t.formatDateAccordingToToday=t.getWeekNumber=t.ONE_DAY=t.days=t.months=void 0;const i=s(2);t.months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.ONE_DAY=86400,t.getWeekNumber=e=>{const s=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-i);const n=new Date(Date.UTC(s.getUTCFullYear(),0,1));return Math.ceil(((s.getTime()-n.getTime())/t.ONE_DAY+1)/7)},t.formatDateAccordingToToday=e=>{const s=new Date,i=s.getTime()/1e3|0,n=e.getTime()/1e3|0;let a;return a=i-n<t.ONE_DAY&&s.getDate()==e.getDate()?("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2):s.getFullYear()!=e.getFullYear()?e.getDate()+"."+("0"+(e.getMonth()+1)).slice(-2)+"."+(""+e.getFullYear()).slice(-2):i-n<7*t.ONE_DAY&&t.getWeekNumber(s)==t.getWeekNumber(e)?t.days[e.getDay()].slice(0,3):t.months[e.getMonth()].slice(0,3)+" "+("0"+e.getDate()).slice(-2),a},t.getFullDate=(e,s={})=>{const i=s.monthAsNumber?".":" ",n=("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)+(s.noSeconds?"":":"+("0"+e.getSeconds()).slice(-2));return(s.leadingZero?("0"+e.getDate()).slice(-2):e.getDate())+i+(s.monthAsNumber?("0"+(e.getMonth()+1)).slice(-2):t.months[e.getMonth()])+i+e.getFullYear()+(s.noTime?"":", "+n)},t.tsNow=function(e){const t=Date.now();return e?Math.floor(t/1e3):t};const n=new RegExp("20[0-9]{1,2}"),a=new RegExp("(\\w{3,}) ([0-9]{0,4})","i"),o=new RegExp("([0-9]{0,4}) (\\w{2,})","i"),r=new RegExp("^([0-9]{1,4})(\\.| |/|\\-)([0-9]{1,4})$","i"),d=new RegExp("^([0-9]{1,2})(\\.| |/|\\-)([0-9]{1,2})(\\.| |/|\\-)([0-9]{1,4})$","i"),l=[31,29,31,30,31,30,31,31,30,31,30,31];function c(e,t){const s=e.trim().toLowerCase();if(s.length<3)return;if(0==="today".indexOf(s)){const e=new Date,s=e.getFullYear(),i=e.getMonth(),n=e.getDate();e.setFullYear(s,i,n),e.setHours(0,0,0);const a=e.getTime();e.setFullYear(s,i,n+1),e.setHours(0,0,0);const o=e.getTime()-1;return void t.push({title:"Today",minDate:a,maxDate:o})}if(0==="yesterday".indexOf(s)){const e=new Date,s=e.getFullYear(),i=e.getMonth(),n=e.getDate();e.setFullYear(s,i,n),e.setHours(0,0,0);const a=e.getTime()-864e5;e.setFullYear(s,i,n+1),e.setHours(0,0,0);const o=e.getTime()-86400001;return void t.push({title:"Yesterday",minDate:a,maxDate:o})}const i=function(e){const t=new Date;if(e.length<=3)return-1;for(let s=0;s<7;s++)if(t.setDate(t.getDate()+1),0===m(t.getTime()).toLowerCase().indexOf(e))return t.getDay();return-1}(s);if(i>=0){const e=new Date,s=e.getTime(),n=i-e.getDay();e.setDate(e.getDate()+n),e.getTime()>s&&e.setTime(e.getTime()-6048e5);const a=e.getFullYear(),o=e.getMonth(),r=e.getDate();e.setFullYear(a,o,r),e.setHours(0,0,0);const d=e.getTime();e.setFullYear(a,o,r+1),e.setHours(0,0,0);const l=e.getTime()-1;return void t.push({title:m(d),minDate:d,maxDate:l})}let l;if(null===(l=r.exec(s)))if(null===(l=d.exec(s)))if(null===(l=n.exec(s))){if(null!==(l=a.exec(s))){const e=l[1],s=l[2],i=v(e);if(i>=0){const e=+s;if(e>0&&e<=31){return void h(t,e-1,i)}if(e>=2013){return void f(t,i,e)}}}if(null!==(l=o.exec(s))){const e=l[1],s=v(l[2]);if(s>=0){const i=+e;if(i>0&&i<=31){return void h(t,i-1,s)}if(i>=2013){f(t,s,i)}}}}else{let e=+s;const i=(new Date).getFullYear();if(e<2013){e=2013;for(let s=i;s>=e;s--){const e=new Date;e.setFullYear(s,0,1),e.setHours(0,0,0);const i=e.getTime();e.setFullYear(s+1,0,1),e.setHours(0,0,0);const n=e.getTime()-1;t.push({title:""+s,minDate:i,maxDate:n})}}else if(e<=i){const s=new Date;s.setFullYear(e,0,1),s.setHours(0,0,0);const i=s.getTime();s.setFullYear(e+1,0,1),s.setHours(0,0,0);const n=s.getTime()-1;t.push({title:""+e,minDate:i,maxDate:n})}}else{const e=l[1],s=l[3],i=l[5];if(!l[2]==l[4])return;const n=parseInt(e),a=parseInt(s)-1;let o=parseInt(i);o>=10&&o<=99&&(o+=2e3);const r=(new Date).getFullYear();if(b(n-1,a)&&o>=2013&&o<=r){const e=new Date;e.setFullYear(o,a,n),e.setHours(0,0,0);const s=e.getTime();e.setFullYear(o,a,n+1),e.setHours(0,0,0);const i=e.getTime()-1;return void t.push({title:g(s),minDate:s,maxDate:i})}}else{const e=l[1],s=l[3],i=parseInt(e),n=parseInt(s);if(i>0&&i<=31){if(n>=2013&&i<=12){return void f(t,i-1,n)}if(n<=12){h(t,i-1,n-1)}}else if(i>=2013&&n<=12){f(t,n-1,i)}}}function f(e,t,s){const i=(new Date).getFullYear(),n=Date.now();if(s>=2013&&s<=i){const i=new Date;i.setFullYear(s,t,1),i.setHours(0,0,0);const a=i.getTime();if(a>n)return;i.setMonth(i.getMonth()+1);const o=i.getTime()-1;e.push({title:u(a),minDate:a,maxDate:o})}}function h(e,t,s){if(b(t,s)){const n=(new Date).getFullYear(),a=Date.now();for(let o=n;o>=2013;o--){if(1==s&&28==t&&(((i=o)%4!=0||i%100==0)&&i%400!=0))continue;const r=new Date;r.setFullYear(o,s,t+1),r.setHours(0,0,0);const d=r.getTime();if(d>a)continue;r.setFullYear(o,s,t+2),r.setHours(0,0,0);const l=r.getTime()-1;o==n?e.push({title:p(d),minDate:d,maxDate:l}):e.push({title:g(d),minDate:d,maxDate:l})}}var i}function u(e){const s=new Date(e);return t.months[s.getMonth()].slice(0,3)+" "+s.getFullYear()}function p(e){const s=new Date(e);return t.months[s.getMonth()].slice(0,3)+" "+s.getDate()}function g(e){const t=new Date(e);return("0"+t.getDate()).slice(-2)+"."+("0"+(t.getMonth()+1)).slice(-2)+"."+t.getFullYear()}function m(e){const s=new Date(e);return t.days[s.getDay()]}function b(e,t){return t>=0&&t<12&&e>=0&&e<l[t]}function v(e){e=e.toLowerCase();for(let s=0;s<12;s++){if(0===t.months[s].toLowerCase().indexOf(e))return s}return-1}t.fillTipDates=c,i.MOUNT_CLASS_TO&&(i.MOUNT_CLASS_TO.fillTipDates=c)},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppChatsManager=void 0;const a=s(26),o=s(14),r=n(s(5)),d=s(2),l=s(3),c=n(s(1)),f=n(s(35)),h=n(s(7)),u=n(s(39)),p=n(s(13)),g=n(s(8));class m{constructor(){this.chats={},this.cachedPhotoLocations={},this.megagroupOnlines={},this.typingsInPeer={},this.onChatUpdated=(e,t)=>{f.default.processUpdateMessage(t),t&&this.isChannel(e)&&u.default.invalidateChannelParticipants(e)},c.default.on("apiUpdate",e=>{var t;const s=e.detail;switch(s._){case"updateChannel":const e=s.channel_id;c.default.broadcast("channel_settings",{channelId:e});break;case"updateUserTyping":case"updateChatUserTyping":{if(c.default.myId==s.user_id)return;const e="updateUserTyping"==s._?s.user_id:-s.chat_id,i=null!==(t=this.typingsInPeer[e])&&void 0!==t?t:this.typingsInPeer[e]=[];let n=i.find(e=>e.userId==s.user_id);n||(n={userId:s.user_id},i.push(n)),n.action=s.action,g.default.hasUser(s.user_id)||"updateChatUserTyping"==s._&&s.chat_id&&b.hasChat(s.chat_id)&&!b.isChannel(s.chat_id)&&u.default.getChatFull(s.chat_id),g.default.forceUserOnline(s.user_id),void 0!==n.timeout&&clearTimeout(n.timeout),n.timeout=window.setTimeout(()=>{delete n.timeout,i.findAndSplice(e=>e.userId==s.user_id),c.default.broadcast("peer_typings",{peerId:e,typings:i}),i.length||delete this.typingsInPeer[e]},6e3),c.default.broadcast("peer_typings",{peerId:e,typings:i});break}}}),p.default.getState().then(e=>{this.chats=e.chats})}saveApiChats(e){e.forEach(e=>this.saveApiChat(e))}saveApiChat(e){if(!o.isObject(e))return;e.rTitle=l.RichTextProcessor.wrapRichText(e.title,{noLinks:!0,noLinebreaks:!0})||"chat_title_deleted";const t=this.chats[e.id];if(e.initials=l.RichTextProcessor.getAbbreviation(e.title),void 0===e.pFlags&&(e.pFlags={}),e.pFlags.min&&void 0!==t)return;"channel"==e._&&void 0===e.participants_count&&void 0!==t&&t.participants_count&&(e.participants_count=t.participants_count);let s=!1;if(void 0===t)this.chats[e.id]=e;else{let i=t.photo&&t.photo.photo_small,n=e.photo&&e.photo.photo_small;JSON.stringify(i)!==JSON.stringify(n)&&(s=!0),o.safeReplaceObject(t,e),c.default.broadcast("chat_update",e.id)}void 0!==this.cachedPhotoLocations[e.id]&&o.safeReplaceObject(this.cachedPhotoLocations[e.id],e&&e.photo?e.photo:{empty:!0}),s&&c.default.broadcast("avatar_update",-e.id)}getChat(e){return e<0&&(e=-e),this.chats[e]||{_:"chatEmpty",id:e,deleted:!0,access_hash:"",pFlags:{}}}hasRights(e,t,s){const i=this.getChat(e);if("chatEmpty"==i._)return!1;if("chatForbidden"==i._||"channelForbidden"==i._||i.pFlags.kicked||i.pFlags.left&&!i.pFlags.megagroup)return!1;if(i.pFlags.creator)return!0;const n=i.admin_rights||i.banned_rights||i.default_banned_rights;let a;switch(n&&(a=n.pFlags),t){case"send":if(s&&a&&a[s])return!1;if("channel"==i._&&!i.pFlags.megagroup&&!(null==a?void 0:a.post_messages))return!1;break;case"deleteRevoke":if("channel"==i._)return!!(null==a?void 0:a.delete_messages);if(!i.pFlags.admin)return!1;break;case"pin":if("channel"==i._)return i.admin_rights?!!a.pin_messages||!!a.post_messages:a&&!a.pin_messages;if((null==a?void 0:a.pin_messages)&&!i.pFlags.admin)return!1;break;case"edit_title":case"edit_photo":case"invite":if("channel"==i._){if(!i.pFlags.megagroup)return!1;if("invite"!=t||!i.pFlags.democracy)return!1}else if(i.pFlags.admins_enabled&&!i.pFlags.admin)return!1}return!0}isChannel(e){e<0&&(e=-e);const t=this.chats[e];return!(!t||"channel"!=t._&&"channelForbidden"!=t._)}isMegagroup(e){const t=this.chats[e];return!(!t||"channel"!=t._||!t.pFlags.megagroup)}isBroadcast(e){return this.isChannel(e)&&!this.isMegagroup(e)}getChannelInput(e){return e<0&&(e=-e),{_:"inputChannel",channel_id:e,access_hash:this.getChat(e).access_hash||0}}getChatInputPeer(e){return{_:"inputPeerChat",chat_id:e}}getChannelInputPeer(e){return{_:"inputPeerChannel",channel_id:e,access_hash:this.getChat(e).access_hash||0}}hasChat(e,t){const s=this.chats[e];return o.isObject(s)&&(t||!s.pFlags.min)}getChatPhoto(e){const t=this.getChat(e);return void 0===this.cachedPhotoLocations[e]&&(this.cachedPhotoLocations[e]=t&&t.photo?t.photo:{empty:!0}),this.cachedPhotoLocations[e]}getChatMembersString(e){var t,s;const i=this.getChat(e),n=u.default.chatsFull[e];let o;o=n?"channelFull"===n._?n.participants_count:null===(t=n.participants.participants)||void 0===t?void 0:t.length:i.participants_count||(null===(s=i.participants)||void 0===s?void 0:s.participants.length);const r=this.isBroadcast(e);return a.numberWithCommas(o||1)+" "+(r?"followers":"members")}wrapForFull(e,t){const s=o.copy(t),i=this.getChat(e);return s.participants_count||(s.participants_count=i.participants_count),s.participants&&"chatParticipants"==s.participants._&&(s.participants.participants=this.wrapParticipants(e,s.participants.participants)),s.about&&(s.rAbout=l.RichTextProcessor.wrapRichText(s.about,{noLinebreaks:!0})),s.chat=i,s}wrapParticipants(e,t){const s=this.getChat(e),i=g.default.getSelf().id;if(this.isChannel(e)){const e=s.pFlags.creator;t.forEach(t=>{t.canLeave=i==t.user_id,t.canKick=e&&"channelParticipant"==t._,t.user=g.default.getUser(t.user_id)})}else{const e=s.pFlags.creator||s.pFlags.admins_enabled&&s.pFlags.admin;t.forEach(t=>{t.canLeave=i==t.user_id,t.canKick=!t.canLeave&&(s.pFlags.creator||"chatParticipant"==t._&&(e||i==t.inviter_id)),t.user=g.default.getUser(t.user_id)})}return t}createChannel(e,t){return r.default.invokeApi("channels.createChannel",{broadcast:!0,title:e,about:t}).then(e=>(f.default.processUpdateMessage(e),e.chats[0].id))}inviteToChannel(e,t){const s=this.getChannelInput(e),i=t.map(e=>g.default.getUserInput(e));return r.default.invokeApi("channels.inviteToChannel",{channel:s,users:i}).then(e=>{f.default.processUpdateMessage(e)})}createChat(e,t){return r.default.invokeApi("messages.createChat",{users:t.map(e=>g.default.getUserInput(e)),title:e}).then(e=>(f.default.processUpdateMessage(e),e.chats[0].id))}editPhoto(e,t){const s={_:"inputChatUploadedPhoto",file:t};return this.isChannel(e)?r.default.invokeApi("channels.editPhoto",{channel:this.getChannelInput(e),photo:s}).then(e=>{f.default.processUpdateMessage(e)}):r.default.invokeApi("messages.editChatPhoto",{chat_id:e,photo:s}).then(e=>{f.default.processUpdateMessage(e)})}getOnlines(e){var t,s;return i(this,void 0,void 0,(function*(){if(this.isMegagroup(e)){const i=Date.now()/1e3|0,n=null!==(t=this.megagroupOnlines[e])&&void 0!==t?t:this.megagroupOnlines[e]={timestamp:0,onlines:1};if(i-n.timestamp<60)return n.onlines;const a=yield r.default.invokeApi("messages.getOnlines",{peer:this.getChannelInputPeer(e)}),o=null!==(s=a.onlines)&&void 0!==s?s:1;return n.timestamp=i,n.onlines=o,o}if(this.isBroadcast(e))return 1;const i=(yield u.default.getChatFull(e)).participants;if(i&&i.participants){return i.participants.reduce((e,t)=>{const s=g.default.getUser(t.user_id);return s&&s.status&&"userStatusOnline"==s.status._?e+1:e},0)}return 1}))}leaveChannel(e){return r.default.invokeApi("channels.leaveChannel",{channel:this.getChannelInput(e)}).then(this.onChatUpdated.bind(this,e))}joinChannel(e){return r.default.invokeApi("channels.joinChannel",{channel:this.getChannelInput(e)}).then(this.onChatUpdated.bind(this,e))}deleteChatUser(e,t){return r.default.invokeApi("messages.deleteChatUser",{chat_id:e,user_id:g.default.getUserInput(t)}).then(this.onChatUpdated.bind(this,e))}leaveChat(e){return this.deleteChatUser(e,g.default.getSelf().id).then(()=>h.default.flushHistory(-e))}leave(e){return this.isChannel(e)?this.leaveChannel(e):this.leaveChat(e)}}t.AppChatsManager=m;const b=new m;d.MOUNT_CLASS_TO&&(d.MOUNT_CLASS_TO.appChatsManager=b),t.default=b},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppPhotosManager=void 0;const n=s(44),a=s(70),o=s(14),r=s(12),d=i(s(5)),l=i(s(45)),c=s(0),f=i(s(40)),h=i(s(8)),u=s(2);class p{constructor(){this.photos={},this.documentThumbsCache={},this.windowW=0,this.windowH=0,window.addEventListener("resize",e=>{this.windowW=document.body.scrollWidth,this.windowH=document.body.scrollHeight}),this.windowW=document.body.scrollWidth,this.windowH=document.body.scrollHeight}savePhoto(e,t){var s;if("photoEmpty"==e._)return;const i=this.photos[e.id];if(e.file_reference&&(o.safeReplaceArrayInObject("file_reference",i,e),l.default.saveContext(e.file_reference,t)),null===(s=e.sizes)||void 0===s?void 0:s.length){const t=e.sizes[e.sizes.length-1];"photoSizeProgressive"==t._&&(t.size=t.sizes[t.sizes.length-1])}return i?Object.assign(i,e):this.photos[e.id]=e}choosePhotoSize(e,t=0,s=0){window.devicePixelRatio>1&&(t*=2,s*=2);let i={_:"photoSizeEmpty",type:""};const n=e.sizes||e.thumbs;if(n)for(const e of n){if(!("w"in e)&&!("h"in e))continue;i=e;const{w:n,h:a}=c.calcImageInBox(e.w,e.h,t,s);if(n==t||a==s)break}return i}getUserPhotos(e,t="0",s=20){const i=h.default.getUserInput(e);return d.default.invokeApi("photos.getUserPhotos",{user_id:i,offset:0,limit:s,max_id:t}).then(t=>{h.default.saveApiUsers(t.users);const s=[];return t.photos.forEach((i,n)=>{t.photos[n]=this.savePhoto(i,{type:"profilePhoto",peerId:e}),s.push(i.id)}),{count:t.count||t.photos.length,photos:s}})}getPreviewURLFromBytes(e,t=!1){let s,i;t?s=e instanceof Uint8Array?e:new Uint8Array(e):(s=p.jf.concat(e.slice(3),p.Df),s[164]=e[1],s[166]=e[2]),i=t?r.isSafari?"image/png":"image/webp":"image/jpeg";const n=new Blob([s],{type:i});return URL.createObjectURL(n)}getPathFromPhotoPathSize(e){const t=e.bytes;let s="M";for(let e=0,i=t.length;e<i;++e){const i=t[e];i>=192?s+="AACAAAAHAAALMAAAQASTAVAAAZaacaaaahaaalmaaaqastava.az0123456789-,"[i-128-64]:(i>=128?s+=",":i>=64&&(s+="-"),s+=""+(63&i))}return s+="z",s}getPreviewURLFromThumb(e,t=!1){var s;return null!==(s=e.url)&&void 0!==s?s:(o.defineNotNumerableProperties(e,["url"]),e.url=this.getPreviewURLFromBytes(e.bytes,t))}setAttachmentPreview(e,t,s=!1,i=!1){let n=this.getPreviewURLFromBytes(e,s);if(i){let e=new Image;return e.src=n,e.addEventListener("load",()=>{t.style.backgroundImage="url("+n+")"}),t}if(t instanceof HTMLImageElement)return t.src=n,t;{let e=new Image;return e.src=n,t.append(e),e}}setAttachmentSize(e,t,s,i,n=!1,a=!1){const o=this.choosePhotoSize(e,s,i),r=e.sizes||e.thumbs,d=(null==r?void 0:r.length)?r[0]:null;let l,f;d&&"bytes"in d&&(e.downloaded&&"video"!=e.type&&"gif"!=e.type||n||a||this.setAttachmentPreview(d.bytes,t,n)),"document"==e._?(l=e.w||512,f=e.h||512):(l="w"in o?o.w:100,f="h"in o?o.h:100);const{w:h,h:u}=c.calcImageInBox(l,f,s,i);return t instanceof SVGForeignObjectElement?(t.setAttributeNS(null,"width",""+h),t.setAttributeNS(null,"height",""+u)):(t.style.width=h+"px",t.style.height=u+"px"),o}getPhotoDownloadOptions(e,t,s){const i="document"==e._;if(!t||"photoSizeEmpty"==t._)throw new Error("photoSizeEmpty!");const n=("photoSize"==t._||"photoSizeProgressive"==t._)&&e.access_hash&&e.file_reference,a=n?{_:i?"inputDocumentFileLocation":"inputPhotoFileLocation",id:e.id,access_hash:e.access_hash,file_reference:e.file_reference,thumb_size:t.type}:t.location;return{dcId:e.dc_id,location:a,size:n?t.size:void 0,queueId:s}}preloadPhoto(e,t,s){const i=this.getPhoto(e);if(!i||"photoEmpty"==i._)throw new Error("preloadPhoto photoEmpty!");if(!t){const e=this.windowW,s=this.windowH;t=this.choosePhotoSize(i,e,s)}const n=this.getCacheContext(i);if(n.downloaded>=("size"in t?t.size:0)&&n.url)return Promise.resolve();const r=this.getPhotoDownloadOptions(i,t,s),d=a.getFileNameByLocation(r.location);let l=f.default.getDownload(d);return l||(l=f.default.download(r),l.then(e=>((!n.downloaded||n.downloaded<e.size)&&(o.defineNotNumerableProperties(n,["downloaded","url"]),n.downloaded=e.size,n.url=URL.createObjectURL(e)),e)),l)}getCacheContext(e){return"document"==e._?this.getDocumentCachedThumb(e.id):e}getDocumentCachedThumb(e){var t;return null!==(t=this.documentThumbsCache[e])&&void 0!==t?t:this.documentThumbsCache[e]={downloaded:0,url:""}}getPhoto(e){return o.isObject(e)?e:this.photos[e]}getInput(e){return{_:"inputMediaPhoto",id:{_:"inputPhoto",id:e.id,access_hash:e.access_hash,file_reference:e.file_reference},ttl_seconds:0}}savePhotoFile(e,t){const s=this.choosePhotoSize(e,65535,65535);if("photoSize"!=s._&&"photoSizeProgressive"!=s._)return;const i={_:"document"==e._?"inputDocumentFileLocation":"inputPhotoFileLocation",id:e.id,access_hash:e.access_hash,file_reference:e.file_reference,thumb_size:s.type};f.default.downloadToDisc({dcId:e.dc_id,location:i,size:s.size,fileName:"photo"+e.id+".jpg",queueId:t},"photo"+e.id+".jpg")}}t.AppPhotosManager=p,p.jf=new Uint8Array(n.bytesFromHex("ffd8ffe000104a46494600010100000100010000ffdb004300281c1e231e19282321232d2b28303c64413c37373c7b585d4964918099968f808c8aa0b4e6c3a0aadaad8a8cc8ffcbdaeef5ffffff9bc1fffffffaffe6fdfff8ffdb0043012b2d2d3c353c76414176f8a58ca5f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8ffc00011080000000003012200021101031101ffc4001f0000010501010101010100000000000000000102030405060708090a0bffc400b5100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9faffc4001f0100030101010101010101010000000000000102030405060708090a0bffc400b51100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00")),p.Df=n.bytesFromHex("ffd9");const g=new p;u.MOUNT_CLASS_TO&&(u.MOUNT_CLASS_TO.appPhotosManager=g),t.default=g},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppDocsManager=void 0;const a=s(70),o=s(14),r=s(2),d=n(s(45)),l=n(s(85)),c=s(3),f=n(s(68)),h=n(s(40)),u=n(s(20));class p{constructor(){this.docs={},this.savingLottiePreview={}}saveDoc(e,t){if("documentEmpty"==e._)return;const s=this.docs[e.id];if(e.file_reference&&(o.safeReplaceArrayInObject("file_reference",s,e),d.default.saveContext(e.file_reference,t)),s)return e.thumbs&&(s.thumbs||(s.thumbs=e.thumbs)),s;if(this.docs[e.id]=e,o.defineNotNumerableProperties(e,["downloaded","url"]),e.attributes.forEach(t=>{switch(t._){case"documentAttributeFilename":e.file_name=c.RichTextProcessor.wrapPlainText(t.file_name);break;case"documentAttributeAudio":e.duration=t.duration,e.audioTitle=t.title,e.audioPerformer=t.performer,e.type=t.pFlags.voice&&"audio/ogg"==e.mime_type?"voice":"audio";break;case"documentAttributeVideo":e.duration=t.duration,e.w=t.w,e.h=t.h,t.pFlags.round_message?e.type="round":e.type="video";break;case"documentAttributeSticker":void 0!==t.alt&&(e.stickerEmojiRaw=t.alt,e.stickerEmoji=c.RichTextProcessor.wrapRichText(e.stickerEmojiRaw,{noLinks:!0,noLinebreaks:!0})),t.stickerset&&("inputStickerSetEmpty"==t.stickerset._?delete t.stickerset:"inputStickerSetID"==t.stickerset._&&(e.stickerSetInput=t.stickerset)),"image/webp"==e.mime_type&&(e.thumbs||f.default.isWebpSupported())&&(e.type="sticker",e.sticker=1);break;case"documentAttributeImageSize":e.type="photo",e.w=t.w,e.h=t.h;break;case"documentAttributeAnimated":"image/gif"!=e.mime_type&&"video/mp4"!=e.mime_type||(e.type="gif"),e.animated=!0}}),!e.mime_type)switch(e.type){case"gif":case"video":case"round":e.mime_type="video/mp4";break;case"sticker":e.mime_type="image/webp";break;case"audio":e.mime_type="audio/mpeg";break;case"voice":e.mime_type="audio/ogg";break;default:e.mime_type="application/octet-stream"}return"serviceWorker"in navigator&&("gif"==e.type&&e.size>8e6||"audio"==e.type||"video"==e.type)&&(e.supportsStreaming=!0,e.url||(e.url=this.getFileURL(e))),e.file_name||(e.file_name=""),"application/x-tgsticker"==e.mime_type&&"AnimatedSticker.tgs"==e.file_name&&(e.type="sticker",e.animated=!0,e.sticker=2),e}getDoc(e){return o.isObject(e)&&"string"!=typeof e?e:this.docs[e]}getMediaInput(e){return{_:"inputMediaDocument",id:{_:"inputDocument",id:e.id,access_hash:e.access_hash,file_reference:e.file_reference},ttl_seconds:0}}getInput(e,t){return{_:"inputDocumentFileLocation",id:e.id,access_hash:e.access_hash,file_reference:e.file_reference,thumb_size:t}}getFileDownloadOptions(e,t,s){const i=this.getInput(e,null==t?void 0:t.type);let n;return n=t?e.sticker?"image/webp":"image/jpeg":e.mime_type||"application/octet-stream",{dcId:e.dc_id,location:i,size:t?t.size:e.size,mimeType:n,fileName:e.file_name,queueId:s}}getFileURL(e,t=!1,s){let i;return i=t?"download":s?"thumb":e.supportsStreaming?"stream":"document",a.getFileURL(i,this.getFileDownloadOptions(e,s))}getThumbURL(e,t){let s=Promise.resolve();return t.url||("bytes"in t?(o.defineNotNumerableProperties(t,["url"]),t.url=u.default.getPreviewURLFromBytes(t.bytes,!!e.sticker)):s=this.downloadDoc(e,t)),{thumb:t,promise:s}}getThumb(e,t=!0){var s;if(null===(s=e.thumbs)||void 0===s?void 0:s.length){let s;return t||(s=e.thumbs.find(e=>!("bytes"in e))),s||(s=e.thumbs[0]),this.getThumbURL(e,s)}return null}getInputFileName(e,t){return a.getFileNameByLocation(this.getInput(e,t),{fileName:e.file_name})}downloadDoc(e,t,s){const n=this.getInputFileName(e,null==t?void 0:t.type);let a=h.default.getDownload(n);if(a)return a;const r=this.getFileDownloadOptions(e,t,s);a=h.default.download(r);const d=a;return d.then(s=>{if(t)return o.defineNotNumerableProperties(t,["url"]),void(t.url=URL.createObjectURL(s));e.supportsStreaming||(e.url=URL.createObjectURL(s)),e.downloaded=!0}),"voice"!=e.type||l.default.isPlaySupported()||(a=d.then(t=>i(this,void 0,void 0,(function*(){let s=new FileReader;return yield new Promise((i,n)=>{s.onloadend=t=>{let s=new Uint8Array(t.target.result);l.default.decode(s).then(t=>{e.url=t.url,i()},t=>{delete e.downloaded,n(t)})},s.readAsArrayBuffer(t)}),t})))),a}saveLottiePreview(e,t,s){const i=e.id+"-"+s;if(this.savingLottiePreview[i])return;e.stickerCachedThumbs||(o.defineNotNumerableProperties(e,["stickerCachedThumbs"]),e.stickerCachedThumbs={});const n=e.stickerCachedThumbs[s];n&&n.w>=t.width&&n.h>=t.height||(this.savingLottiePreview[i]=!0,t.toBlob(n=>{const a={url:URL.createObjectURL(n),w:t.width,h:t.height};e.stickerCachedThumbs[s]=a,delete this.savingLottiePreview[i]}))}saveDocFile(e,t){const s=this.getFileDownloadOptions(e,void 0,t);return h.default.downloadToDisc(s,e.file_name)}}t.AppDocsManager=p;const g=new p;r.MOUNT_CLASS_TO&&(r.MOUNT_CLASS_TO.appDocsManager=g),t.default=g},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationIntersector=void 0;const n=s(0),a=s(31),o=s(2),r=i(s(1)),d=s(12);class l{constructor(){this.visible=new Set,this.byGroups={},this.lockedGroups={},this.onlyOnePlayableGroup="",this.intersectionLockedGroups={},this.observer=new IntersectionObserver(e=>{if(!r.default.idle.isIDLE)for(const t of e){const e=t.target;for(const s in this.byGroups){if(this.intersectionLockedGroups[s])continue;const i=this.byGroups[s].find(t=>t.el==e);if(i){t.isIntersecting?(this.visible.add(i),this.checkAnimation(i,!1)):(this.visible.delete(i),this.checkAnimation(i,!0),i.animation instanceof a.RLottiePlayer&&i.animation.clearCache());break}}}})}getAnimations(e){const t=[];for(const s in this.byGroups)for(const i of this.byGroups[s])i.el==e&&t.push(i);return t}removeAnimation(e){const{el:t,animation:s}=e;s.remove(),s instanceof HTMLVideoElement&&d.isSafari&&setTimeout(()=>{s.src="",s.load()},1e3);for(const t in this.byGroups)this.byGroups[t].findAndSplice(t=>t==e);this.observer.unobserve(t),this.visible.delete(e)}addAnimation(e,t=""){var s;const i={el:e instanceof a.RLottiePlayer?e.el:e,animation:e,group:t};(null!==(s=this.byGroups[t])&&void 0!==s?s:this.byGroups[t]=[]).push(i),this.observer.observe(i.el)}checkAnimations(e,t,s=!1){if(r.default.idle.isIDLE)return;const i=t?[t]:Object.keys(this.byGroups);if(!t||this.byGroups[t])for(const t of i){this.byGroups[t].forEach(t=>{this.checkAnimation(t,e,s)})}else this.byGroups[t]=[]}checkAnimation(e,t=!1,s=!1){const{el:i,animation:a,group:o}=e;s||!n.isInDOM(i)&&!this.lockedGroups[o]?this.removeAnimation(e):t?a.paused||a.pause():a.paused&&this.visible.has(e)&&a.autoplay&&(!this.onlyOnePlayableGroup||this.onlyOnePlayableGroup==o)&&a.play()}setOnlyOnePlayableGroup(e){this.onlyOnePlayableGroup=e}lockGroup(e){this.lockedGroups[e]=!0}unlockGroup(e){delete this.lockedGroups[e],this.checkAnimations(void 0,e)}refreshGroup(e){const t=this.byGroups[e];t&&t.length&&(t.forEach(e=>{this.observer.unobserve(e.el)}),window.requestAnimationFrame(()=>{t.forEach(e=>{this.observer.observe(e.el)})}))}lockIntersectionGroup(e){this.intersectionLockedGroups[e]=!0}unlockIntersectionGroup(e){delete this.intersectionLockedGroups[e],this.refreshGroup(e)}}t.AnimationIntersector=l;const c=new l;o.MOUNT_CLASS_TO&&(o.MOUNT_CLASS_TO.animationIntersector=c),t.default=c},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppDialogsManager=void 0;const d=r(s(42)),l=r(s(164)),c=s(47),f=s(4),h=s(17),u=a(s(6)),p=r(s(27)),g=s(18),m=s(33),b=s(12),v=s(16),y=s(3),M=r(s(1)),_=s(0),w=r(s(15)),S=r(s(7)),I=r(s(10)),L=r(s(13)),E=r(s(8)),C=s(2),T=r(s(32)),P=r(s(63)),k=r(s(55)),x=r(s(35));class A{constructor(e){this.currentText="",this.connecting=!1,this.updating=!1,this.setStatusText=e=>{this.currentText!=e&&(this.statusEl.innerText=this.currentText=e,this.statusEl.appendChild(this.statusPreloader))},this.setState=()=>{this.connecting?this.setStatusText("Waiting for network..."):this.updating&&this.setStatusText("Updating..."),this.log("setState",this.connecting||this.updating),window.requestAnimationFrame(()=>{P.default(this.statusContainer,"is-shown",this.connecting||this.updating,200)})},this.log=v.logger("CS"),this.statusContainer=document.createElement("div"),this.statusContainer.classList.add("connection-status"),this.statusEl=T.default("btn-primary bg-warning connection-status-button",{noRipple:!0}),this.statusPreloader=f.putPreloader(null,!0).firstElementChild,this.statusContainer.append(this.statusEl),e.prepend(this.statusContainer),M.default.on("connection_status_change",e=>{const s=e.detail;console.log(s),t()}),M.default.on("state_synchronizing",e=>{e.detail||(this.updating=!0,this.log("updating",this.updating),this.setState())}),M.default.on("state_synchronized",e=>{const t=e.detail;this.log("state_synchronized",t),t||(this.updating=!1,this.log("updating",this.updating),this.setState())});const t=()=>{k.default.get("dc").then(e=>{e||(e=C.App.baseDcId),s&&(clearTimeout(s),s=0);const t=M.default.connectionStatus["NET-"+e],i=t&&t.online;this.connecting&&i&&x.default.forceGetDifference(),this.connecting=!i,this.log("connecting",this.connecting),this.setState()})};let s=window.setTimeout(t,2e3)}}class D{constructor(){this._chatList=document.getElementById("dialogs"),this.chatList=this._chatList,this.doms={},this.chatsContainer=document.getElementById("chatlist-container"),this.scroll=null,this._scroll=null,this.log=v.logger("DIALOGS",v.LogLevels.log|v.LogLevels.error|v.LogLevels.warn|v.LogLevels.debug),this.contextMenu=new l.default,this.chatLists={0:this.chatList,1:p.default.archivedTab.chatList},this.filterId=0,this.folders={menu:document.getElementById("folders-tabs"),menuScrollContainer:null,container:document.getElementById("folders-container")},this.filtersRendered={},this.lastActiveElements=new Set,this.onTabChange=()=>{this.doms={},this.scroll.loadedAll.top=!0,this.scroll.loadedAll.bottom=!1,this.loadDialogsPromise=void 0,this.chatList=this.chatLists[this.filterId],this.loadDialogs()},this.onChatsRegularScroll=()=>{this.sliceTimeout&&clearTimeout(this.sliceTimeout),this.sliceTimeout=window.setTimeout(()=>{this.sliceTimeout=void 0;const e=this.scroll.container.getBoundingClientRect(),t=Array.from(this.scroll.splitUp.children),s=_.findUpTag(document.elementFromPoint(Math.ceil(e.x),Math.ceil(e.y+1)),"LI"),i=_.findUpTag(document.elementFromPoint(Math.ceil(e.x),Math.floor(e.y+e.height-1)),"LI");if(!s||!i)return;const n=s.getBoundingClientRect().y-e.y,a=[],o=t.indexOf(s),r=t.indexOf(i),d=b.isApple?[]:t.slice(0,Math.max(0,o-10)),l=t.slice(r+10);d.length&&(this.scroll.loadedAll.top=!1),l.length&&(this.scroll.loadedAll.bottom=!1),a.push(...d),a.push(...l),a.forEach(e=>{e.remove();const t=+e.getAttribute("data-peerId");delete this.doms[t]}),this.scroll.scrollTop=s.offsetTop-n},200)},this.onChatsScrollTop=()=>{this.onChatsScroll("top")},this.onChatsScroll=(e="bottom")=>{this.scroll.loadedAll[e]||this.loadDialogsPromise||(this.log("onChatsScroll",e),this.loadDialogs(e))},this.chatsPreloader=f.putPreloader(null,!0),this.allUnreadCount=this.folders.menu.querySelector(".badge"),this.folders.menuScrollContainer=this.folders.menu.parentElement;const e=document.createElement("div");e.classList.add("connection-status-bottom"),e.append(this.folders.container),this.scroll=this._scroll=new u.default(e,"CL",500),this.scroll.container.addEventListener("scroll",this.onChatsRegularScroll),this.scroll.onScrolledTop=this.onChatsScrollTop,this.scroll.onScrolledBottom=this.onChatsScroll,this.scroll.setVirtualContainer(this.chatList),this.setListClickListener(this.chatList,null,!0),M.default.on("user_update",e=>{var t;const s=e.detail,i=E.default.getUser(s),n=S.default.getDialogByPeerId(i.id)[0];if(n&&!E.default.isBot(n.peerId)&&n.peerId!=M.default.myId){const e="userStatusOnline"==(null===(t=i.status)||void 0===t?void 0:t._),s=this.getDialogDom(n.peerId);s&&s.avatarEl.classList.toggle("is-online",e)}}),M.default.on("dialog_flush",e=>{const t=e.detail.peerId,s=S.default.getDialogByPeerId(t)[0];s&&(this.setLastMessage(s),this.validateForFilter(),this.setFiltersUnreadCount())}),M.default.on("dialogs_multiupdate",e=>{const t=e.detail;for(const e in t){const s=t[e];this.updateDialog(s)}this.validateForFilter(),this.setFiltersUnreadCount()}),M.default.on("dialog_drop",e=>{const{peerId:t,dialog:s}=e.detail,i=this.getDialogDom(t);i&&(i.listEl.remove(),delete this.doms[t]),this.setFiltersUnreadCount()}),M.default.on("dialog_unread",e=>{const t=e.detail,s=S.default.getDialogByPeerId(t.peerId)[0];s&&(this.setUnreadMessages(s),this.validateForFilter(),this.setFiltersUnreadCount())}),M.default.on("dialog_notify_settings",e=>{const t=S.default.getDialogByPeerId(e.detail)[0];t&&this.setUnreadMessages(t)}),M.default.on("peer_changed",e=>{const t=e.detail;for(const e of this.lastActiveElements)+e.getAttribute("data-peerid")!==t&&(e.classList.remove("active"),this.lastActiveElements.delete(e));Array.from(document.querySelectorAll(`[data-autonomous="0"] li[data-peerid="${t}"]`)).forEach(e=>{e.classList.add("active"),this.lastActiveElements.add(e)})}),M.default.on("filter_update",e=>{const t=e.detail;if(!this.filtersRendered[t.id])return void this.addFilter(t);if(t.id==this.filterId){const e=S.default.dialogsStorage.getFolder(t.id);this.validateForFilter();for(let t=0,s=e.length;t<s;++t){const s=e[t];this.updateDialog(s)}this.setFiltersUnreadCount()}this.filtersRendered[t.id].title.innerHTML=y.RichTextProcessor.wrapEmojiText(t.title)}),M.default.on("filter_delete",e=>{const t=e.detail,s=this.filtersRendered[t.id];s&&(this.folders.menu.firstElementChild.children[0].click(),s.container.remove(),s.menu.remove(),delete this.chatLists[t.id],delete this.filtersRendered[t.id],Object.keys(this.filtersRendered).length||this.folders.menuScrollContainer.classList.add("hide"))}),M.default.on("filter_order",e=>{const t=e.detail,i=this.folders.menu.firstElementChild;if(t.forEach(e=>{const t=S.default.filtersStorage.filters[e],s=this.filtersRendered[e];_.positionElementByIndex(s.menu,i,t.orderIndex),_.positionElementByIndex(s.container,this.folders.container,t.orderIndex)}),this.filterId){const e=t.indexOf(this.filterId)+1;s.prevId=e}}),M.default.on("peer_typings",e=>{const{peerId:t,typings:s}=e.detail,i=S.default.getDialogByPeerId(t)[0];i&&(s.length?this.setTyping(i,E.default.getUser(s[0])):this.unsetTyping(i))});const t=new u.ScrollableX(this.folders.menuScrollContainer);e.prepend(this.folders.menuScrollContainer);const s=c.horizontalMenu(this.folders.menu,this.folders.container,(e,s)=>{t.scrollIntoView(this.folders.menu.firstElementChild.children[e],!0,250),e=+s.dataset.filterId||0,this.filterId!=e&&(this.chatLists[e].innerHTML="",this.scroll.setVirtualContainer(this.chatLists[e]),this.filterId=e,this.onTabChange())},()=>{for(const e in this.chatLists)+e!=this.filterId&&(this.chatLists[e].innerHTML="")});this.folders.menu.firstElementChild.firstElementChild.click(),L.default.getState().then(e=>(S.default.filtersStorage.getDialogFilters().then(e=>{for(const t of e)this.addFilter(t)}),this.loadDialogs())).then(()=>{S.default.getConversationsAll("",0).finally(()=>{S.default.getConversationsAll("",1).then(()=>{this.accumulateArchivedUnread()})})}),new A(this.chatsContainer),this.chatsContainer.append(e)}get topOffsetIndex(){if(!this.scroll.loadedAll.top){const e=this.chatList.firstElementChild;if(e){const t=+e.getAttribute("data-peerId");return S.default.getDialogByPeerId(t)[0].index}}return 0}updateDialog(e){if(e)if(this.topOffsetIndex&&e.index>this.topOffsetIndex){const t=this.getDialogDom(e.peerId);t&&(t.listEl.remove(),delete this.doms[e.peerId])}else this.doms.hasOwnProperty(e.peerId)||this.addDialogNew({dialog:e}),this.getDialogDom(e.peerId)&&(this.setLastMessage(e),this.reorderDialogs())}setFilterUnreadCount(e,t){var s;const i=0==e?this.allUnreadCount:null===(s=this.filtersRendered[e])||void 0===s?void 0:s.unread;if(!i)return;const n=(t=t||S.default.dialogsStorage.getFolder(e)).reduce((e,t)=>e+ +!!t.unread_count,0);i.innerText=n?""+n:""}setFiltersUnreadCount(){for(const e in this.filtersRendered)this.setFilterUnreadCount(+e);this.setFilterUnreadCount(0)}validateForFilter(){const e=S.default.dialogsStorage.getFolder(this.filterId);for(const t in this.doms){const s=+t;if(-1===e.findIndex(e=>e.peerId==s)){this.doms[s].listEl.remove(),delete this.doms[s]}}}addFilter(e){if(this.filtersRendered[e.id])return;const t=document.createElement("li"),s=document.createElement("span"),i=document.createElement("span");i.innerHTML=y.RichTextProcessor.wrapEmojiText(e.title);const n=document.createElement("span");n.classList.add("badge","badge-20","badge-blue");const a=document.createElement("i");s.append(i,n,a),t.append(s),h.ripple(t);const o=this.folders.menu.firstElementChild;_.positionElementByIndex(t,o,e.orderIndex);const r=document.createElement("ul"),d=document.createElement("div");d.append(r),d.dataset.filterId=""+e.id,_.positionElementByIndex(d,this.folders.container,e.orderIndex),this.chatLists[e.id]=r,this.setListClickListener(r,null,!0),this.showFiltersTimeout||(this.showFiltersTimeout=window.setTimeout(()=>{this.showFiltersTimeout=0,this.folders.menuScrollContainer.classList.remove("hide"),this.setFiltersUnreadCount()},0)),this.filtersRendered[e.id]={menu:t,container:d,unread:n,title:i}}loadDialogs(e="bottom"){if(this.loadDialogsPromise)return this.loadDialogsPromise;const t=new Promise((t,s)=>o(this,void 0,void 0,(function*(){if(!this.chatList.childElementCount){this.chatList.parentElement.append(this.chatsPreloader)}const s=this.filterId;let i=30;const n=S.default.dialogsStorage.getFolder(s);let a=0;if("top"==e){const e=this.chatList.firstElementChild;if(e){const t=+e.getAttribute("data-peerId"),s=n.findIndex(e=>e.peerId==t),o=Math.max(0,s-i);i=s-o,a=n[o].index+1}}else{const e=this.chatList.lastElementChild;if(e){const t=+e.getAttribute("data-peerId"),s=n.find(e=>e.peerId==t);a=s.index}}try{const t=(this.filterId>1?E.default.getContacts():Promise.resolve()).then(()=>S.default.getConversations("",a,i,s)),n=yield t;if(this.filterId!=s)return;if("bottom"==e)n.isEnd&&(this.scroll.loadedAll[e]=!0);else{const t=S.default.dialogsStorage.getFolder(s);(!n.dialogs.length||t.length&&t[0].index<a)&&(this.scroll.loadedAll[e]=!0)}if(n.dialogs.length){("top"==e?n.dialogs.slice().reverse():n.dialogs).forEach(t=>{this.addDialogNew({dialog:t,append:"bottom"==e})})}this.log.debug("getDialogs "+i+" dialogs by offset:",a,n,this.chatList.childElementCount),setTimeout(()=>{this.scroll.onScroll()},0)}catch(e){this.log.error(e)}this.chatsPreloader.remove(),t()})));return this.loadDialogsPromise=t.finally(()=>{this.loadDialogsPromise=void 0})}setListClickListener(e,t,s=!1,i=!1){let n;e.dataset.autonomous=""+ +i,e.addEventListener("mousedown",e=>{if(0!=e.button)return;this.log("dialogs click list");let s=e.target,a=s.classList.contains("rp")?s:_.findUpClassName(s,"rp");if(a){if(a=a.parentElement,i){let e=n===a;n&&!e&&n.classList.remove("active"),a&&(a.classList.add("active"),n=a,this.lastActiveElements.add(a))}if(a){t&&t();let e=+a.getAttribute("data-peerId"),s=+a.dataset.mid||void 0;w.default.setPeer(e,s)}else w.default.setPeer(0)}},{capture:!0}),C.DEBUG&&e.addEventListener("dblclick",e=>{const t=_.findUpTag(e.target,"LI");if(t){const e=+t.getAttribute("data-peerId");this.log("debug dialog:",S.default.getDialogByPeerId(e))}}),s&&f.attachContextMenuListener(e,this.contextMenu.onContextMenu)}reorderDialogs(){this.reorderDialogsTimeout||(this.reorderDialogsTimeout=window.requestAnimationFrame(()=>{this.reorderDialogsTimeout=0;let e=0;if(this.topOffsetIndex){const t=this.chatList.firstElementChild;if(t){const s=+t.getAttribute("data-peerId"),i=S.default.getDialogByPeerId(s);e=i[1]}}const t=S.default.dialogsStorage.getFolder(this.filterId),s=Array.from(this.chatList.children).map(e=>+e.getAttribute("data-peerId"));t.forEach((t,i)=>{const n=this.getDialogDom(t.peerId);if(!n)return;const a=i-e;if(a>s.length)return n.listEl.remove(),void delete this.doms[t.peerId];const o=s[a];o!=t.peerId&&_.positionElementByIndex(n.listEl,this.chatList,a)&&this.log.debug("setDialogPosition:",t,n,o,a)})}))}setLastMessage(e,t,s,i){if(!s&&!(s=this.getDialogDom(e.peerId)))return;if(t||(t=S.default.getMessageByPeer(e.peerId,e.top_message)),"messageEmpty"==t._||"messageService"==t._&&!t.rReply)return s.lastMessageSpan.innerHTML="",s.lastTimeSpan.innerHTML="",void delete s.listEl.dataset.mid;let n=e.peer,a=e.peerId;if(i&&t.message){let e,n=S.default.getRichReplyText(t,""),a=t.message,o=y.RichTextProcessor.parseEntities(a.replace(/\n/g," ")),r=new RegExp(m.escapeRegExp(i),"gi");o||(o=[]);let d=!1;for(;null!==(e=r.exec(a));)o.push({_:"messageEntityHighlight",length:i.length,offset:e.index}),d=!0;d&&o.sort((e,t)=>e.offset-t.offset);let l=y.RichTextProcessor.wrapRichText(a,{noLinebreaks:!0,entities:o,noTextFormat:!0});s.lastMessageSpan.innerHTML=n+l}else t.deleted?s.lastMessageSpan.innerHTML="":s.lastMessageSpan.innerHTML=t.rReply;if("peerUser"!=n._&&a!=t.fromId&&!t.action){const e=I.default.getPeer(t.fromId);if(e&&e.id){const i=document.createElement("b");let n="";n=e.id==M.default.myId?"You":I.default.getPeerTitle(t.fromId,!0,!0),i.innerHTML=y.RichTextProcessor.wrapRichText(n,{noLinebreaks:!0,noLinks:!0})+": ",s.lastMessageSpan.prepend(i)}}t.deleted?s.lastTimeSpan.innerHTML="":s.lastTimeSpan.innerHTML=g.formatDateAccordingToToday(new Date(1e3*t.date)),this.doms[a]==s?this.setUnreadMessages(e):s.listEl.dataset.mid=t.mid}setUnreadMessages(e){var t;const s=this.getDialogDom(e.peerId);if(1==e.folder_id&&this.accumulateArchivedUnread(),!s)return;const i=1e3*(null===(t=e.notify_settings)||void 0===t?void 0:t.mute_until)>Date.now(),n=s.listEl.classList.contains("is-muted");!i&&n?(s.listEl.classList.add("backwards"),s.muteAnimationTimeout&&clearTimeout(s.muteAnimationTimeout),s.muteAnimationTimeout=window.setTimeout(()=>{delete s.muteAnimationTimeout,s.listEl.classList.remove("backwards","is-muted")},200)):s.listEl.classList.toggle("is-muted",i);const a=S.default.getMessageByPeer(e.peerId,e.top_message);if("messageEmpty"==a._||a.deleted||a.fromId!=M.default.myId||a.peerId==M.default.myId)s.statusSpan.classList.remove("tgico-check","tgico-checks");else{a.pFlags&&a.pFlags.unread?(s.statusSpan.classList.remove("tgico-checks"),s.statusSpan.classList.add("tgico-check")):(s.statusSpan.classList.remove("tgico-check"),s.statusSpan.classList.add("tgico-checks"))}s.unreadMessagesSpan.innerText="",s.unreadMessagesSpan.classList.remove("tgico-pinnedchat");const o=S.default.filtersStorage.filters[this.filterId];let r;r=o?-1!==o.pinned_peers.findIndex(t=>t==e.peerId):!!e.pFlags.pinned,e.unread_count||e.pFlags.unread_mark?(s.unreadMessagesSpan.innerText=""+(e.unread_count||" "),s.unreadMessagesSpan.classList.add("unread")):(s.unreadMessagesSpan.classList.remove("unread"),r&&s.unreadMessagesSpan.classList.add("tgico-pinnedchat"))}accumulateArchivedUnread(){this.accumulateArchivedTimeout||(this.accumulateArchivedTimeout=window.setTimeout(()=>{this.accumulateArchivedTimeout=0;const e=S.default.dialogsStorage.getFolder(1).reduce((e,t)=>e+t.unread_count,0);M.default.broadcast("dialogs_archived_unread",{count:e})},0))}getDialogDom(e){return this.doms[e]}addDialogNew(e){return this.addDialog(e.dialog,e.container,e.drawStatus,e.rippleEnabled,e.onlyFirstName,e.meAsSaved,e.append,e.avatarSize,e.autonomous)}addDialog(e,t,s=!0,i=!0,n=!1,a=!0,o=!0,r=54,l=!!t){var c,f;let u;if("number"==typeof e){let t=S.default.getDialogByPeerId(e)[0];t||(t={peerId:e,peer:I.default.getOutputPeer(e),pFlags:{}}),u=t}else u=e;const p=u.peerId;if(!t){if(this.doms[p])return;const e=S.default.filtersStorage.filters[this.filterId];if(e&&!S.default.filtersStorage.testDialogForFilter(u,e)||!e&&this.filterId!=u.folder_id)return}let g=I.default.getPeerTitle(p,!1,n);const m=new d.default;if(m.setAttribute("dialog",a?"1":"0"),m.setAttribute("peer",""+p),m.classList.add("dialog-avatar","avatar-"+r),s&&p!=M.default.myId&&u.peer){switch(u.peer._){case"peerUser":const e=E.default.getUser(p);e.status&&"userStatusOnline"==e.status._&&m.classList.add("is-online")}}const b=document.createElement("div");b.classList.add("user-caption");const v=document.createElement("span");v.classList.add("user-title");const y=document.createElement("span");p==M.default.myId&&a&&(g=n?"Saved":"Saved Messages"),y.innerHTML=g,v.append(y);const _=I.default.getPeer(p);if(v.classList.add("tgico"),null===(c=null==_?void 0:_.pFlags)||void 0===c?void 0:c.verified){v.classList.add("is-verified");const e=document.createElement("i");e.classList.add("verified-icon"),v.append(e)}const L=document.createElement("span");L.classList.add("user-last-message");const C=document.createElement("div");C.classList.add("rp"),C.append(m,b),i&&h.ripple(C);const T=document.createElement("li");T.append(C),T.setAttribute("data-peerId",""+p);const P=document.createElement("span");P.classList.add("message-status");const k=document.createElement("span");k.classList.add("message-time");const x=document.createElement("span");x.classList.add("dialog-subtitle-badge");const A=document.createElement("p");A.classList.add("dialog-title");const D=document.createElement("span");D.classList.add("dialog-title-details"),D.append(P,k),A.append(v,D);const X=document.createElement("p");X.classList.add("dialog-subtitle"),X.append(L,x),b.append(A,X);const F={avatarEl:m,captionDiv:b,titleSpan:y,titleSpanContainer:v,statusSpan:P,lastTimeSpan:k,unreadMessagesSpan:x,lastMessageSpan:L,containerEl:C,listEl:T},O=o?"append":"prepend";return t?t[O](T):(this.scroll[O](T),this.doms[u.peerId]=F,this.setLastMessage(u)),l||(null===(f=w.default.chat)||void 0===f?void 0:f.peerId)!==p||(T.classList.add("active"),this.lastActiveElements.add(T)),{dom:F,dialog:u}}setTyping(e,t){const s=this.getDialogDom(e.peerId);if(!s)return;let i="";if(e.peerId<0){let e=t.rFirstName||t.username;if(!e)return;i=e+" "}const n=document.createElement("i");i+="typing...",n.innerHTML=i,s.lastMessageSpan.innerHTML="",s.lastMessageSpan.append(n),s.lastMessageSpan.classList.add("user-typing")}unsetTyping(e){const t=this.getDialogDom(e.peerId);t&&(t.lastMessageSpan.classList.remove("user-typing"),this.setLastMessage(e,null,t))}}t.AppDialogsManager=D;const X=new D;C.MOUNT_CLASS_TO&&(C.MOUNT_CLASS_TO.appDialogsManager=X),t.default=X},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPoll=t.wrapGroupedDocuments=t.wrapAlbum=t.prepareAlbum=t.wrapReply=t.wrapSticker=t.wrapPhoto=t.wrapDocument=t.formatDate=t.wrapVideo=void 0;const a=s(82),o=s(56),r=s(30),d=s(18),l=n(s(9)),c=s(26),f=s(12),h=n(s(21)),u=n(s(7)),p=n(s(20)),g=n(s(31)),m=n(s(73)),b=s(0),v=n(s(68)),y=n(s(22)),M=n(s(50)),_=n(s(132)),w=n(s(92)),S=s(133),I=s(4),L=n(s(93)),E=n(s(46));s(91);const C=s(65),T=n(s(3)),P=n(s(15));function k({doc:e,container:t,message:s,boxWidth:n,boxHeight:a,withTail:o,isOut:d,middleware:l,lazyLoadQueue:c,noInfo:u,group:g}){var v;const _=!(n&&a),w="video"!=e.type||e.size<=52428800&&!_;let S;if(!u&&"round"!=e.type)if(S=document.createElement("span"),S.classList.add("video-time"),t.append(S),"gif"!=e.type)if(S.innerText=(e.duration+"").toHHMMSS(!1),w)S.classList.add("tgico","can-autoplay");else{const e=document.createElement("span");e.classList.add("video-play","tgico-largeplay","btn-circle","position-center"),t.append(e)}else S.innerText="GIF";if("image/gif"==e.mime_type)return D({photo:e,message:s,container:t,boxWidth:n,boxHeight:a,withTail:o,isOut:d,lazyLoadQueue:c,middleware:l});const L=document.createElement("video");if(L.muted=!0,L.setAttribute("playsinline","true"),"round"==e.type){const t=M.default.addMedia(s.peerId,e,s.mid);L.addEventListener("canplay",()=>{t.currentTime>0&&(L.currentTime=t.currentTime),t.paused||L.play()},{once:!0});const i=()=>{t.removeEventListener("timeupdate",n),t.removeEventListener("play",a),t.removeEventListener("pause",o),L.removeEventListener("play",r),L.removeEventListener("pause",d)},n=()=>{b.isInDOM(L)||i()},a=()=>{L.play()},o=()=>{L.pause()},r=()=>{t.play()},d=()=>{b.isInDOM(L)?t.pause():i()};t.addEventListener("timeupdate",n),t.addEventListener("play",a),t.addEventListener("pause",o),L.addEventListener("play",r),L.addEventListener("pause",d)}else L.autoplay=!0;let C;if(s){if(!w)return D({photo:e,message:s,container:t,boxWidth:n,boxHeight:a,withTail:o,isOut:d,lazyLoadQueue:c,middleware:l});if(o?C=A(e,s,t,n,a,d):(n&&a&&p.default.setAttachmentSize(e,t,n,a,!1,!0),(null===(v=e.thumbs)||void 0===v?void 0:v.length)&&"bytes"in e.thumbs[0]&&p.default.setAttachmentPreview(e.thumbs[0].bytes,t,!1),C=t.lastElementChild,"IMG"!=(null==C?void 0:C.tagName)&&t.append(C=new Image)),C&&C.classList.add("thumbnail"),o){const e=C.parentElement;L.width=+e.getAttributeNS(null,"width"),L.height=+e.getAttributeNS(null,"height"),e.append(L)}}if(!(null==C?void 0:C.parentElement)){const t=h.default.getThumb(e,!1);t&&t.promise.then(()=>{L.poster=t.thumb.url})}!L.parentElement&&t&&t.append(L);const T=()=>i(this,void 0,void 0,(function*(){var i;if(l&&!l())return;let n;if(null===(i=null==s?void 0:s.media)||void 0===i?void 0:i.preloader)n=s.media.preloader,n.attach(t,!1);else if(e.downloaded||e.supportsStreaming)e.supportsStreaming&&(n=new E.default(null,!1,!1,"prepend"),n.attach(t,!1,null),L.addEventListener(f.isSafari?"timeupdate":"canplay",()=>{n.detach()},{once:!0}));else{const s=h.default.downloadDoc(e,void 0,null==c?void 0:c.queueId);if(n=new E.default(null,!0,!1,"prepend"),n.attach(t,!0,s),yield s,l&&!l())return}const a=r.deferredPromise();return L.addEventListener(f.isAppleMobile?"loadeddata":"canplay",()=>{(null==C?void 0:C.parentElement)&&C.remove(),"round"!=e.type&&g&&y.default.addAnimation(L,g),a.resolve()},{once:!0}),"video"==e.type&&L.addEventListener("timeupdate",()=>{S.innerText=(L.duration-L.currentTime+"").toHHMMSS(!1)}),L.addEventListener("error",e=>{a.resolve()}),I.renderImageFromUrl(L,e.url),"round"==e.type?(L.dataset.ckin="circle",L.dataset.overlay="1",new m.default(L)):(L.muted=!0,L.loop=!0,L.autoplay=!0),a}));return c?(c.push({div:t,load:T}),Promise.resolve()):T()}function x({message:e,withTime:s,fontWeight:i,voiceAsMusic:n,showSender:a,searchContext:o}){var r;i||(i=500);const l=e.pFlags.is_outgoing,f=e.media.document||e.media.webpage.document;if("audio"==f.type||"voice"==f.type){const t=new _.default;return t.setAttribute("message-id",""+e.mid),t.setAttribute("peer-id",""+e.peerId),t.withTime=s,t.message=e,n&&(t.voiceAsMusic=n),o&&(t.searchContext=o),a&&(t.showSender=a),t.dataset.fontWeight=""+i,t.render(),t}let p=f.file_name?f.file_name.split("."):"",g="";g=p.length>1&&Array.isArray(p)?p.pop().toLowerCase():"file";let m=document.createElement("div");m.classList.add("document","ext-"+g);const v=document.createElement("div");if(v.classList.add("document-ico"),(null===(r=f.thumbs)||void 0===r?void 0:r.length)||l&&f.url&&"photo"==f.type){m.classList.add("document-with-thumb"),l?v.innerHTML=`<img src="${f.url}">`:(D({photo:f,message:null,container:v,boxWidth:54,boxHeight:54}),v.style.width=v.style.height="");const e=v.querySelector("img");e&&e.classList.add("document-thumb")}else v.innerText=g;let y=f.file_name||"Unknown.file",M=c.formatBytes(f.size);s&&(M+=" · "+t.formatDate(f.date)),a&&(M+=" · "+u.default.getSenderToPeerText(e));let w="";if(a&&(w=`<div class="sent-time">${d.formatDateAccordingToToday(new Date(1e3*e.date))}</div>`),m.innerHTML=`\n  ${l?"":'<div class="document-download"><div class="tgico-download"></div></div>'}\n  <div class="document-name"><middle-ellipsis-element data-font-weight="${i}">${y}</middle-ellipsis-element>${w}</div>\n  <div class="document-size">${M}</div>\n  `,m.prepend(v),!l){let e,t,s=m.querySelector(".document-download");b.attachClickEvent(m,i=>{if(b.cancelEvent(i),t)t.cancel();else{if(s.classList.contains("downloading"))return;e||(e=new E.default(null,!0)),t=h.default.saveDocFile(f,P.default.chat.bubbles.lazyLoadQueue.queueId),e.attach(s,!0,t),t.then(()=>{s.remove()}).catch(e=>{"AbortError"===e.name&&(t=null)}).finally(()=>{s.classList.remove("downloading")}),s.classList.add("downloading")}})}return m}function A(e,t,s,i,n,a){const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.classList.add("bubble__media-container",a?"is-out":"is-in");const r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");p.default.setAttachmentSize(e,r,i,n);const d=+r.getAttributeNS(null,"width"),l=+r.getAttributeNS(null,"height");o.setAttributeNS(null,"width",""+d),o.setAttributeNS(null,"height",""+l),o.setAttributeNS(null,"viewBox","0 0 "+d+" "+l),o.setAttributeNS(null,"preserveAspectRatio","none");const c="clip"+t.mid+"_"+C.nextRandomInt(9999);o.dataset.clipId=c;const f=document.createElementNS("http://www.w3.org/2000/svg","defs");let h="";t.message||(h+=a?`\n      <use href="#message-tail" transform="translate(${d-2}, ${l}) scale(-1, -1)"></use>\n      <path />\n      `:`\n      <use href="#message-tail" transform="translate(2, ${l}) scale(1, -1)"></use>\n      <path />\n      `),f.innerHTML=`<clipPath id="${c}">${h}</clipPath>`,s.style.width=parseInt(s.style.width)-9+"px",s.classList.add("with-tail"),o.append(f,r),s.append(o);let u=r.firstElementChild;return u||r.append(u=new Image),u}function D({photo:e,message:t,container:s,boxWidth:i,boxHeight:n,withTail:a,isOut:o,lazyLoadQueue:r,middleware:d,size:c}){var f;let u;if(void 0===i&&(i=l.default.active.regular.width),void 0===n&&(n=l.default.active.regular.height),a)u=A(e,t,s,i,n,o);else{if(i&&n&&(c=p.default.setAttachmentSize(e,s,i,n,!1,!0)),"document"==e._||!e.downloaded){const t=e.sizes||e.thumbs;(null==t?void 0:t.length)&&"bytes"in t[0]&&p.default.setAttachmentPreview(t[0].bytes,s,!1)}u=s.lastElementChild,u&&"IMG"==u.tagName||s.append(u=new Image)}if(!e.sizes&&!e.thumbs)return Promise.resolve();const g=p.default.getCacheContext(e);let m;(null===(f=null==t?void 0:t.media)||void 0===f?void 0:f.preloader)?t.media.preloader.attach(s,!1):g.downloaded||(m=new E.default(null,!1,!1,"document"==e._?"prepend":"append"));const b=()=>{const t="document"==e._&&e.animated?h.default.downloadDoc(e,void 0,null==r?void 0:r.queueId):p.default.preloadPhoto(e,c,null==r?void 0:r.queueId);return m&&m.attach(s,!0,t),t.then(()=>{d&&!d()||I.renderImageFromUrl(u||s,g.url||e.url)})};return g.downloaded||!r?b():(r.push({div:s,load:b}),Promise.resolve())}function X(e){const t=new S.Layouter(e.items,e.maxWidth,e.minWidth,e.spacing,e.maxHeight).layout(),s=t.find(e=>e.sides&S.RectPart.Right),i=s.geometry.width+s.geometry.x,n=t.find(e=>e.sides&S.RectPart.Bottom),a=n.geometry.height+n.geometry.y,o=e.container;o.style.width=i+"px",o.style.height=a+"px";const r=o.children;t.forEach(({geometry:t,sides:s},n)=>{let d;if(d=r[n],d||(d=document.createElement("div"),o.append(d)),d.classList.add("album-item","grouped-item"),d.style.width=t.width/i*100+"%",d.style.height=t.height/a*100+"%",d.style.top=t.y/a*100+"%",d.style.left=t.x/i*100+"%",s&S.RectPart.Left&&s&S.RectPart.Top&&(d.style.borderTopLeftRadius="inherit"),s&S.RectPart.Left&&s&S.RectPart.Bottom&&(d.style.borderBottomLeftRadius="inherit"),s&S.RectPart.Right&&s&S.RectPart.Top&&(d.style.borderTopRightRadius="inherit"),s&S.RectPart.Right&&s&S.RectPart.Bottom&&(d.style.borderBottomRightRadius="inherit"),e.forMedia){const e=document.createElement("div");e.classList.add("album-item-media"),d.append(e)}})}t.wrapVideo=k,t.formatDate=(e,t=!1,s=!0)=>{const i=new Date(1e3*e);let n=d.months[i.getMonth()];t&&(n=n.slice(0,3));let a=n+" "+i.getDate();return s&&(a+=", "+i.getFullYear()),a+" at "+i.getHours()+":"+("0"+i.getMinutes()).slice(-2)},t.wrapDocument=x,t.wrapPhoto=D,t.wrapSticker=function({doc:e,div:t,middleware:s,lazyLoadQueue:n,group:r,play:d,onlyThumb:l,emoji:c,width:f,height:u,withThumb:m,loop:y}){var M;const _=e.sticker;if(f||(f=c?void 0:200),u||(u=c?void 0:200),2!=_||g.default.loaded||g.default.loadLottieWorkers(),!_)throw console.error("wrong doc for wrapSticker!",e),new Error("wrong doc for wrapSticker!");t.dataset.docId=e.id;const w=c?a.getEmojiToneIndex(c):-1;if(((null===(M=e.thumbs)||void 0===M?void 0:M.length)||e.stickerCachedThumbs)&&!t.firstElementChild&&(!e.downloaded||2==_||l)){let i,a=e.stickerCachedThumbs&&e.stickerCachedThumbs[w]||e.thumbs[0];const o=()=>{t.childElementCount||t.append(i)};if("url"in a)i=new Image,I.renderImageFromUrl(i,a.url,o);else if("bytes"in a){if("photoPathSize"==a._)if(a.bytes.length){const s=p.default.getPathFromPhotoPathSize(a);t.innerHTML=`<svg class="rlottie-vector" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 ${e.w||512} ${e.h||512}" xml:space="preserve">\n            <path d="${s}"/>\n          </svg>`}else a=e.thumbs.find(e=>{var t;return null===(t=e.bytes)||void 0===t?void 0:t.length})||a;a&&"photoPathSize"!=a._&&w<=0&&(i=new Image,v.default.isWebpSupported()||e.pFlags.stickerThumbConverted||a.url?I.renderImageFromUrl(i,p.default.getPreviewURLFromThumb(a,!0),o):v.default.convert(e.id,a.bytes).then(n=>{a.bytes=n,e.pFlags.stickerThumbConverted=!0,s&&!s()||t.childElementCount||I.renderImageFromUrl(i,p.default.getPreviewURLFromThumb(a,!0),o)}).catch(()=>{}))}else if(2==_&&(m||l)&&w<=0){i=new Image;const r=()=>{if(t.childElementCount||s&&!s())return;const n=()=>{t.childElementCount||s&&!s()||I.renderImageFromUrl(i,a.url,o)};return a.url?(n(),Promise.resolve()):h.default.getThumbURL(e,a).promise.then(n)};if(n&&l)return n.push({div:t,load:r}),Promise.resolve();r()}}if(l)return Promise.resolve();let S=e.downloaded,L=()=>i(this,void 0,void 0,(function*(){if(!s||s())if(2==_)yield h.default.downloadDoc(e,void 0,null==n?void 0:n.queueId).then(o.readBlobAsText).then(n=>i(this,void 0,void 0,(function*(){if(s&&!s())return;let i=yield g.default.loadAnimationWorker({container:t,loop:y&&!c,autoplay:d,animationData:n,width:f,height:u},r,w);i.addListener("firstFrame",()=>{const s=t.firstElementChild,n=!s||"svg"===s.tagName,a=()=>{s&&s!=i.canvas&&s.remove()};n?(i.canvas.classList.add("fade-in"),s&&setTimeout(()=>{a()},"svg"===s.tagName?50:200)):a(),h.default.saveLottiePreview(e,i.canvas,w)},!0),c&&b.attachClickEvent(t,e=>{b.cancelEvent(e);let s=g.default.getAnimation(t);s.paused&&(s.autoplay=!0,s.restart())})})));else if(1==_){let i=new Image;S||t.firstElementChild&&"IMG"==t.firstElementChild.tagName||(i.classList.add("fade-in-transition"),i.style.opacity="0",i.addEventListener("load",()=>{e.downloaded=!0,window.requestAnimationFrame(()=>{i.style.opacity=""})}));const a=()=>{s&&!s()||I.renderImageFromUrl(i,e.url,()=>{t.firstElementChild&&t.firstElementChild!=i&&t.firstElementChild.remove(),t.append(i)})};e.url?a():h.default.downloadDoc(e,void 0,null==n?void 0:n.queueId).then(a)}}));return!n||e.downloaded&&2!=_?L():(n.push({div:t,load:L}),Promise.resolve())},t.wrapReply=function(e,t,s){const i=new w.default("reply");return i.fill(e,t,s),i.container},t.prepareAlbum=X,t.wrapAlbum=function({groupId:e,attachmentDiv:t,middleware:s,uploading:i,lazyLoadQueue:n,isOut:a,chat:o}){const r=[],d=u.default.getMidsByAlbum(e);for(const e of d){const t=o.getMessage(e),s=t.media.photo||t.media.document,i="photo"==s._?p.default.choosePhotoSize(s,480,480):{w:s.w,h:s.h};r.push({size:i,media:s,message:t})}X({container:t,items:r.map(e=>({w:e.size.w,h:e.size.h})),maxWidth:l.default.active.album.width,minWidth:100,spacing:2,forMedia:!0}),r.forEach((e,i)=>{const{size:o,media:r,message:d}=e,l=t.children[i];l.dataset.mid=""+d.mid;const c=l.firstElementChild;"photo"==r._?D({photo:r,message:d,container:c,boxWidth:0,boxHeight:0,isOut:a,lazyLoadQueue:n,middleware:s,size:o}):k({doc:d.media.document,container:c,message:d,boxWidth:0,boxHeight:0,withTail:!1,isOut:a,lazyLoadQueue:n,middleware:s})})},t.wrapGroupedDocuments=function({albumMustBeRenderedFull:e,message:t,bubble:s,messageDiv:i,chat:n}){let a;const o=e?n.getMidsByMid(t.mid):[t.mid],r=t.pFlags.is_outgoing;return o.forEach((e,t)=>{const s=n.getMessage(e),d=s.media.document,l=x({message:s}),c=document.createElement("div");c.classList.add("document-container"),c.dataset.mid=""+e;const f=document.createElement("div");if(f.classList.add("document-wrapper"),s.message){const e=document.createElement("div");e.classList.add("document-message");const t=T.default.wrapRichText(s.message,{entities:s.totalEntities});e.innerHTML=t,f.append(e)}if(o.length>1){const e=document.createElement("div");e.classList.add("document-selection"),c.append(e),c.classList.add("grouped-item"),0===t&&(a=f)}if(r)if("audio"==d.type||"voice"==d.type)l.preloader=s.media.preloader;else{const e=l.querySelector(".audio-download, .document-ico");s.media.preloader.attach(e,!1)}f.append(l),c.append(f),i.append(c)}),o.length>1&&s.classList.add("is-multiple-documents","is-grouped"),a},t.wrapPoll=function(e){const t=new L.default;return t.message=e,t.setAttribute("peer-id",""+e.peerId),t.setAttribute("poll-id",e.media.poll.id),t.setAttribute("message-id",""+e.mid),t}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LazyLoadQueueRepeat2=t.LazyLoadQueueRepeat=t.LazyLoadQueueIntersector=t.LazyLoadQueueBase=void 0;const a=s(34),o=s(16),r=n(s(116));class d{constructor(e=1/0){this.parallelLimit=e,this.queueId=0,this.queue=[],this.inProcess=new Set,this.lockPromise=null,this.unlockResolve=null,this.log=o.logger("LL",o.LogLevels.error),this.processQueue=a.debounce(()=>this._processQueue(),20,!1,!0)}clear(){this.inProcess.clear(),this.queue.length=0}lock(){if(this.lockPromise)return;const e=performance.now();this.lockPromise=new Promise((e,t)=>{this.unlockResolve=e}),this.lockPromise.then(()=>{this.log("was locked for:",performance.now()-e)})}unlock(){this.unlockResolve&&(this.unlockResolve(),this.unlockResolve=this.lockPromise=null,this.processQueue())}processItem(e){return i(this,void 0,void 0,(function*(){if(!this.lockPromise){this.inProcess.add(e),this.log("will load media",this.lockPromise,e);try{yield this.loadItem(e)}catch(e){this.log.error("loadMediaQueue error:",e)}this.inProcess.delete(e),this.log("loaded media",e),this.processQueue()}}))}loadItem(e){return e.load()}getItem(){return this.queue.shift()}addElement(e,t){this.queue[e](t),this.processQueue()}_processQueue(e){if(!(!this.queue.length||this.lockPromise||this.parallelLimit>0&&this.inProcess.size>=this.parallelLimit))do{if(e?this.queue.findAndSplice(t=>t==e):e=this.getItem(),!e)break;this.processItem(e),e=null}while(this.inProcess.size<this.parallelLimit&&this.queue.length)}push(e){this.addElement("push",e)}unshift(e){this.addElement("unshift",e)}}t.LazyLoadQueueBase=d;class l extends d{constructor(e=1/0){super(e),this.parallelLimit=e,this.queue=[],this.inProcess=new Set}lock(){super.lock(),this.intersector.lock()}unlock(){super.unlock(),this.intersector.unlock()}unlockAndRefresh(){super.unlock(),this.intersector.unlockAndRefresh()}clear(){super.clear(),this.intersector.disconnect()}refresh(){this.intersector.refresh()}loadItem(e){return e.load(e.div)}addElement(e,t){if(this.queue.find(e=>e.div==t.div))return!1;for(const e of this.inProcess)if(e.div==t.div)return!1;return this.queue[e](t),!0}setProcessQueueTimeout(){this.intersectorTimeout||(this.intersectorTimeout=window.setTimeout(()=>{this.intersectorTimeout=0,this.processQueue()},0))}push(e){super.push(e)}unshift(e){super.unshift(e)}unobserve(e){this.queue.findAndSplice(t=>t.div===e),this.intersector.unobserve(e)}}t.LazyLoadQueueIntersector=l;t.default=class extends l{constructor(e=1/0){super(e),this.parallelLimit=e,this.onVisibilityChange=(e,t)=>{if(t){this.log("isIntersecting",e);const t=this.queue.findAndSplice(t=>t.div==e);t&&(t.wasSeen=!0,this.queue.unshift(t)),this.setProcessQueueTimeout()}},this.intersector=new r.default(this.onVisibilityChange)}getItem(){return this.queue.findAndSplice(e=>e.wasSeen)}processItem(e){const t=Object.create(null,{processItem:{get:()=>super.processItem}});return i(this,void 0,void 0,(function*(){yield t.processItem.call(this,e),this.intersector.unobserve(e.div)}))}addElement(e,t){return!!super.addElement(e,t)&&(this.intersector.observe(t.div),t.hasOwnProperty("wasSeen")||(t.wasSeen=!1),!0)}};t.LazyLoadQueueRepeat=class extends l{constructor(e=1/0,t){super(e),this.parallelLimit=e,this.onVisibilityChange=t,this._queue=new Map,this.intersector=new r.default((e,t)=>{if(t){const t=this.queue.findAndSplice(t=>t.div==e);this.queue.unshift(t||this._queue.get(e))}else this.queue.findAndSplice(t=>t.div==e);this.onVisibilityChange&&this.onVisibilityChange(e,t),this.setProcessQueueTimeout()})}clear(){super.clear(),this._queue.clear()}observe(e){this._queue.set(e.div,e),this.intersector.observe(e.div)}};t.LazyLoadQueueRepeat2=class extends l{constructor(e=1/0,t){super(e),this.parallelLimit=e,this.onVisibilityChange=t,this.intersector=new r.default((e,t)=>{const s=this.queue.findAndSplice(t=>t.div==e);t&&s&&this.queue.unshift(s),this.onVisibilityChange&&this.onVisibilityChange(e,t),this.setProcessQueueTimeout()})}observe(e){this.intersector.observe(e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=t.formatNumber=t.formatBytes=t.numberWithCommas=void 0,t.numberWithCommas=function(e){const t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")},t.formatBytes=function(e,t=2){if(0===e)return"0 Bytes";const s=t<0?0:t,i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]},t.formatNumber=function(e,t=2){if(0===e)return"0";const s=t<0?0:t,i=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,i)).toFixed(s))+["","K","M","B","T"][i]},t.clamp=function(e,t,s){return e<t?t:e>s?s:e}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppSidebarLeft=void 0;const r=s(26),d=o(s(15)),l=o(s(10)),c=o(s(13)),f=o(s(8)),h=s(2),u=o(s(1)),p=s(0),g=s(49);s(42);const m=s(4),b=a(s(6)),v=o(s(43)),y=o(s(89)),M=s(87),_=o(s(121)),w=o(s(122)),S=o(s(123)),I=o(s(124)),L=o(s(125)),E=o(s(126)),C=o(s(128)),T=o(s(129)),P=o(s(130)),k=o(s(131)),x=o(s(7)),A=o(s(5)),D=o(s(90)),X=s(18),F=new T.default,O=new _.default,R=new I.default,B=new P.default,j=new k.default,U=new E.default,N=new L.default,H=new C.default,z=new w.default;class q extends y.default{constructor(){super(document.getElementById("column-left")),this.buttons={},this.newButtons={},this.searchGroups={},Object.assign(this.tabs,{[q.SLIDERITEMSIDS.archived]:z,[q.SLIDERITEMSIDS.newChannel]:F,[q.SLIDERITEMSIDS.contacts]:R,[q.SLIDERITEMSIDS.addMembers]:O,[q.SLIDERITEMSIDS.newGroup]:B,[q.SLIDERITEMSIDS.settings]:j,[q.SLIDERITEMSIDS.editProfile]:U,[q.SLIDERITEMSIDS.chatFolders]:this.chatFoldersTab=new S.default(x.default,l.default,this,A.default,u.default),[q.SLIDERITEMSIDS.editFolder]:N,[q.SLIDERITEMSIDS.includedChats]:H}),this.inputSearch=new v.default("Telegram Search");this.sidebarEl.querySelector(".item-main .sidebar-header").append(this.inputSearch.container),this.toolsBtn=this.sidebarEl.querySelector(".sidebar-tools-button"),this.backBtn=this.sidebarEl.querySelector(".sidebar-back-button"),this.archivedTab=z,this.newChannelTab=F,this.addMembersTab=O,this.contactsTab=R,this.newGroupTab=B,this.settingsTab=j,this.editProfileTab=U,this.editFolderTab=N,this.includedChatsTab=H,this.menuEl=this.toolsBtn.querySelector(".btn-menu"),this.newBtnMenu=this.sidebarEl.querySelector("#new-menu"),this.inputSearch.input.addEventListener("focus",()=>this.initSearch(),{once:!0}),m.parseMenuButtonsTo(this.buttons,this.menuEl.children),m.parseMenuButtonsTo(this.newButtons,this.newBtnMenu.firstElementChild.children),this.archivedCount=this.buttons.archived.querySelector(".archived-count"),p.attachClickEvent(this.buttons.saved,e=>{setTimeout(()=>{d.default.setPeer(d.default.myId)},0)}),p.attachClickEvent(this.buttons.archived,e=>{this.selectTab(q.SLIDERITEMSIDS.archived)}),p.attachClickEvent(this.buttons.contacts,e=>{this.contactsTab.openContacts()}),p.attachClickEvent(this.buttons.settings,e=>{this.settingsTab.fillElements(),this.selectTab(q.SLIDERITEMSIDS.settings)}),p.attachClickEvent(this.newButtons.channel,e=>{this.selectTab(q.SLIDERITEMSIDS.newChannel)}),[this.newButtons.group,this.buttons.newGroup].forEach(e=>{p.attachClickEvent(e,e=>{this.addMembersTab.init(0,"chat",!1,e=>{this.newGroupTab.init(e)})})}),u.default.on("dialogs_archived_unread",e=>{this.archivedCount.innerText=""+r.formatNumber(e.detail.count,1),this.archivedCount.classList.toggle("hide",!e.detail.count)}),f.default.getTopPeers()}initSearch(){const e=this.sidebarEl.querySelector("#search-container"),t=new b.default(e);this.searchGroups={contacts:new g.SearchGroup("Chats","contacts"),globalContacts:new g.SearchGroup("Global Search","contacts"),messages:new g.SearchGroup("Messages","messages"),people:new g.SearchGroup("","contacts",!0,"search-group-people",!0,!1),recent:new g.SearchGroup("Recent","contacts",!0,"search-group-recent",!0,!1)};const s=this.searchSuper=new D.default([{inputFilter:"inputMessagesFilterEmpty",name:"Chats"},{inputFilter:"inputMessagesFilterPhotoVideo",name:"Media"},{inputFilter:"inputMessagesFilterUrl",name:"Links"},{inputFilter:"inputMessagesFilterDocument",name:"Files"},{inputFilter:"inputMessagesFilterMusic",name:"Music"},{inputFilter:"inputMessagesFilterVoice",name:"Voice"}],t,this.searchGroups,!0);t.container.append(s.container);const i=()=>{s.setQuery({peerId:0,folderId:0}),s.selectTab(0),s.load(!0)};i();let n=[],a=0,o=0,r=0;const d=()=>{this.inputSearch.input.placeholder=n.length?"Search":"Telegram Search",this.inputSearch.container.classList.toggle("is-picked-twice",2===n.length),this.inputSearch.container.classList.toggle("is-picked",!!n.length),n.length?this.inputSearch.input.style.setProperty("--paddingLeft",n[n.length-1].getBoundingClientRect().right-this.inputSearch.input.getBoundingClientRect().left+"px"):this.inputSearch.input.style.removeProperty("--paddingLeft")},h=document.createElement("div");h.classList.add("search-helper"),h.addEventListener("click",e=>{const t=p.findUpClassName(e.target,"selector-user");if(!t)return;const s=t.dataset.key;if(0===s.indexOf("date_")){const[e,t,i]=s.split("_");o=+t,r=+i}else a=+s;t.addEventListener("click",()=>{v(t)}),this.inputSearch.container.append(t),this.inputSearch.onChange(this.inputSearch.value=""),n.push(t),d()}),s.nav.parentElement.append(h);const m=(e,t)=>{const s=document.createElement("div");s.classList.add("selector-user");const i=document.createElement("avatar-element");return i.classList.add("selector-user-avatar","tgico"),i.setAttribute("dialog","1"),i.classList.add("avatar-30"),s.dataset.key=""+e,"number"==typeof e?(void 0===t&&(t=e==u.default.myId?"Saved":l.default.getPeerTitle(e,!1,!0)),i.setAttribute("peer",""+e)):i.classList.add("tgico-calendarfilter"),t&&(s.innerHTML=t),s.insertAdjacentElement("afterbegin",i),s},v=e=>{0===e.dataset.key.indexOf("date_")?o=r=0:a=0,e.remove(),n.findAndSplice(t=>t===e),setTimeout(()=>{d(),this.inputSearch.onChange(this.inputSearch.value)},0)};this.inputSearch.onClear=()=>{n.forEach(e=>{v(e)})},this.inputSearch.onChange=e=>{if(s.cleanupHTML(),s.setQuery({peerId:a,folderId:a?void 0:0,query:e,minDate:o,maxDate:r}),s.load(!0),h.innerHTML="",s.nav.classList.remove("hide"),!a&&e.trim()){const t=s.getMiddleware();Promise.all([x.default.getConversationsAll(e).then(e=>e.map(e=>e.peerId)),f.default.getContacts(e,!0)]).then(e=>{if(!t())return;new Set(e[0].concat(e[1])).forEach(e=>{h.append(m(e))}),s.nav.classList.toggle("hide",!!h.innerHTML)})}if(!o&&e.trim()){const t=[];X.fillTipDates(e,t),t.forEach(e=>{h.append(m("date_"+e.minDate+"_"+e.maxDate,e.title))}),s.nav.classList.toggle("hide",!!h.innerHTML)}},s.tabs.inputMessagesFilterEmpty.addEventListener("click",e=>{const t=p.findUpTag(e.target,"LI");if(!t)return;const s=p.findUpClassName(t,"search-group");if(!s||s.classList.contains("search-group-recent")||s.classList.contains("search-group-people"))return;const i=+t.getAttribute("data-peerId");c.default.getState().then(e=>{const t=e.recentSearch||[];if(t[0]!=i){t.findAndSplice(e=>e==i),t.unshift(i),t.length>20&&(t.length=20),c.default.pushToState("recentSearch",t);for(const e of t)c.default.setPeer(e,l.default.getPeer(e))}})},{capture:!0});let y=document.createElement("div");y.classList.add("search-group-scrollable"),y.append(this.searchGroups.people.list),this.searchGroups.people.container.append(y);let _;new b.ScrollableX(y);const w=M.TransitionSlider(e.parentElement,"zoom-fade",150,e=>{_&&clearTimeout(_),0===e&&(this.inputSearch.onClearClick(),i(),_=window.setTimeout(()=>{_=0,this.newBtnMenu.classList.remove("is-hidden")},150))});w(0);const S=()=>{this.toolsBtn.classList.remove("active"),this.backBtn.classList.add("active"),this.newBtnMenu.classList.add("is-hidden"),w(1)};this.inputSearch.input.addEventListener("focus",S),S(),this.backBtn.addEventListener("click",e=>{this.toolsBtn.classList.add("active"),this.backBtn.classList.remove("active"),w(0)});const I=document.createElement("button");I.classList.add("btn-icon","tgico-close"),this.searchGroups.recent.nameEl.append(I),I.addEventListener("click",()=>{this.searchGroups.recent.clear(),c.default.pushToState("recentSearch",[])})}}t.AppSidebarLeft=q,q.SLIDERITEMSIDS={archived:1,contacts:2,newChannel:3,addMembers:4,newGroup:5,settings:6,editProfile:7,chatFolders:8,editFolder:9,includedChats:10};const W=new q;h.MOUNT_CLASS_TO&&(h.MOUNT_CLASS_TO.appSidebarLeft=W),t.default=W},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),a=s(33),o=i(s(3));let r=()=>{document.addEventListener("paste",e=>{if(!e.target.hasAttribute("contenteditable")&&!e.target.parentElement.hasAttribute("contenteditable"))return;e.preventDefault();let t=(e.originalEvent||e).clipboardData.getData("text/plain"),s=o.default.parseEntities(t);s=s.filter(e=>"messageEntityEmoji"==e._||"messageEntityLinebreak"==e._),t=o.default.wrapRichText(t,{entities:s,noLinks:!0,wrappingDraft:!0}),window.document.execCommand("insertHTML",!1,t)}),r=null};const d=e=>{const t=(e instanceof HTMLInputElement?e.value:e.innerText)[0];let s="ltr";t&&a.checkRTL(t)&&(s="rtl"),e.style.direction=s};t.default=class{constructor(e={}){this.options=e,this.container=document.createElement("div"),this.container.classList.add("input-field"),e.maxLength&&(e.showLengthOn=Math.round(e.maxLength/3));const{placeholder:t,label:s,maxLength:i,showLengthOn:a,name:o,plainText:l}=e;let c,f;if(l)this.container.innerHTML=`\n      <input type="text" ${o?`name="${o}"`:""} ${t?`placeholder="${t}"`:""} autocomplete="off" ${s?'required=""':""} class="input-field-input">\n      ${s?`<label>${s}</label>`:""}\n      `,c=this.container.firstElementChild,c.addEventListener("input",()=>d(c));else{r&&r(),this.container.innerHTML=`\n      <div ${t?`data-placeholder="${t}"`:""} contenteditable="true" class="input-field-input"></div>\n      ${s?`<label>${s}</label>`:""}\n      `,c=this.container.firstElementChild;new MutationObserver(()=>{d(c),f&&f()}).observe(c,{characterData:!0,childList:!0,subtree:!0})}if(i){const e=this.container.lastElementChild;let t=!1;f=()=>{const o=c.classList.contains("error"),r=l?c.value.length:[...n.getRichValue(c)].length,d=i-r,f=d<0;c.classList.toggle("error",f),f||d<=a?(e.innerText=s+` (${i-r})`,t||(t=!0)):(o&&!f||t)&&(e.innerText=s,t=!1)},c.addEventListener("input",f)}this.input=c}get value(){return this.options.plainText?this.input.value:n.getRichValue(this.input)}set value(e){this.setValueSilently(e);const t=new Event("input",{bubbles:!0,cancelable:!0});this.input.dispatchEvent(t)}setValueSilently(e){this.options.plainText?this.input.value=e:this.input.innerHTML=e}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppSidebarRight=t.RIGHT_COLUMN_ACTIVE_CLASSNAME=void 0;const r=o(s(15)),d=o(s(89)),l=o(s(135)),c=o(s(136)),f=o(s(137)),h=a(s(9)),u=o(s(138)),p=o(s(139)),g=s(2),m=s(34);t.RIGHT_COLUMN_ACTIVE_CLASSNAME="is-right-column-shown";const b=new p.default,v=new u.default,y=new l.default,M=new c.default,_=new f.default;class w extends d.default{constructor(){super(document.getElementById("column-right"),{[w.SLIDERITEMSIDS.sharedMedia]:b,[w.SLIDERITEMSIDS.search]:v,[w.SLIDERITEMSIDS.stickers]:y,[w.SLIDERITEMSIDS.pollResults]:M,[w.SLIDERITEMSIDS.gifs]:_},!0),this.sharedMediaTab=b,this.searchTab=v,this.stickersTab=y,this.pollResultsTab=M,this.gifsTab=_,h.default.addListener("changeScreen",(e,t)=>{t==h.ScreenSize.medium&&e!==h.ScreenSize.mobile&&this.toggleSidebar(!1)})}onCloseTab(e){this.historyTabIds.length||this.toggleSidebar(!1),super.onCloseTab(e)}toggleSidebar(e,s=!0){const i=document.body.classList.contains(t.RIGHT_COLUMN_ACTIVE_CLASSNAME);let n;return void 0!==e?e?i||(n=!0):i&&(n=!0):n=!0,n?(s&&(r.default.hideRightSidebar=!1),i||this.historyTabIds.length||this.selectTab(w.SLIDERITEMSIDS.sharedMedia),document.body.classList.toggle(t.RIGHT_COLUMN_ACTIVE_CLASSNAME,e),r.default.selectTab(i?1:2),m.pause(h.default.isMobile?250:200)):Promise.resolve()}}t.AppSidebarRight=w,w.SLIDERITEMSIDS={sharedMedia:0,search:1,stickers:2,pollResults:3,gifs:4};const S=new w;g.MOUNT_CLASS_TO&&(g.MOUNT_CLASS_TO.appSidebarRight=S),t.default=S},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deferredPromise=void 0,t.deferredPromise=function(){let e={isFulfilled:!1,isRejected:!1,notify:()=>{},notifyAll:(...t)=>{e.lastNotify=t,e.listeners.forEach(e=>e(...t))},lastNotify:void 0,listeners:[],addNotifyListener:t=>{e.lastNotify&&t(...e.lastNotify),e.listeners.push(t)}},t=new Promise((s,i)=>{e.resolve=e=>{t.isFulfilled||(t.isFulfilled=!0,s(e))},e.reject=(...e)=>{t.isRejected||(t.isRejected=!0,i(...e))}});return t.finally(()=>{t.notify=null,t.listeners.length=0,t.lastNotify=null}),Object.assign(t,e),t}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RLottiePlayer=void 0;const a=n(s(120)),o=n(s(22)),r=n(s(54)),d=n(s(9)),l=s(26),c=s(12),f=s(16),h=n(s(5)),u=s(2);let p=e=>Math.round(255*Math.min(Math.max(e,0),1));class g extends r.default{constructor({el:e,worker:t,options:s}){super(!0),this.reqId=0,this.width=0,this.height=0,this.paused=!0,this.direction=1,this.speed=1,this.autoplay=!0,this.loop=!0,this.group="",this.frames={},this.cachingDelta=0,this.reqId=++g.reqId,this.el=e,this.worker=t;for(let e in s)this.hasOwnProperty(e)&&(this[e]=s[e]);let i;void 0!==s.skipRatio?i=s.skipRatio:(c.isAndroid||c.isAppleMobile||c.isApple&&!c.isSafari)&&this.width<100&&this.height<100&&(i=.5),this.skipDelta=void 0!==i?1/i|0:1;const n=l.clamp(window.devicePixelRatio,1,2);n>1&&(s.needUpscale?(this.width=Math.round(this.width*n),this.height=Math.round(this.height*n)):n>1&&(this.width>100&&this.height>100?c.isApple||!d.default.isMobile?(this.width=Math.round(this.width*n),this.height=Math.round(this.height*n)):n>2.5&&(this.width=Math.round(this.width*(n-1.5)),this.height=Math.round(this.height*(n-1.5))):(this.width=Math.round(this.width*Math.max(1.5,n-1.5)),this.height=Math.round(this.height*Math.max(1.5,n-1.5))))),s.noCache||(c.isApple&&this.width>100&&this.height>100?this.cachingDelta=2:this.width<100&&this.height<100?this.cachingDelta=1/0:this.cachingDelta=4),this.canvas=document.createElement("canvas"),this.canvas.classList.add("rlottie"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.clamped=new Uint8ClampedArray(this.width*this.height*4),this.imageData=new ImageData(this.width,this.height)}clearCache(){this.frames={}}sendQuery(e,...t){this.worker.sendQuery(e,this.reqId,...t)}loadFromData(e){this.sendQuery("loadFromData",e,this.width,this.height)}play(){this.paused&&(this.paused=!1,this.setMainLoop())}pause(e=!0){this.paused||(this.paused=!0,e&&clearTimeout(this.rafId))}stop(e=!0){this.pause(),this.curFrame=1==this.direction?0:this.frameCount,e&&this.requestFrame(this.curFrame)}restart(){this.stop(!1),this.play()}setSpeed(e){this.speed=e,this.paused||this.setMainLoop()}setDirection(e){this.direction=e,this.paused||this.setMainLoop()}remove(){v.onDestroy(this.reqId),this.pause(),this.sendQuery("destroy")}renderFrame2(e,t){try{this.imageData.data.set(e),this.context.putImageData(this.imageData,0,0)}catch(e){return console.error("RLottiePlayer renderFrame error:",e,this.width,this.height),this.autoplay=!1,void this.pause()}this.setListenerResult("enterFrame",t)}renderFrame(e,t){if(this.cachingDelta&&(t%this.cachingDelta||!t)&&!this.frames[t]&&(this.frames[t]=new Uint8ClampedArray(e)),this.frInterval){const s=Date.now()-this.frThen;if(s<0)return this.rafId&&clearTimeout(this.rafId),this.rafId=window.setTimeout(()=>{this.renderFrame2(e,t)},this.frInterval>-s?-s%this.frInterval:this.frInterval)}this.renderFrame2(e,t)}requestFrame(e){this.frames[e]?this.renderFrame(this.frames[e],e):c.isSafari?this.sendQuery("renderFrame",e):(this.clamped.length||(this.clamped=new Uint8ClampedArray(this.width*this.height*4)),this.sendQuery("renderFrame",e,this.clamped))}mainLoopForwards(){const e=this.curFrame+this.skipDelta>=this.frameCount?this.curFrame=0:this.curFrame+=this.skipDelta;return this.requestFrame(e),!(e+this.skipDelta>=this.frameCount&&!this.loop)||(this.pause(!1),!1)}mainLoopBackwards(){const e=this.curFrame-this.skipDelta<0?this.curFrame=this.frameCount-1:this.curFrame-=this.skipDelta;return this.requestFrame(e),!(e-this.skipDelta<0&&!this.loop)||(this.pause(!1),!1)}setMainLoop(){clearTimeout(this.rafId),this.frInterval=1e3/this.fps/this.speed*this.skipDelta,this.frThen=Date.now()-this.frInterval;const e=(1==this.direction?this.mainLoopForwards:this.mainLoopBackwards).bind(this);this.currentMethod=e,this.frameListener&&this.listenerResults.hasOwnProperty("enterFrame")&&this.frameListener()}onLoad(e,t){return i(this,void 0,void 0,(function*(){this.curFrame=1==this.direction?0:e-1,this.frameCount=e,this.fps=t,this.frInterval=1e3/this.fps/this.speed*this.skipDelta,this.frThen=Date.now()-this.frInterval,this.requestFrame(0),this.setListenerResult("ready"),this.addListener("enterFrame",()=>{this.setListenerResult("firstFrame"),this.el.appendChild(this.canvas),this.frameListener=()=>{if(this.paused)return;const e=Date.now();this.frThen=e+this.frInterval;this.currentMethod()||this.loop||!this.autoplay||(this.autoplay=!1)},this.addListener("enterFrame",this.frameListener)},!0)}))}}t.RLottiePlayer=g,g.reqId=0;class m extends r.default{constructor(e,t=(()=>{}),s){super(),this.worker=e,this.defaultListener=t,s&&(this.worker.onerror=s),this.worker.onmessage=e=>{e.data instanceof Object&&e.data.hasOwnProperty("queryMethodListener")&&e.data.hasOwnProperty("queryMethodArguments")?this.setListenerResult(e.data.queryMethodListener,...e.data.queryMethodArguments):this.defaultListener.call(this,e.data)}}postMessage(e){this.worker.postMessage(e)}terminate(){this.worker.terminate()}sendQuery(e,...t){if(c.isSafari)this.worker.postMessage({queryMethod:e,queryMethodArguments:t});else{const s=[];t.forEach(e=>{e instanceof ArrayBuffer&&s.push(e),e.buffer&&e.buffer instanceof ArrayBuffer&&s.push(e.buffer)}),this.worker.postMessage({queryMethod:e,queryMethodArguments:t},s)}}}class b{constructor(){this.loaded=!1,this.workersLimit=4,this.players={},this.workers=[],this.curWorkerNum=0,this.log=f.logger("LOTTIE",f.LogLevels.error),this.onPlayerLoaded=(e,t,s)=>{const i=this.players[e];i?(this.log.debug("onPlayerLoaded"),i.onLoad(t,s)):this.log.warn("onPlayerLoaded on destroyed player:",e,t)},this.onFrame=(e,t,s)=>{const i=this.players[e];i?(i.clamped=s,i.renderFrame(s,t)):this.log.warn("onFrame on destroyed player:",e,t)},this.onPlayerError=(e,t)=>{const s=this.players[e];if(s){o.default.getAnimations(s.el).forEach(e=>{o.default.checkAnimation(e,!0,!0)})}}}getAnimation(e){for(let t in this.players)if(this.players[t].el==e)return this.players[t];return null}loadLottieWorkers(){return"undefined"==typeof WebAssembly?Promise.reject():this.loadPromise?this.loadPromise:this.loadPromise=new Promise((e,t)=>{let s=this.workersLimit;for(let t=0;t<this.workersLimit;++t){const i=this.workers[t]=new m(new a.default);i.addListener("ready",()=>{this.log("worker #"+t+" ready"),i.addListener("frame",this.onFrame),i.addListener("loaded",this.onPlayerLoaded),i.addListener("error",this.onPlayerError),--s,s||(this.log("workers ready"),e(),this.loaded=!0)})}})}applyReplacements(e,t){const s=b.COLORREPLACEMENTS[Math.max(t-1,0)],i=e=>{for(let t of e){switch(t.ty){case"st":case"fl":let e=t.c.k,i=p(e[2])|p(e[1])<<8|p(e[0])<<16,n=s.find(e=>e[0]==i);n&&(e[0]=(n[1]>>16&255)/255,e[1]=(n[1]>>8&255)/255,e[2]=(255&n[1])/255)}t.hasOwnProperty("it")&&i(t.it)}};for(let t of e.layers)if(t.shapes)for(let e of t.shapes)i(e.it)}loadAnimationFromURL(e,t){return this.loaded||this.loadLottieWorkers(),fetch(t).then(e=>e.arrayBuffer()).then(e=>h.default.gzipUncompress(e,!0)).then(t=>this.loadAnimationWorker(Object.assign(e,{animationData:t,needUpscale:!0})))}loadAnimationWorker(e,t="",s=-1){return i(this,void 0,void 0,(function*(){if(s>=1&&s<=5){const t=JSON.parse(e.animationData);this.applyReplacements(t,s),e.animationData=JSON.stringify(t)}if(this.loaded||(yield this.loadLottieWorkers()),e.width&&e.height||(e.width=parseInt(e.container.style.width),e.height=parseInt(e.container.style.height)),!e.width||!e.height)throw new Error("No size for sticker!");e.group=t;const i=this.initPlayer(e.container,e);return o.default.addAnimation(i,t),i}))}onDestroy(e){delete this.players[e]}destroyWorkers(){this.workers.forEach((e,t)=>{e.terminate(),this.log("worker #"+t+" terminated")}),this.log("workers destroyed"),this.workers.length=0}initPlayer(e,t){const s=new g({el:e,worker:this.workers[this.curWorkerNum++],options:t});return this.players[s.reqId]=s,this.curWorkerNum>=this.workers.length&&(this.curWorkerNum=0),s.loadFromData(t.animationData),s}}b.COLORREPLACEMENTS=[[[16219713,13275258],[16757049,15582629],[16765248,16245699],[16768889,16510934]],[[16219713,11172960],[16757049,13150599],[16765248,14534815],[16768889,15128242]],[[16219713,9199944],[16757049,11371874],[16765248,12885622],[16768889,13939080]],[[16219713,7224364],[16757049,9591348],[16765248,10579526],[16768889,11303506]],[[16219713,2694162],[16757049,4663842],[16765248,5716784],[16768889,6834492]]];const v=new b;u.MOUNT_CLASS_TO&&(u.MOUNT_CLASS_TO.lottieLoader=v),t.default=v},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(17);t.default=(e,t={})=>{const s=document.createElement("button");return s.className=e+(t.icon?" tgico-"+t.icon:""),t.noRipple||i.ripple(s),t.onlyMobile&&s.classList.add("only-handhelds"),s}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkRTL=t.splitStringByLength=t.encodeEntities=t.escapeRegExp=t.limitSymbols=void 0,t.limitSymbols=function(e,t,s=t+10){return e.length>s&&(e=e.slice(0,t).replace(/(\n|\s)+$/,"")+"..."),e},t.escapeRegExp=function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},t.encodeEntities=function(e){return e.replace(/&/g,"&amp;").replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,e=>"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";").replace(/([^\#-~| |!])/g,e=>"&#"+e.charCodeAt(0)+";").replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.splitStringByLength=function e(t,s){if(t.length<s)return[t];let i=0,n=0,a=0;const o=[],r=r=>{let d=t.slice(n,r);const l=a++;if(d.length>s){e(d.slice(s),s).forEach(e=>{o[a++]=e}),d=d.slice(0,s)}n=r,i=0,o[l]=(o[l]||"")+d};let d=0;for(;;){let e=t.indexOf(" ",d);if(-1===e){d!=t.length-1&&r();break}e+=" ".length;const n=e-d;i+n>s&&r(i),d=e,i+=n}return o},t.checkRTL=e=>new RegExp("^[^A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿Ⰰ-﬜﷾-﹯﻽-￿]*[֑-߿יִ-﷽ﹰ-ﻼ]").test(e)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pause=t.debounce=void 0,t.debounce=function(e,t,s=!0,i=!0){let n=null;return(...a)=>{n?(clearTimeout(n),n=null):s&&e(...a),n=window.setTimeout(()=>{i&&e(...a),n=null},t)}},t.pause=e=>new Promise(t=>{setTimeout(t,e)})},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ApiUpdatesManager=void 0;const a=s(16),o=n(s(5)),r=s(2),d=n(s(1)),l=n(s(19)),c=n(s(10)),f=n(s(13)),h=n(s(8));class u{constructor(){this.updatesState={pendingPtsUpdates:[],pendingSeqUpdates:{},syncPending:null,syncLoading:!0},this.channelStates={},this.attached=!1,this.log=a.logger("UPDATES",a.LogLevels.error),this.processUpdateMessage=e=>{var t={date:e.date,seq:e.seq,seqStart:e.seq_start};switch(e._){case"updatesTooLong":case"new_session_created":this.forceGetDifference();break;case"updateShort":this.processUpdate(e.update,t);break;case"updateShortMessage":case"updateShortChatMessage":{this.log("updateShortMessage | updateShortChatMessage",Object.assign({},e));const s=e.pFlags.out,i=e.from_id||(s?d.default.myId:e.user_id),n=e.chat_id?-e.chat_id:e.user_id||d.default.myId;this.processUpdate({_:"updateNewMessage",message:{_:"message",pFlags:e.pFlags,id:e.id,from_id:c.default.getOutputPeer(i),peer_id:c.default.getOutputPeer(n),date:e.date,message:e.message,fwd_from:e.fwd_from,reply_to:e.reply_to,entities:e.entities},pts:e.pts,pts_count:e.pts_count},t);break}case"updatesCombined":case"updates":h.default.saveApiUsers(e.users),l.default.saveApiChats(e.chats),e.updates.forEach(e=>{this.processUpdate(e,t)});break;default:this.log.warn("Unknown update message",e)}},f.default.addListener("save",()=>i(this,void 0,void 0,(function*(){const e=this.updatesState;f.default.pushToState("updates",{seq:e.seq,pts:e.pts,date:e.date})})))}popPendingSeqUpdate(){const e=this.updatesState.seq+1,t=this.updatesState.pendingSeqUpdates[e];if(!t)return!1;const s=t.updates;for(let e=0,t=s.length;e<t;e++)this.saveUpdate(s[e]);return this.updatesState.seq=t.seq,t.date&&this.updatesState.date<t.date&&(this.updatesState.date=t.date),delete this.updatesState.pendingSeqUpdates[e],!this.popPendingSeqUpdate()&&this.updatesState.syncPending&&this.updatesState.syncPending.seqAwaiting&&this.updatesState.seq>=this.updatesState.syncPending.seqAwaiting&&(this.updatesState.syncPending.ptsAwaiting?delete this.updatesState.syncPending.seqAwaiting:(clearTimeout(this.updatesState.syncPending.timeout),this.updatesState.syncPending=null)),!0}popPendingPtsUpdate(e){const t=e?this.getChannelState(e):this.updatesState;if(!t.pendingPtsUpdates.length)return!1;t.pendingPtsUpdates.sort((e,t)=>e.pts-t.pts);let s=t.pts,i=0,n=0;for(let e=0,a=t.pendingPtsUpdates.length;e<a;e++){const a=t.pendingPtsUpdates[e];s+=a.pts_count,s>=a.pts&&(i=a.pts,n=e)}if(!i)return!1;this.log("pop pending pts updates",i,t.pendingPtsUpdates.slice(0,n+1)),t.pts=i;for(let e=0;e<=n;e++){const s=t.pendingPtsUpdates[e];this.saveUpdate(s)}return t.pendingPtsUpdates.splice(0,n+1),!t.pendingPtsUpdates.length&&t.syncPending&&(t.syncPending.seqAwaiting?delete t.syncPending.ptsAwaiting:(clearTimeout(t.syncPending.timeout),t.syncPending=null)),!0}forceGetDifference(){this.updatesState.syncLoading||this.getDifference()}getDifference(e=!1){const t=this.updatesState;return t.syncLoading||(t.syncLoading=!0,t.pendingSeqUpdates={},t.pendingPtsUpdates=[],d.default.broadcast("state_synchronizing")),t.syncPending&&(clearTimeout(t.syncPending.timeout),t.syncPending=null),o.default.invokeApi("updates.getDifference",{pts:t.pts,date:t.date,qts:-1},{timeout:2147483647}).then(s=>{if(this.log("Get diff result",s),"updates.differenceEmpty"==s._)return this.log("apply empty diff",s.seq),t.date=s.date,t.seq=s.seq,t.syncLoading=!1,d.default.broadcast("state_synchronized"),!1;if(e&&d.default.broadcast("state_synchronizing"),"updates.differenceTooLong"!=s._){h.default.saveApiUsers(s.users),l.default.saveApiChats(s.chats),s.other_updates.forEach(e=>{switch(e._){case"updateChannelTooLong":case"updateNewChannelMessage":case"updateEditChannelMessage":return void this.processUpdate(e)}this.saveUpdate(e)}),s.new_messages.forEach(e=>{this.saveUpdate({_:"updateNewMessage",message:e,pts:t.pts,pts_count:0})});const e="updates.difference"==s._?s.state:s.intermediate_state;t.seq=e.seq,t.pts=e.pts,t.date=e.date}else t.pts=s.pts,delete t.seq,delete t.date;"updates.differenceSlice"==s._?this.getDifference():(d.default.broadcast("state_synchronized"),t.syncLoading=!1)},()=>{t.syncLoading=!1})}getChannelDifference(e){const t=this.getChannelState(e);t.syncLoading||(t.syncLoading=!0,t.pendingPtsUpdates=[],d.default.broadcast("state_synchronizing",e)),t.syncPending&&(clearTimeout(t.syncPending.timeout),t.syncPending=null),o.default.invokeApi("updates.getChannelDifference",{channel:l.default.getChannelInput(e),filter:{_:"channelMessagesFilterEmpty"},pts:t.pts,limit:30},{timeout:2147483647}).then(s=>(this.log("Get channel diff result",s),t.pts="pts"in s?s.pts:void 0,"updates.channelDifferenceEmpty"==s._?(this.log("apply channel empty diff",s),t.syncLoading=!1,d.default.broadcast("state_synchronized",e),!1):"updates.channelDifferenceTooLong"==s._?(this.log("channel diff too long",s),t.syncLoading=!1,delete this.channelStates[e],this.saveUpdate({_:"updateChannelReload",channel_id:e}),!1):(h.default.saveApiUsers(s.users),l.default.saveApiChats(s.chats),this.log("applying",s.other_updates.length,"channel other updates"),s.other_updates.forEach(e=>{this.saveUpdate(e)}),this.log("applying",s.new_messages.length,"channel new messages"),s.new_messages.forEach(e=>{this.saveUpdate({_:"updateNewChannelMessage",message:e,pts:t.pts,pts_count:0})}),this.log("apply channel diff",t.pts),void("updates.channelDifference"!=s._||s.pFlags.final?(this.log("finished channel get diff"),d.default.broadcast("state_synchronized",e),t.syncLoading=!1):this.getChannelDifference(e)))),()=>{t.syncLoading=!1})}addChannelState(e,t){if(!t)throw new Error("Add channel state without pts "+e);return!(e in this.channelStates)&&(this.channelStates[e]={pts:t,pendingPtsUpdates:[],syncPending:null,syncLoading:!1},!0)}getChannelState(e,t){return void 0===this.channelStates[e]&&this.addChannelState(e,t),this.channelStates[e]}processUpdate(e,t={}){let s=0;switch(e._){case"updateNewChannelMessage":case"updateEditChannelMessage":s=-c.default.getPeerId(e.message.peer_id);break;case"updateDeleteChannelMessages":s=e.channel_id;break;case"updateChannelTooLong":if(s=e.channel_id,!(s in this.channelStates))return!1}const i=s?this.getChannelState(s,e.pts):this.updatesState;if(i.syncLoading)return!1;if("updateChannelTooLong"==e._)return(!i.lastPtsUpdateTime||i.lastPtsUpdateTime<Date.now()-1e4)&&this.getChannelDifference(s),!1;if("updateNewMessage"==e._||"updateEditMessage"==e._||"updateNewChannelMessage"==e._||"updateEditChannelMessage"==e._){const t=e.message,i=c.default.getPeerId(t.peer_id),n=t.fwd_from||{};let a=!1;if(t.from_id&&!h.default.hasUser(c.default.getPeerId(t.from_id),t.pFlags.post)&&(a="author")||n.from_id&&!h.default.hasUser(c.default.getPeerId(n.from_id),!!n.channel_id)&&(a="fwdAuthor")||n.channel_id&&!l.default.hasChat(n.channel_id,!0)&&(a="fwdChannel")||i>0&&!h.default.hasUser(i)&&(a="toPeer User")||i<0&&!l.default.hasChat(-i)&&(a="toPeer Chat"))return this.log.warn("Not enough data for message update",i,a,t),s&&l.default.hasChat(s)?this.getChannelDifference(s):this.forceGetDifference(),!1}else if(s&&!l.default.hasChat(s))return!1;let n,a;if(e.pts){if(i.pts+(e.pts_count||0)<e.pts)return this.log.warn("Pts hole",i,e,s&&l.default.getChat(s)),i.pendingPtsUpdates.push(e),i.syncPending||(i.syncPending={timeout:window.setTimeout(()=>{s?this.getChannelDifference(s):this.getDifference()},25)}),i.syncPending.ptsAwaiting=!0,!1;if(e.pts>i.pts)i.pts=e.pts,n=!0,i.lastPtsUpdateTime=Date.now();else if(e.pts_count)return!1;s&&t.date&&this.updatesState.date<t.date&&(this.updatesState.date=t.date)}else if(!s&&t.seq>0){const s=t.seq,n=t.seqStart||s;if(n!=i.seq+1&&n>i.seq)return this.log.warn("Seq hole",i,i.syncPending&&i.syncPending.seqAwaiting),void 0===i.pendingSeqUpdates[n]&&(i.pendingSeqUpdates[n]={seq:s,date:t.date,updates:[]}),i.pendingSeqUpdates[n].updates.push(e),i.syncPending||(i.syncPending={timeout:window.setTimeout(()=>{this.getDifference()},25)}),(!i.syncPending.seqAwaiting||i.syncPending.seqAwaiting<n)&&(i.syncPending.seqAwaiting=n),!1;i.seq!=s&&(i.seq=s,t.date&&i.date<t.date&&(i.date=t.date),a=!0)}this.saveUpdate(e),n?this.popPendingPtsUpdate(s):a&&this.popPendingSeqUpdate()}saveUpdate(e){d.default.broadcast("apiUpdate",e)}attach(){this.attached||(this.attached=!0,f.default.getState().then(e=>{const t=e.updates;o.default.setUpdatesProcessor(this.processUpdateMessage),t&&t.pts&&t.date&&t.seq?(Object.assign(this.updatesState,t),this.getDifference(!0)):o.default.invokeApi("updates.getState",{},{noErrorBox:!0}).then(e=>{this.updatesState.seq=e.seq,this.updatesState.pts=e.pts,this.updatesState.date=e.date,setTimeout(()=>{this.updatesState.syncLoading=!1},1e3)})}))}}t.ApiUpdatesManager=u;const p=new u;r.MOUNT_CLASS_TO&&(r.MOUNT_CLASS_TO.apiUpdatesManager=p),t.default=p},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toast=void 0;const i=document.createElement("div");i.classList.add("toast"),t.toast=function(e){i.innerHTML=e,document.body.append(i),i.dataset.timeout&&clearTimeout(+i.dataset.timeout),i.dataset.timeout=""+setTimeout(()=>{i.remove(),delete i.dataset.timeout},3e3)}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(1)),a=s(0),o=s(17);t.default=class{constructor(e,t,s={}){if(this.element=document.createElement("div"),this.container=document.createElement("div"),this.header=document.createElement("div"),this.title=document.createElement("div"),this.onEscape=()=>!0,this._onKeyDown=e=>{"Escape"==e.key&&this.onEscape()&&(a.cancelEvent(e),this.destroy())},this.destroy=()=>{this.onClose&&this.onClose(),this.element.classList.remove("active"),window.removeEventListener("keydown",this._onKeyDown,{capture:!0}),this.btnClose&&this.btnClose.removeEventListener("click",this.destroy),n.default.overlayIsActive=!1,setTimeout(()=>{this.element.remove(),this.onCloseAfterTimeout&&this.onCloseAfterTimeout()},1e3)},this.element.classList.add("popup"),this.element.className="popup"+(e?" "+e:""),this.container.classList.add("popup-container","z-depth-1"),this.header.classList.add("popup-header"),this.title.classList.add("popup-title"),this.header.append(this.title),s.closable&&(this.btnClose=document.createElement("span"),this.btnClose.classList.add("btn-icon","popup-close","tgico-close"),this.header.prepend(this.btnClose),this.btnClose.addEventListener("click",this.destroy,{once:!0}),s.overlayClosable)){const e=e=>{a.findUpClassName(e.target,"popup-container")||this.btnClose.click()};this.element.addEventListener("click",e,{once:!0})}if(window.addEventListener("keydown",this._onKeyDown,{capture:!0}),s.withConfirm&&(this.btnConfirm=document.createElement("button"),this.btnConfirm.classList.add("btn-primary"),this.btnConfirm.innerText=s.withConfirm,this.header.append(this.btnConfirm),o.ripple(this.btnConfirm)),this.container.append(this.header),s.body&&(this.body=document.createElement("div"),this.body.classList.add("popup-body"),this.container.append(this.body)),t&&t.length){const e=document.createElement("div");e.classList.add("popup-buttons");const s=t.map(e=>{const t=document.createElement("button");return t.className="btn"+(e.isDanger?" danger":""),t.innerHTML=e.text,o.ripple(t),e.callback?t.addEventListener("click",()=>{e.callback(),this.destroy()},{once:!0}):e.isCancel&&t.addEventListener("click",()=>{this.destroy()},{once:!0}),t});e.append(...s),this.container.append(e)}this.element.append(this.container)}show(){a.blurActiveElement(),document.body.append(this.element),this.element.offsetWidth,this.element.classList.add("active"),n.default.overlayIsActive=!0}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(32));t.default=(e,t={})=>n.default("btn-icon",Object.assign({icon:e},t))},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppProfileManager=void 0;const a=s(4),o=s(18),r=n(s(5)),d=s(2),l=s(3),c=n(s(1)),f=n(s(35)),h=n(s(19)),u=n(s(40)),p=n(s(10)),g=n(s(20)),m=n(s(8));class b{constructor(){this.botInfos={},this.usersFull={},this.chatsFull={},this.chatFullPromises={},this.channelFullPromises={},this.chatParticipantsPromises={},this.savedAvatarURLs={},c.default.on("apiUpdate",e=>{const t=e.detail;switch(t._){case"updateChatParticipants":{const e=t.participants;if("chatParticipants"==e._){const t=e.chat_id,s=this.chatsFull[t];void 0!==s&&(s.participants=e,c.default.broadcast("chat_full_update",t))}break}case"updateChatParticipantAdd":{const e=this.chatsFull[t.chat_id];if(void 0!==e){const s=e.participants,i=s.participants||[];for(let e=0,s=i.length;e<s;e++)if(i[e].user_id==t.user_id)return;i.push({_:"chatParticipant",user_id:t.user_id,inviter_id:t.inviter_id,date:o.tsNow(!0)}),s.version=t.version,c.default.broadcast("chat_full_update",t.chat_id)}break}case"updateChatParticipantDelete":{const e=this.chatsFull[t.chat_id];if(void 0!==e){const s=e.participants,i=s.participants||[];for(let e=0,n=i.length;e<n;e++)if(i[e].user_id==t.user_id)return i.splice(e,1),s.version=t.version,void c.default.broadcast("chat_full_update",t.chat_id)}break}}}),c.default.on("chat_update",e=>{const t=e.detail,s=this.chatsFull[t],i=h.default.getChat(t);if(!i.photo||!s)return;const n="chatPhotoEmpty"==i.photo._;if(s.chat_photo&&n!=("photoEmpty"==s.chat_photo._))return delete this.chatsFull[t],void c.default.broadcast("chat_full_update",t);if(n)return;const a=i.photo.photo_small,o=g.default.choosePhotoSize(s.chat_photo,0,0);JSON.stringify(a)!==JSON.stringify(o.location)&&(delete this.chatsFull[t],c.default.broadcast("chat_full_update",t))})}saveBotInfo(e){const t=e&&e.user_id;if(!t)return null;const s={};return e.commands.forEach(e=>{s[e.command]=e.description}),this.botInfos[t]={id:t,version:e.version,shareText:e.share_text,description:e.description,commands:s}}getProfile(e,t){return this.usersFull[e]&&!t?Promise.resolve(this.usersFull[e]):r.default.invokeApi("users.getFullUser",{id:m.default.getUserInput(e)}).then(t=>{const s=t.user;return m.default.saveApiUser(s,!0),t.profile_photo&&(t.profile_photo=g.default.savePhoto(t.profile_photo,{type:"profilePhoto",peerId:e})),void 0!==t.about&&(t.rAbout=l.RichTextProcessor.wrapRichText(t.about,{noLinebreaks:!0})),t.bot_info&&(t.bot_info=this.saveBotInfo(t.bot_info)),this.usersFull[e]=t})}getProfileByPeerId(e,t){return e<0?this.getChatFull(-e,t):this.getProfile(e,t)}getFullPhoto(e){return this.getProfileByPeerId(e).then(e=>{switch(e._){case"userFull":return e.profile_photo;case"channelFull":case"chatFull":return e.chat_photo}})}getChatFull(e,t){if(h.default.isChannel(e))return this.getChannelFull(e,t);const s=this.chatsFull[e];if(s&&!t){const t=h.default.getChat(e);if(t.version==s.participants.version||t.pFlags.left)return Promise.resolve(s)}return void 0!==this.chatFullPromises[e]?this.chatFullPromises[e]:this.chatFullPromises[e]=r.default.invokeApi("messages.getFullChat",{chat_id:e}).then(t=>{h.default.saveApiChats(t.chats),m.default.saveApiUsers(t.users);const s=t.full_chat;return s&&s.chat_photo&&s.chat_photo.id&&(s.chat_photo=g.default.savePhoto(s.chat_photo,{type:"profilePhoto",peerId:-e})),delete this.chatFullPromises[e],this.chatsFull[e]=s,c.default.broadcast("chat_full_update",e),s})}getChannelFull(e,t){return void 0===this.chatsFull[e]||t?void 0!==this.channelFullPromises[e]?this.channelFullPromises[e]:this.channelFullPromises[e]=r.default.invokeApi("channels.getFullChannel",{channel:h.default.getChannelInput(e)}).then(t=>{h.default.saveApiChats(t.chats),m.default.saveApiUsers(t.users);const s=t.full_chat;return s&&s.chat_photo.id&&(s.chat_photo=g.default.savePhoto(s.chat_photo,{type:"profilePhoto",peerId:-e})),delete this.channelFullPromises[e],this.chatsFull[e]=s,c.default.broadcast("chat_full_update",e),s},t=>{switch(t.type){case"CHANNEL_PRIVATE":let t=h.default.getChat(e);t={_:"channelForbidden",access_hash:t.access_hash,title:t.title},f.default.processUpdateMessage({_:"updates",updates:[{_:"updateChannel",channel_id:e}],chats:[t],users:[]})}return Promise.reject(t)}):Promise.resolve(this.chatsFull[e])}invalidateChannelParticipants(e){delete this.chatsFull[e],delete this.chatFullPromises[e];for(let t in this.chatParticipantsPromises)+t.split("_")[0]==e&&delete this.chatParticipantsPromises[t];c.default.broadcast("chat_full_update",e)}updateProfile(e,t,s){return r.default.invokeApi("account.updateProfile",{first_name:e,last_name:t,about:s}).then(e=>(m.default.saveApiUser(e),this.getProfile(c.default.myId,!0)))}uploadProfilePhoto(e){return r.default.invokeApi("photos.uploadProfilePhoto",{file:e}).then(e=>{m.default.saveApiUsers(e.users);const t=c.default.myId;g.default.savePhoto(e.photo,{type:"profilePhoto",peerId:t}),f.default.processUpdateMessage({_:"updateShort",update:{_:"updateUserPhoto",user_id:t,date:o.tsNow(!0),photo:m.default.getUser(t).photo,previous:!0}})})}updateUsername(e){return r.default.invokeApi("account.updateUsername",{username:e}).then(e=>{m.default.saveApiUser(e)})}removeFromAvatarsCache(e){this.savedAvatarURLs[e]&&delete this.savedAvatarURLs[e]}putAvatar(e,t,s){return i(this,void 0,void 0,(function*(){const i=p.default.getInputPeerById(t);if(this.savedAvatarURLs[t])"string"!=typeof this.savedAvatarURLs[t]&&(yield this.savedAvatarURLs[t]);else{const e={_:"inputPeerPhotoFileLocation",peer:i,volume_id:s.photo_small.volume_id,local_id:s.photo_small.local_id},n={dcId:s.dc_id,location:e},a=u.default.download(n);yield(this.savedAvatarURLs[t]=a).then(e=>{this.savedAvatarURLs[t]=URL.createObjectURL(e)})}const n=new Image;a.renderImageFromUrl(n,this.savedAvatarURLs[t])?(e.innerHTML="",e.append(n),e.style.backgroundColor=""):(n.classList.add("fade-in"),n.addEventListener("load",()=>{e.innerHTML="",e.append(n),setTimeout(()=>{e.childElementCount&&(e.style.backgroundColor="",n.classList.remove("fade-in"))},200)}))}))}putPhoto(e,t,s=!1,n=""){var a;return i(this,void 0,void 0,(function*(){const i=p.default.getPeerPhoto(t),o=i&&!i.empty&&i.photo_small,r=!!e.firstElementChild,d=c.default.myId;if(t==d&&s)return e.innerHTML="",e.style.backgroundColor="",e.classList.add("tgico-savedmessages"),void e.classList.remove("tgico-avatar_deletedaccount");if(t>0){const s=m.default.getUser(t);if(s&&s.pFlags&&s.pFlags.deleted)return e.innerHTML="",e.style.backgroundColor=p.default.getPeerColorById(t),e.classList.add("tgico-avatar_deletedaccount"),void e.classList.remove("tgico-savedmessages")}if(!o||!r||!this.savedAvatarURLs[t]){let i,o="";!t||t==d&&s||(o=p.default.getPeerColorById(t)),e.innerHTML="",e.classList.remove("tgico-savedmessages","tgico-avatar_deletedaccount"),e.style.backgroundColor=o,i=n?l.RichTextProcessor.getAbbreviation(n):null!==(a=p.default.getPeer(t).initials)&&void 0!==a?a:"",e.innerHTML=i}return o?this.putAvatar(e,t,i):void 0}))}}t.AppProfileManager=b;const v=new b;d.MOUNT_CLASS_TO&&(d.MOUNT_CLASS_TO.appProfileManager=v),t.default=v},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppDownloadManager=void 0;const n=i(s(1)),a=i(s(5)),o=s(30),r=i(s(45)),d=s(70),l=i(s(80));class c{constructor(){this.cacheStorage=new l.default("cachedFiles"),this.downloads={},this.progress={},this.progressCallbacks={},this.uploadId=0,n.default.on("download_progress",e=>{const t=e.detail;this.progress[t.fileName]=t;const s=this.progressCallbacks[t.fileName];s&&s.forEach(e=>e(t));const i=this.downloads[t.fileName];i&&i.notifyAll(t)})}getNewDeferred(e){const t=o.deferredPromise();return t.cancel=()=>{const s=new Error("Download canceled");s.name="AbortError",a.default.cancelDownload(e),this.clearDownload(e),t.reject(s),t.cancel=()=>{}},t.finally(()=>{delete this.progress[e],delete this.progressCallbacks[e]}),this.downloads[e]=t}clearDownload(e){delete this.downloads[e]}download(e){const t=d.getFileNameByLocation(e.location,{fileName:e.fileName});if(this.downloads.hasOwnProperty(t))return this.downloads[t];const s=this.getNewDeferred(t),i=t=>{var i;switch(t.type){case"FILE_REFERENCE_EXPIRED":{const t=null===(i=null==e?void 0:e.location)||void 0===i?void 0:i.file_reference;if(t){r.default.refreshReference(t).then(n);break}console.warn("FILE_REFERENCE_EXPIRED: no context for bytes:",t)}default:s.reject(t)}},n=()=>a.default.worker?a.default.downloadFile(e).then(s.resolve,i):this.cacheStorage.getFile(t).then(t=>{if(t.size<e.size)throw"wrong size";s.resolve(t)}).catch(()=>a.default.downloadFile(e).then(s.resolve,i));return n(),s}upload(e,t){if(!t){const s=null==e?void 0:e.type;if(s){const e=this.uploadId+++"."+s.split("/")[1];t=["image/jpeg","image/png","image/bmp"].indexOf(s)>=0?"photo"+e:0===s.indexOf("audio/")||["video/ogg"].indexOf(s)>=0?"audio"+e:0===s.indexOf("video/")?"video"+e:"document"+e}else t="upload-"+this.uploadId++}const s=this.getNewDeferred(t);return a.default.uploadFile({file:e,fileName:t}).then(s.resolve,s.reject),s.finally(()=>{this.clearDownload(t)}),s}getDownload(e){return this.downloads[e]}addProgressCallback(e,t){var s;const i=this.progress[e];(null!==(s=this.progressCallbacks[e])&&void 0!==s?s:this.progressCallbacks[e]=[]).push(t),i&&t(i)}createDownloadAnchor(e,t,s){const i=document.createElement("a");i.href=e,i.download=t,i.target="_blank",i.style.position="absolute",i.style.top="1px",i.style.left="1px",document.body.append(i);try{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)}catch(t){console.error("Download click error",t);try{i.click()}catch(t){window.open(e,"_blank")}}setTimeout(()=>{i.remove(),s&&s()},100)}downloadToDisc(e,t){const s=this.download(e);return s.then(e=>{const s=URL.createObjectURL(e);this.createDownloadAnchor(s,t,()=>{URL.revokeObjectURL(s)})}),s}}t.AppDownloadManager=c,t.default=new c},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(119));t.default=class{constructor(e,t,s,i,n){this.isAuthPage=t,this.onFirstMount=s,this.onMount=i,this.onShown=n,this.installed=!1,this.pageEl=document.body.getElementsByClassName(e)[0]}mount(...e){return i(this,void 0,void 0,(function*(){if(this.onMount&&this.onMount(...e),!this.installed){if(this.onFirstMount)try{const t=this.onFirstMount(...e);t instanceof Promise&&(yield t)}catch(e){console.error("PAGE MOUNT ERROR:",e)}this.installed=!0}a.default.setPage(this)}))}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=r(s(7)),l=r(s(39)),c=r(s(1)),f=s(0),h=a(s(71));c.default.on("avatar_update",e=>{let t=e.detail;l.default.removeFromAvatarsCache(t),Array.from(document.querySelectorAll('avatar-element[peer="'+t+'"]')).forEach(e=>{e.update()})});class u extends HTMLElement{constructor(){super(),this.isDialog=!1,this.addedToQueue=!1}connectedCallback(){if(this.isDialog=!!this.getAttribute("dialog"),""===this.getAttribute("clickable")){this.setAttribute("clickable","set");let e=!1;f.attachClickEvent(this,t=>o(this,void 0,void 0,(function*(){if(f.cancelEvent(t),e)return;const s=this.peerId;e=!0;const i=yield l.default.getFullPhoto(this.peerId);if(this.peerId==s&&i){if(s<0){const t=Number.MAX_SAFE_INTEGER,n="inputMessagesFilterChatPhotos";let a=yield d.default.getSearch({peerId:s,inputFilter:{_:n},maxId:t,limit:2,backLimit:1}).then(e=>e.history[0]);if(a){a.action.photo.id!=i.id&&(a={_:"message",mid:t,media:{_:"messageMediaPhoto",photo:i},peerId:s,date:i.date,fromId:s},d.default.getMessagesStorage(s)[t]=a);const o=Array.from(this.querySelectorAll("img")).find(e=>!e.classList.contains("emoji"));return(new h.default).setSearchContext({peerId:s,inputFilter:n}).openMedia(a,o?this:null),void(e=!1)}}if(i){const e=Array.from(this.querySelectorAll("img")).find(e=>!e.classList.contains("emoji"));new h.AppMediaViewerAvatar(s).openMedia(i.id,e?this:null)}e=!1}else e=!1})))}}disconnectedCallback(){this.lazyLoadQueue&&this.lazyLoadQueue.unobserve(this)}static get observedAttributes(){return["peer","dialog","peer-title"]}attributeChangedCallback(e,t,s){if("peer"==e){if(this.peerId==+s)return;this.peerId=+s,this.update()}else"peer-title"==e?this.peerTitle=s:"dialog"==e&&(this.isDialog=!!+s)}update(){if(this.lazyLoadQueue){if(this.addedToQueue)return;this.lazyLoadQueue.push({div:this,load:()=>l.default.putPhoto(this,this.peerId,this.isDialog,this.peerTitle).finally(()=>{this.addedToQueue=!1})}),this.addedToQueue=!0}else l.default.putPhoto(this,this.peerId,this.isDialog,this.peerTitle)}}t.default=u,customElements.define("avatar-element",u)},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(28));t.default=class{constructor(e,t){this.prevValue="",this.timeout=0,this.onInput=()=>{if(!this.onChange)return;let e=this.value;e!==this.prevValue&&(this.prevValue=e,clearTimeout(this.timeout),this.timeout=window.setTimeout(()=>{this.onChange(e)},200))},this.onClearClick=()=>{this.value="",this.onChange&&this.onChange(""),this.onClear&&this.onClear()},this.inputField=new n.default({placeholder:e,plainText:!0}),this.container=this.inputField.container,this.container.classList.remove("input-field"),this.container.classList.add("input-search"),this.onChange=t,this.input=this.inputField.input,this.input.classList.add("input-search-input");const s=document.createElement("span");s.classList.add("tgico","tgico-search"),this.clearBtn=document.createElement("span"),this.clearBtn.classList.add("tgico","btn-icon","tgico-close"),this.input.addEventListener("input",this.onInput),this.clearBtn.addEventListener("click",this.onClearClick),this.container.append(this.input,s,this.clearBtn)}get value(){return this.inputField.value}set value(e){this.prevValue=e,clearTimeout(this.timeout),this.inputField.value=e}remove(){clearTimeout(this.timeout),this.input.removeEventListener("input",this.onInput),this.clearBtn.removeEventListener("click",this.onClearClick)}}},function(e,t,s){"use strict";function i(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function n(e){return new Uint8Array(e).buffer}Object.defineProperty(t,"__esModule",{value:!0}),t.bytesToWordss=t.bytesFromWordss=t.bufferConcats=t.bufferConcat=t.bytesFromArrayBuffer=t.convertToUint8Array=t.convertToArrayBuffer=t.bytesToArrayBuffer=t.bytesXor=t.bytesCmp=t.uint6ToBase64=t.bytesToBase64=t.bytesFromHex=t.bytesToHex=void 0,t.bytesToHex=function(e){e=e||[];for(var t=[],s=0;s<e.length;s++)t.push((e[s]<16?"0":"")+(e[s]||0).toString(16));return t.join("")},t.bytesFromHex=function(e){var t,s=e.length,i=0,n=[];for(e.length%2&&(n.push(parseInt(e.charAt(0),16)),i++),t=i;t<s;t+=2)n.push(parseInt(e.substr(t,2),16));return n},t.bytesToBase64=function(e){for(var t,s="",n=e.length,a=0,o=0;o<n;o++)t=o%3,a|=e[o]<<(16>>>t&24),2!==t&&n-o!=1||(s+=String.fromCharCode(i(a>>>18&63),i(a>>>12&63),i(a>>>6&63),i(63&a)),a=0);return s.replace(/A(?=A$|$)/g,"=")},t.uint6ToBase64=i,t.bytesCmp=function(e,t){var s=e.length;if(s!=t.length)return!1;for(var i=0;i<s;i++)if(e[i]!=t[i])return!1;return!0},t.bytesXor=function(e,t){for(var s=e.length,i=[],n=0;n<s;++n)i[n]=e[n]^t[n];return i},t.bytesToArrayBuffer=n,t.convertToArrayBuffer=function(e){return e instanceof ArrayBuffer?e:void 0!==e.buffer&&e.buffer.byteLength==e.length*e.BYTES_PER_ELEMENT?e.buffer:n(e)},t.convertToUint8Array=function(e){return void 0!==e.buffer?e:new Uint8Array(e)},t.bytesFromArrayBuffer=function(e){for(var t=e.byteLength,s=new Uint8Array(e),i=[],n=0;n<t;++n)i[n]=s[n];return i},t.bufferConcat=function(e,t){var s=e.byteLength||e.length,i=t.byteLength||t.length,n=new Uint8Array(s+i);return n.set(e instanceof ArrayBuffer?new Uint8Array(e):e,0),n.set(t instanceof ArrayBuffer?new Uint8Array(t):t,s),n.buffer},t.bufferConcats=function(...e){let t=0;e.forEach(e=>t+=e.byteLength||e.length);var s=new Uint8Array(t);let i=0;return e.forEach(e=>{s.set(e instanceof ArrayBuffer?new Uint8Array(e):e,i),i+=e.byteLength||e.length}),s},t.bytesFromWordss=function(e){for(var t=[],s=0;s<4*e.length;s++)t.push(e[s>>>2]>>>24-s%4*8&255);return t},t.bytesToWordss=function(e){let t;t=e instanceof ArrayBuffer?new Uint8Array(e):e;var s,i=t.length,n=[];for(s=0;s<i;s++)n[s>>>2]|=t[s]<<24-s%4*8;return new Uint32Array(n)}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(7)),a=s(2),o=s(44),r=s(14);const d=new class{constructor(){this.contexts=new Map,this.links={}}saveContext(e,t,s){[s,e]=this.getContexts(e),s||(s=new Set,this.contexts.set(e,s),this.links[o.bytesToHex(e)]=e);for(const e of s)if(r.deepEqual(e,t))return;s.add(t)}getReferenceByLink(e){return this.links[o.bytesToHex(e)]}getContexts(e){return[this.contexts.get(e)||(e=this.getReferenceByLink(e)||e,this.contexts.get(e)),e]}getContext(e){const t=this.getContexts(e);return t?[t[0].values().next().value,t[1]]:void 0}deleteContext(e,t,s){if([s,e]=this.getContexts(e),s)for(const i of s)if(r.deepEqual(i,t))return s.delete(i),s.size||(this.contexts.delete(e),delete this.links[o.bytesToHex(e)]),!0;return!1}refreshReference(e,t){switch([t,e]=this.getContext(e),null==t?void 0:t.type){case"message":return n.default.wrapSingleMessage(t.peerId,t.messageId,!0);default:return console.warn("FILE_REFERENCE_EXPIRED: not implemented context",t),Promise.reject()}}};a.MOUNT_CLASS_TO&&(a.MOUNT_CLASS_TO.referenceDatabase=d),t.default=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0);t.default=class{constructor(e,t=!0,s=!1,n="append"){this.cancelable=t,this.attachMethod=n,this.tempId=0,this.detached=!0,this.promise=null,this.preloader=document.createElement("div"),this.preloader.classList.add("preloader-container"),s&&this.preloader.classList.add("preloader-streamable"),this.preloader.innerHTML=`\n    <div class="you-spin-me-round">\n    <svg xmlns="http://www.w3.org/2000/svg" class="preloader-circular" viewBox="25 25 50 50">\n    <circle class="preloader-path-new" cx="50" cy="50" r="${s?19:23}" fill="none" stroke-miterlimit="10"/>\n    </svg>\n    </div>`,t?this.preloader.innerHTML+='\n      <svg xmlns="http://www.w3.org/2000/svg" class="preloader-close" viewBox="0 0 20 20">\n      <line x1="0" y1="20" x2="20" y2="0" stroke-width="2" stroke-linecap="round"></line>\n      <line x1="0" y1="0" x2="20" y2="20" stroke-width="2" stroke-linecap="round"></line>\n      </svg>':this.preloader.classList.add("preloader-swing"),this.circle=this.preloader.firstElementChild.firstElementChild.firstElementChild,e&&this.attach(e),this.cancelable&&i.attachClickEvent(this.preloader,e=>{i.cancelEvent(e),this.promise&&this.promise.cancel&&(this.promise.cancel(),this.setProgress(0),setTimeout(()=>{this.detach()},100))})}attachPromise(e){this.promise=e;const t=--this.tempId;e.finally(()=>{e.notify=null,t===this.tempId&&(this.detach(),this.promise=e=null)}),e.addNotifyListener&&e.addNotifyListener(e=>{if(t!==this.tempId)return;const s=e.done/e.total*100;this.setProgress(s)})}attach(e,t=!1,s){s&&this.attachPromise(s),this.detached=!1,window.requestAnimationFrame(()=>{this.detached||(this.detached=!1,e[this.attachMethod](this.preloader),this.cancelable&&t&&this.setProgress(0))})}detach(){this.detached=!0,this.preloader.parentElement&&window.requestAnimationFrame(()=>{this.detached&&(this.detached=!0,this.preloader.parentElement&&this.preloader.remove())})}setProgress(e){if(i.isInDOM(this.circle))if(0!==e)try{const t=this.circle.getTotalLength();this.circle.style.strokeDasharray=Math.max(5,e/100*t)+", 200"}catch(e){}else this.circle.style.strokeDasharray=""}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.horizontalMenu=void 0;const i=s(0),n=s(87);t.horizontalMenu=function(e,t,s,a,o=250){const r=n.TransitionSlider(t,e||"tabs"==t.dataset.slider?"tabs":"navigation",o,a);if(e){const n=new Proxy(r,{apply:(t,s,i)=>{const n=+i[0],o=void 0===i[1]||i[1],r=e.querySelector(`[data-tab="${n}"]`)||e.children[n];a(r,n,o)}}),a=(i,n,a=!0)=>{const l=t.children[n];if(s&&s(n,l),i.classList.contains("active")||n===r.prevId)return!1;const c=e.querySelector(d.toLowerCase()+".active");if(c&&c.classList.remove("active"),o&&-1!==r.prevId&&a){const e=i.querySelector("i"),t=i.parentElement.children[r.prevId].querySelector("i");t.classList.remove("animate"),e.classList.remove("animate");const s=t.parentElement.parentElement.offsetLeft-e.parentElement.parentElement.offsetLeft,n=t.clientWidth/e.clientWidth;e.style.transform=`translate3d(${s}px, 0, 0) scale3d(${n}, 1, 1)`,requestAnimationFrame(()=>{e.classList.add("animate"),e.style.transform="none"})}i.classList.add("active"),r(n,a)},o=!e.classList.contains("no-stripe"),d=e.classList.contains("menu-horizontal-div")?"BUTTON":"LI";return e.addEventListener("click",(function(e){let t,s=e.target;if(s.tagName!=d&&(s=i.findUpTag(s,d)),!s)return!1;if(s.dataset.tab){if(t=+s.dataset.tab,-1==t)return!1}else t=i.whichChild(s);a(s,t)})),n}return r}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=r(s(13));const l=new(r(s(41)).default)("page-chats",!1,()=>{d.default.pushToState("authState",{_:"authStateSignedIn"});const e=Promise.resolve().then(()=>a(s(23)));return e.finally(()=>o(void 0,void 0,void 0,(function*(){const e=yield Promise.resolve().then(()=>a(s(64)));Array.from(document.getElementsByClassName("btn-menu-toggle")).forEach(t=>{e.ButtonMenuToggleHandler(t)})}))),e});t.default=l},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SearchGroup=void 0;const n=i(s(23)),a=i(s(6)),o=i(s(7));t.SearchGroup=class{constructor(e,t,s=!0,i,a=!0,o=!0){this.name=e,this.type=t,this.clearable=s,this.autonomous=o,this.list=document.createElement("ul"),this.container=document.createElement("div"),i&&(this.container.className=i),e&&(this.nameEl=document.createElement("div"),this.nameEl.classList.add("search-group__name"),this.nameEl.innerText=e,this.container.append(this.nameEl)),this.container.classList.add("search-group","search-group-"+t),this.container.append(this.list),this.container.style.display="none",a&&n.default.setListClickListener(this.list,void 0,void 0,o)}clear(){this.container.style.display="none",this.clearable&&(this.list.innerHTML="")}setActive(){this.container.style.display=""}toggle(){this.list.childElementCount?this.setActive():this.clear()}};t.default=class{constructor(e,t,s,i){this.container=e,this.searchInput=t,this.searchGroups=s,this.onSearch=i,this.minMsgId=0,this.loadedCount=-1,this.foundCount=-1,this.searchPromise=null,this.searchTimeout=0,this.query="",this.listsContainer=null,this.peerId=0,this.threadId=0,this.scrollable=new a.default(this.container),this.listsContainer=this.scrollable.container;for(let e in this.searchGroups)this.listsContainer.append(this.searchGroups[e].container);this.searchGroups.messages&&this.scrollable.setVirtualContainer(this.searchGroups.messages.list),this.searchInput.onChange=e=>{this.query=e,this.reset(!1),this.searchMore()},this.scrollable.onScrolledBottom=()=>{this.query.trim()&&(this.searchTimeout||(this.searchTimeout=window.setTimeout(()=>{this.searchMore(),this.searchTimeout=0},0)))}}reset(e=!0){e&&(this.searchInput.value="",this.query="",this.peerId=0,this.threadId=0),this.minMsgId=0,this.loadedCount=-1,this.foundCount=-1;for(let e in this.searchGroups)this.searchGroups[e].clear();this.searchPromise=null}beginSearch(e,t){e&&(this.peerId=e),t&&(this.threadId=t),this.searchInput.input.focus()}searchMore(){if(this.searchPromise)return this.searchPromise;const e=this.query;if(!e.trim())return void(this.onSearch&&this.onSearch(0));if(-1!=this.foundCount&&this.loadedCount>=this.foundCount)return Promise.resolve();const t=this.minMsgId||0;return this.searchPromise=o.default.getSearch({peerId:this.peerId,query:e,inputFilter:{_:"inputMessagesFilterEmpty"},maxId:t,limit:20,threadId:this.threadId}).then(t=>{if(this.searchPromise=null,this.searchInput.value!==e)return;const{count:s,history:i}=t;i.length&&i[0].mid===this.minMsgId&&i.shift();const a=this.searchGroups.messages;i.forEach(t=>{const{dialog:s,dom:i}=n.default.addDialogNew({dialog:t.peerId,container:this.scrollable,drawStatus:!1,avatarSize:54});n.default.setLastMessage(s,t,i,e)}),a.toggle(),this.minMsgId=i.length&&i[i.length-1].mid,-1===this.loadedCount&&(this.loadedCount=0),this.loadedCount+=i.length,-1===this.foundCount&&(this.foundCount=s,this.onSearch&&this.onSearch(this.foundCount))}).catch(e=>{console.error("search error",e),this.searchPromise=null})}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(1)),a=i(s(7)),o=i(s(21)),r=s(30),d=s(12),l=s(2);const c=new class{constructor(){this.media={},this.waitingMediaForLoad={},this.onPause=e=>{n.default.broadcast("audio_pause")},this.onEnded=e=>{if(this.onPause(e),this.nextMid){const e=this.media[this.currentPeerId][this.nextMid];this.resolveWaitingForLoadMedia(this.currentPeerId,this.nextMid),setTimeout(()=>{e.play()},0)}},this.container=document.createElement("div"),this.container.style.cssText="display: none;",document.body.append(this.container)}addMedia(e,t,s,i=!0){var a,l;const c=null!==(a=this.media[e])&&void 0!==a?a:this.media[e]={};if(c[s])return c[s];const f=document.createElement("round"==t.type?"video":"audio");"round"==t.type&&f.setAttribute("playsinline","true"),f.dataset.mid=""+s,f.dataset.type=t.type,f.volume=1,this.container.append(f),f.addEventListener("playing",()=>{this.currentPeerId=e,this.playingMedia!=f&&(this.playingMedia&&!this.playingMedia.paused&&this.playingMedia.pause(),this.playingMedia=f,this.loadSiblingsMedia(e,t.type,s)),setTimeout(()=>{n.default.broadcast("audio_play",{peerId:e,doc:t,mid:s})},0)}),f.addEventListener("pause",this.onPause),f.addEventListener("ended",this.onEnded);const h=i=>{this.nextMid==s&&this.loadSiblingsMedia(e,t.type,s).then(()=>{this.nextMid&&c[this.nextMid]&&c[this.nextMid].play()})};f.addEventListener("error",h);const u=r.deferredPromise();if(i)u.resolve();else{(null!==(l=this.waitingMediaForLoad[e])&&void 0!==l?l:this.waitingMediaForLoad[e]={})[s]=u}const p=t.supportsStreaming?Promise.resolve():o.default.downloadDoc(t);return Promise.all([u,p]).then(()=>{"audio"==t.type&&t.supportsStreaming&&d.isSafari&&this.handleSafariStreamable(f),f.src=t.url},h),c[s]=f}handleSafariStreamable(e){e.addEventListener("play",()=>{const t=e.currentTime;e.addEventListener("progress",()=>{e.currentTime=e.duration-1,e.addEventListener("progress",()=>{e.currentTime=t,e.paused||e.play()},{once:!0})},{once:!0})})}resolveWaitingForLoadMedia(e,t){var s;const i=null!==(s=this.waitingMediaForLoad[e])&&void 0!==s?s:this.waitingMediaForLoad[e]={},n=i[t];n&&(n.resolve(),delete i[t])}isSafariBuffering(e){return!!e.safariBuffering}setSafariBuffering(e,t){e.safariBuffering=t}loadSiblingsMedia(e,t,s){const i=this.playingMedia;return this.prevMid=this.nextMid=0,a.default.getSearch({peerId:e,query:"",inputFilter:{_:"audio"==t?"inputMessagesFilterMusic":"inputMessagesFilterRoundVoice"},maxId:s,limit:3,backLimit:2}).then(t=>{if(this.playingMedia===i){for(const{mid:e}of t.history)if(e>s)this.nextMid=e;else if(e<s){this.prevMid=e;break}[this.prevMid,this.nextMid].filter(Boolean).forEach(t=>{const s=a.default.getMessageByPeer(e,t);this.addMedia(e,s.media.document,t,!1)})}})}toggle(){this.playingMedia&&(this.playingMedia.paused?this.playingMedia.play():this.playingMedia.pause())}pause(){this.playingMedia&&!this.playingMedia.paused&&this.playingMedia.pause()}willBePlayed(e){this.willBePlayedMedia=e}};l.MOUNT_CLASS_TO&&(l.MOUNT_CLASS_TO.appMediaPlaybackController=c),t.default=c},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppStickersManager=void 0;const a=n(s(5)),o=s(2),r=n(s(1)),d=n(s(21)),l=n(s(13));class c{constructor(){this.stickerSets={},this.getStickerSetPromises={},this.getStickersByEmoticonsPromises={},l.default.getState().then(({stickerSets:e})=>{if(e){for(let t in e){let s=e[t];this.saveStickers(s.documents)}this.stickerSets=e}this.getStickerSet({id:"emoji",access_hash:""},{overwrite:!0})}),r.default.on("apiUpdate",e=>{const t=e.detail;switch(t._){case"updateNewStickerSet":this.saveStickerSet(t.stickerset,t.stickerset.set.id),r.default.broadcast("stickers_installed",t.stickerset.set)}})}saveStickers(e){e.forEachReverse((t,s)=>{(t=d.default.saveDoc(t))?e[s]=t:e.splice(s,1)})}getStickerSet(e,t={}){var s;return i(this,void 0,void 0,(function*(){if(this.stickerSets[e.id]&&!t.overwrite&&(null===(s=this.stickerSets[e.id].documents)||void 0===s?void 0:s.length))return this.stickerSets[e.id];if(this.getStickerSetPromises[e.id])return this.getStickerSetPromises[e.id];const i=this.getStickerSetPromises[e.id]=a.default.invokeApi("messages.getStickerSet",{stickerset:this.getStickerSetInput(e)}),n=yield i;return delete this.getStickerSetPromises[e.id],this.saveStickerSet(n,e.id),n}))}getRecentStickers(){return i(this,void 0,void 0,(function*(){const e=yield a.default.invokeApiHashable("messages.getRecentStickers");return this.saveStickers(e.stickers),e}))}getAnimatedEmojiSticker(e){let t=this.stickerSets.emoji;if(!t||!t.documents)return;e=e.replace(/\ufe0f/g,"").replace(/🏻|🏼|🏽|🏾|🏿/g,"");const s=t.packs.find(t=>t.emoticon==e);return s?d.default.getDoc(s.documents[0]):void 0}saveStickerSet(e,t){const s={_:"messages.stickerSet",set:e.set,packs:e.packs,documents:e.documents};this.stickerSets[t]?Object.assign(this.stickerSets[t],s):this.stickerSets[t]=s,this.saveStickers(e.documents),this.saveSetsTimeout||(this.saveSetsTimeout=window.setTimeout(()=>{const e={};for(const t in this.stickerSets){const s=this.stickerSets[t];(s.set.installed_date||"emoji"==t)&&(e[t]=s)}l.default.pushToState("stickerSets",e),l.default.saveState(),this.saveSetsTimeout=0},100))}getStickerSetThumbDownloadOptions(e){var t;const s=e.thumb,i=e.thumb_dc_id,n=null===(t=e.pFlags)||void 0===t?void 0:t.animated;return{dcId:i,location:{_:"inputStickerSetThumb",stickerset:this.getStickerSetInput(e),volume_id:s.location.volume_id,local_id:s.location.local_id},size:s.size,mimeType:n?"application/x-tgsticker":"image/webp"}}getStickerSetInput(e){return"emoji"==e.id?{_:"inputStickerSetAnimatedEmoji"}:{_:"inputStickerSetID",id:e.id,access_hash:e.access_hash}}getFeaturedStickers(){return i(this,void 0,void 0,(function*(){const e=yield a.default.invokeApiHashable("messages.getFeaturedStickers");return e.sets.forEach(e=>{this.saveStickerSet({set:e.set,documents:[],packs:[]},e.set.id)}),e.sets}))}toggleStickerSet(e){return i(this,void 0,void 0,(function*(){if(e.installed_date){if(yield a.default.invokeApi("messages.uninstallStickerSet",{stickerset:this.getStickerSetInput(e)}))return delete e.installed_date,r.default.broadcast("stickers_deleted",e),!0}else{if(yield a.default.invokeApi("messages.installStickerSet",{stickerset:this.getStickerSetInput(e),archived:!1}))return e.installed_date=Date.now()/1e3|0,r.default.broadcast("stickers_installed",e),!0}return!1}))}searchStickerSets(e,t=!0){return i(this,void 0,void 0,(function*(){const s=t?1:0,i=yield a.default.invokeApiHashable("messages.searchStickerSets",{flags:s,exclude_featured:t||void 0,q:e});i.sets.forEach(e=>{this.saveStickerSet({set:e.set,documents:[],packs:[]},e.set.id)});const n=[];for(let t in this.stickerSets){const{set:s}=this.stickerSets[t];s.title.toLowerCase().includes(e.toLowerCase())&&!i.sets.find(e=>e.set.id==s.id)&&n.push({_:"stickerSetCovered",set:s,cover:null})}return i.sets.concat(n)}))}getAllStickers(){return a.default.invokeApiHashable("messages.getAllStickers")}preloadStickerSets(){return this.getAllStickers().then(e=>Promise.all(e.sets.map(e=>this.getStickerSet(e))))}getStickersByEmoticon(e){return this.getStickersByEmoticonsPromises[e]?this.getStickersByEmoticonsPromises[e]:this.getStickersByEmoticonsPromises[e]=Promise.all([a.default.invokeApiHashable("messages.getStickers",{emoticon:e}),this.preloadStickerSets(),this.getRecentStickers()]).then(([t,s,i])=>{const n=t.stickers.map(e=>d.default.saveDoc(e)),a=[],o=[],r=t=>{for(const s of t)if(s.emoticon.includes(e))for(const e of s.documents){const t=d.default.getDoc(e);(t.animated?a:o).push(t)}};r(i.packs);for(const e of s)r(e.packs);return[...new Set(a.concat(o,n))]})}}t.AppStickersManager=c;const f=new c;o.MOUNT_CLASS_TO&&(o.MOUNT_CLASS_TO.appStickersManager=f),t.default=f},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(11),o=n(s(15)),r=n(s(72)),d=n(s(37));class l extends d.default{constructor(e,t,s,n){super("popup-forward",null,{closable:!0,overlayClosable:!0,body:!0}),n&&(this.onClose=n),this.selector=new r.default(this.body,()=>i(this,void 0,void 0,(function*(){const i=this.selector.getSelected()[0];this.btnClose.click(),this.selector=null,yield s&&s()||Promise.resolve(),o.default.setInnerPeer(i),o.default.chat.input.initMessagesForward(e,t.slice())})),["dialogs","contacts"],()=>{this.show(),this.selector.checkForTriggers(),a.isTouchSupported||this.selector.input.focus()},null,"send",!1),this.selector.input.placeholder="Forward to...",this.title.append(this.selector.input)}}t.default=l},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EmoticonsDropdown=t.EMOTICONSSTICKERGROUP=void 0;const a=s(11),o=n(s(19)),r=n(s(15)),d=s(2),l=n(s(1)),c=s(0),f=n(s(22)),h=s(47),u=n(s(25)),p=n(s(29)),g=n(s(97)),m=n(s(149)),b=n(s(150)),v=n(s(100)),y=s(34);t.EMOTICONSSTICKERGROUP="emoticons-dropdown";class M{constructor(){this.tabId=-1,this.events={onClose:[],onCloseAfter:[],onOpen:[],onOpenAfter:[]},this.forceClose=!1,this.onMouseOut=e=>{if(!this.element.classList.contains("active"))return;const t=e.toElement;t&&c.findUpClassName(t,"emoji-dropdown")||(clearTimeout(this.displayTimeout),this.displayTimeout=window.setTimeout(()=>{this.toggle(!1)},200))},this.onSelectTabClick=e=>{this.tabId!=e&&(f.default.checkAnimations(!0,t.EMOTICONSSTICKERGROUP),this.tabId=e,this.searchButton.classList.toggle("hide",0==this.tabId),this.deleteBtn.classList.toggle("hide",0!=this.tabId))},this.checkRights=()=>{const e=r.default.chat.peerId,t=this.tabsEl.children,s=Array.from(t),i=e>0||o.default.hasRights(e,"send","send_stickers");s[2].toggleAttribute("disabled",!i);const n=e>0||o.default.hasRights(e,"send","send_gifs");s[3].toggleAttribute("disabled",!n);const a=this.tabsEl.querySelector(".active");!a||1==c.whichChild(a)||i&&n||(this.selectTab(0),this.onSelectTabClick(0),a.classList.remove("active"),t[1].classList.add("active"))},this.toggle=e=>i(this,void 0,void 0,(function*(){const s=!!this.element.style.display&&void 0===e||e;if(this.init){if(!s)return;this.init(),this.init=null}a.isTouchSupported&&s&&(r.default.chat.input.saveScroll(),document.activeElement.blur(),yield y.pause(100)),this.element.parentElement!==r.default.chat.input.chatInput&&r.default.chat.input.chatInput.append(this.element),this.element.style.display&&void 0===e||e?(this.events.onOpen.forEach(e=>e()),M.lazyLoadQueue.lock(),f.default.lockIntersectionGroup(t.EMOTICONSSTICKERGROUP),this.element.style.display="",this.element.offsetLeft,this.element.classList.add("active"),clearTimeout(this.displayTimeout),this.displayTimeout=window.setTimeout(()=>{f.default.unlockIntersectionGroup(t.EMOTICONSSTICKERGROUP),M.lazyLoadQueue.unlock(),M.lazyLoadQueue.refresh(),this.forceClose=!1,this.container.classList.remove("disable-hover"),this.events.onOpenAfter.forEach(e=>e())},a.isTouchSupported?0:200)):(this.events.onClose.forEach(e=>e()),M.lazyLoadQueue.lock(),f.default.lockIntersectionGroup(t.EMOTICONSSTICKERGROUP),f.default.checkAnimations(!0,t.EMOTICONSSTICKERGROUP),this.element.classList.remove("active"),clearTimeout(this.displayTimeout),this.displayTimeout=window.setTimeout(()=>{this.element.style.display="none",f.default.unlockIntersectionGroup(t.EMOTICONSSTICKERGROUP),M.lazyLoadQueue.unlock(),M.lazyLoadQueue.refresh(),this.forceClose=!1,this.container.classList.remove("disable-hover"),this.events.onCloseAfter.forEach(e=>e())},a.isTouchSupported?0:200))})),this.element=document.getElementById("emoji-dropdown")}attachButtonListener(e){let t=!0;a.isTouchSupported?e.addEventListener("click",()=>{t?(t=!1,this.toggle(!0)):this.toggle()}):e.onmouseover=s=>{clearTimeout(this.displayTimeout),t&&(e.onmouseout=this.onMouseOut,t=!1),this.toggle(!0)}}init(){this.emojiTab=new m.default,this.stickersTab=new v.default,this.gifsTab=new b.default,this.tabs={0:this.emojiTab,1:this.stickersTab,2:this.gifsTab},this.container=this.element.querySelector(".emoji-container .tabs-container"),this.tabsEl=this.element.querySelector(".emoji-tabs"),this.selectTab=h.horizontalMenu(this.tabsEl,this.container,this.onSelectTabClick,()=>{const e=this.tabs[this.tabId];e.init&&e.init(),e.onCloseAfterTimeout&&e.onCloseAfterTimeout(),f.default.checkAnimations(!1,t.EMOTICONSSTICKERGROUP)}),this.searchButton=this.element.querySelector(".emoji-tabs-search"),this.searchButton.addEventListener("click",()=>{1==this.tabId?p.default.stickersTab.init():p.default.gifsTab.init()}),this.deleteBtn=this.element.querySelector(".emoji-tabs-delete"),this.deleteBtn.addEventListener("click",()=>{var e;const t=r.default.chat.input.messageInput;(null===(e=t.lastChild)||void 0===e?void 0:e.tagName)?t.lastElementChild.remove():t.lastChild&&(t.lastChild.textContent.length?t.lastChild.textContent=t.lastChild.textContent.slice(0,-1):t.lastChild.remove());const s=new Event("input",{bubbles:!0,cancelable:!0});r.default.chat.input.messageInput.dispatchEvent(s)}),this.tabsEl.children[1].click(),this.tabs[0].init(),l.default.on("peer_changed",this.checkRights),this.checkRights(),a.isTouchSupported||(this.element.onmouseout=this.onMouseOut,this.element.onmouseover=e=>{this.forceClose||clearTimeout(this.displayTimeout)})}addLazyLoadQueueRepeat(e,t){this.events.onClose.push(()=>{e.lock()}),this.events.onCloseAfter.push(()=>{const s=e.intersector.getVisible();for(const e of s)t(e);e.intersector.clearVisible()}),this.events.onOpenAfter.push(()=>{e.unlockAndRefresh()})}}t.EmoticonsDropdown=M,M.lazyLoadQueue=new u.default,M.menuOnClick=(e,t,s)=>{let i=0,n=-1;const a=t=>t!=i&&(e.children[i].classList.remove("active"),e.children[t].classList.add("active"),i=t,!0),o=new g.default(t.container,(i,o)=>{if(Math.abs(n-t.container.scrollTop)<=1)return;n=-1;const r=c.whichChild(o);!i&&r||(a(r),s&&(r<e.childElementCount-4?s.container.scrollLeft=47*(r-3):s.container.scrollLeft=47*r))});return e.addEventListener("click",e=>{let s=e.target;if(s=c.findUpClassName(s,"menu-horizontal-div-item"),!s)return;const i=c.whichChild(s);if(!a(i))return;const o=(t.splitUp||t.container).children[i].offsetTop+1;t.container.scrollTop=n=o}),o},M.onMediaClick=e=>{let t=e.target;if(t=c.findUpTag(t,"DIV"),!t)return;const s=t.dataset.docId;s&&(r.default.chat.input.sendMessageWithDocument(s)?(_.forceClose=!0,_.container.classList.add("disable-hover"),_.toggle(!1)):console.warn("got no doc by id:",s))};const _=new M;d.MOUNT_CLASS_TO&&(d.MOUNT_CLASS_TO.emoticonsDropdown=_),t.default=_},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.reuseResults=e,this.listeners={},this.listenerResults={}}addListener(e,t,s){var i;(null!==(i=this.listeners[e])&&void 0!==i?i:this.listeners[e]=[]).push({callback:t,once:s}),this.listenerResults.hasOwnProperty(e)&&(t(...this.listenerResults[e]),s&&this.removeListener(e,t))}removeListener(e,t){this.listeners[e]&&this.listeners[e].findAndSplice(e=>e.callback==t)}setListenerResult(e,...t){this.reuseResults&&(this.listenerResults[e]=t);const s=[];return this.listeners[e]&&this.listeners[e].forEach(i=>{s.push(i.callback(...t)),i.once&&this.removeListener(e,i.callback)}),s}}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(80)),o=s(2);const r=new class{constructor(){this.cacheStorage=new a.default("session"),this.cache={},this.useCS=!0}storageGetPrefix(){return""}get(...e){return i(this,void 0,void 0,(function*(){const t=1===e.length,s=[],i=this.storageGetPrefix();for(let t of e)if(t=i+t,this.cache.hasOwnProperty(t))s.push(this.cache[t]);else{if(!this.useCS)throw"something went wrong";{let e;try{e=yield this.cacheStorage.getFile(t,"text"),e=JSON.parse(e)}catch(s){"NO_ENTRY_FOUND"!==s&&(this.useCS=!1,e=void 0,console.error("[AS]: get error:",s,t,e))}try{e=null!=e&&e}catch(t){e=!1}s.push(this.cache[t]=e)}}return t?s[0]:s}))}set(e){return i(this,void 0,void 0,(function*(){const t=this.storageGetPrefix();for(let s in e)if(e.hasOwnProperty(s)){let i=e[s];s=t+s,this.cache[s]=i;let n=0;if(i=JSON.stringify(i),n){let e=performance.now()-n;e>10&&console.warn("LocalStorage set: stringify time by JSON.stringify:",e,s)}if(this.useCS)try{yield this.cacheStorage.save(s,new Response(i,{headers:{"Content-Type":"application/json"}}))}catch(e){console.error("[AS]: set error:",e,s)}}}))}remove(...e){return i(this,arguments,void 0,(function*(){Array.isArray(e)||(e=Array.prototype.slice.call(arguments));const t=this.storageGetPrefix();for(let s=0;s<e.length;s++){const i=e[s]=t+e[s];if(delete this.cache[i],this.useCS)try{yield this.cacheStorage.delete(i)}catch(e){this.useCS=!1,console.error("[AS]: remove error:",e)}}}))}clear(){return this.cacheStorage.deleteAll()}};o.MOUNT_CLASS_TO&&(o.MOUNT_CLASS_TO.appStorage=r),t.default=r},function(e,t,s){"use strict";function i(e){return-1===["image/jpeg","image/png","image/gif","image/webp","image/bmp","video/mp4","video/webm","video/quicktime","audio/ogg","audio/mpeg","audio/mp4","application/json"].indexOf(e)?"application/octet-stream":e}Object.defineProperty(t,"__esModule",{value:!0}),t.blobSafeMimeType=t.blobConstruct=t.readBlobAsText=void 0,t.readBlobAsText=e=>new Promise(t=>{const s=new FileReader;s.addEventListener("loadend",e=>{t(e.srcElement.result)}),s.readAsText(e)}),t.blobConstruct=function(e,t=""){let s;const n=i(t);try{s=new Blob(e,{type:n})}catch(t){let i=new BlobBuilder;e.forEach(e=>{i.append(e)}),s=i.getBlob(n)}return s},t.blobSafeMimeType=i},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ServerTimeManager=void 0;const n=s(18),a=i(s(55));class o{constructor(){this.timestampNow=n.tsNow(!0),this.midnightNoOffset=this.timestampNow-this.timestampNow%86400,this.midnightOffseted=new Date,this.midnightOffset=this.midnightNoOffset-Math.floor(+this.midnightOffseted/1e3),this.serverTimeOffset=0,this.timeParams={midnightOffset:this.midnightOffset,serverTimeOffset:this.serverTimeOffset},this.midnightOffseted.setHours(0,0,0,0),a.default.get("server_time_offset").then(e=>{e&&(this.serverTimeOffset=e,this.timeParams.serverTimeOffset=e)})}}t.ServerTimeManager=o,t.default=new o},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppPollsManager=void 0;const n=s(14),a=s(16),o=i(s(5)),r=s(2),d=s(3),l=i(s(1)),c=i(s(35)),f=i(s(7)),h=i(s(10)),u=i(s(8));class p{constructor(){this.polls={},this.results={},this.log=a.logger("POLLS",a.LogLevels.error),l.default.on("apiUpdate",e=>{const t=e.detail;this.handleUpdate(t)})}handleUpdate(e){switch(e._){case"updateMessagePoll":{this.log("updateMessagePoll:",e);let t=e.poll||this.polls[e.poll_id];if(!t)break;t=this.savePoll(t,e.results),l.default.broadcast("poll_update",{poll:t,results:e.results});break}}}savePoll(e,t){const s=e.id;return this.polls[s]?(e=Object.assign(this.polls[s],e),this.saveResults(e,t),e):(this.polls[s]=e,e.rQuestion=d.RichTextProcessor.wrapEmojiText(e.question),e.rReply=d.RichTextProcessor.wrapEmojiText("📊")+" "+(e.rQuestion||"poll"),e.chosenIndexes=[],this.saveResults(e,t),e)}saveResults(e,t){var s;this.results[e.id]?t=Object.assign(this.results[e.id],t):this.results[e.id]=t,t.pFlags.min||(e.chosenIndexes.length=0,(null===(s=null==t?void 0:t.results)||void 0===s?void 0:s.length)&&t.results.forEach((t,s)=>{var i;(null===(i=t.pFlags)||void 0===i?void 0:i.chosen)&&e.chosenIndexes.push(s)}))}getPoll(e){return{poll:this.polls[e],results:this.results[e]}}getInputMediaPoll(e,t,s,i){return s&&(i||(i=[]),s=d.RichTextProcessor.parseMarkdown(s,i)),{_:"inputMediaPoll",poll:e,correct_answers:t,solution:s,solution_entities:(null==i?void 0:i.length)?i:void 0}}sendVote(e,t){const s=e.media.poll,i=t.map(e=>s.answers[e].option),n=e.mid,a=e.peerId,r=h.default.getInputPeerById(a);return e.pFlags.is_outgoing?f.default.invokeAfterMessageIsSent(n,"sendVote",e=>(this.log("invoke sendVote callback"),this.sendVote(e,t))):o.default.invokeApi("messages.sendVote",{peer:r,msg_id:f.default.getLocalMessageId(e.mid),options:i}).then(e=>{this.log("sendVote updates:",e),c.default.processUpdateMessage(e)})}getResults(e){const t=h.default.getInputPeerById(e.peerId);return o.default.invokeApi("messages.getPollResults",{peer:t,msg_id:f.default.getLocalMessageId(e.mid)}).then(e=>{c.default.processUpdateMessage(e),this.log("getResults updates:",e)})}getVotes(e,t,s,i=20){return o.default.invokeApi("messages.getPollVotes",{peer:h.default.getInputPeerById(e.peerId),id:f.default.getLocalMessageId(e.mid),option:t,offset:s,limit:i}).then(e=>(this.log("getPollVotes messages:",e),u.default.saveApiUsers(e.users),e))}stopPoll(e){const t=e.media.poll;if(t.pFlags.closed)return Promise.resolve();const s=n.copy(t);return s.pFlags.closed=!0,f.default.editMessage(e,void 0,{newMedia:this.getInputMediaPoll(s)}).then(()=>{},e=>{this.log.error("stopPoll error:",e)})}}t.AppPollsManager=p;const g=new p;r.MOUNT_CLASS_TO&&(r.MOUNT_CLASS_TO.appPollsManager=g),t.default=g},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(40)),a=i(s(127)),o=i(s(37)),r=s(17);class d extends o.default{constructor(){super("popup-avatar",null,{closable:!0}),this.image=new Image,this.cropper={crop:()=>{},removeHandlers:()=>{}},this.h6=document.createElement("h6"),this.h6.innerText="Drag to Reposition",this.btnClose.classList.remove("btn-icon"),this.header.append(this.h6),this.cropContainer=document.createElement("div"),this.cropContainer.classList.add("crop"),this.cropContainer.append(this.image),this.input=document.createElement("input"),this.input.type="file",this.input.style.display="none",this.input.addEventListener("change",e=>{const t=e.target.files[0];if(!t)return;const s=new FileReader;s.onload=e=>{const t=e.target.result;this.image=new Image,this.cropContainer.append(this.image),this.image.src=t,this.image.onload=()=>{this.show(),this.cropper=a.default(this.image,this.canvas),this.input.value=""}},s.readAsDataURL(t)},!1),this.btnSubmit=document.createElement("button"),this.btnSubmit.className="btn-primary btn-circle btn-crop btn-icon tgico-check z-depth-1",r.ripple(this.btnSubmit),this.btnSubmit.addEventListener("click",()=>{this.cropper.crop(),this.btnClose.click(),this.canvas.toBlob(e=>{this.blob=e,this.darkenCanvas(),this.resolve()},"image/jpeg",1)}),this.container.append(this.cropContainer,this.btnSubmit,this.input),this.onCloseAfterTimeout=()=>{this.cropper.removeHandlers(),this.image&&this.image.remove()}}resolve(){this.onCrop(()=>n.default.upload(this.blob))}open(e,t){this.canvas=e,this.onCrop=t,this.input.click()}darkenCanvas(){let e=this.canvas.getContext("2d");e.fillStyle="rgba(0, 0, 0, 0.3)",e.fillRect(0,0,this.canvas.width,this.canvas.height)}}t.default=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.listeners=new Set,this.add=(e,t,s,i)=>{const n={element:e,event:t,callback:s,options:i};return this.addManual(n),n},this.addManual=e=>{e.element.addEventListener(e.event,e.callback,e.options),this.listeners.add(e)},this.remove=e=>{e.element.removeEventListener(e.event,e.callback,e.options),this.listeners.delete(e)},this.removeManual=(e,t,s,i)=>{let n;for(const a of this.listeners)if(a.element===e&&a.event===t&&a.callback===s&&a.options===i){n=a;break}n&&this.remove(n)},this.removeAll=()=>{this.listeners.forEach(e=>{this.remove(e)})}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),n=s(4),a=s(17),o=e=>{if(e.element)return e.element;const{icon:t,text:s,onClick:o}=e,r=document.createElement("div");return r.className="btn-menu-item tgico-"+t,r.innerText=s,a.ripple(r),i.attachClickEvent(r,"click"!==i.CLICK_EVENT_NAME?e=>{i.cancelEvent(e),o(e),n.closeBtnMenu()}:o,e.options),e.element=r};t.default=(e,t)=>{const s=document.createElement("div");s.classList.add("btn-menu"),t&&e.forEach(e=>{e.options?e.options.listenerSetter=t:e.options={listenerSetter:t}});const i=e.map(o);return s.append(...i),s}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(42)),a=i(s(37));class o extends a.default{constructor(e,t={}){super("popup-peer"+(e?" "+e:""),t.buttons),this.className=e;let s=new n.default;s.setAttribute("dialog","1"),s.setAttribute("peer",""+t.peerId),s.classList.add("avatar-32"),this.title.innerText=t.title||"",this.header.prepend(s);let i=document.createElement("p");i.classList.add("popup-description"),i.innerHTML=t.description,this.container.insertBefore(i,this.header.nextElementSibling)}}t.default=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=(e,t,s,i,n)=>{const a=e.dataset.timeout;void 0!==a&&clearTimeout(+a),s&&t&&e.classList.add(t),e.classList.add("animating"),e.classList.toggle("backwards",!s),e.dataset.timeout=""+setTimeout(()=>{delete e.dataset.timeout,s||e.classList.remove("backwards",t),e.classList.remove("animating"),n&&n()},i)}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonMenuToggleHandler=void 0;const n=s(0),a=i(s(38)),o=i(s(61)),r=s(4),d=(e,t,s)=>{((null==s?void 0:s.listenerSetter)?s.listenerSetter.add.bind(s.listenerSetter,e):e.addEventListener.bind(e))(n.CLICK_EVENT_NAME,s=>{if(!e.classList.contains("btn-menu-toggle"))return!1;const i=e.querySelector(".btn-menu");n.cancelEvent(s),e.classList.contains("menu-open")?r.closeBtnMenu():(t&&t(s),r.openBtnMenu(i))})};t.ButtonMenuToggleHandler=d,t.default=(e={},t,s,i)=>{const n=a.default("more btn-menu-toggle",e),r=o.default(s,e.listenerSetter);return r.classList.add(t),d(n,i,e),n.append(r),n}},function(e,t,s){"use strict";function i(e){return Math.floor(Math.random()*e)}Object.defineProperty(t,"__esModule",{value:!0}),t.randomLong=t.nextRandomInt=void 0,t.nextRandomInt=i,t.randomLong=function(){return""+i(4294967295)+i(16777215)}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(4),a=i(s(6)),o=i(s(81)),r=i(s(13)),d=i(s(5)),l=s(2),c=s(3),f=s(0),h=i(s(41)),u=i(s(88)),p=i(s(166));let g=null;const m=new h.default("page-sign",!0,()=>{l.Modes.test&&(o.default.push({name:"Test Country",phoneCode:"999 66",code:"TC",emoji:"🤔",pattern:"999 66 XXX XX"}),console.log("Added test country to list!"));const e=o.default.filter(e=>e.emoji).sort((e,t)=>e.name.localeCompare(t.name));let t=null;var s=m.pageEl.querySelector('input[name="countryCode"]'),i=s.parentElement,r=document.createElement("div");r.classList.add("select-wrapper","z-depth-3","hide");var h=document.createElement("ul");r.appendChild(h);new a.default(r);let b=!1;m.pageEl.querySelector(".a-qr").addEventListener("click",()=>{p.default.mount()});let v,y=()=>{y=null,e.forEach(e=>{b=!0;let t=e.emoji,s=[];e.phoneCode.split(" and ").forEach(i=>{let n=document.createElement("li");var a=document.createElement("span");let o=c.RichTextProcessor.wrapRichText(t);n.appendChild(a),a.outerHTML=o,n.append(e.name);var r=document.createElement("span");r.classList.add("phone-code"),r.innerText="+"+i,n.appendChild(r),s.push(n),h.append(n)}),e.li=s}),h.addEventListener("mousedown",(function(i){let n=i.target;"LI"!=n.tagName&&(n=f.findUpTag(n,"LI"));let a=n.childNodes[1].textContent,o=n.querySelector(".phone-code").innerText;s.value=a,t=e.find(e=>e.name==a),w.value=_=o,setTimeout(()=>w.focus(),0)})),i.appendChild(r)};y(),s.addEventListener("focus",(function(t){y?y():e.forEach(e=>{e.li.forEach(e=>e.style.display="")}),clearTimeout(v),r.classList.remove("hide"),r.offsetWidth,r.classList.add("active")})),s.addEventListener("blur",(function(e){r.classList.remove("active"),v=window.setTimeout(()=>{r.classList.add("hide")},200),e.cancelBubble=!0}),{capture:!0}),s.addEventListener("keyup",(function(t){if(t.ctrlKey||"Control"==t.key)return!1;let s=this.value.toLowerCase(),i=[];e.forEach(e=>{let t=-1!==e.name.toLowerCase().indexOf(s);e.li.forEach(e=>e.style.display=t?"":"none"),t&&i.push(e)}),0==i.length&&e.forEach(e=>{e.li.forEach(e=>e.style.display="")})})),m.pageEl.querySelector(".arrow-down").addEventListener("mousedown",(function(e){e.cancelBubble=!0,e.preventDefault(),s.matches(":focus")?s.blur():s.focus()}));let M=!1,_="",w=m.pageEl.querySelector('input[name="phone"]');const S=w.nextElementSibling;w.addEventListener("input",(function(e){this.classList.remove("error");Math.abs(this.value.length-_.length)>1&&!M&&(this.value=_+this.value),M=!1,S.innerText="Phone Number";let{formatted:i,country:a}=n.formatPhoneNumber(this.value);this.value=_=i?"+"+i:"";let o=a?a.name:"";o==s.value||t&&a&&t.phoneCode==a.phoneCode||(s.value=o,t=a),a||this.value.length-1>1?g.style.visibility="":g.style.visibility="hidden"})),w.addEventListener("paste",e=>{M=!0}),w.addEventListener("keypress",(function(e){return g.style.visibility||"Enter"!=e.key?/\D/.test(e.key)?(e.preventDefault(),!1):void 0:g.click()})),g.addEventListener("click",(function(e){this.setAttribute("disabled","true"),this.textContent="PLEASE WAIT...",n.putPreloader(this);let t=w.value;d.default.invokeApi("auth.sendCode",{phone_number:t,api_id:l.App.id,api_hash:l.App.hash,settings:{_:"codeSettings"}}).then(e=>{u.default.mount(Object.assign(e,{phone_number:t}))}).catch(e=>{switch(this.removeAttribute("disabled"),this.innerText="NEXT",e.type){case"PHONE_NUMBER_INVALID":S.innerText="Phone Number Invalid",w.classList.add("error");break;default:console.error("auth.sendCode error:",e),this.innerText=e.type}})}));d.default.invokeApi("help.getNearestDc").then(e=>{const t=[1,2,3,4,5];let s;return e.nearest_dc!=e.this_dc&&(s=d.default.getNetworker(e.nearest_dc).then(()=>{})),(s||Promise.resolve()).then(()=>{t.forEach(e=>{d.default.getNetworker(e,{fileDownload:!0})})}),e}).then(i=>{let n=e.find(e=>e.code==i.country);n&&(s.value.length||w.value.length||(s.value=n.name,t=n,w.value=_="+"+n.phoneCode.split(" and ").shift()))})},()=>{g||(g=m.pageEl.querySelector("button")),g.textContent="NEXT",g.removeAttribute("disabled"),r.default.pushToState("authState",{_:"authStateSignIn"}),r.default.saveState()});t.default=m},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LatinizeMap=t.TLD=t.Emoji=void 0;const n=i(s(9)),a=s(2);t.Emoji={2049:6356,2122:6364,2139:6389,2194:6269,2195:6268,2196:6267,2197:6261,2198:6263,2199:6265,2328:680,2600:4177,2601:4185,2602:4200,2603:4205,2604:4207,2611:6341,2614:4201,2615:3101,2618:2123,2620:194,2622:6258,2623:6259,2626:6288,2638:6285,2639:166,2648:6293,2649:6294,2650:6301,2651:6302,2652:6303,2653:6304,2660:567,2663:570,2665:568,2666:569,2668:457,2692:6184,2693:4110,2694:6187,2696:6195,2697:6201,2699:6193,2702:6171,2705:6340,2708:4118,2709:6132,2712:6146,2714:6342,2716:6343,2721:6284,2728:56,2733:6352,2734:6353,2744:4204,2747:6354,2753:6357,2754:6358,2755:6359,2757:6360,2763:1125,2764:1127,2795:6346,2796:6347,2797:6348,2934:6272,2935:6273,3030:6361,3297:6413,3299:6414,"0023-20e3":6365,"002a-20e3":6366,"0030-20e3":6367,"0031-20e3":6368,"0032-20e3":6369,"0033-20e3":6370,"0034-20e3":6371,"0035-20e3":6372,"0036-20e3":6373,"0037-20e3":6374,"0038-20e3":6375,"0039-20e3":6376,"00a9":6362,"00ae":6363,"1f004":573,"1f0cf":572,"1f170":6383,"1f171":6385,"1f17e":6394,"1f17f":6396,"1f18e":6384,"1f191":6386,"1f192":6387,"1f193":6388,"1f194":6390,"1f195":6392,"1f196":6393,"1f197":6395,"1f198":6397,"1f199":6398,"1f19a":6399,"1f1e6-1f1e8":78,"1f1e6-1f1e9":79,"1f1e6-1f1ea":710,"1f1e6-1f1eb":711,"1f1e6-1f1ec":712,"1f1e6-1f1ee":713,"1f1e6-1f1f1":714,"1f1e6-1f1f2":715,"1f1e6-1f1f4":716,"1f1e6-1f1f6":717,"1f1e6-1f1f7":718,"1f1e6-1f1f8":719,"1f1e6-1f1f9":720,"1f1e6-1f1fa":721,"1f1e6-1f1fc":722,"1f1e6-1f1fd":723,"1f1e6-1f1ff":724,"1f1e7-1f1e6":725,"1f1e7-1f1e7":726,"1f1e7-1f1e9":727,"1f1e7-1f1ea":728,"1f1e7-1f1eb":729,"1f1e7-1f1ec":730,"1f1e7-1f1ed":731,"1f1e7-1f1ee":732,"1f1e7-1f1ef":733,"1f1e7-1f1f1":734,"1f1e7-1f1f2":735,"1f1e7-1f1f3":736,"1f1e7-1f1f4":737,"1f1e7-1f1f6":738,"1f1e7-1f1f7":739,"1f1e7-1f1f8":740,"1f1e7-1f1f9":741,"1f1e7-1f1fb":742,"1f1e7-1f1fc":743,"1f1e7-1f1fe":744,"1f1e7-1f1ff":745,"1f1e8-1f1e6":746,"1f1e8-1f1e8":747,"1f1e8-1f1e9":748,"1f1e8-1f1eb":749,"1f1e8-1f1ec":750,"1f1e8-1f1ed":751,"1f1e8-1f1ee":752,"1f1e8-1f1f0":753,"1f1e8-1f1f1":754,"1f1e8-1f1f2":755,"1f1e8-1f1f3":756,"1f1e8-1f1f4":757,"1f1e8-1f1f5":758,"1f1e8-1f1f7":759,"1f1e8-1f1fa":760,"1f1e8-1f1fb":761,"1f1e8-1f1fc":762,"1f1e8-1f1fd":763,"1f1e8-1f1fe":764,"1f1e8-1f1ff":765,"1f1e9-1f1ea":766,"1f1e9-1f1ec":767,"1f1e9-1f1ef":768,"1f1e9-1f1f0":769,"1f1e9-1f1f2":770,"1f1e9-1f1f4":771,"1f1e9-1f1ff":772,"1f1ea-1f1e6":773,"1f1ea-1f1e8":774,"1f1ea-1f1ea":775,"1f1ea-1f1ec":776,"1f1ea-1f1ed":777,"1f1ea-1f1f7":778,"1f1ea-1f1f8":779,"1f1ea-1f1f9":780,"1f1ea-1f1fa":781,"1f1eb-1f1ee":782,"1f1eb-1f1ef":783,"1f1eb-1f1f0":784,"1f1eb-1f1f2":785,"1f1eb-1f1f4":786,"1f1eb-1f1f7":787,"1f1ec-1f1e6":788,"1f1ec-1f1e7":789,"1f1ec-1f1e9":790,"1f1ec-1f1ea":791,"1f1ec-1f1eb":792,"1f1ec-1f1ec":793,"1f1ec-1f1ed":794,"1f1ec-1f1ee":795,"1f1ec-1f1f1":796,"1f1ec-1f1f2":797,"1f1ec-1f1f3":798,"1f1ec-1f1f5":799,"1f1ec-1f1f6":7100,"1f1ec-1f1f7":7101,"1f1ec-1f1f8":7102,"1f1ec-1f1f9":7103,"1f1ec-1f1fa":7104,"1f1ec-1f1fc":7105,"1f1ec-1f1fe":7106,"1f1ed-1f1f0":7107,"1f1ed-1f1f2":7108,"1f1ed-1f1f3":7109,"1f1ed-1f1f7":7110,"1f1ed-1f1f9":7111,"1f1ed-1f1fa":7112,"1f1ee-1f1e8":7113,"1f1ee-1f1e9":7114,"1f1ee-1f1ea":7115,"1f1ee-1f1f1":7116,"1f1ee-1f1f2":7117,"1f1ee-1f1f3":7118,"1f1ee-1f1f4":7119,"1f1ee-1f1f6":7120,"1f1ee-1f1f7":7121,"1f1ee-1f1f8":7122,"1f1ee-1f1f9":7123,"1f1ef-1f1ea":7124,"1f1ef-1f1f2":7125,"1f1ef-1f1f4":7126,"1f1ef-1f1f5":7127,"1f1f0-1f1ea":7128,"1f1f0-1f1ec":7129,"1f1f0-1f1ed":7130,"1f1f0-1f1ee":7131,"1f1f0-1f1f2":7132,"1f1f0-1f1f3":7133,"1f1f0-1f1f5":7134,"1f1f0-1f1f7":7135,"1f1f0-1f1fc":7136,"1f1f0-1f1fe":7137,"1f1f0-1f1ff":7138,"1f1f1-1f1e6":7139,"1f1f1-1f1e7":7140,"1f1f1-1f1e8":7141,"1f1f1-1f1ee":7142,"1f1f1-1f1f0":7143,"1f1f1-1f1f7":7144,"1f1f1-1f1f8":7145,"1f1f1-1f1f9":7146,"1f1f1-1f1fa":7147,"1f1f1-1f1fb":7148,"1f1f1-1f1fe":7149,"1f1f2-1f1e6":7150,"1f1f2-1f1e8":7151,"1f1f2-1f1e9":7152,"1f1f2-1f1ea":7153,"1f1f2-1f1eb":7154,"1f1f2-1f1ec":7155,"1f1f2-1f1ed":7156,"1f1f2-1f1f0":7157,"1f1f2-1f1f1":7158,"1f1f2-1f1f2":7159,"1f1f2-1f1f3":7160,"1f1f2-1f1f4":7161,"1f1f2-1f1f5":7162,"1f1f2-1f1f6":7163,"1f1f2-1f1f7":7164,"1f1f2-1f1f8":7165,"1f1f2-1f1f9":7166,"1f1f2-1f1fa":7167,"1f1f2-1f1fb":7168,"1f1f2-1f1fc":7169,"1f1f2-1f1fd":7170,"1f1f2-1f1fe":7171,"1f1f2-1f1ff":7172,"1f1f3-1f1e6":7173,"1f1f3-1f1e8":7174,"1f1f3-1f1ea":7175,"1f1f3-1f1eb":7176,"1f1f3-1f1ec":7177,"1f1f3-1f1ee":7178,"1f1f3-1f1f1":7179,"1f1f3-1f1f4":7180,"1f1f3-1f1f5":7181,"1f1f3-1f1f7":7182,"1f1f3-1f1fa":7183,"1f1f3-1f1ff":7184,"1f1f4-1f1f2":7185,"1f1f5-1f1e6":7186,"1f1f5-1f1ea":7187,"1f1f5-1f1eb":7188,"1f1f5-1f1ec":7189,"1f1f5-1f1ed":7190,"1f1f5-1f1f0":7191,"1f1f5-1f1f1":7192,"1f1f5-1f1f2":7193,"1f1f5-1f1f3":7194,"1f1f5-1f1f7":7195,"1f1f5-1f1f8":7196,"1f1f5-1f1f9":7197,"1f1f5-1f1fc":7198,"1f1f5-1f1fe":7199,"1f1f6-1f1e6":7200,"1f1f7-1f1ea":7201,"1f1f7-1f1f4":7202,"1f1f7-1f1f8":7203,"1f1f7-1f1fa":7204,"1f1f7-1f1fc":7205,"1f1f8-1f1e6":7206,"1f1f8-1f1e7":7207,"1f1f8-1f1e8":7208,"1f1f8-1f1e9":7209,"1f1f8-1f1ea":7210,"1f1f8-1f1ec":7211,"1f1f8-1f1ed":7212,"1f1f8-1f1ee":7213,"1f1f8-1f1ef":7214,"1f1f8-1f1f0":7215,"1f1f8-1f1f1":7216,"1f1f8-1f1f2":7217,"1f1f8-1f1f3":7218,"1f1f8-1f1f4":7219,"1f1f8-1f1f7":7220,"1f1f8-1f1f8":7221,"1f1f8-1f1f9":7222,"1f1f8-1f1fb":7223,"1f1f8-1f1fd":7224,"1f1f8-1f1fe":7225,"1f1f8-1f1ff":7226,"1f1f9-1f1e6":7227,"1f1f9-1f1e8":7228,"1f1f9-1f1e9":7229,"1f1f9-1f1eb":7230,"1f1f9-1f1ec":7231,"1f1f9-1f1ed":7232,"1f1f9-1f1ef":7233,"1f1f9-1f1f0":7234,"1f1f9-1f1f1":7235,"1f1f9-1f1f2":7236,"1f1f9-1f1f3":7237,"1f1f9-1f1f4":7238,"1f1f9-1f1f7":7239,"1f1f9-1f1f9":7240,"1f1f9-1f1fb":7241,"1f1f9-1f1fc":7242,"1f1f9-1f1ff":7243,"1f1fa-1f1e6":7244,"1f1fa-1f1ec":7245,"1f1fa-1f1f2":7246,"1f1fa-1f1f3":7247,"1f1fa-1f1f8":7248,"1f1fa-1f1fe":7249,"1f1fa-1f1ff":7250,"1f1fb-1f1e6":7251,"1f1fb-1f1e8":7252,"1f1fb-1f1ea":7253,"1f1fb-1f1ec":7254,"1f1fb-1f1ee":7255,"1f1fb-1f1f3":7256,"1f1fb-1f1fa":7257,"1f1fc-1f1eb":7258,"1f1fc-1f1f8":7259,"1f1fd-1f1f0":7260,"1f1fe-1f1ea":7261,"1f1fe-1f1f9":7262,"1f1ff-1f1e6":7263,"1f1ff-1f1f2":7264,"1f1ff-1f1fc":7265,"1f201":6400,"1f202":6401,"1f21a":6407,"1f22f":6404,"1f232":6408,"1f233":6412,"1f234":6411,"1f235":6416,"1f236":6403,"1f237":6402,"1f238":6410,"1f239":6406,"1f23a":6415,"1f250":6405,"1f251":6409,"1f300":4197,"1f301":449,"1f302":4199,"1f303":450,"1f304":452,"1f305":453,"1f306":454,"1f307":455,"1f308":4198,"1f309":456,"1f30a":4210,"1f30b":410,"1f30c":4184,"1f30d":41,"1f30e":42,"1f30f":43,"1f310":44,"1f311":4164,"1f312":4165,"1f313":4166,"1f314":4167,"1f315":4168,"1f316":4169,"1f317":4170,"1f318":4171,"1f319":4172,"1f31a":4173,"1f31b":4174,"1f31c":4175,"1f31d":4178,"1f31e":4179,"1f31f":4182,"1f320":4183,"1f321":4176,"1f324":4188,"1f325":4189,"1f326":4190,"1f327":4191,"1f328":4192,"1f329":4193,"1f32a":4194,"1f32b":4195,"1f32c":4196,"1f32d":347,"1f32e":349,"1f32f":350,"1f330":331,"1f331":2116,"1f332":2117,"1f333":2118,"1f334":2119,"1f335":2120,"1f336":323,"1f337":2115,"1f338":2107,"1f339":2110,"1f33a":2112,"1f33b":2113,"1f33c":2114,"1f33d":322,"1f33e":2121,"1f33f":2122,"1f340":2124,"1f341":2125,"1f342":2126,"1f343":2127,"1f344":329,"1f345":316,"1f346":319,"1f347":31,"1f348":32,"1f349":33,"1f34a":34,"1f34b":35,"1f34c":36,"1f34d":37,"1f34e":39,"1f34f":310,"1f350":311,"1f351":312,"1f352":313,"1f353":314,"1f354":344,"1f355":346,"1f356":340,"1f357":341,"1f358":364,"1f359":365,"1f35a":366,"1f35b":367,"1f35c":368,"1f35d":369,"1f35e":332,"1f35f":345,"1f360":370,"1f361":376,"1f362":371,"1f363":372,"1f364":373,"1f365":374,"1f366":385,"1f367":386,"1f368":387,"1f369":388,"1f36a":389,"1f36b":394,"1f36c":395,"1f36d":396,"1f36e":397,"1f36f":398,"1f370":391,"1f371":363,"1f372":356,"1f373":354,"1f374":3118,"1f375":3102,"1f376":3103,"1f377":3105,"1f378":3106,"1f379":3107,"1f37a":3108,"1f37b":3109,"1f37c":399,"1f37d":3117,"1f37e":3104,"1f37f":359,"1f380":517,"1f381":518,"1f382":390,"1f383":51,"1f384":52,"1f385":1326,"1f386":53,"1f387":54,"1f388":57,"1f389":58,"1f38a":59,"1f38b":510,"1f38c":73,"1f38d":511,"1f38e":512,"1f38f":513,"1f390":514,"1f391":515,"1f392":625,"1f393":637,"1f396":522,"1f397":519,"1f399":656,"1f39a":657,"1f39b":658,"1f39e":689,"1f39f":520,"1f3a0":458,"1f3a1":459,"1f3a2":460,"1f3a3":549,"1f3a4":659,"1f3a5":688,"1f3a6":6324,"1f3a7":660,"1f3a8":577,"1f3a9":636,"1f3aa":462,"1f3ab":521,"1f3ac":691,"1f3ad":575,"1f3ae":561,"1f3af":555,"1f3b0":563,"1f3b1":558,"1f3b2":564,"1f3b3":537,"1f3b4":574,"1f3b5":654,"1f3b6":655,"1f3b7":662,"1f3b8":663,"1f3b9":664,"1f3ba":665,"1f3bb":666,"1f3bc":653,"1f3bd":551,"1f3be":535,"1f3bf":552,"1f3c0":531,"1f3c1":71,"1f3c2":1397,"1f3c3-200d-2640-fe0f":1381,"1f3c3-200d-2642-fe0f":1380,"1f3c3":1379,"1f3c4-200d-2640-fe0f":1403,"1f3c4-200d-2642-fe0f":1402,"1f3c4":1401,"1f3c5":524,"1f3c6":523,"1f3c7":1395,"1f3c8":533,"1f3c9":534,"1f3ca-200d-2640-fe0f":1409,"1f3ca-200d-2642-fe0f":1408,"1f3ca":1407,"1f3cb-fe0f-200d-2640-fe0f":1415,"1f3cb-fe0f-200d-2642-fe0f":1414,"1f3cb":1413,"1f3cc-fe0f-200d-2640-fe0f":1400,"1f3cc-fe0f-200d-2642-fe0f":1399,"1f3cc":1398,"1f3cd":492,"1f3ce":491,"1f3cf":538,"1f3d0":532,"1f3d1":539,"1f3d2":540,"1f3d3":542,"1f3d4":48,"1f3d5":412,"1f3d6":413,"1f3d7":419,"1f3d8":421,"1f3d9":451,"1f3da":422,"1f3db":418,"1f3dc":414,"1f3dd":415,"1f3de":416,"1f3df":417,"1f3e0":423,"1f3e1":424,"1f3e2":425,"1f3e3":426,"1f3e4":427,"1f3e5":428,"1f3e6":429,"1f3e7":6234,"1f3e8":430,"1f3e9":431,"1f3ea":432,"1f3eb":433,"1f3ec":434,"1f3ed":435,"1f3ee":6102,"1f3ef":436,"1f3f0":437,"1f3f3-fe0f-200d-1f308":76,"1f3f3":75,"1f3f4-200d-2620-fe0f":77,"1f3f4-e0067-e0062-e0065-e006e-e0067-e007f":7266,"1f3f4-e0067-e0062-e0073-e0063-e0074-e007f":7267,"1f3f4-e0067-e0062-e0077-e006c-e0073-e007f":7268,"1f3f4":74,"1f3f5":2109,"1f3f7":6120,"1f3f8":543,"1f3f9":6189,"1f3fa":3121,"1f3fb":81,"1f3fc":82,"1f3fd":83,"1f3fe":84,"1f3ff":85,"1f400":244,"1f401":243,"1f402":225,"1f403":226,"1f404":227,"1f405":217,"1f406":218,"1f407":247,"1f408":214,"1f409":282,"1f40a":277,"1f40b":286,"1f40c":294,"1f40d":280,"1f40e":220,"1f40f":232,"1f410":234,"1f411":233,"1f412":22,"1f413":262,"1f414":261,"1f415-200d-1f9ba":28,"1f415":26,"1f416":229,"1f417":230,"1f418":239,"1f419":292,"1f41a":293,"1f41b":296,"1f41c":297,"1f41d":298,"1f41e":299,"1f41f":288,"1f420":289,"1f421":290,"1f422":278,"1f423":263,"1f424":264,"1f425":265,"1f426":266,"1f427":267,"1f428":252,"1f429":29,"1f42a":235,"1f42b":236,"1f42c":287,"1f42d":242,"1f42e":224,"1f42f":216,"1f430":246,"1f431":213,"1f432":281,"1f433":285,"1f434":219,"1f435":21,"1f436":25,"1f437":228,"1f438":276,"1f439":245,"1f43a":210,"1f43b":251,"1f43c":253,"1f43d":231,"1f43e":259,"1f43f":248,"1f440":1194,"1f441-fe0f-200d-1f5e8-fe0f":1145,"1f441":1195,"1f442":1188,"1f443":1190,"1f444":1197,"1f445":1196,"1f446":1164,"1f447":1166,"1f448":1162,"1f449":1163,"1f44a":1171,"1f44b":1150,"1f44c":1155,"1f44d":1168,"1f44e":1169,"1f44f":1174,"1f450":1176,"1f451":634,"1f452":635,"1f453":61,"1f454":66,"1f455":67,"1f456":68,"1f457":613,"1f458":614,"1f459":619,"1f45a":620,"1f45b":621,"1f45c":622,"1f45d":623,"1f45e":626,"1f45f":627,"1f460":630,"1f461":631,"1f462":633,"1f463":1483,"1f464":1481,"1f465":1482,"1f466":1200,"1f467":1201,"1f468-200d-1f33e":1267,"1f468-200d-1f373":1270,"1f468-200d-1f393":1258,"1f468-200d-1f3a4":1288,"1f468-200d-1f3a8":1291,"1f468-200d-1f3eb":1261,"1f468-200d-1f3ed":1276,"1f468-200d-1f466-200d-1f466":1471,"1f468-200d-1f466":1470,"1f468-200d-1f467-200d-1f466":1473,"1f468-200d-1f467-200d-1f467":1474,"1f468-200d-1f467":1472,"1f468-200d-1f468-200d-1f466":1460,"1f468-200d-1f468-200d-1f466-200d-1f466":1463,"1f468-200d-1f468-200d-1f467":1461,"1f468-200d-1f468-200d-1f467-200d-1f466":1462,"1f468-200d-1f468-200d-1f467-200d-1f467":1464,"1f468-200d-1f469-200d-1f466":1455,"1f468-200d-1f469-200d-1f466-200d-1f466":1458,"1f468-200d-1f469-200d-1f467":1456,"1f468-200d-1f469-200d-1f467-200d-1f466":1457,"1f468-200d-1f469-200d-1f467-200d-1f467":1459,"1f468-200d-1f4bb":1285,"1f468-200d-1f4bc":1279,"1f468-200d-1f527":1273,"1f468-200d-1f52c":1282,"1f468-200d-1f680":1297,"1f468-200d-1f692":1300,"1f468-200d-1f9af":1371,"1f468-200d-1f9b0":1206,"1f468-200d-1f9b1":1207,"1f468-200d-1f9b2":1209,"1f468-200d-1f9b3":1208,"1f468-200d-1f9bc":1374,"1f468-200d-1f9bd":1377,"1f468-200d-2695-fe0f":1255,"1f468-200d-2696-fe0f":1264,"1f468-200d-2708-fe0f":1294,"1f468-200d-2764-fe0f-200d-1f468":1452,"1f468-200d-2764-fe0f-200d-1f48b-200d-1f468":1448,"1f468":1204,"1f469-200d-1f33e":1268,"1f469-200d-1f373":1271,"1f469-200d-1f393":1259,"1f469-200d-1f3a4":1289,"1f469-200d-1f3a8":1292,"1f469-200d-1f3eb":1262,"1f469-200d-1f3ed":1277,"1f469-200d-1f466-200d-1f466":1476,"1f469-200d-1f466":1475,"1f469-200d-1f467-200d-1f466":1478,"1f469-200d-1f467-200d-1f467":1479,"1f469-200d-1f467":1477,"1f469-200d-1f469-200d-1f466":1465,"1f469-200d-1f469-200d-1f466-200d-1f466":1468,"1f469-200d-1f469-200d-1f467":1466,"1f469-200d-1f469-200d-1f467-200d-1f466":1467,"1f469-200d-1f469-200d-1f467-200d-1f467":1469,"1f469-200d-1f4bb":1286,"1f469-200d-1f4bc":1280,"1f469-200d-1f527":1274,"1f469-200d-1f52c":1283,"1f469-200d-1f680":1298,"1f469-200d-1f692":1301,"1f469-200d-1f9af":1372,"1f469-200d-1f9b0":1211,"1f469-200d-1f9b1":1213,"1f469-200d-1f9b2":1217,"1f469-200d-1f9b3":1215,"1f469-200d-1f9bc":1375,"1f469-200d-1f9bd":1378,"1f469-200d-2695-fe0f":1256,"1f469-200d-2696-fe0f":1265,"1f469-200d-2708-fe0f":1295,"1f469-200d-2764-fe0f-200d-1f468":1451,"1f469-200d-2764-fe0f-200d-1f469":1453,"1f469-200d-2764-fe0f-200d-1f48b-200d-1f468":1447,"1f469-200d-2764-fe0f-200d-1f48b-200d-1f469":1449,"1f469":1210,"1f46a":1454,"1f46b":1444,"1f46c":1445,"1f46d":1443,"1f46e-200d-2640-fe0f":1304,"1f46e-200d-2642-fe0f":1303,"1f46e":1302,"1f46f-200d-2640-fe0f":1387,"1f46f-200d-2642-fe0f":1386,"1f46f":1385,"1f470":1322,"1f471-200d-2640-fe0f":1219,"1f471-200d-2642-fe0f":1220,"1f471":1203,"1f472":1319,"1f473-200d-2640-fe0f":1318,"1f473-200d-2642-fe0f":1317,"1f473":1316,"1f474":1222,"1f475":1223,"1f476":1198,"1f477-200d-2640-fe0f":1313,"1f477-200d-2642-fe0f":1312,"1f477":1311,"1f478":1315,"1f479":197,"1f47a":198,"1f47b":199,"1f47c":1325,"1f47d":1100,"1f47e":1101,"1f47f":192,"1f480":193,"1f481-200d-2640-fe0f":1238,"1f481-200d-2642-fe0f":1237,"1f481":1236,"1f482-200d-2640-fe0f":1310,"1f482-200d-2642-fe0f":1309,"1f482":1308,"1f483":1382,"1f484":641,"1f485":1181,"1f486-200d-2640-fe0f":1357,"1f486-200d-2642-fe0f":1356,"1f486":1355,"1f487-200d-2640-fe0f":1360,"1f487-200d-2642-fe0f":1359,"1f487":1358,"1f488":461,"1f489":6208,"1f48a":6210,"1f48b":1115,"1f48c":1116,"1f48d":642,"1f48e":643,"1f48f":1446,"1f490":2106,"1f491":1450,"1f492":438,"1f493":1121,"1f494":1126,"1f495":1123,"1f496":1119,"1f497":1120,"1f498":1117,"1f499":1131,"1f49a":1130,"1f49b":1129,"1f49c":1132,"1f49d":1118,"1f49e":1122,"1f49f":1124,"1f4a0":6447,"1f4a1":6100,"1f4a2":1137,"1f4a3":1143,"1f4a4":1149,"1f4a5":1138,"1f4a6":1140,"1f4a7":4209,"1f4a8":1141,"1f4a9":195,"1f4aa":1183,"1f4ab":1139,"1f4ac":1144,"1f4ad":1148,"1f4ae":2108,"1f4af":1136,"1f4b0":6121,"1f4b1":6130,"1f4b2":6131,"1f4b3":6127,"1f4b4":6122,"1f4b5":6123,"1f4b6":6124,"1f4b7":6125,"1f4b8":6126,"1f4b9":6129,"1f4ba":4123,"1f4bb":677,"1f4bc":6152,"1f4bd":683,"1f4be":684,"1f4bf":685,"1f4c0":686,"1f4c1":6153,"1f4c2":6154,"1f4c3":6113,"1f4c4":6115,"1f4c5":6156,"1f4c6":6157,"1f4c7":6160,"1f4c8":6161,"1f4c9":6162,"1f4ca":6163,"1f4cb":6164,"1f4cc":6165,"1f4cd":6166,"1f4ce":6167,"1f4cf":6169,"1f4d0":6170,"1f4d1":6118,"1f4d2":6112,"1f4d3":6111,"1f4d4":6104,"1f4d5":6105,"1f4d6":6106,"1f4d7":6107,"1f4d8":6108,"1f4d9":6109,"1f4da":6110,"1f4db":6337,"1f4dc":6114,"1f4dd":6151,"1f4de":672,"1f4df":673,"1f4e0":674,"1f4e1":6207,"1f4e2":648,"1f4e3":649,"1f4e4":6136,"1f4e5":6137,"1f4e6":6138,"1f4e7":6133,"1f4e8":6134,"1f4e9":6135,"1f4ea":6140,"1f4eb":6139,"1f4ec":6141,"1f4ed":6142,"1f4ee":6143,"1f4ef":650,"1f4f0":6116,"1f4f1":669,"1f4f2":670,"1f4f3":6328,"1f4f4":6329,"1f4f5":6256,"1f4f6":6327,"1f4f7":693,"1f4f8":694,"1f4f9":695,"1f4fa":692,"1f4fb":661,"1f4fc":696,"1f4fd":690,"1f4ff":640,"1f500":6306,"1f501":6307,"1f502":6308,"1f503":6274,"1f504":6275,"1f505":6325,"1f506":6326,"1f507":644,"1f508":645,"1f509":646,"1f50a":647,"1f50b":675,"1f50c":676,"1f50d":697,"1f50e":698,"1f50f":6177,"1f510":6178,"1f511":6179,"1f512":6175,"1f513":6176,"1f514":651,"1f515":652,"1f516":6119,"1f517":6197,"1f518":6448,"1f519":6276,"1f51a":6277,"1f51b":6278,"1f51c":6279,"1f51d":6280,"1f51e":6257,"1f51f":6377,"1f520":6378,"1f521":6379,"1f522":6380,"1f523":6381,"1f524":6382,"1f525":4208,"1f526":6101,"1f527":6191,"1f528":6181,"1f529":6192,"1f52a":3120,"1f52b":6188,"1f52c":6205,"1f52d":6206,"1f52e":559,"1f52f":6292,"1f530":6338,"1f531":6336,"1f532":6450,"1f533":6449,"1f534":6417,"1f535":6421,"1f536":6441,"1f537":6442,"1f538":6443,"1f539":6444,"1f53a":6445,"1f53b":6446,"1f53c":6316,"1f53d":6318,"1f549":6283,"1f54a":268,"1f54b":446,"1f54c":442,"1f54d":444,"1f54e":6291,"1f550":4142,"1f551":4144,"1f552":4146,"1f553":4148,"1f554":4150,"1f555":4152,"1f556":4154,"1f557":4156,"1f558":4158,"1f559":4160,"1f55a":4162,"1f55b":4140,"1f55c":4143,"1f55d":4145,"1f55e":4147,"1f55f":4149,"1f560":4151,"1f561":4153,"1f562":4155,"1f563":4157,"1f564":4159,"1f565":4161,"1f566":4163,"1f567":4141,"1f56f":699,"1f570":4139,"1f573":1142,"1f574":1384,"1f575-fe0f-200d-2640-fe0f":1307,"1f575-fe0f-200d-2642-fe0f":1306,"1f575":1305,"1f576":62,"1f577":2101,"1f578":2102,"1f579":562,"1f57a":1383,"1f587":6168,"1f58a":6148,"1f58b":6147,"1f58c":6149,"1f58d":6150,"1f590":1152,"1f595":1165,"1f596":1154,"1f5a4":1134,"1f5a5":678,"1f5a8":679,"1f5b1":681,"1f5b2":682,"1f5bc":576,"1f5c2":6155,"1f5c3":6172,"1f5c4":6173,"1f5d1":6174,"1f5d2":6158,"1f5d3":6159,"1f5dc":6194,"1f5dd":6180,"1f5de":6117,"1f5e1":6186,"1f5e3":1480,"1f5e8":1146,"1f5ef":1147,"1f5f3":6144,"1f5fa":45,"1f5fb":411,"1f5fc":439,"1f5fd":440,"1f5fe":46,"1f5ff":6233,"1f600":11,"1f601":14,"1f602":18,"1f603":12,"1f604":13,"1f605":16,"1f606":15,"1f607":113,"1f608":191,"1f609":111,"1f60a":112,"1f60b":122,"1f60c":142,"1f60d":115,"1f60e":160,"1f60f":137,"1f610":134,"1f611":135,"1f612":138,"1f613":183,"1f614":143,"1f615":163,"1f616":180,"1f617":118,"1f618":117,"1f619":121,"1f61a":120,"1f61b":123,"1f61c":124,"1f61d":126,"1f61e":182,"1f61f":164,"1f620":189,"1f621":188,"1f622":177,"1f623":181,"1f624":187,"1f625":176,"1f626":172,"1f627":173,"1f628":174,"1f629":184,"1f62a":144,"1f62b":185,"1f62c":140,"1f62d":178,"1f62e":167,"1f62f":168,"1f630":175,"1f631":179,"1f632":169,"1f633":170,"1f634":146,"1f635":156,"1f636":136,"1f637":147,"1f638":1104,"1f639":1105,"1f63a":1103,"1f63b":1106,"1f63c":1107,"1f63d":1108,"1f63e":1111,"1f63f":1110,"1f640":1109,"1f641":165,"1f642":19,"1f643":110,"1f644":139,"1f645-200d-2640-fe0f":1232,"1f645-200d-2642-fe0f":1231,"1f645":1230,"1f646-200d-2640-fe0f":1235,"1f646-200d-2642-fe0f":1234,"1f646":1233,"1f647-200d-2640-fe0f":1247,"1f647-200d-2642-fe0f":1246,"1f647":1245,"1f648":1112,"1f649":1113,"1f64a":1114,"1f64b-200d-2640-fe0f":1241,"1f64b-200d-2642-fe0f":1240,"1f64b":1239,"1f64c":1175,"1f64d-200d-2640-fe0f":1226,"1f64d-200d-2642-fe0f":1225,"1f64d":1224,"1f64e-200d-2640-fe0f":1229,"1f64e-200d-2642-fe0f":1228,"1f64e":1227,"1f64f":1179,"1f680":4129,"1f681":4124,"1f682":463,"1f683":464,"1f684":465,"1f685":466,"1f686":467,"1f687":468,"1f688":469,"1f689":470,"1f68a":471,"1f68b":474,"1f68c":475,"1f68d":476,"1f68e":477,"1f68f":4100,"1f690":478,"1f691":479,"1f692":480,"1f693":481,"1f694":482,"1f695":483,"1f696":484,"1f697":485,"1f698":486,"1f699":487,"1f69a":488,"1f69b":489,"1f69c":490,"1f69d":472,"1f69e":473,"1f69f":4125,"1f6a0":4126,"1f6a1":4127,"1f6a2":4117,"1f6a3-200d-2640-fe0f":1406,"1f6a3-200d-2642-fe0f":1405,"1f6a3":1404,"1f6a4":4113,"1f6a5":4106,"1f6a6":4107,"1f6a7":4109,"1f6a8":4105,"1f6a9":72,"1f6aa":6213,"1f6ab":6250,"1f6ac":6230,"1f6ad":6252,"1f6ae":6235,"1f6af":6253,"1f6b0":6236,"1f6b1":6254,"1f6b2":497,"1f6b3":6251,"1f6b4-200d-2640-fe0f":1418,"1f6b4-200d-2642-fe0f":1417,"1f6b4":1416,"1f6b5-200d-2640-fe0f":1421,"1f6b5-200d-2642-fe0f":1420,"1f6b5":1419,"1f6b6-200d-2640-fe0f":1363,"1f6b6-200d-2642-fe0f":1362,"1f6b6":1361,"1f6b7":6255,"1f6b8":6248,"1f6b9":6238,"1f6ba":6239,"1f6bb":6240,"1f6bc":6241,"1f6bd":6217,"1f6be":6242,"1f6bf":6218,"1f6c0":1440,"1f6c1":6219,"1f6c2":6243,"1f6c3":6244,"1f6c4":6245,"1f6c5":6246,"1f6cb":6215,"1f6cc":1441,"1f6cd":624,"1f6ce":4131,"1f6cf":6214,"1f6d0":6281,"1f6d1":4108,"1f6d2":6229,"1f6d5":443,"1f6e0":6185,"1f6e1":6190,"1f6e2":4103,"1f6e3":4101,"1f6e4":4102,"1f6e5":4116,"1f6e9":4119,"1f6eb":4120,"1f6ec":4121,"1f6f0":4128,"1f6f3":4114,"1f6f4":498,"1f6f5":493,"1f6f6":4112,"1f6f7":553,"1f6f8":4130,"1f6f9":499,"1f6fa":496,"1f7e0":6418,"1f7e1":6419,"1f7e2":6420,"1f7e3":6422,"1f7e4":6423,"1f7e5":6426,"1f7e6":6430,"1f7e7":6427,"1f7e8":6428,"1f7e9":6429,"1f7ea":6431,"1f7eb":6432,"1f90d":1135,"1f90e":1133,"1f90f":1156,"1f910":132,"1f911":127,"1f912":148,"1f913":161,"1f914":131,"1f915":149,"1f916":1102,"1f917":128,"1f918":1160,"1f919":1161,"1f91a":1151,"1f91b":1172,"1f91c":1173,"1f91d":1178,"1f91e":1158,"1f91f":1159,"1f920":158,"1f921":196,"1f922":150,"1f923":17,"1f924":145,"1f925":141,"1f926-200d-2640-fe0f":1250,"1f926-200d-2642-fe0f":1249,"1f926":1248,"1f927":152,"1f928":133,"1f929":116,"1f92a":125,"1f92b":130,"1f92c":190,"1f92d":129,"1f92e":151,"1f92f":157,"1f930":1323,"1f931":1324,"1f932":1177,"1f933":1182,"1f934":1314,"1f935":1321,"1f936":1327,"1f937-200d-2640-fe0f":1253,"1f937-200d-2642-fe0f":1252,"1f937":1251,"1f938-200d-2640-fe0f":1424,"1f938-200d-2642-fe0f":1423,"1f938":1422,"1f939-200d-2640-fe0f":1436,"1f939-200d-2642-fe0f":1435,"1f939":1434,"1f93a":1394,"1f93c-200d-2640-fe0f":1427,"1f93c-200d-2642-fe0f":1426,"1f93c":1425,"1f93d-200d-2640-fe0f":1430,"1f93d-200d-2642-fe0f":1429,"1f93d":1428,"1f93e-200d-2640-fe0f":1433,"1f93e-200d-2642-fe0f":1432,"1f93e":1431,"1f93f":550,"1f940":2111,"1f941":668,"1f942":3110,"1f943":3111,"1f944":3119,"1f945":546,"1f947":525,"1f948":526,"1f949":527,"1f94a":544,"1f94b":545,"1f94c":554,"1f94d":541,"1f94e":530,"1f94f":536,"1f950":333,"1f951":318,"1f952":324,"1f953":343,"1f954":320,"1f955":321,"1f956":334,"1f957":358,"1f958":355,"1f959":351,"1f95a":353,"1f95b":3100,"1f95c":330,"1f95d":315,"1f95e":337,"1f95f":377,"1f960":378,"1f961":379,"1f962":3116,"1f963":357,"1f964":3112,"1f965":317,"1f966":326,"1f967":393,"1f968":335,"1f969":342,"1f96a":348,"1f96b":362,"1f96c":325,"1f96d":38,"1f96e":375,"1f96f":336,"1f970":114,"1f971":186,"1f973":159,"1f974":155,"1f975":153,"1f976":154,"1f97a":171,"1f97b":615,"1f97c":64,"1f97d":63,"1f97e":628,"1f97f":629,"1f980":380,"1f981":215,"1f982":2103,"1f983":260,"1f984":221,"1f985":269,"1f986":270,"1f987":250,"1f988":291,"1f989":272,"1f98a":211,"1f98b":295,"1f98c":223,"1f98d":23,"1f98e":279,"1f98f":240,"1f990":382,"1f991":383,"1f992":238,"1f993":222,"1f994":249,"1f995":283,"1f996":284,"1f997":2100,"1f998":257,"1f999":237,"1f99a":274,"1f99b":241,"1f99c":275,"1f99d":212,"1f99e":381,"1f99f":2104,"1f9a0":2105,"1f9a1":258,"1f9a2":271,"1f9a5":254,"1f9a6":255,"1f9a7":24,"1f9a8":256,"1f9a9":273,"1f9aa":384,"1f9ae":27,"1f9af":6196,"1f9b4":1193,"1f9b5":1186,"1f9b6":1187,"1f9b7":1192,"1f9b8-200d-2640-fe0f":1330,"1f9b8-200d-2642-fe0f":1329,"1f9b8":1328,"1f9b9-200d-2640-fe0f":1333,"1f9b9-200d-2642-fe0f":1332,"1f9b9":1331,"1f9ba":65,"1f9bb":1189,"1f9bc":495,"1f9bd":494,"1f9be":1184,"1f9bf":1185,"1f9c0":339,"1f9c1":392,"1f9c2":361,"1f9c3":3113,"1f9c4":327,"1f9c5":328,"1f9c6":352,"1f9c7":338,"1f9c8":360,"1f9c9":3114,"1f9ca":3115,"1f9cd-200d-2640-fe0f":1366,"1f9cd-200d-2642-fe0f":1365,"1f9cd":1364,"1f9ce-200d-2640-fe0f":1369,"1f9ce-200d-2642-fe0f":1368,"1f9ce":1367,"1f9cf-200d-2640-fe0f":1244,"1f9cf-200d-2642-fe0f":1243,"1f9cf":1242,"1f9d0":162,"1f9d1-200d-1f33e":1266,"1f9d1-200d-1f373":1269,"1f9d1-200d-1f393":1257,"1f9d1-200d-1f3a4":1287,"1f9d1-200d-1f3a8":1290,"1f9d1-200d-1f3eb":1260,"1f9d1-200d-1f3ed":1275,"1f9d1-200d-1f4bb":1284,"1f9d1-200d-1f4bc":1278,"1f9d1-200d-1f527":1272,"1f9d1-200d-1f52c":1281,"1f9d1-200d-1f680":1296,"1f9d1-200d-1f692":1299,"1f9d1-200d-1f91d-200d-1f9d1":1442,"1f9d1-200d-1f9af":1370,"1f9d1-200d-1f9b0":1212,"1f9d1-200d-1f9b1":1214,"1f9d1-200d-1f9b2":1218,"1f9d1-200d-1f9b3":1216,"1f9d1-200d-1f9bc":1373,"1f9d1-200d-1f9bd":1376,"1f9d1-200d-2695-fe0f":1254,"1f9d1-200d-2696-fe0f":1263,"1f9d1-200d-2708-fe0f":1293,"1f9d1":1202,"1f9d2":1199,"1f9d3":1221,"1f9d4":1205,"1f9d5":1320,"1f9d6-200d-2640-fe0f":1390,"1f9d6-200d-2642-fe0f":1389,"1f9d6":1388,"1f9d7-200d-2640-fe0f":1393,"1f9d7-200d-2642-fe0f":1392,"1f9d7":1391,"1f9d8-200d-2640-fe0f":1439,"1f9d8-200d-2642-fe0f":1438,"1f9d8":1437,"1f9d9-200d-2640-fe0f":1336,"1f9d9-200d-2642-fe0f":1335,"1f9d9":1334,"1f9da-200d-2640-fe0f":1339,"1f9da-200d-2642-fe0f":1338,"1f9da":1337,"1f9db-200d-2640-fe0f":1342,"1f9db-200d-2642-fe0f":1341,"1f9db":1340,"1f9dc-200d-2640-fe0f":1345,"1f9dc-200d-2642-fe0f":1344,"1f9dc":1343,"1f9dd-200d-2640-fe0f":1348,"1f9dd-200d-2642-fe0f":1347,"1f9dd":1346,"1f9de-200d-2640-fe0f":1351,"1f9de-200d-2642-fe0f":1350,"1f9de":1349,"1f9df-200d-2640-fe0f":1354,"1f9df-200d-2642-fe0f":1353,"1f9df":1352,"1f9e0":1191,"1f9e1":1128,"1f9e2":638,"1f9e3":69,"1f9e4":610,"1f9e5":611,"1f9e6":612,"1f9e7":516,"1f9e8":55,"1f9e9":565,"1f9ea":6202,"1f9eb":6203,"1f9ec":6204,"1f9ed":47,"1f9ee":687,"1f9ef":6228,"1f9f0":6199,"1f9f1":420,"1f9f2":6200,"1f9f3":4132,"1f9f4":6221,"1f9f5":578,"1f9f6":579,"1f9f7":6222,"1f9f8":566,"1f9f9":6223,"1f9fa":6224,"1f9fb":6225,"1f9fc":6226,"1f9fd":6227,"1f9fe":6128,"1f9ff":560,"1fa70":632,"1fa71":616,"1fa72":617,"1fa73":618,"1fa78":6209,"1fa79":6211,"1fa7a":6212,"1fa80":556,"1fa81":557,"1fa82":4122,"1fa90":4180,"1fa91":6216,"1fa92":6220,"1fa93":6182,"1fa94":6103,"1fa95":667,"203c":6355,"21a9":6270,"21aa":6271,"231a":4135,"231b":4133,"23cf":6323,"23e9":6310,"23ea":6314,"23eb":6317,"23ec":6319,"23ed":6311,"23ee":6315,"23ef":6312,"23f0":4136,"23f1":4137,"23f2":4138,"23f3":4134,"23f8":6320,"23f9":6321,"23fa":6322,"24c2":6391,"25aa":6439,"25ab":6440,"25b6":6309,"25c0":6313,"25fb":6436,"25fc":6435,"25fd":6438,"25fe":6437,"260e":671,"261d":1167,"262a":6289,"262e":6290,"262f":6286,"263a":119,"264a":6295,"264b":6296,"264c":6297,"264d":6298,"264e":6299,"264f":6300,"265f":571,"267b":6334,"267e":6333,"267f":6237,"269b":6282,"269c":6335,"26a0":6247,"26a1":4203,"26aa":6425,"26ab":6424,"26b0":6231,"26b1":6232,"26bd":528,"26be":529,"26c4":4206,"26c5":4186,"26c8":4187,"26ce":6305,"26cf":6183,"26d1":639,"26d3":6198,"26d4":6249,"26e9":445,"26ea":441,"26f0":49,"26f1":4202,"26f2":447,"26f3":547,"26f4":4115,"26f5":4111,"26f7":1396,"26f8":548,"26f9-fe0f-200d-2640-fe0f":1412,"26f9-fe0f-200d-2642-fe0f":1411,"26f9":1410,"26fa":448,"26fd":4104,"270a":1170,"270b":1153,"270c":1157,"270d":1180,"270f":6145,"271d":6287,"274c":6344,"274e":6345,"27a1":6262,"27b0":6349,"27bf":6350,"2b05":6266,"2b06":6260,"2b07":6264,"2b1b":6433,"2b1c":6434,"2b50":4181,"2b55":6339,"303d":6351,"1f385-1f3fb":0,"1f385-1f3fc":0,"1f385-1f3fd":0,"1f385-1f3fe":0,"1f385-1f3ff":0,"1f3c2-1f3fb":0,"1f3c2-1f3fc":0,"1f3c2-1f3fd":0,"1f3c2-1f3fe":0,"1f3c2-1f3ff":0,"1f3c3-1f3fb-200d-2640-fe0f":0,"1f3c3-1f3fc-200d-2640-fe0f":0,"1f3c3-1f3fd-200d-2640-fe0f":0,"1f3c3-1f3fe-200d-2640-fe0f":0,"1f3c3-1f3ff-200d-2640-fe0f":0,"1f3c3-1f3fb-200d-2642-fe0f":0,"1f3c3-1f3fc-200d-2642-fe0f":0,"1f3c3-1f3fd-200d-2642-fe0f":0,"1f3c3-1f3fe-200d-2642-fe0f":0,"1f3c3-1f3ff-200d-2642-fe0f":0,"1f3c3-1f3fb":0,"1f3c3-1f3fc":0,"1f3c3-1f3fd":0,"1f3c3-1f3fe":0,"1f3c3-1f3ff":0,"1f3c4-1f3fb-200d-2640-fe0f":0,"1f3c4-1f3fc-200d-2640-fe0f":0,"1f3c4-1f3fd-200d-2640-fe0f":0,"1f3c4-1f3fe-200d-2640-fe0f":0,"1f3c4-1f3ff-200d-2640-fe0f":0,"1f3c4-1f3fb-200d-2642-fe0f":0,"1f3c4-1f3fc-200d-2642-fe0f":0,"1f3c4-1f3fd-200d-2642-fe0f":0,"1f3c4-1f3fe-200d-2642-fe0f":0,"1f3c4-1f3ff-200d-2642-fe0f":0,"1f3c4-1f3fb":0,"1f3c4-1f3fc":0,"1f3c4-1f3fd":0,"1f3c4-1f3fe":0,"1f3c4-1f3ff":0,"1f3c7-1f3fb":0,"1f3c7-1f3fc":0,"1f3c7-1f3fd":0,"1f3c7-1f3fe":0,"1f3c7-1f3ff":0,"1f3ca-1f3fb-200d-2640-fe0f":0,"1f3ca-1f3fc-200d-2640-fe0f":0,"1f3ca-1f3fd-200d-2640-fe0f":0,"1f3ca-1f3fe-200d-2640-fe0f":0,"1f3ca-1f3ff-200d-2640-fe0f":0,"1f3ca-1f3fb-200d-2642-fe0f":0,"1f3ca-1f3fc-200d-2642-fe0f":0,"1f3ca-1f3fd-200d-2642-fe0f":0,"1f3ca-1f3fe-200d-2642-fe0f":0,"1f3ca-1f3ff-200d-2642-fe0f":0,"1f3ca-1f3fb":0,"1f3ca-1f3fc":0,"1f3ca-1f3fd":0,"1f3ca-1f3fe":0,"1f3ca-1f3ff":0,"1f3cb-1f3fb-200d-2640-fe0f":0,"1f3cb-1f3fc-200d-2640-fe0f":0,"1f3cb-1f3fd-200d-2640-fe0f":0,"1f3cb-1f3fe-200d-2640-fe0f":0,"1f3cb-1f3ff-200d-2640-fe0f":0,"1f3cb-1f3fb-200d-2642-fe0f":0,"1f3cb-1f3fc-200d-2642-fe0f":0,"1f3cb-1f3fd-200d-2642-fe0f":0,"1f3cb-1f3fe-200d-2642-fe0f":0,"1f3cb-1f3ff-200d-2642-fe0f":0,"1f3cb-1f3fb":0,"1f3cb-1f3fc":0,"1f3cb-1f3fd":0,"1f3cb-1f3fe":0,"1f3cb-1f3ff":0,"1f3cc-1f3fb-200d-2640-fe0f":0,"1f3cc-1f3fc-200d-2640-fe0f":0,"1f3cc-1f3fd-200d-2640-fe0f":0,"1f3cc-1f3fe-200d-2640-fe0f":0,"1f3cc-1f3ff-200d-2640-fe0f":0,"1f3cc-1f3fb-200d-2642-fe0f":0,"1f3cc-1f3fc-200d-2642-fe0f":0,"1f3cc-1f3fd-200d-2642-fe0f":0,"1f3cc-1f3fe-200d-2642-fe0f":0,"1f3cc-1f3ff-200d-2642-fe0f":0,"1f3cc-1f3fb":0,"1f3cc-1f3fc":0,"1f3cc-1f3fd":0,"1f3cc-1f3fe":0,"1f3cc-1f3ff":0,"1f442-1f3fb":0,"1f442-1f3fc":0,"1f442-1f3fd":0,"1f442-1f3fe":0,"1f442-1f3ff":0,"1f443-1f3fb":0,"1f443-1f3fc":0,"1f443-1f3fd":0,"1f443-1f3fe":0,"1f443-1f3ff":0,"1f446-1f3fb":0,"1f446-1f3fc":0,"1f446-1f3fd":0,"1f446-1f3fe":0,"1f446-1f3ff":0,"1f447-1f3fb":0,"1f447-1f3fc":0,"1f447-1f3fd":0,"1f447-1f3fe":0,"1f447-1f3ff":0,"1f448-1f3fb":0,"1f448-1f3fc":0,"1f448-1f3fd":0,"1f448-1f3fe":0,"1f448-1f3ff":0,"1f449-1f3fb":0,"1f449-1f3fc":0,"1f449-1f3fd":0,"1f449-1f3fe":0,"1f449-1f3ff":0,"1f44a-1f3fb":0,"1f44a-1f3fc":0,"1f44a-1f3fd":0,"1f44a-1f3fe":0,"1f44a-1f3ff":0,"1f44b-1f3fb":0,"1f44b-1f3fc":0,"1f44b-1f3fd":0,"1f44b-1f3fe":0,"1f44b-1f3ff":0,"1f44c-1f3fb":0,"1f44c-1f3fc":0,"1f44c-1f3fd":0,"1f44c-1f3fe":0,"1f44c-1f3ff":0,"1f44d-1f3fb":0,"1f44d-1f3fc":0,"1f44d-1f3fd":0,"1f44d-1f3fe":0,"1f44d-1f3ff":0,"1f44e-1f3fb":0,"1f44e-1f3fc":0,"1f44e-1f3fd":0,"1f44e-1f3fe":0,"1f44e-1f3ff":0,"1f44f-1f3fb":0,"1f44f-1f3fc":0,"1f44f-1f3fd":0,"1f44f-1f3fe":0,"1f44f-1f3ff":0,"1f450-1f3fb":0,"1f450-1f3fc":0,"1f450-1f3fd":0,"1f450-1f3fe":0,"1f450-1f3ff":0,"1f466-1f3fb":0,"1f466-1f3fc":0,"1f466-1f3fd":0,"1f466-1f3fe":0,"1f466-1f3ff":0,"1f467-1f3fb":0,"1f467-1f3fc":0,"1f467-1f3fd":0,"1f467-1f3fe":0,"1f467-1f3ff":0,"1f468-1f3fb-200d-1f33e":0,"1f468-1f3fc-200d-1f33e":0,"1f468-1f3fd-200d-1f33e":0,"1f468-1f3fe-200d-1f33e":0,"1f468-1f3ff-200d-1f33e":0,"1f468-1f3fb-200d-1f373":0,"1f468-1f3fc-200d-1f373":0,"1f468-1f3fd-200d-1f373":0,"1f468-1f3fe-200d-1f373":0,"1f468-1f3ff-200d-1f373":0,"1f468-1f3fb-200d-1f393":0,"1f468-1f3fc-200d-1f393":0,"1f468-1f3fd-200d-1f393":0,"1f468-1f3fe-200d-1f393":0,"1f468-1f3ff-200d-1f393":0,"1f468-1f3fb-200d-1f3a4":0,"1f468-1f3fc-200d-1f3a4":0,"1f468-1f3fd-200d-1f3a4":0,"1f468-1f3fe-200d-1f3a4":0,"1f468-1f3ff-200d-1f3a4":0,"1f468-1f3fb-200d-1f3a8":0,"1f468-1f3fc-200d-1f3a8":0,"1f468-1f3fd-200d-1f3a8":0,"1f468-1f3fe-200d-1f3a8":0,"1f468-1f3ff-200d-1f3a8":0,"1f468-1f3fb-200d-1f3eb":0,"1f468-1f3fc-200d-1f3eb":0,"1f468-1f3fd-200d-1f3eb":0,"1f468-1f3fe-200d-1f3eb":0,"1f468-1f3ff-200d-1f3eb":0,"1f468-1f3fb-200d-1f3ed":0,"1f468-1f3fc-200d-1f3ed":0,"1f468-1f3fd-200d-1f3ed":0,"1f468-1f3fe-200d-1f3ed":0,"1f468-1f3ff-200d-1f3ed":0,"1f468-1f3fb-200d-1f4bb":0,"1f468-1f3fc-200d-1f4bb":0,"1f468-1f3fd-200d-1f4bb":0,"1f468-1f3fe-200d-1f4bb":0,"1f468-1f3ff-200d-1f4bb":0,"1f468-1f3fb-200d-1f4bc":0,"1f468-1f3fc-200d-1f4bc":0,"1f468-1f3fd-200d-1f4bc":0,"1f468-1f3fe-200d-1f4bc":0,"1f468-1f3ff-200d-1f4bc":0,"1f468-1f3fb-200d-1f527":0,"1f468-1f3fc-200d-1f527":0,"1f468-1f3fd-200d-1f527":0,"1f468-1f3fe-200d-1f527":0,"1f468-1f3ff-200d-1f527":0,"1f468-1f3fb-200d-1f52c":0,"1f468-1f3fc-200d-1f52c":0,"1f468-1f3fd-200d-1f52c":0,"1f468-1f3fe-200d-1f52c":0,"1f468-1f3ff-200d-1f52c":0,"1f468-1f3fb-200d-1f680":0,"1f468-1f3fc-200d-1f680":0,"1f468-1f3fd-200d-1f680":0,"1f468-1f3fe-200d-1f680":0,"1f468-1f3ff-200d-1f680":0,"1f468-1f3fb-200d-1f692":0,"1f468-1f3fc-200d-1f692":0,"1f468-1f3fd-200d-1f692":0,"1f468-1f3fe-200d-1f692":0,"1f468-1f3ff-200d-1f692":0,"1f468-1f3fb-200d-1f9af":0,"1f468-1f3fc-200d-1f9af":0,"1f468-1f3fd-200d-1f9af":0,"1f468-1f3fe-200d-1f9af":0,"1f468-1f3ff-200d-1f9af":0,"1f468-1f3fb-200d-1f9b0":0,"1f468-1f3fc-200d-1f9b0":0,"1f468-1f3fd-200d-1f9b0":0,"1f468-1f3fe-200d-1f9b0":0,"1f468-1f3ff-200d-1f9b0":0,"1f468-1f3fb-200d-1f9b1":0,"1f468-1f3fc-200d-1f9b1":0,"1f468-1f3fd-200d-1f9b1":0,"1f468-1f3fe-200d-1f9b1":0,"1f468-1f3ff-200d-1f9b1":0,"1f468-1f3fb-200d-1f9b2":0,"1f468-1f3fc-200d-1f9b2":0,"1f468-1f3fd-200d-1f9b2":0,"1f468-1f3fe-200d-1f9b2":0,"1f468-1f3ff-200d-1f9b2":0,"1f468-1f3fb-200d-1f9b3":0,"1f468-1f3fc-200d-1f9b3":0,"1f468-1f3fd-200d-1f9b3":0,"1f468-1f3fe-200d-1f9b3":0,"1f468-1f3ff-200d-1f9b3":0,"1f468-1f3fb-200d-1f9bc":0,"1f468-1f3fc-200d-1f9bc":0,"1f468-1f3fd-200d-1f9bc":0,"1f468-1f3fe-200d-1f9bc":0,"1f468-1f3ff-200d-1f9bc":0,"1f468-1f3fb-200d-1f9bd":0,"1f468-1f3fc-200d-1f9bd":0,"1f468-1f3fd-200d-1f9bd":0,"1f468-1f3fe-200d-1f9bd":0,"1f468-1f3ff-200d-1f9bd":0,"1f468-1f3fb-200d-2695-fe0f":0,"1f468-1f3fc-200d-2695-fe0f":0,"1f468-1f3fd-200d-2695-fe0f":0,"1f468-1f3fe-200d-2695-fe0f":0,"1f468-1f3ff-200d-2695-fe0f":0,"1f468-1f3fb-200d-2696-fe0f":0,"1f468-1f3fc-200d-2696-fe0f":0,"1f468-1f3fd-200d-2696-fe0f":0,"1f468-1f3fe-200d-2696-fe0f":0,"1f468-1f3ff-200d-2696-fe0f":0,"1f468-1f3fb-200d-2708-fe0f":0,"1f468-1f3fc-200d-2708-fe0f":0,"1f468-1f3fd-200d-2708-fe0f":0,"1f468-1f3fe-200d-2708-fe0f":0,"1f468-1f3ff-200d-2708-fe0f":0,"1f468-1f3fb":0,"1f468-1f3fc":0,"1f468-1f3fd":0,"1f468-1f3fe":0,"1f468-1f3ff":0,"1f469-1f3fb-200d-1f33e":0,"1f469-1f3fc-200d-1f33e":0,"1f469-1f3fd-200d-1f33e":0,"1f469-1f3fe-200d-1f33e":0,"1f469-1f3ff-200d-1f33e":0,"1f469-1f3fb-200d-1f373":0,"1f469-1f3fc-200d-1f373":0,"1f469-1f3fd-200d-1f373":0,"1f469-1f3fe-200d-1f373":0,"1f469-1f3ff-200d-1f373":0,"1f469-1f3fb-200d-1f393":0,"1f469-1f3fc-200d-1f393":0,"1f469-1f3fd-200d-1f393":0,"1f469-1f3fe-200d-1f393":0,"1f469-1f3ff-200d-1f393":0,"1f469-1f3fb-200d-1f3a4":0,"1f469-1f3fc-200d-1f3a4":0,"1f469-1f3fd-200d-1f3a4":0,"1f469-1f3fe-200d-1f3a4":0,"1f469-1f3ff-200d-1f3a4":0,"1f469-1f3fb-200d-1f3a8":0,"1f469-1f3fc-200d-1f3a8":0,"1f469-1f3fd-200d-1f3a8":0,"1f469-1f3fe-200d-1f3a8":0,"1f469-1f3ff-200d-1f3a8":0,"1f469-1f3fb-200d-1f3eb":0,"1f469-1f3fc-200d-1f3eb":0,"1f469-1f3fd-200d-1f3eb":0,"1f469-1f3fe-200d-1f3eb":0,"1f469-1f3ff-200d-1f3eb":0,"1f469-1f3fb-200d-1f3ed":0,"1f469-1f3fc-200d-1f3ed":0,"1f469-1f3fd-200d-1f3ed":0,"1f469-1f3fe-200d-1f3ed":0,"1f469-1f3ff-200d-1f3ed":0,"1f469-1f3fb-200d-1f4bb":0,"1f469-1f3fc-200d-1f4bb":0,"1f469-1f3fd-200d-1f4bb":0,"1f469-1f3fe-200d-1f4bb":0,"1f469-1f3ff-200d-1f4bb":0,"1f469-1f3fb-200d-1f4bc":0,"1f469-1f3fc-200d-1f4bc":0,"1f469-1f3fd-200d-1f4bc":0,"1f469-1f3fe-200d-1f4bc":0,"1f469-1f3ff-200d-1f4bc":0,"1f469-1f3fb-200d-1f527":0,"1f469-1f3fc-200d-1f527":0,"1f469-1f3fd-200d-1f527":0,"1f469-1f3fe-200d-1f527":0,"1f469-1f3ff-200d-1f527":0,"1f469-1f3fb-200d-1f52c":0,"1f469-1f3fc-200d-1f52c":0,"1f469-1f3fd-200d-1f52c":0,"1f469-1f3fe-200d-1f52c":0,"1f469-1f3ff-200d-1f52c":0,"1f469-1f3fb-200d-1f680":0,"1f469-1f3fc-200d-1f680":0,"1f469-1f3fd-200d-1f680":0,"1f469-1f3fe-200d-1f680":0,"1f469-1f3ff-200d-1f680":0,"1f469-1f3fb-200d-1f692":0,"1f469-1f3fc-200d-1f692":0,"1f469-1f3fd-200d-1f692":0,"1f469-1f3fe-200d-1f692":0,"1f469-1f3ff-200d-1f692":0,"1f469-1f3fb-200d-1f9af":0,"1f469-1f3fc-200d-1f9af":0,"1f469-1f3fd-200d-1f9af":0,"1f469-1f3fe-200d-1f9af":0,"1f469-1f3ff-200d-1f9af":0,"1f469-1f3fb-200d-1f9b0":0,"1f469-1f3fc-200d-1f9b0":0,"1f469-1f3fd-200d-1f9b0":0,"1f469-1f3fe-200d-1f9b0":0,"1f469-1f3ff-200d-1f9b0":0,"1f469-1f3fb-200d-1f9b1":0,"1f469-1f3fc-200d-1f9b1":0,"1f469-1f3fd-200d-1f9b1":0,"1f469-1f3fe-200d-1f9b1":0,"1f469-1f3ff-200d-1f9b1":0,"1f469-1f3fb-200d-1f9b2":0,"1f469-1f3fc-200d-1f9b2":0,"1f469-1f3fd-200d-1f9b2":0,"1f469-1f3fe-200d-1f9b2":0,"1f469-1f3ff-200d-1f9b2":0,"1f469-1f3fb-200d-1f9b3":0,"1f469-1f3fc-200d-1f9b3":0,"1f469-1f3fd-200d-1f9b3":0,"1f469-1f3fe-200d-1f9b3":0,"1f469-1f3ff-200d-1f9b3":0,"1f469-1f3fb-200d-1f9bc":0,"1f469-1f3fc-200d-1f9bc":0,"1f469-1f3fd-200d-1f9bc":0,"1f469-1f3fe-200d-1f9bc":0,"1f469-1f3ff-200d-1f9bc":0,"1f469-1f3fb-200d-1f9bd":0,"1f469-1f3fc-200d-1f9bd":0,"1f469-1f3fd-200d-1f9bd":0,"1f469-1f3fe-200d-1f9bd":0,"1f469-1f3ff-200d-1f9bd":0,"1f469-1f3fb-200d-2695-fe0f":0,"1f469-1f3fc-200d-2695-fe0f":0,"1f469-1f3fd-200d-2695-fe0f":0,"1f469-1f3fe-200d-2695-fe0f":0,"1f469-1f3ff-200d-2695-fe0f":0,"1f469-1f3fb-200d-2696-fe0f":0,"1f469-1f3fc-200d-2696-fe0f":0,"1f469-1f3fd-200d-2696-fe0f":0,"1f469-1f3fe-200d-2696-fe0f":0,"1f469-1f3ff-200d-2696-fe0f":0,"1f469-1f3fb-200d-2708-fe0f":0,"1f469-1f3fc-200d-2708-fe0f":0,"1f469-1f3fd-200d-2708-fe0f":0,"1f469-1f3fe-200d-2708-fe0f":0,"1f469-1f3ff-200d-2708-fe0f":0,"1f469-1f3fb":0,"1f469-1f3fc":0,"1f469-1f3fd":0,"1f469-1f3fe":0,"1f469-1f3ff":0,"1f46b-1f3fb":0,"1f46b-1f3fc":0,"1f46b-1f3fd":0,"1f46b-1f3fe":0,"1f46b-1f3ff":0,"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fc":0,"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fd":0,"1f469-1f3fb-200d-1f91d-200d-1f468-1f3fe":0,"1f469-1f3fb-200d-1f91d-200d-1f468-1f3ff":0,"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fb":0,"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fd":0,"1f469-1f3fc-200d-1f91d-200d-1f468-1f3fe":0,"1f469-1f3fc-200d-1f91d-200d-1f468-1f3ff":0,"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fb":0,"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fc":0,"1f469-1f3fd-200d-1f91d-200d-1f468-1f3fe":0,"1f469-1f3fd-200d-1f91d-200d-1f468-1f3ff":0,"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fb":0,"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fc":0,"1f469-1f3fe-200d-1f91d-200d-1f468-1f3fd":0,"1f469-1f3fe-200d-1f91d-200d-1f468-1f3ff":0,"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fb":0,"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fc":0,"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fd":0,"1f469-1f3ff-200d-1f91d-200d-1f468-1f3fe":0,"1f46c-1f3fb":0,"1f46c-1f3fc":0,"1f46c-1f3fd":0,"1f46c-1f3fe":0,"1f46c-1f3ff":0,"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fc":0,"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fd":0,"1f468-1f3fb-200d-1f91d-200d-1f468-1f3fe":0,"1f468-1f3fb-200d-1f91d-200d-1f468-1f3ff":0,"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fb":0,"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fd":0,"1f468-1f3fc-200d-1f91d-200d-1f468-1f3fe":0,"1f468-1f3fc-200d-1f91d-200d-1f468-1f3ff":0,"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fb":0,"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fc":0,"1f468-1f3fd-200d-1f91d-200d-1f468-1f3fe":0,"1f468-1f3fd-200d-1f91d-200d-1f468-1f3ff":0,"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fb":0,"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fc":0,"1f468-1f3fe-200d-1f91d-200d-1f468-1f3fd":0,"1f468-1f3fe-200d-1f91d-200d-1f468-1f3ff":0,"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fb":0,"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fc":0,"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fd":0,"1f468-1f3ff-200d-1f91d-200d-1f468-1f3fe":0,"1f46d-1f3fb":0,"1f46d-1f3fc":0,"1f46d-1f3fd":0,"1f46d-1f3fe":0,"1f46d-1f3ff":0,"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fc":0,"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fd":0,"1f469-1f3fb-200d-1f91d-200d-1f469-1f3fe":0,"1f469-1f3fb-200d-1f91d-200d-1f469-1f3ff":0,"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fb":0,"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fd":0,"1f469-1f3fc-200d-1f91d-200d-1f469-1f3fe":0,"1f469-1f3fc-200d-1f91d-200d-1f469-1f3ff":0,"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fb":0,"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fc":0,"1f469-1f3fd-200d-1f91d-200d-1f469-1f3fe":0,"1f469-1f3fd-200d-1f91d-200d-1f469-1f3ff":0,"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fb":0,"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fc":0,"1f469-1f3fe-200d-1f91d-200d-1f469-1f3fd":0,"1f469-1f3fe-200d-1f91d-200d-1f469-1f3ff":0,"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fb":0,"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fc":0,"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fd":0,"1f469-1f3ff-200d-1f91d-200d-1f469-1f3fe":0,"1f46e-1f3fb-200d-2640-fe0f":0,"1f46e-1f3fc-200d-2640-fe0f":0,"1f46e-1f3fd-200d-2640-fe0f":0,"1f46e-1f3fe-200d-2640-fe0f":0,"1f46e-1f3ff-200d-2640-fe0f":0,"1f46e-1f3fb-200d-2642-fe0f":0,"1f46e-1f3fc-200d-2642-fe0f":0,"1f46e-1f3fd-200d-2642-fe0f":0,"1f46e-1f3fe-200d-2642-fe0f":0,"1f46e-1f3ff-200d-2642-fe0f":0,"1f46e-1f3fb":0,"1f46e-1f3fc":0,"1f46e-1f3fd":0,"1f46e-1f3fe":0,"1f46e-1f3ff":0,"1f470-1f3fb":0,"1f470-1f3fc":0,"1f470-1f3fd":0,"1f470-1f3fe":0,"1f470-1f3ff":0,"1f471-1f3fb-200d-2640-fe0f":0,"1f471-1f3fc-200d-2640-fe0f":0,"1f471-1f3fd-200d-2640-fe0f":0,"1f471-1f3fe-200d-2640-fe0f":0,"1f471-1f3ff-200d-2640-fe0f":0,"1f471-1f3fb-200d-2642-fe0f":0,"1f471-1f3fc-200d-2642-fe0f":0,"1f471-1f3fd-200d-2642-fe0f":0,"1f471-1f3fe-200d-2642-fe0f":0,"1f471-1f3ff-200d-2642-fe0f":0,"1f471-1f3fb":0,"1f471-1f3fc":0,"1f471-1f3fd":0,"1f471-1f3fe":0,"1f471-1f3ff":0,"1f472-1f3fb":0,"1f472-1f3fc":0,"1f472-1f3fd":0,"1f472-1f3fe":0,"1f472-1f3ff":0,"1f473-1f3fb-200d-2640-fe0f":0,"1f473-1f3fc-200d-2640-fe0f":0,"1f473-1f3fd-200d-2640-fe0f":0,"1f473-1f3fe-200d-2640-fe0f":0,"1f473-1f3ff-200d-2640-fe0f":0,"1f473-1f3fb-200d-2642-fe0f":0,"1f473-1f3fc-200d-2642-fe0f":0,"1f473-1f3fd-200d-2642-fe0f":0,"1f473-1f3fe-200d-2642-fe0f":0,"1f473-1f3ff-200d-2642-fe0f":0,"1f473-1f3fb":0,"1f473-1f3fc":0,"1f473-1f3fd":0,"1f473-1f3fe":0,"1f473-1f3ff":0,"1f474-1f3fb":0,"1f474-1f3fc":0,"1f474-1f3fd":0,"1f474-1f3fe":0,"1f474-1f3ff":0,"1f475-1f3fb":0,"1f475-1f3fc":0,"1f475-1f3fd":0,"1f475-1f3fe":0,"1f475-1f3ff":0,"1f476-1f3fb":0,"1f476-1f3fc":0,"1f476-1f3fd":0,"1f476-1f3fe":0,"1f476-1f3ff":0,"1f477-1f3fb-200d-2640-fe0f":0,"1f477-1f3fc-200d-2640-fe0f":0,"1f477-1f3fd-200d-2640-fe0f":0,"1f477-1f3fe-200d-2640-fe0f":0,"1f477-1f3ff-200d-2640-fe0f":0,"1f477-1f3fb-200d-2642-fe0f":0,"1f477-1f3fc-200d-2642-fe0f":0,"1f477-1f3fd-200d-2642-fe0f":0,"1f477-1f3fe-200d-2642-fe0f":0,"1f477-1f3ff-200d-2642-fe0f":0,"1f477-1f3fb":0,"1f477-1f3fc":0,"1f477-1f3fd":0,"1f477-1f3fe":0,"1f477-1f3ff":0,"1f478-1f3fb":0,"1f478-1f3fc":0,"1f478-1f3fd":0,"1f478-1f3fe":0,"1f478-1f3ff":0,"1f47c-1f3fb":0,"1f47c-1f3fc":0,"1f47c-1f3fd":0,"1f47c-1f3fe":0,"1f47c-1f3ff":0,"1f481-1f3fb-200d-2640-fe0f":0,"1f481-1f3fc-200d-2640-fe0f":0,"1f481-1f3fd-200d-2640-fe0f":0,"1f481-1f3fe-200d-2640-fe0f":0,"1f481-1f3ff-200d-2640-fe0f":0,"1f481-1f3fb-200d-2642-fe0f":0,"1f481-1f3fc-200d-2642-fe0f":0,"1f481-1f3fd-200d-2642-fe0f":0,"1f481-1f3fe-200d-2642-fe0f":0,"1f481-1f3ff-200d-2642-fe0f":0,"1f481-1f3fb":0,"1f481-1f3fc":0,"1f481-1f3fd":0,"1f481-1f3fe":0,"1f481-1f3ff":0,"1f482-1f3fb-200d-2640-fe0f":0,"1f482-1f3fc-200d-2640-fe0f":0,"1f482-1f3fd-200d-2640-fe0f":0,"1f482-1f3fe-200d-2640-fe0f":0,"1f482-1f3ff-200d-2640-fe0f":0,"1f482-1f3fb-200d-2642-fe0f":0,"1f482-1f3fc-200d-2642-fe0f":0,"1f482-1f3fd-200d-2642-fe0f":0,"1f482-1f3fe-200d-2642-fe0f":0,"1f482-1f3ff-200d-2642-fe0f":0,"1f482-1f3fb":0,"1f482-1f3fc":0,"1f482-1f3fd":0,"1f482-1f3fe":0,"1f482-1f3ff":0,"1f483-1f3fb":0,"1f483-1f3fc":0,"1f483-1f3fd":0,"1f483-1f3fe":0,"1f483-1f3ff":0,"1f485-1f3fb":0,"1f485-1f3fc":0,"1f485-1f3fd":0,"1f485-1f3fe":0,"1f485-1f3ff":0,"1f486-1f3fb-200d-2640-fe0f":0,"1f486-1f3fc-200d-2640-fe0f":0,"1f486-1f3fd-200d-2640-fe0f":0,"1f486-1f3fe-200d-2640-fe0f":0,"1f486-1f3ff-200d-2640-fe0f":0,"1f486-1f3fb-200d-2642-fe0f":0,"1f486-1f3fc-200d-2642-fe0f":0,"1f486-1f3fd-200d-2642-fe0f":0,"1f486-1f3fe-200d-2642-fe0f":0,"1f486-1f3ff-200d-2642-fe0f":0,"1f486-1f3fb":0,"1f486-1f3fc":0,"1f486-1f3fd":0,"1f486-1f3fe":0,"1f486-1f3ff":0,"1f487-1f3fb-200d-2640-fe0f":0,"1f487-1f3fc-200d-2640-fe0f":0,"1f487-1f3fd-200d-2640-fe0f":0,"1f487-1f3fe-200d-2640-fe0f":0,"1f487-1f3ff-200d-2640-fe0f":0,"1f487-1f3fb-200d-2642-fe0f":0,"1f487-1f3fc-200d-2642-fe0f":0,"1f487-1f3fd-200d-2642-fe0f":0,"1f487-1f3fe-200d-2642-fe0f":0,"1f487-1f3ff-200d-2642-fe0f":0,"1f487-1f3fb":0,"1f487-1f3fc":0,"1f487-1f3fd":0,"1f487-1f3fe":0,"1f487-1f3ff":0,"1f4aa-1f3fb":0,"1f4aa-1f3fc":0,"1f4aa-1f3fd":0,"1f4aa-1f3fe":0,"1f4aa-1f3ff":0,"1f574-1f3fb":0,"1f574-1f3fc":0,"1f574-1f3fd":0,"1f574-1f3fe":0,"1f574-1f3ff":0,"1f575-1f3fb-200d-2640-fe0f":0,"1f575-1f3fc-200d-2640-fe0f":0,"1f575-1f3fd-200d-2640-fe0f":0,"1f575-1f3fe-200d-2640-fe0f":0,"1f575-1f3ff-200d-2640-fe0f":0,"1f575-1f3fb-200d-2642-fe0f":0,"1f575-1f3fc-200d-2642-fe0f":0,"1f575-1f3fd-200d-2642-fe0f":0,"1f575-1f3fe-200d-2642-fe0f":0,"1f575-1f3ff-200d-2642-fe0f":0,"1f575-1f3fb":0,"1f575-1f3fc":0,"1f575-1f3fd":0,"1f575-1f3fe":0,"1f575-1f3ff":0,"1f57a-1f3fb":0,"1f57a-1f3fc":0,"1f57a-1f3fd":0,"1f57a-1f3fe":0,"1f57a-1f3ff":0,"1f590-1f3fb":0,"1f590-1f3fc":0,"1f590-1f3fd":0,"1f590-1f3fe":0,"1f590-1f3ff":0,"1f595-1f3fb":0,"1f595-1f3fc":0,"1f595-1f3fd":0,"1f595-1f3fe":0,"1f595-1f3ff":0,"1f596-1f3fb":0,"1f596-1f3fc":0,"1f596-1f3fd":0,"1f596-1f3fe":0,"1f596-1f3ff":0,"1f645-1f3fb-200d-2640-fe0f":0,"1f645-1f3fc-200d-2640-fe0f":0,"1f645-1f3fd-200d-2640-fe0f":0,"1f645-1f3fe-200d-2640-fe0f":0,"1f645-1f3ff-200d-2640-fe0f":0,"1f645-1f3fb-200d-2642-fe0f":0,"1f645-1f3fc-200d-2642-fe0f":0,"1f645-1f3fd-200d-2642-fe0f":0,"1f645-1f3fe-200d-2642-fe0f":0,"1f645-1f3ff-200d-2642-fe0f":0,"1f645-1f3fb":0,"1f645-1f3fc":0,"1f645-1f3fd":0,"1f645-1f3fe":0,"1f645-1f3ff":0,"1f646-1f3fb-200d-2640-fe0f":0,"1f646-1f3fc-200d-2640-fe0f":0,"1f646-1f3fd-200d-2640-fe0f":0,"1f646-1f3fe-200d-2640-fe0f":0,"1f646-1f3ff-200d-2640-fe0f":0,"1f646-1f3fb-200d-2642-fe0f":0,"1f646-1f3fc-200d-2642-fe0f":0,"1f646-1f3fd-200d-2642-fe0f":0,"1f646-1f3fe-200d-2642-fe0f":0,"1f646-1f3ff-200d-2642-fe0f":0,"1f646-1f3fb":0,"1f646-1f3fc":0,"1f646-1f3fd":0,"1f646-1f3fe":0,"1f646-1f3ff":0,"1f647-1f3fb-200d-2640-fe0f":0,"1f647-1f3fc-200d-2640-fe0f":0,"1f647-1f3fd-200d-2640-fe0f":0,"1f647-1f3fe-200d-2640-fe0f":0,"1f647-1f3ff-200d-2640-fe0f":0,"1f647-1f3fb-200d-2642-fe0f":0,"1f647-1f3fc-200d-2642-fe0f":0,"1f647-1f3fd-200d-2642-fe0f":0,"1f647-1f3fe-200d-2642-fe0f":0,"1f647-1f3ff-200d-2642-fe0f":0,"1f647-1f3fb":0,"1f647-1f3fc":0,"1f647-1f3fd":0,"1f647-1f3fe":0,"1f647-1f3ff":0,"1f64b-1f3fb-200d-2640-fe0f":0,"1f64b-1f3fc-200d-2640-fe0f":0,"1f64b-1f3fd-200d-2640-fe0f":0,"1f64b-1f3fe-200d-2640-fe0f":0,"1f64b-1f3ff-200d-2640-fe0f":0,"1f64b-1f3fb-200d-2642-fe0f":0,"1f64b-1f3fc-200d-2642-fe0f":0,"1f64b-1f3fd-200d-2642-fe0f":0,"1f64b-1f3fe-200d-2642-fe0f":0,"1f64b-1f3ff-200d-2642-fe0f":0,"1f64b-1f3fb":0,"1f64b-1f3fc":0,"1f64b-1f3fd":0,"1f64b-1f3fe":0,"1f64b-1f3ff":0,"1f64c-1f3fb":0,"1f64c-1f3fc":0,"1f64c-1f3fd":0,"1f64c-1f3fe":0,"1f64c-1f3ff":0,"1f64d-1f3fb-200d-2640-fe0f":0,"1f64d-1f3fc-200d-2640-fe0f":0,"1f64d-1f3fd-200d-2640-fe0f":0,"1f64d-1f3fe-200d-2640-fe0f":0,"1f64d-1f3ff-200d-2640-fe0f":0,"1f64d-1f3fb-200d-2642-fe0f":0,"1f64d-1f3fc-200d-2642-fe0f":0,"1f64d-1f3fd-200d-2642-fe0f":0,"1f64d-1f3fe-200d-2642-fe0f":0,"1f64d-1f3ff-200d-2642-fe0f":0,"1f64d-1f3fb":0,"1f64d-1f3fc":0,"1f64d-1f3fd":0,"1f64d-1f3fe":0,"1f64d-1f3ff":0,"1f64e-1f3fb-200d-2640-fe0f":0,"1f64e-1f3fc-200d-2640-fe0f":0,"1f64e-1f3fd-200d-2640-fe0f":0,"1f64e-1f3fe-200d-2640-fe0f":0,"1f64e-1f3ff-200d-2640-fe0f":0,"1f64e-1f3fb-200d-2642-fe0f":0,"1f64e-1f3fc-200d-2642-fe0f":0,"1f64e-1f3fd-200d-2642-fe0f":0,"1f64e-1f3fe-200d-2642-fe0f":0,"1f64e-1f3ff-200d-2642-fe0f":0,"1f64e-1f3fb":0,"1f64e-1f3fc":0,"1f64e-1f3fd":0,"1f64e-1f3fe":0,"1f64e-1f3ff":0,"1f64f-1f3fb":0,"1f64f-1f3fc":0,"1f64f-1f3fd":0,"1f64f-1f3fe":0,"1f64f-1f3ff":0,"1f6a3-1f3fb-200d-2640-fe0f":0,"1f6a3-1f3fc-200d-2640-fe0f":0,"1f6a3-1f3fd-200d-2640-fe0f":0,"1f6a3-1f3fe-200d-2640-fe0f":0,"1f6a3-1f3ff-200d-2640-fe0f":0,"1f6a3-1f3fb-200d-2642-fe0f":0,"1f6a3-1f3fc-200d-2642-fe0f":0,"1f6a3-1f3fd-200d-2642-fe0f":0,"1f6a3-1f3fe-200d-2642-fe0f":0,"1f6a3-1f3ff-200d-2642-fe0f":0,"1f6a3-1f3fb":0,"1f6a3-1f3fc":0,"1f6a3-1f3fd":0,"1f6a3-1f3fe":0,"1f6a3-1f3ff":0,"1f6b4-1f3fb-200d-2640-fe0f":0,"1f6b4-1f3fc-200d-2640-fe0f":0,"1f6b4-1f3fd-200d-2640-fe0f":0,"1f6b4-1f3fe-200d-2640-fe0f":0,"1f6b4-1f3ff-200d-2640-fe0f":0,"1f6b4-1f3fb-200d-2642-fe0f":0,"1f6b4-1f3fc-200d-2642-fe0f":0,"1f6b4-1f3fd-200d-2642-fe0f":0,"1f6b4-1f3fe-200d-2642-fe0f":0,"1f6b4-1f3ff-200d-2642-fe0f":0,"1f6b4-1f3fb":0,"1f6b4-1f3fc":0,"1f6b4-1f3fd":0,"1f6b4-1f3fe":0,"1f6b4-1f3ff":0,"1f6b5-1f3fb-200d-2640-fe0f":0,"1f6b5-1f3fc-200d-2640-fe0f":0,"1f6b5-1f3fd-200d-2640-fe0f":0,"1f6b5-1f3fe-200d-2640-fe0f":0,"1f6b5-1f3ff-200d-2640-fe0f":0,"1f6b5-1f3fb-200d-2642-fe0f":0,"1f6b5-1f3fc-200d-2642-fe0f":0,"1f6b5-1f3fd-200d-2642-fe0f":0,"1f6b5-1f3fe-200d-2642-fe0f":0,"1f6b5-1f3ff-200d-2642-fe0f":0,"1f6b5-1f3fb":0,"1f6b5-1f3fc":0,"1f6b5-1f3fd":0,"1f6b5-1f3fe":0,"1f6b5-1f3ff":0,"1f6b6-1f3fb-200d-2640-fe0f":0,"1f6b6-1f3fc-200d-2640-fe0f":0,"1f6b6-1f3fd-200d-2640-fe0f":0,"1f6b6-1f3fe-200d-2640-fe0f":0,"1f6b6-1f3ff-200d-2640-fe0f":0,"1f6b6-1f3fb-200d-2642-fe0f":0,"1f6b6-1f3fc-200d-2642-fe0f":0,"1f6b6-1f3fd-200d-2642-fe0f":0,"1f6b6-1f3fe-200d-2642-fe0f":0,"1f6b6-1f3ff-200d-2642-fe0f":0,"1f6b6-1f3fb":0,"1f6b6-1f3fc":0,"1f6b6-1f3fd":0,"1f6b6-1f3fe":0,"1f6b6-1f3ff":0,"1f6c0-1f3fb":0,"1f6c0-1f3fc":0,"1f6c0-1f3fd":0,"1f6c0-1f3fe":0,"1f6c0-1f3ff":0,"1f6cc-1f3fb":0,"1f6cc-1f3fc":0,"1f6cc-1f3fd":0,"1f6cc-1f3fe":0,"1f6cc-1f3ff":0,"1f90f-1f3fb":0,"1f90f-1f3fc":0,"1f90f-1f3fd":0,"1f90f-1f3fe":0,"1f90f-1f3ff":0,"1f918-1f3fb":0,"1f918-1f3fc":0,"1f918-1f3fd":0,"1f918-1f3fe":0,"1f918-1f3ff":0,"1f919-1f3fb":0,"1f919-1f3fc":0,"1f919-1f3fd":0,"1f919-1f3fe":0,"1f919-1f3ff":0,"1f91a-1f3fb":0,"1f91a-1f3fc":0,"1f91a-1f3fd":0,"1f91a-1f3fe":0,"1f91a-1f3ff":0,"1f91b-1f3fb":0,"1f91b-1f3fc":0,"1f91b-1f3fd":0,"1f91b-1f3fe":0,"1f91b-1f3ff":0,"1f91c-1f3fb":0,"1f91c-1f3fc":0,"1f91c-1f3fd":0,"1f91c-1f3fe":0,"1f91c-1f3ff":0,"1f91e-1f3fb":0,"1f91e-1f3fc":0,"1f91e-1f3fd":0,"1f91e-1f3fe":0,"1f91e-1f3ff":0,"1f91f-1f3fb":0,"1f91f-1f3fc":0,"1f91f-1f3fd":0,"1f91f-1f3fe":0,"1f91f-1f3ff":0,"1f926-1f3fb-200d-2640-fe0f":0,"1f926-1f3fc-200d-2640-fe0f":0,"1f926-1f3fd-200d-2640-fe0f":0,"1f926-1f3fe-200d-2640-fe0f":0,"1f926-1f3ff-200d-2640-fe0f":0,"1f926-1f3fb-200d-2642-fe0f":0,"1f926-1f3fc-200d-2642-fe0f":0,"1f926-1f3fd-200d-2642-fe0f":0,"1f926-1f3fe-200d-2642-fe0f":0,"1f926-1f3ff-200d-2642-fe0f":0,"1f926-1f3fb":0,"1f926-1f3fc":0,"1f926-1f3fd":0,"1f926-1f3fe":0,"1f926-1f3ff":0,"1f930-1f3fb":0,"1f930-1f3fc":0,"1f930-1f3fd":0,"1f930-1f3fe":0,"1f930-1f3ff":0,"1f931-1f3fb":0,"1f931-1f3fc":0,"1f931-1f3fd":0,"1f931-1f3fe":0,"1f931-1f3ff":0,"1f932-1f3fb":0,"1f932-1f3fc":0,"1f932-1f3fd":0,"1f932-1f3fe":0,"1f932-1f3ff":0,"1f933-1f3fb":0,"1f933-1f3fc":0,"1f933-1f3fd":0,"1f933-1f3fe":0,"1f933-1f3ff":0,"1f934-1f3fb":0,"1f934-1f3fc":0,"1f934-1f3fd":0,"1f934-1f3fe":0,"1f934-1f3ff":0,"1f935-1f3fb":0,"1f935-1f3fc":0,"1f935-1f3fd":0,"1f935-1f3fe":0,"1f935-1f3ff":0,"1f936-1f3fb":0,"1f936-1f3fc":0,"1f936-1f3fd":0,"1f936-1f3fe":0,"1f936-1f3ff":0,"1f937-1f3fb-200d-2640-fe0f":0,"1f937-1f3fc-200d-2640-fe0f":0,"1f937-1f3fd-200d-2640-fe0f":0,"1f937-1f3fe-200d-2640-fe0f":0,"1f937-1f3ff-200d-2640-fe0f":0,"1f937-1f3fb-200d-2642-fe0f":0,"1f937-1f3fc-200d-2642-fe0f":0,"1f937-1f3fd-200d-2642-fe0f":0,"1f937-1f3fe-200d-2642-fe0f":0,"1f937-1f3ff-200d-2642-fe0f":0,"1f937-1f3fb":0,"1f937-1f3fc":0,"1f937-1f3fd":0,"1f937-1f3fe":0,"1f937-1f3ff":0,"1f938-1f3fb-200d-2640-fe0f":0,"1f938-1f3fc-200d-2640-fe0f":0,"1f938-1f3fd-200d-2640-fe0f":0,"1f938-1f3fe-200d-2640-fe0f":0,"1f938-1f3ff-200d-2640-fe0f":0,"1f938-1f3fb-200d-2642-fe0f":0,"1f938-1f3fc-200d-2642-fe0f":0,"1f938-1f3fd-200d-2642-fe0f":0,"1f938-1f3fe-200d-2642-fe0f":0,"1f938-1f3ff-200d-2642-fe0f":0,"1f938-1f3fb":0,"1f938-1f3fc":0,"1f938-1f3fd":0,"1f938-1f3fe":0,"1f938-1f3ff":0,"1f939-1f3fb-200d-2640-fe0f":0,"1f939-1f3fc-200d-2640-fe0f":0,"1f939-1f3fd-200d-2640-fe0f":0,"1f939-1f3fe-200d-2640-fe0f":0,"1f939-1f3ff-200d-2640-fe0f":0,"1f939-1f3fb-200d-2642-fe0f":0,"1f939-1f3fc-200d-2642-fe0f":0,"1f939-1f3fd-200d-2642-fe0f":0,"1f939-1f3fe-200d-2642-fe0f":0,"1f939-1f3ff-200d-2642-fe0f":0,"1f939-1f3fb":0,"1f939-1f3fc":0,"1f939-1f3fd":0,"1f939-1f3fe":0,"1f939-1f3ff":0,"1f93d-1f3fb-200d-2640-fe0f":0,"1f93d-1f3fc-200d-2640-fe0f":0,"1f93d-1f3fd-200d-2640-fe0f":0,"1f93d-1f3fe-200d-2640-fe0f":0,"1f93d-1f3ff-200d-2640-fe0f":0,"1f93d-1f3fb-200d-2642-fe0f":0,"1f93d-1f3fc-200d-2642-fe0f":0,"1f93d-1f3fd-200d-2642-fe0f":0,"1f93d-1f3fe-200d-2642-fe0f":0,"1f93d-1f3ff-200d-2642-fe0f":0,"1f93d-1f3fb":0,"1f93d-1f3fc":0,"1f93d-1f3fd":0,"1f93d-1f3fe":0,"1f93d-1f3ff":0,"1f93e-1f3fb-200d-2640-fe0f":0,"1f93e-1f3fc-200d-2640-fe0f":0,"1f93e-1f3fd-200d-2640-fe0f":0,"1f93e-1f3fe-200d-2640-fe0f":0,"1f93e-1f3ff-200d-2640-fe0f":0,"1f93e-1f3fb-200d-2642-fe0f":0,"1f93e-1f3fc-200d-2642-fe0f":0,"1f93e-1f3fd-200d-2642-fe0f":0,"1f93e-1f3fe-200d-2642-fe0f":0,"1f93e-1f3ff-200d-2642-fe0f":0,"1f93e-1f3fb":0,"1f93e-1f3fc":0,"1f93e-1f3fd":0,"1f93e-1f3fe":0,"1f93e-1f3ff":0,"1f9b5-1f3fb":0,"1f9b5-1f3fc":0,"1f9b5-1f3fd":0,"1f9b5-1f3fe":0,"1f9b5-1f3ff":0,"1f9b6-1f3fb":0,"1f9b6-1f3fc":0,"1f9b6-1f3fd":0,"1f9b6-1f3fe":0,"1f9b6-1f3ff":0,"1f9b8-1f3fb-200d-2640-fe0f":0,"1f9b8-1f3fc-200d-2640-fe0f":0,"1f9b8-1f3fd-200d-2640-fe0f":0,"1f9b8-1f3fe-200d-2640-fe0f":0,"1f9b8-1f3ff-200d-2640-fe0f":0,"1f9b8-1f3fb-200d-2642-fe0f":0,"1f9b8-1f3fc-200d-2642-fe0f":0,"1f9b8-1f3fd-200d-2642-fe0f":0,"1f9b8-1f3fe-200d-2642-fe0f":0,"1f9b8-1f3ff-200d-2642-fe0f":0,"1f9b8-1f3fb":0,"1f9b8-1f3fc":0,"1f9b8-1f3fd":0,"1f9b8-1f3fe":0,"1f9b8-1f3ff":0,"1f9b9-1f3fb-200d-2640-fe0f":0,"1f9b9-1f3fc-200d-2640-fe0f":0,"1f9b9-1f3fd-200d-2640-fe0f":0,"1f9b9-1f3fe-200d-2640-fe0f":0,"1f9b9-1f3ff-200d-2640-fe0f":0,"1f9b9-1f3fb-200d-2642-fe0f":0,"1f9b9-1f3fc-200d-2642-fe0f":0,"1f9b9-1f3fd-200d-2642-fe0f":0,"1f9b9-1f3fe-200d-2642-fe0f":0,"1f9b9-1f3ff-200d-2642-fe0f":0,"1f9b9-1f3fb":0,"1f9b9-1f3fc":0,"1f9b9-1f3fd":0,"1f9b9-1f3fe":0,"1f9b9-1f3ff":0,"1f9bb-1f3fb":0,"1f9bb-1f3fc":0,"1f9bb-1f3fd":0,"1f9bb-1f3fe":0,"1f9bb-1f3ff":0,"1f9cd-1f3fb-200d-2640-fe0f":0,"1f9cd-1f3fc-200d-2640-fe0f":0,"1f9cd-1f3fd-200d-2640-fe0f":0,"1f9cd-1f3fe-200d-2640-fe0f":0,"1f9cd-1f3ff-200d-2640-fe0f":0,"1f9cd-1f3fb-200d-2642-fe0f":0,"1f9cd-1f3fc-200d-2642-fe0f":0,"1f9cd-1f3fd-200d-2642-fe0f":0,"1f9cd-1f3fe-200d-2642-fe0f":0,"1f9cd-1f3ff-200d-2642-fe0f":0,"1f9cd-1f3fb":0,"1f9cd-1f3fc":0,"1f9cd-1f3fd":0,"1f9cd-1f3fe":0,"1f9cd-1f3ff":0,"1f9ce-1f3fb-200d-2640-fe0f":0,"1f9ce-1f3fc-200d-2640-fe0f":0,"1f9ce-1f3fd-200d-2640-fe0f":0,"1f9ce-1f3fe-200d-2640-fe0f":0,"1f9ce-1f3ff-200d-2640-fe0f":0,"1f9ce-1f3fb-200d-2642-fe0f":0,"1f9ce-1f3fc-200d-2642-fe0f":0,"1f9ce-1f3fd-200d-2642-fe0f":0,"1f9ce-1f3fe-200d-2642-fe0f":0,"1f9ce-1f3ff-200d-2642-fe0f":0,"1f9ce-1f3fb":0,"1f9ce-1f3fc":0,"1f9ce-1f3fd":0,"1f9ce-1f3fe":0,"1f9ce-1f3ff":0,"1f9cf-1f3fb-200d-2640-fe0f":0,"1f9cf-1f3fc-200d-2640-fe0f":0,"1f9cf-1f3fd-200d-2640-fe0f":0,"1f9cf-1f3fe-200d-2640-fe0f":0,"1f9cf-1f3ff-200d-2640-fe0f":0,"1f9cf-1f3fb-200d-2642-fe0f":0,"1f9cf-1f3fc-200d-2642-fe0f":0,"1f9cf-1f3fd-200d-2642-fe0f":0,"1f9cf-1f3fe-200d-2642-fe0f":0,"1f9cf-1f3ff-200d-2642-fe0f":0,"1f9cf-1f3fb":0,"1f9cf-1f3fc":0,"1f9cf-1f3fd":0,"1f9cf-1f3fe":0,"1f9cf-1f3ff":0,"1f9d1-1f3fb-200d-1f33e":0,"1f9d1-1f3fc-200d-1f33e":0,"1f9d1-1f3fd-200d-1f33e":0,"1f9d1-1f3fe-200d-1f33e":0,"1f9d1-1f3ff-200d-1f33e":0,"1f9d1-1f3fb-200d-1f373":0,"1f9d1-1f3fc-200d-1f373":0,"1f9d1-1f3fd-200d-1f373":0,"1f9d1-1f3fe-200d-1f373":0,"1f9d1-1f3ff-200d-1f373":0,"1f9d1-1f3fb-200d-1f393":0,"1f9d1-1f3fc-200d-1f393":0,"1f9d1-1f3fd-200d-1f393":0,"1f9d1-1f3fe-200d-1f393":0,"1f9d1-1f3ff-200d-1f393":0,"1f9d1-1f3fb-200d-1f3a4":0,"1f9d1-1f3fc-200d-1f3a4":0,"1f9d1-1f3fd-200d-1f3a4":0,"1f9d1-1f3fe-200d-1f3a4":0,"1f9d1-1f3ff-200d-1f3a4":0,"1f9d1-1f3fb-200d-1f3a8":0,"1f9d1-1f3fc-200d-1f3a8":0,"1f9d1-1f3fd-200d-1f3a8":0,"1f9d1-1f3fe-200d-1f3a8":0,"1f9d1-1f3ff-200d-1f3a8":0,"1f9d1-1f3fb-200d-1f3eb":0,"1f9d1-1f3fc-200d-1f3eb":0,"1f9d1-1f3fd-200d-1f3eb":0,"1f9d1-1f3fe-200d-1f3eb":0,"1f9d1-1f3ff-200d-1f3eb":0,"1f9d1-1f3fb-200d-1f3ed":0,"1f9d1-1f3fc-200d-1f3ed":0,"1f9d1-1f3fd-200d-1f3ed":0,"1f9d1-1f3fe-200d-1f3ed":0,"1f9d1-1f3ff-200d-1f3ed":0,"1f9d1-1f3fb-200d-1f4bb":0,"1f9d1-1f3fc-200d-1f4bb":0,"1f9d1-1f3fd-200d-1f4bb":0,"1f9d1-1f3fe-200d-1f4bb":0,"1f9d1-1f3ff-200d-1f4bb":0,"1f9d1-1f3fb-200d-1f4bc":0,"1f9d1-1f3fc-200d-1f4bc":0,"1f9d1-1f3fd-200d-1f4bc":0,"1f9d1-1f3fe-200d-1f4bc":0,"1f9d1-1f3ff-200d-1f4bc":0,"1f9d1-1f3fb-200d-1f527":0,"1f9d1-1f3fc-200d-1f527":0,"1f9d1-1f3fd-200d-1f527":0,"1f9d1-1f3fe-200d-1f527":0,"1f9d1-1f3ff-200d-1f527":0,"1f9d1-1f3fb-200d-1f52c":0,"1f9d1-1f3fc-200d-1f52c":0,"1f9d1-1f3fd-200d-1f52c":0,"1f9d1-1f3fe-200d-1f52c":0,"1f9d1-1f3ff-200d-1f52c":0,"1f9d1-1f3fb-200d-1f680":0,"1f9d1-1f3fc-200d-1f680":0,"1f9d1-1f3fd-200d-1f680":0,"1f9d1-1f3fe-200d-1f680":0,"1f9d1-1f3ff-200d-1f680":0,"1f9d1-1f3fb-200d-1f692":0,"1f9d1-1f3fc-200d-1f692":0,"1f9d1-1f3fd-200d-1f692":0,"1f9d1-1f3fe-200d-1f692":0,"1f9d1-1f3ff-200d-1f692":0,"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fb":0,"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fc":0,"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fd":0,"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fe":0,"1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3ff":0,"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fb":0,"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fc":0,"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fd":0,"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fe":0,"1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3ff":0,"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fb":0,"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fc":0,"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fd":0,"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fe":0,"1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3ff":0,"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fb":0,"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fc":0,"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fd":0,"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fe":0,"1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3ff":0,"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fb":0,"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fc":0,"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fd":0,"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fe":0,"1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3ff":0,"1f9d1-1f3fb-200d-1f9af":0,"1f9d1-1f3fc-200d-1f9af":0,"1f9d1-1f3fd-200d-1f9af":0,"1f9d1-1f3fe-200d-1f9af":0,"1f9d1-1f3ff-200d-1f9af":0,"1f9d1-1f3fb-200d-1f9b0":0,"1f9d1-1f3fc-200d-1f9b0":0,"1f9d1-1f3fd-200d-1f9b0":0,"1f9d1-1f3fe-200d-1f9b0":0,"1f9d1-1f3ff-200d-1f9b0":0,"1f9d1-1f3fb-200d-1f9b1":0,"1f9d1-1f3fc-200d-1f9b1":0,"1f9d1-1f3fd-200d-1f9b1":0,"1f9d1-1f3fe-200d-1f9b1":0,"1f9d1-1f3ff-200d-1f9b1":0,"1f9d1-1f3fb-200d-1f9b2":0,"1f9d1-1f3fc-200d-1f9b2":0,"1f9d1-1f3fd-200d-1f9b2":0,"1f9d1-1f3fe-200d-1f9b2":0,"1f9d1-1f3ff-200d-1f9b2":0,"1f9d1-1f3fb-200d-1f9b3":0,"1f9d1-1f3fc-200d-1f9b3":0,"1f9d1-1f3fd-200d-1f9b3":0,"1f9d1-1f3fe-200d-1f9b3":0,"1f9d1-1f3ff-200d-1f9b3":0,"1f9d1-1f3fb-200d-1f9bc":0,"1f9d1-1f3fc-200d-1f9bc":0,"1f9d1-1f3fd-200d-1f9bc":0,"1f9d1-1f3fe-200d-1f9bc":0,"1f9d1-1f3ff-200d-1f9bc":0,"1f9d1-1f3fb-200d-1f9bd":0,"1f9d1-1f3fc-200d-1f9bd":0,"1f9d1-1f3fd-200d-1f9bd":0,"1f9d1-1f3fe-200d-1f9bd":0,"1f9d1-1f3ff-200d-1f9bd":0,"1f9d1-1f3fb-200d-2695-fe0f":0,"1f9d1-1f3fc-200d-2695-fe0f":0,"1f9d1-1f3fd-200d-2695-fe0f":0,"1f9d1-1f3fe-200d-2695-fe0f":0,"1f9d1-1f3ff-200d-2695-fe0f":0,"1f9d1-1f3fb-200d-2696-fe0f":0,"1f9d1-1f3fc-200d-2696-fe0f":0,"1f9d1-1f3fd-200d-2696-fe0f":0,"1f9d1-1f3fe-200d-2696-fe0f":0,"1f9d1-1f3ff-200d-2696-fe0f":0,"1f9d1-1f3fb-200d-2708-fe0f":0,"1f9d1-1f3fc-200d-2708-fe0f":0,"1f9d1-1f3fd-200d-2708-fe0f":0,"1f9d1-1f3fe-200d-2708-fe0f":0,"1f9d1-1f3ff-200d-2708-fe0f":0,"1f9d1-1f3fb":0,"1f9d1-1f3fc":0,"1f9d1-1f3fd":0,"1f9d1-1f3fe":0,"1f9d1-1f3ff":0,"1f9d2-1f3fb":0,"1f9d2-1f3fc":0,"1f9d2-1f3fd":0,"1f9d2-1f3fe":0,"1f9d2-1f3ff":0,"1f9d3-1f3fb":0,"1f9d3-1f3fc":0,"1f9d3-1f3fd":0,"1f9d3-1f3fe":0,"1f9d3-1f3ff":0,"1f9d4-1f3fb":0,"1f9d4-1f3fc":0,"1f9d4-1f3fd":0,"1f9d4-1f3fe":0,"1f9d4-1f3ff":0,"1f9d5-1f3fb":0,"1f9d5-1f3fc":0,"1f9d5-1f3fd":0,"1f9d5-1f3fe":0,"1f9d5-1f3ff":0,"1f9d6-1f3fb-200d-2640-fe0f":0,"1f9d6-1f3fc-200d-2640-fe0f":0,"1f9d6-1f3fd-200d-2640-fe0f":0,"1f9d6-1f3fe-200d-2640-fe0f":0,"1f9d6-1f3ff-200d-2640-fe0f":0,"1f9d6-1f3fb-200d-2642-fe0f":0,"1f9d6-1f3fc-200d-2642-fe0f":0,"1f9d6-1f3fd-200d-2642-fe0f":0,"1f9d6-1f3fe-200d-2642-fe0f":0,"1f9d6-1f3ff-200d-2642-fe0f":0,"1f9d6-1f3fb":0,"1f9d6-1f3fc":0,"1f9d6-1f3fd":0,"1f9d6-1f3fe":0,"1f9d6-1f3ff":0,"1f9d7-1f3fb-200d-2640-fe0f":0,"1f9d7-1f3fc-200d-2640-fe0f":0,"1f9d7-1f3fd-200d-2640-fe0f":0,"1f9d7-1f3fe-200d-2640-fe0f":0,"1f9d7-1f3ff-200d-2640-fe0f":0,"1f9d7-1f3fb-200d-2642-fe0f":0,"1f9d7-1f3fc-200d-2642-fe0f":0,"1f9d7-1f3fd-200d-2642-fe0f":0,"1f9d7-1f3fe-200d-2642-fe0f":0,"1f9d7-1f3ff-200d-2642-fe0f":0,"1f9d7-1f3fb":0,"1f9d7-1f3fc":0,"1f9d7-1f3fd":0,"1f9d7-1f3fe":0,"1f9d7-1f3ff":0,"1f9d8-1f3fb-200d-2640-fe0f":0,"1f9d8-1f3fc-200d-2640-fe0f":0,"1f9d8-1f3fd-200d-2640-fe0f":0,"1f9d8-1f3fe-200d-2640-fe0f":0,"1f9d8-1f3ff-200d-2640-fe0f":0,"1f9d8-1f3fb-200d-2642-fe0f":0,"1f9d8-1f3fc-200d-2642-fe0f":0,"1f9d8-1f3fd-200d-2642-fe0f":0,"1f9d8-1f3fe-200d-2642-fe0f":0,"1f9d8-1f3ff-200d-2642-fe0f":0,"1f9d8-1f3fb":0,"1f9d8-1f3fc":0,"1f9d8-1f3fd":0,"1f9d8-1f3fe":0,"1f9d8-1f3ff":0,"1f9d9-1f3fb-200d-2640-fe0f":0,"1f9d9-1f3fc-200d-2640-fe0f":0,"1f9d9-1f3fd-200d-2640-fe0f":0,"1f9d9-1f3fe-200d-2640-fe0f":0,"1f9d9-1f3ff-200d-2640-fe0f":0,"1f9d9-1f3fb-200d-2642-fe0f":0,"1f9d9-1f3fc-200d-2642-fe0f":0,"1f9d9-1f3fd-200d-2642-fe0f":0,"1f9d9-1f3fe-200d-2642-fe0f":0,"1f9d9-1f3ff-200d-2642-fe0f":0,"1f9d9-1f3fb":0,"1f9d9-1f3fc":0,"1f9d9-1f3fd":0,"1f9d9-1f3fe":0,"1f9d9-1f3ff":0,"1f9da-1f3fb-200d-2640-fe0f":0,"1f9da-1f3fc-200d-2640-fe0f":0,"1f9da-1f3fd-200d-2640-fe0f":0,"1f9da-1f3fe-200d-2640-fe0f":0,"1f9da-1f3ff-200d-2640-fe0f":0,"1f9da-1f3fb-200d-2642-fe0f":0,"1f9da-1f3fc-200d-2642-fe0f":0,"1f9da-1f3fd-200d-2642-fe0f":0,"1f9da-1f3fe-200d-2642-fe0f":0,"1f9da-1f3ff-200d-2642-fe0f":0,"1f9da-1f3fb":0,"1f9da-1f3fc":0,"1f9da-1f3fd":0,"1f9da-1f3fe":0,"1f9da-1f3ff":0,"1f9db-1f3fb-200d-2640-fe0f":0,"1f9db-1f3fc-200d-2640-fe0f":0,"1f9db-1f3fd-200d-2640-fe0f":0,"1f9db-1f3fe-200d-2640-fe0f":0,"1f9db-1f3ff-200d-2640-fe0f":0,"1f9db-1f3fb-200d-2642-fe0f":0,"1f9db-1f3fc-200d-2642-fe0f":0,"1f9db-1f3fd-200d-2642-fe0f":0,"1f9db-1f3fe-200d-2642-fe0f":0,"1f9db-1f3ff-200d-2642-fe0f":0,"1f9db-1f3fb":0,"1f9db-1f3fc":0,"1f9db-1f3fd":0,"1f9db-1f3fe":0,"1f9db-1f3ff":0,"1f9dc-1f3fb-200d-2640-fe0f":0,"1f9dc-1f3fc-200d-2640-fe0f":0,"1f9dc-1f3fd-200d-2640-fe0f":0,"1f9dc-1f3fe-200d-2640-fe0f":0,"1f9dc-1f3ff-200d-2640-fe0f":0,"1f9dc-1f3fb-200d-2642-fe0f":0,"1f9dc-1f3fc-200d-2642-fe0f":0,"1f9dc-1f3fd-200d-2642-fe0f":0,"1f9dc-1f3fe-200d-2642-fe0f":0,"1f9dc-1f3ff-200d-2642-fe0f":0,"1f9dc-1f3fb":0,"1f9dc-1f3fc":0,"1f9dc-1f3fd":0,"1f9dc-1f3fe":0,"1f9dc-1f3ff":0,"1f9dd-1f3fb-200d-2640-fe0f":0,"1f9dd-1f3fc-200d-2640-fe0f":0,"1f9dd-1f3fd-200d-2640-fe0f":0,"1f9dd-1f3fe-200d-2640-fe0f":0,"1f9dd-1f3ff-200d-2640-fe0f":0,"1f9dd-1f3fb-200d-2642-fe0f":0,"1f9dd-1f3fc-200d-2642-fe0f":0,"1f9dd-1f3fd-200d-2642-fe0f":0,"1f9dd-1f3fe-200d-2642-fe0f":0,"1f9dd-1f3ff-200d-2642-fe0f":0,"1f9dd-1f3fb":0,"1f9dd-1f3fc":0,"1f9dd-1f3fd":0,"1f9dd-1f3fe":0,"1f9dd-1f3ff":0,"261d-1f3fb":0,"261d-1f3fc":0,"261d-1f3fd":0,"261d-1f3fe":0,"261d-1f3ff":0,"26f9-1f3fb-200d-2640-fe0f":0,"26f9-1f3fc-200d-2640-fe0f":0,"26f9-1f3fd-200d-2640-fe0f":0,"26f9-1f3fe-200d-2640-fe0f":0,"26f9-1f3ff-200d-2640-fe0f":0,"26f9-1f3fb-200d-2642-fe0f":0,"26f9-1f3fc-200d-2642-fe0f":0,"26f9-1f3fd-200d-2642-fe0f":0,"26f9-1f3fe-200d-2642-fe0f":0,"26f9-1f3ff-200d-2642-fe0f":0,"26f9-1f3fb":0,"26f9-1f3fc":0,"26f9-1f3fd":0,"26f9-1f3fe":0,"26f9-1f3ff":0,"270a-1f3fb":0,"270a-1f3fc":0,"270a-1f3fd":0,"270a-1f3fe":0,"270a-1f3ff":0,"270b-1f3fb":0,"270b-1f3fc":0,"270b-1f3fd":0,"270b-1f3fe":0,"270b-1f3ff":0,"270c-1f3fb":0,"270c-1f3fc":0,"270c-1f3fd":0,"270c-1f3fe":0,"270c-1f3ff":0,"270d-1f3fb":0,"270d-1f3fc":0,"270d-1f3fd":0,"270d-1f3fe":0,"270d-1f3ff":0},t.Emoji["00a9-fe0f"]=6362,t.Emoji["00ae-fe0f"]=6363,t.Emoji["2122-fe0f"]=6364,t.TLD=["abogado","ac","academy","accountants","active","actor","ad","adult","ae","aero","af","ag","agency","ai","airforce","al","allfinanz","alsace","am","amsterdam","an","android","ao","apartments","aq","aquarelle","ar","archi","army","arpa","as","asia","associates","at","attorney","au","auction","audio","autos","aw","ax","axa","az","ba","band","bank","bar","barclaycard","barclays","bargains","bayern","bb","bd","be","beer","berlin","best","bf","bg","bh","bi","bid","bike","bingo","bio","biz","bj","black","blackfriday","bloomberg","blue","bm","bmw","bn","bnpparibas","bo","boo","boutique","br","brussels","bs","bt","budapest","build","builders","business","buzz","bv","bw","by","bz","bzh","ca","cab","cal","camera","camp","cancerresearch","canon","capetown","capital","caravan","cards","care","career","careers","cartier","casa","cash","cat","catering","cc","cd","center","ceo","cern","cf","cg","ch","channel","chat","cheap","christmas","chrome","church","ci","citic","city","ck","cl","claims","cleaning","click","clinic","clothing","club","cm","cn","co","coach","codes","coffee","college","cologne","com","community","company","computer","condos","construction","consulting","contractors","cooking","cool","coop","country","cr","credit","creditcard","cricket","crs","cruises","cu","cuisinella","cv","cw","cx","cy","cymru","cz","dabur","dad","dance","dating","day","dclk","de","deals","degree","delivery","democrat","dental","dentist","desi","design","dev","diamonds","diet","digital","direct","directory","discount","dj","dk","dm","dnp","do","docs","domains","doosan","durban","dvag","dz","eat","ec","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","equipment","er","es","esq","estate","et","eu","eurovision","eus","events","everbank","exchange","expert","exposed","fail","farm","fashion","feedback","fi","finance","financial","firmdale","fish","fishing","fit","fitness","fj","fk","flights","florist","flowers","flsmidth","fly","fm","fo","foo","forsale","foundation","fr","frl","frogans","fund","furniture","futbol","ga","gal","gallery","garden","gb","gbiz","gd","ge","gent","gf","gg","ggee","gh","gi","gift","gifts","gives","gl","glass","gle","global","globo","gm","gmail","gmo","gmx","gn","goog","google","gop","gov","gp","gq","gr","graphics","gratis","green","gripe","gs","gt","gu","guide","guitars","guru","gw","gy","hamburg","hangout","haus","healthcare","help","here","hermes","hiphop","hiv","hk","hm","hn","holdings","holiday","homes","horse","host","hosting","house","how","hr","ht","hu","ibm","id","ie","ifm","il","im","immo","immobilien","in","industries","info","ing","ink","institute","insure","int","international","investments","io","iq","ir","irish","is","it","iwc","jcb","je","jetzt","jm","jo","jobs","joburg","jp","juegos","kaufen","kddi","ke","kg","kh","ki","kim","kitchen","kiwi","km","kn","koeln","kp","kr","krd","kred","kw","ky","kyoto","kz","la","lacaixa","land","lat","latrobe","lawyer","lb","lc","lds","lease","legal","lgbt","li","lidl","life","lighting","limited","limo","link","lk","loans","london","lotte","lotto","lr","ls","lt","ltda","lu","luxe","luxury","lv","ly","ma","madrid","maison","management","mango","market","marketing","marriott","mc","md","me","media","meet","melbourne","meme","memorial","menu","mg","mh","miami","mil","mini","mk","ml","mm","mn","mo","mobi","moda","moe","monash","money","mormon","mortgage","moscow","motorcycles","mov","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","nagoya","name","navy","nc","ne","net","network","neustar","new","nexus","nf","ng","ngo","nhk","ni","nico","ninja","nl","no","np","nr","nra","nrw","ntt","nu","nyc","nz","okinawa","om","one","ong","onl","ooo","org","organic","osaka","otsuka","ovh","pa","paris","partners","parts","party","pe","pf","pg","ph","pharmacy","photo","photography","photos","physio","pics","pictures","pink","pizza","pk","pl","place","plumbing","pm","pn","pohl","poker","porn","post","pr","praxi","press","pro","prod","productions","prof","properties","property","ps","pt","pub","pw","py","qa","qpon","quebec","re","realtor","recipes","red","rehab","reise","reisen","reit","ren","rentals","repair","report","republican","rest","restaurant","reviews","rich","rio","rip","ro","rocks","rodeo","rs","rsvp","ru","ruhr","rw","ryukyu","sa","saarland","sale","samsung","sarl","saxo","sb","sc","sca","scb","schmidt","schule","schwarz","science","scot","sd","se","services","sew","sexy","sg","sh","shiksha","shoes","shriram","si","singles","sj","sk","sky","sl","sm","sn","so","social","software","sohu","solar","solutions","soy","space","spiegel","sr","st","style","su","supplies","supply","support","surf","surgery","suzuki","sv","sx","sy","sydney","systems","sz","taipei","tatar","tattoo","tax","tc","td","technology","tel","temasek","tennis","tf","tg","th","tienda","tips","tires","tirol","tj","tk","tl","tm","tn","to","today","tokyo","tools","top","toshiba","town","toys","tp","tr","trade","training","travel","trust","tt","tui","tv","tw","tz","ua","ug","uk","university","uno","uol","us","uy","uz","va","vacations","vc","ve","vegas","ventures","versicherung","vet","vg","vi","viajes","video","villas","vision","vlaanderen","vn","vodka","vote","voting","voto","voyage","vu","wales","wang","watch","webcam","website","wed","wedding","wf","whoswho","wien","wiki","williamhill","wme","work","works","world","ws","wtc","wtf","佛山","集团","在线","한국","ভারত","八卦","موقع","公益","公司","移动","我爱你","москва","қаз","онлайн","сайт","срб","淡马锡","орг","삼성","சிங்கப்பூர்","商标","商店","商城","дети","мкд","中文网","中信","中国","中國","谷歌","భారత్","ලංකා","ભારત","भारत","网店","संगठन","网络","укр","香港","台湾","台灣","手机","мон","الجزائر","عمان","ایران","امارات","بازار","الاردن","بھارت","المغرب","السعودية","مليسيا","شبكة","გე","机构","组织机构","ไทย","سورية","рус","рф","تونس","みんな","グーグル","世界","ਭਾਰਤ","网址","游戏","vermögensberater","vermögensberatung","企业","مصر","قطر","广东","இலங்கை","இந்தியா","新加坡","فلسطين","政务","xxx","xyz","yachts","yandex","ye","yoga","yokohama","youtube","yt","za","zip","zm","zone","zuerich","zw"],t.LatinizeMap={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"A","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Ö":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","ẞ":"SS","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"U","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"a","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"o","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ß":"ss","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x","Ё":"YO","Й":"I","Ц":"TS","У":"U","К":"K","Е":"E","Н":"N","Г":"G","Ш":"SH","Щ":"SCH","З":"Z","Х":"H","Ъ":"","ё":"yo","й":"i","ц":"ts","у":"u","к":"k","е":"e","н":"n","г":"g","ш":"sh","щ":"sch","з":"z","х":"h","ъ":"","Ф":"F","Ы":"I","В":"V","А":"A","П":"P","Р":"R","О":"O","Л":"L","Д":"D","Ж":"ZH","Э":"E","ф":"f","ы":"i","в":"v","а":"a","п":"p","р":"r","о":"o","л":"l","д":"d","ж":"zh","э":"e","Я":"Ya","Ч":"CH","С":"S","М":"M","И":"I","Т":"T","Ь":"","Б":"B","Ю":"YU","я":"ya","ч":"ch","с":"s","м":"m","и":"i","т":"t","ь":"","б":"b","ю":"yu"};const o={Emoji:t.Emoji,LatinizeMap:t.LatinizeMap,TLD:t.TLD,MediaSizes:n.default};a.MOUNT_CLASS_TO&&(a.MOUNT_CLASS_TO.Config=o),t.default=o},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebpWorkerController=void 0;const n=i(s(115)),a=s(30),o=i(s(5)),r=s(2);class d{constructor(){this.convertPromises={}}init(){this.worker=new n.default,this.worker.addEventListener("message",e=>{const t=e.data.payload;if(0===t.fileName.indexOf("main-")){const e=this.convertPromises[t.fileName];e&&(t.bytes?e.resolve(t.bytes):e.reject(),delete this.convertPromises[t.fileName])}else o.default.postMessage(e.data)})}postMessage(e){this.init&&(this.init(),this.init=null),this.worker.postMessage(e)}isWebpSupported(){return void 0===this.isWebpSupportedCache&&(this.isWebpSupportedCache=document.createElement("canvas").toDataURL("image/webp").startsWith("data:image/webp")),this.isWebpSupportedCache}convert(e,t){if(e="main-"+e,this.convertPromises.hasOwnProperty(e))return this.convertPromises[e];const s=a.deferredPromise();return this.postMessage({type:"convertWebp",payload:{fileName:e,bytes:t}}),this.convertPromises[e]=s}}t.WebpWorkerController=d;const l=new d;r.MOUNT_CLASS_TO&&(r.MOUNT_CLASS_TO.webpWorkerController=l),t.default=l},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(67));class a{createIndex(){return{fullTexts:{}}}cleanSearchText(e,t=!0){const s="%"==e.charAt(0);return e=e.replace(a.badCharsRe,"").replace(a.trimRe,""),t&&(e=e.replace(/[^A-Za-z0-9]/g,e=>{const t=n.default.LatinizeMap[e];return void 0!==t?t:e})),e=e.toLowerCase(),s&&(e="%"+e),e}cleanUsername(e){return e&&e.toLowerCase()||""}indexObject(e,t,s){return!s.fullTexts.hasOwnProperty(e)&&(!!(t=this.cleanSearchText(t)).length&&void(s.fullTexts[e]=t))}search(e,t){const s=t.fullTexts,i={},n=(e=this.cleanSearchText(e)).split(" ");for(const e in s){const t=s[e];let a=!0;for(const e of n)if(-1===t.indexOf(e)){a=!1;break}a&&(i[e]=!0)}return i}}a.badCharsRe=/[`~!@#$%^&*()\-_=+\[\]\\|{}'";:\/?.>,<]+/g,a.trimRe=/^\s+|\s$/g,t.default=new a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFileURL=t.getFileNameByLocation=void 0,t.getFileNameByLocation=function(e,t){const s=""["".length-1]||"";switch(e._){case"inputPhotoFileLocation":case"inputDocumentFileLocation":{const t=e.thumb_size?"_"+e.thumb_size:"";return(""[0]?""[0]+"_":"")+e.id+t+(s?"."+s:s)}case"fileLocationToBeDeprecated":case"inputPeerPhotoFileLocation":case"inputStickerSetThumb":case"inputFileLocation":return e.volume_id+"_"+e.local_id+(s?"."+s:s);default:return console.error("Unrecognized location:",e),""}},t.getFileURL=function(e,t){return"/"+e+"/"+encodeURIComponent(JSON.stringify(t))}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppMediaViewerAvatar=void 0;const d=s(30),l=r(s(9)),c=s(11),f=s(12),h=r(s(21)),u=r(s(15)),p=r(s(7)),g=r(s(10)),m=r(s(20)),b=s(16),v=r(s(73)),y=s(3),M=r(s(1)),_=s(0),w=r(s(22)),S=r(s(50)),I=r(s(42)),L=r(s(38)),E=r(s(64)),C=s(25),T=s(4),P=r(s(52)),k=r(s(46)),x=r(s(6)),A=a(s(29)),D=r(s(163)),X=s(18);class F{constructor(e){this.author={},this.content={},this.buttons={},this.tempId=0,this.preloader=null,this.preloaderStreamable=null,this.lastTarget=null,this.prevTargets=[],this.nextTargets=[],this.isFirstOpen=!0,this.loadMediaPromiseUp=null,this.loadMediaPromiseDown=null,this.loadedAllMediaUp=!1,this.loadedAllMediaDown=!1,this.reverse=!1,this.needLoadMore=!0,this.pageEl=document.getElementById("page-chats"),this.onClick=e=>{if(this.setMoverAnimationPromise)return;const t=e.target;if("A"==t.tagName)return;if(_.cancelEvent(e),c.isTouchSupported)return this.highlightSwitchersTimeout?clearTimeout(this.highlightSwitchersTimeout):this.wholeDiv.classList.add("highlight-switchers"),void(this.highlightSwitchersTimeout=window.setTimeout(()=>{this.wholeDiv.classList.remove("highlight-switchers"),this.highlightSwitchersTimeout=0},3e3));let s=null;["media-viewer-mover","media-viewer-buttons","media-viewer-author","media-viewer-caption"].find(e=>{try{if(s=_.findUpClassName(t,e),s)return!0}catch(e){return!1}}),s&&"IMG"!=t.tagName&&"image"!=t.tagName||this.buttons.close.click()},this.onKeyDown=e=>{"Escape"==e.key?this.close():"ArrowRight"==e.key?this.buttons.next.click():"ArrowLeft"==e.key&&this.buttons.prev.click()},this.log=b.logger("AMV"),this.preloader=new k.default,this.preloaderStreamable=new k.default(void 0,!1,!0),this.lazyLoadQueue=new C.LazyLoadQueueBase,this.wholeDiv=document.createElement("div"),this.wholeDiv.classList.add("media-viewer-whole"),this.overlaysDiv=document.createElement("div"),this.overlaysDiv.classList.add("overlays");const t=document.createElement("div");t.classList.add("media-viewer"),this.author.container=document.createElement("div"),this.author.container.classList.add("media-viewer-author","no-select"),this.author.avatarEl=new I.default,this.author.avatarEl.classList.add("media-viewer-userpic","avatar-44"),this.author.nameEl=document.createElement("div"),this.author.nameEl.classList.add("media-viewer-name"),this.author.date=document.createElement("div"),this.author.date.classList.add("media-viewer-date"),this.author.container.append(this.author.avatarEl,this.author.nameEl,this.author.date);const s=document.createElement("div");s.classList.add("media-viewer-buttons"),e.concat(["download","close"]).forEach(e=>{const t=L.default(e);this.buttons[e]=t,s.append(t)}),this.content.main=document.createElement("div"),this.content.main.classList.add("media-viewer-content"),this.content.container=document.createElement("div"),this.content.container.classList.add("media-viewer-container"),this.content.media=document.createElement("div"),this.content.media.classList.add("media-viewer-media"),this.content.container.append(this.content.media),this.content.main.append(this.content.container),t.append(this.author.container,s,this.content.main),this.overlaysDiv.append(t),this.buttons["mobile-close"]=L.default("close",{onlyMobile:!0}),this.buttons.prev=document.createElement("div"),this.buttons.prev.className="media-viewer-switcher media-viewer-switcher-left",this.buttons.prev.innerHTML='<span class="tgico-down media-viewer-prev-button"></span>',this.buttons.next=document.createElement("div"),this.buttons.next.className="media-viewer-switcher media-viewer-switcher-right",this.buttons.next.innerHTML='<span class="tgico-down media-viewer-next-button"></span>',this.wholeDiv.append(this.overlaysDiv,this.buttons["mobile-close"],this.buttons.prev,this.buttons.next),this.setNewMover()}setListeners(){if(this.buttons.download.addEventListener("click",this.onDownloadClick),[this.buttons.close,this.buttons["mobile-close"],this.preloaderStreamable.preloader].forEach(e=>{e.addEventListener("click",this.close.bind(this))}),this.buttons.prev.addEventListener("click",e=>{if(_.cancelEvent(e),this.setMoverPromise)return;const t=this.prevTargets.pop();t?this.onPrevClick(t):this.buttons.prev.style.display="none"}),this.buttons.next.addEventListener("click",e=>{if(_.cancelEvent(e),this.setMoverPromise)return;let t=this.nextTargets.shift();t?this.onNextClick(t):this.buttons.next.style.display="none"}),this.wholeDiv.addEventListener("click",this.onClick),c.isTouchSupported){new D.default(this.wholeDiv,(e,t)=>{if(v.default.isFullScreen())return;if(Math.abs(e)/m.default.windowW>.2||e>125)return e<0?this.buttons.prev.click():this.buttons.next.click(),!0;return(Math.abs(t)/m.default.windowH>.2||t>125)&&(this.buttons.close.click(),!0)},e=>"INPUT"!=e.target.tagName&&!_.findUpClassName(e.target,"media-viewer-caption"))}}setBtnMenuToggle(e){const t=E.default({onlyMobile:!0},"bottom-left",e);this.wholeDiv.append(t)}close(e){if(e&&_.cancelEvent(e),this.setMoverAnimationPromise)return;this.lazyLoadQueue.clear();const t=this.setMoverToTarget(this.lastTarget,!0).then(({onAnimationEnd:e})=>e);return this.lastTarget=null,this.prevTargets=[],this.nextTargets=[],this.loadedAllMediaUp=this.loadedAllMediaDown=!1,this.loadMediaPromiseUp=this.loadMediaPromiseDown=null,this.setMoverPromise=null,this.tempId=-1,window.removeEventListener("keydown",this.onKeyDown),t.finally(()=>{this.wholeDiv.remove(),M.default.overlayIsActive=!1,w.default.checkAnimations(!1)}),t}setMoverToTarget(e,t=!1,s=0){return o(this,void 0,void 0,(function*(){const i=this.content.mover;e||(e=this.content.media),t||(i.innerHTML=""),this.removeCenterFromMover(i);const n=0!==s,a=n?350:200;let o,r;this.log("setMoverToTarget",e,t,n,s),e&&(e instanceof I.default?(o=e,r=e.getBoundingClientRect()):e instanceof SVGImageElement||e.parentElement instanceof SVGForeignObjectElement?(o=_.findUpClassName(e,"attachment"),r=o.getBoundingClientRect()):(o=e.parentElement,r=e.getBoundingClientRect()));const l=this.content.media.getBoundingClientRect();let c,f,h,u="";if(n?(c=1===s?m.default.windowW:-l.width,f=l.top):(c=r.left,f=r.top),u+=`translate3d(${c}px,${f}px,0) `,e instanceof HTMLImageElement||e instanceof HTMLVideoElement||"DIV"==e.tagName){if(i.firstElementChild&&i.firstElementChild.classList.contains("media-viewer-aspecter")){h=i.firstElementChild;const e=h.querySelector(".ckin__player");if(e){const t=e.firstElementChild;h.append(t),e.remove()}h.style.cssText||(i.classList.remove("active"),this.setFullAspect(h,l,r),i.offsetLeft,i.classList.add("active"))}else h=document.createElement("div"),h.classList.add("media-viewer-aspecter"),i.prepend(h);h.style.cssText=`width: ${r.width}px; height: ${r.height}px; transform: scale3d(${l.width/r.width}, ${l.height/r.height}, 1);`}i.style.width=l.width+"px",i.style.height=l.height+"px";const p=r.width/l.width,g=r.height/l.height;n||(u+=`scale3d(${p},${g},1) `);let b=window.getComputedStyle(o).getPropertyValue("border-radius");const v=_.fillPropertyValue(b);let y;b=v.map(e=>parseInt(e)/p+"px").join(" "),n||(i.style.borderRadius=b),i.style.transform=u;const M=e.classList.contains("is-out"),w=this.setMoverAnimationPromise=d.deferredPromise(),S={onAnimationEnd:w};if(this.setMoverAnimationPromise.then(()=>{this.setMoverAnimationPromise=null}),t)return e instanceof SVGSVGElement&&(y=i.querySelector("path"),y&&this.sizeTailPath(y,l,p,a,!1,M,b)),e.classList.contains("media-viewer-media")&&i.classList.add("hiding"),setTimeout(()=>{this.wholeDiv.classList.remove("active")},0),setTimeout(()=>{i.style.borderRadius=b,i.firstElementChild&&(i.firstElementChild.style.borderRadius=b)},a/2),setTimeout(()=>{i.innerHTML="",i.classList.remove("moving","active","hiding"),i.style.cssText="display: none;",w.resolve()},a),S;{let t,s;if("DIV"==e.tagName||"AVATAR-ELEMENT"==e.tagName)e.firstElementChild&&(t=new Image,s=e.firstElementChild.src,i.append(t));else if(e instanceof HTMLImageElement)t=new Image,s=e.src;else if(e instanceof HTMLVideoElement){(t=document.createElement("video")).src=null==e?void 0:e.src}else if(e instanceof SVGSVGElement){const t=e.dataset.clipId,s=t+"-mv",{width:n,height:a}=l,o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"width",""+n),o.setAttributeNS(null,"height",""+a),o.setAttributeNS(null,"viewBox",`0 0 ${n} ${a}`),o.setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),o.insertAdjacentHTML("beforeend",e.firstElementChild.outerHTML.replace(t,s)),o.insertAdjacentHTML("beforeend",e.lastElementChild.outerHTML.replace(t,s));const r=o.firstElementChild,d=r.firstElementChild.firstElementChild;if(d instanceof SVGUseElement){let e,t=d.getAttributeNS(null,"transform");t=t.replace(/translate\((.+?), (.+?)\) scale\((.+?), (.+?)\)/,(e,t,s,i,o)=>`translate(${t=2!=(t=+t)?n-2/p:2/p}, ${a}) scale(${+i/p}, ${+o/g})`),d.setAttributeNS(null,"transform",t),y=r.firstElementChild.lastElementChild;const s=b.split(" ").map(e=>parseInt(e));e=M?_.generatePathData(0,0,n-9/p,a,...s):_.generatePathData(9/p,0,n-9/p,a,...s),y.setAttributeNS(null,"d",e)}const c=o.lastElementChild;c.setAttributeNS(null,"width",""+l.width),c.setAttributeNS(null,"height",""+l.height),i.prepend(o)}h&&(h.style.borderRadius=b,t&&h.append(t)),t=i.querySelector("video, img"),t instanceof HTMLImageElement&&(t.classList.add("thumbnail"),h||(t.style.width=l.width+"px",t.style.height=l.height+"px"),s&&(yield new Promise((e,i)=>{t.addEventListener("load",e),s&&(t.src=s)}))),i.style.display="",window.requestAnimationFrame(()=>{i.classList.add(n?"moving":"active")})}return yield new Promise(e=>window.requestAnimationFrame(()=>window.requestAnimationFrame(e))),i.style.transform=`translate3d(${l.left}px,${l.top}px,0) scale3d(1,1,1)`,h&&this.setFullAspect(h,l,r),setTimeout(()=>{i.style.borderRadius="",i.firstElementChild&&(i.firstElementChild.style.borderRadius="")},0),i.dataset.timeout=""+setTimeout(()=>{i.classList.remove("moving"),h&&(i.querySelector("video"),i.classList.remove("active"),h.style.cssText="",i.offsetLeft),i.classList.add("center","no-transition"),i.classList.add("active"),delete i.dataset.timeout,w.resolve()},a),y&&this.sizeTailPath(y,l,p,a,!0,M,b),S}))}setFullAspect(e,t,s){const i=t.width/t.height;let{width:n,height:a}=s;i>0?n=a*i:a=n*i,e.style.cssText=`width: ${n}px; height: ${a}px; transform: scale3d(${t.width/n}, ${t.height/a}, 1);`}sizeTailPath(e,t,s,i,n,a,o){const r=Date.now(),{width:d,height:l}=t;i/=2;const c=o.split(" ").map(e=>parseInt(e)),f=()=>{const t=Date.now()-r;let o=t/i;o>1&&(o=1),n&&(o=1-o);const h=c.map(e=>e*o);let u;u=a?_.generatePathData(0,0,d-9/s*o,l,...h):_.generatePathData(9/s*o,0,d,l,...h),e.setAttributeNS(null,"d",u),t<i&&window.requestAnimationFrame(f)};f()}removeCenterFromMover(e){if(e.classList.contains("center")){const t=this.content.media.getBoundingClientRect();e.style.transform=`translate3d(${t.left}px,${t.top}px,0)`,e.classList.remove("center"),e.offsetLeft,e.classList.remove("no-transition")}}moveTheMover(e,t=!0){const s=m.default.windowW;this.removeCenterFromMover(e),e.classList.add("moving"),e.dataset.timeout&&clearTimeout(+e.dataset.timeout);const i=e.getBoundingClientRect(),n=e.style.transform.replace(/translate3d\((.+?),/,(e,n)=>{const a=t?-i.width:s;return e.replace(n,a+"px")});e.style.transform=n,setTimeout(()=>{e.remove()},350)}setNewMover(){const e=document.createElement("div");if(e.classList.add("media-viewer-mover"),this.content.mover){this.content.mover.parentElement.append(e)}else this.wholeDiv.append(e);return this.content.mover=e}updateMediaSource(e,t,s){const i=e.querySelector(s);T.renderImageFromUrl(i,t)}setAuthorInfo(e,t){const s=new Date,i=new Date(1e3*t),n=s.getTime()/1e3,a=i.getHours()+":"+("0"+i.getMinutes()).slice(-2);let o;o=n-t<X.ONE_DAY&&s.getDate()==i.getDate()?"Today":n-t<2*X.ONE_DAY&&s.getDate()-1==i.getDate()?"Yesterday":s.getFullYear()!=i.getFullYear()?X.months[i.getMonth()].slice(0,3)+" "+i.getDate()+", "+i.getFullYear():X.months[i.getMonth()].slice(0,3)+" "+i.getDate(),this.author.date.innerText=o+" at "+a;const r=g.default.getPeerTitle(e);this.author.nameEl.innerHTML=r;let d=this.author.avatarEl;this.author.avatarEl=this.author.avatarEl.cloneNode(),this.author.avatarEl.setAttribute("peer",""+e),d.parentElement.replaceChild(this.author.avatarEl,d)}_openMedia(e,t,s,i,n,a=!1,r=[],d=[],c=!0){return o(this,void 0,void 0,(function*(){if(this.setMoverPromise)return this.setMoverPromise;this.log("openMedia:",e,s,r,d),this.setAuthorInfo(s,t);const u="video"==e.type||"gif"==e.type;this.isFirstOpen&&(this.prevTargets=r,this.nextTargets=d,this.reverse=a,this.needLoadMore=c,this.isFirstOpen=!1),this.buttons.prev.classList.toggle("hide",!this.prevTargets.length),this.buttons.next.classList.toggle("hide",!this.nextTargets.length);const p=this.content.media;!n&&(n=p),this.lastTarget=n;const g=++this.tempId;this.needLoadMore&&(this.nextTargets.length<20&&this.loadMoreMedia(!this.reverse),this.prevTargets.length<20&&this.loadMoreMedia(this.reverse)),p.firstElementChild&&(p.innerHTML="");if(0!==i)this.moveTheMover(this.content.mover,1===i),this.setNewMover();else{window.addEventListener("keydown",this.onKeyDown);const e=this.pageEl.querySelector("#main-columns");this.pageEl.insertBefore(this.wholeDiv,e),this.wholeDiv.offsetLeft,this.wholeDiv.classList.add("active"),M.default.overlayIsActive=!0,w.default.checkAnimations(!0)}const b=this.content.mover,y=l.default.isMobile?this.pageEl.scrollWidth:this.pageEl.scrollWidth-16,_=m.default.windowH-100,I=m.default.setAttachmentSize(e,p,y,_),L=e.supportsStreaming?this.preloaderStreamable:this.preloader;let E;if(u){const t=document.createElement("video");E=this.setMoverToTarget(n,!1,i).then(({onAnimationEnd:s})=>{const i=b.firstElementChild&&b.firstElementChild.classList.contains("media-viewer-aspecter")?b.firstElementChild:b,a=b.querySelector("video");a&&a.remove(),t.setAttribute("playsinline","true"),t.addEventListener("timeupdate",()=>{this.tempId!=g&&t.pause()}),f.isSafari&&(t.autoplay=!0),"gif"==e.type&&(t.muted=!0,t.autoplay=!0,t.loop=!0),t.parentElement||i.append(t);const r=new Promise(e=>{t.addEventListener("canplay",e,{once:!0})}),d=()=>{"gif"!=e.type&&(t.dataset.ckin="default",t.dataset.overlay="1",S.default.pause(),S.default.willBePlayedMedia=null,Promise.all([r,s]).then(()=>{if(this.tempId!=g)return;new v.default(t,!0,e.supportsStreaming)}))};if(e.supportsStreaming){s.then(()=>{t.readyState<t.HAVE_FUTURE_DATA&&L.attach(b,!0)});const e=()=>{t.addEventListener("canplay",()=>{L.detach(),t.parentElement.classList.remove("is-buffering")},{once:!0})};t.addEventListener("waiting",s=>{const i=t.networkState===t.NETWORK_LOADING,n=t.readyState<t.HAVE_FUTURE_DATA;i&&n&&(e(),L.attach(b,!0),t.parentElement.classList.add("is-buffering"))}),e()}this.lazyLoadQueue.unshift({load:()=>{const a=e.supportsStreaming?Promise.resolve():h.default.downloadDoc(e);return e.supportsStreaming||s.then(()=>{L.attach(b,!0,a)}),a.then(()=>o(this,void 0,void 0,(function*(){if(this.tempId!=g)return void this.log.warn("media viewer changed video");const s=e.url;n instanceof SVGSVGElement?(i.firstElementChild.lastElementChild.append(t),this.updateMediaSource(b,s,"video")):T.renderImageFromUrl(t,s),d()}))),a}})})}else E=this.setMoverToTarget(n,!1,i).then(({onAnimationEnd:t})=>{this.lazyLoadQueue.unshift({load:()=>{const s=m.default.preloadPhoto(e.id,I);return t.then(()=>{this.preloader.attach(b,!0,s)}),s.then(()=>{if(this.tempId!=g)return void this.log.warn("media viewer changed photo");const t=e.url;if(n instanceof SVGSVGElement){if(this.updateMediaSource(n,t,"img"),this.updateMediaSource(b,t,"img"),l.default.isMobile){const e=b.querySelectorAll("img");e&&e.length&&e.forEach(e=>{e.classList.remove("thumbnail")})}}else{const e=b.firstElementChild&&b.firstElementChild.classList.contains("media-viewer-aspecter")?b.firstElementChild:b;let s=e.firstElementChild;s&&"IMG"==s.tagName||(s=new Image),T.renderImageFromUrl(s,t,()=>{l.default.isMobile&&s.classList.remove("thumbnail"),e.append(s)})}this.preloader.detach()}).catch(e=>{this.log.error(e)}),s}})});return this.setMoverPromise=E.catch(()=>{this.setMoverAnimationPromise=null}).finally(()=>{this.setMoverPromise=null})}))}}t.default=class extends F{constructor(){super(["delete","forward"]),this.currentMessageId=0,this.currentPeerId=0,this.onPrevClick=e=>{this.nextTargets.unshift({element:this.lastTarget,mid:this.currentMessageId,peerId:this.currentPeerId}),this.openMedia(p.default.getMessageByPeer(e.peerId,e.mid),e.element,-1)},this.onNextClick=e=>{this.prevTargets.push({element:this.lastTarget,mid:this.currentMessageId,peerId:this.currentPeerId}),this.openMedia(p.default.getMessageByPeer(e.peerId,e.mid),e.element,1)},this.onForwardClick=()=>{this.currentMessageId&&new P.default(this.currentPeerId,[this.currentMessageId],()=>this.close())},this.onAuthorClick=e=>{if(this.currentMessageId&&this.currentMessageId!==Number.MAX_SAFE_INTEGER){const t=this.currentMessageId,s=this.currentPeerId,i=this.searchContext.threadId;this.close(e).then(()=>{l.default.isMobile&&A.default.closeTab(A.AppSidebarRight.SLIDERITEMSIDS.sharedMedia);const e=p.default.getMessageByPeer(s,t);u.default.setInnerPeer(e.peerId,t,i?"discussion":void 0,i)})}},this.onDownloadClick=()=>{const e=p.default.getMessageByPeer(this.currentPeerId,this.currentMessageId);if(e.media.photo)m.default.savePhotoFile(e.media.photo,u.default.chat.bubbles.lazyLoadQueue.queueId);else{let t=null;t=e.media.webpage?e.media.webpage.document:e.media.document,t&&h.default.saveDocFile(t,u.default.chat.bubbles.lazyLoadQueue.queueId)}},this.loadMoreMedia=(e=!0)=>{if(e&&this.loadedAllMediaDown)return Promise.resolve();if(!e&&this.loadedAllMediaUp)return Promise.resolve();if(e&&this.loadMediaPromiseDown)return this.loadMediaPromiseDown;if(!e&&this.loadMediaPromiseUp)return this.loadMediaPromiseUp;const t=e?0:50;let s,i=this.currentMessageId;s=e?this.reverse?this.prevTargets[0]:this.nextTargets[this.nextTargets.length-1]:this.reverse?this.nextTargets[this.nextTargets.length-1]:this.prevTargets[0],s&&(i=s.mid),e||(i=p.default.incrementMessageId(i,1));const n=p.default.getSearch({peerId:this.searchContext.peerId,query:this.searchContext.query,inputFilter:{_:this.searchContext.inputFilter},maxId:i,limit:t?0:50,backLimit:t,threadId:this.searchContext.threadId,folderId:this.searchContext.folderId,nextRate:this.searchContext.nextRate,minDate:this.searchContext.minDate,maxDate:this.searchContext.maxDate}).then(t=>{this.log("loaded more media by maxId:",i,t,e,this.reverse),t.next_rate&&(this.searchContext.nextRate=t.next_rate),t.history.length<50&&(e?this.loadedAllMediaDown=!0:this.loadedAllMediaUp=!0);(e?t.history.forEach:t.history.forEachReverse).call(t.history,t=>{const{mid:s,peerId:i}=t;if(!this.getMediaFromMessage(t))return;const n={element:null,mid:s,peerId:i};e?this.reverse?this.prevTargets.unshift(n):this.nextTargets.push(n):this.reverse?this.nextTargets.push(n):this.prevTargets.unshift(n)}),this.buttons.prev.classList.toggle("hide",!this.prevTargets.length),this.buttons.next.classList.toggle("hide",!this.nextTargets.length)},()=>{}).then(()=>{e?this.loadMediaPromiseDown=null:this.loadMediaPromiseUp=null});return e?this.loadMediaPromiseDown=n:this.loadMediaPromiseUp=n,n},this.content.caption=document.createElement("div"),this.content.caption.classList.add("media-viewer-caption"),new x.default(this.content.caption),this.wholeDiv.append(this.content.caption),this.setBtnMenuToggle([{icon:"forward",text:"Forward",onClick:this.onForwardClick},{icon:"download",text:"Download",onClick:this.onDownloadClick},{icon:"delete danger btn-disabled",text:"Delete",onClick:()=>{}}]),this.setListeners()}setListeners(){super.setListeners(),this.buttons.forward.addEventListener("click",this.onForwardClick),this.author.container.addEventListener("click",this.onAuthorClick)}getMediaFromMessage(e){return e.action?e.action.photo:e.media.photo||e.media.document||e.media.webpage&&(e.media.webpage.document||e.media.webpage.photo)}setCaption(e){const t=e.message;this.content.caption.classList.toggle("hide",!t),this.content.caption.firstElementChild.innerHTML=t?y.RichTextProcessor.wrapRichText(t,{entities:e.totalEntities}):""}setSearchContext(e){return this.searchContext=e,void 0!==this.searchContext.folderId&&(this.loadedAllMediaUp=!0,void 0===this.searchContext.nextRate&&(this.loadedAllMediaDown=!0)),this}openMedia(e,t,s=0,i=!1,n=[],a=[],r=!0){const d=Object.create(null,{_openMedia:{get:()=>super._openMedia}});return o(this,void 0,void 0,(function*(){if(this.setMoverPromise)return this.setMoverPromise;const o=e.mid,l=e.fromId,c=this.getMediaFromMessage(e);this.currentMessageId=o,this.currentPeerId=e.peerId;const f=d._openMedia.call(this,c,e.date,l,s,t,i,n,a,r);return this.setCaption(e),f}))}};t.AppMediaViewerAvatar=class extends F{constructor(e){super(["delete"]),this.onPrevClick=e=>{this.nextTargets.unshift({element:this.lastTarget,photoId:this.currentPhotoId}),this.openMedia(e.photoId,e.element,-1)},this.onNextClick=e=>{this.prevTargets.push({element:this.lastTarget,photoId:this.currentPhotoId}),this.openMedia(e.photoId,e.element,1)},this.onDownloadClick=()=>{m.default.savePhotoFile(m.default.getPhoto(this.currentPhotoId),u.default.chat.bubbles.lazyLoadQueue.queueId)},this.loadMoreMedia=(e=!0)=>{if(this.peerId<0)return Promise.resolve();if(this.loadedAllMediaDown)return Promise.resolve();if(this.loadMediaPromiseDown)return this.loadMediaPromiseDown;const t=this.peerId,s=this.nextTargets.length?this.nextTargets[this.nextTargets.length-1].photoId:this.currentPhotoId,i=m.default.getUserPhotos(t,s,50).then(s=>{this.peerId==t?(this.log("loaded more media by maxId:",s,e,this.reverse),s.photos.length<50&&(this.loadedAllMediaDown=!0),s.photos.forEach(e=>{this.currentPhotoId!=e&&this.nextTargets.push({element:null,photoId:e})}),this.buttons.prev.classList.toggle("hide",!this.prevTargets.length),this.buttons.next.classList.toggle("hide",!this.nextTargets.length)):this.log.warn("peer changed")},()=>{}).then(()=>{this.loadMediaPromiseDown=null});return this.loadMediaPromiseDown=i},this.peerId=e,this.setBtnMenuToggle([{icon:"download",text:"Download",onClick:this.onDownloadClick},{icon:"delete danger btn-disabled",text:"Delete",onClick:()=>{}}]),this.setListeners()}openMedia(e,t,s=0){const i=Object.create(null,{_openMedia:{get:()=>super._openMedia}});return o(this,void 0,void 0,(function*(){if(this.setMoverPromise)return this.setMoverPromise;const n=m.default.getPhoto(e);return this.currentPhotoId=n.id,i._openMedia.call(this,n,n.date,this.peerId,s,t,!1)}))}}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(19)),o=n(s(23)),r=n(s(7)),d=n(s(10)),l=n(s(20)),c=n(s(8)),f=n(s(1)),h=s(0),u=n(s(6));let p,g=!1;t.default=class{constructor(e,t,s=["dialogs"],i,n,a,o=!0){this.appendTo=e,this.onChange=t,this.peerType=s,this.renderResultsFunc=n,this.chatRightsAction=a,this.multiSelect=o,this.container=document.createElement("div"),this.list=document.createElement("ul"),this.chatsContainer=document.createElement("div"),this.selected=new Set,this.freezed=!1,this.folderId=0,this.offsetIndex=0,this.query="",this.loadedWhat={},this.renderedPeerIds=new Set,this.checkForTriggers=()=>{this.scrollable.checkForTriggers()},this.container.classList.add("selector");const r=(n||this.renderResults).bind(this);if(this.renderResultsFunc=e=>(e=e.filter(e=>{const t=!this.renderedPeerIds.has(e);return t&&this.renderedPeerIds.add(e),t}),r(e)),this.input=document.createElement("input"),this.input.classList.add("selector-search-input"),this.input.placeholder=s.includes("dialogs")?"Select chat":"Add People...",this.input.type="text",o){let e=document.createElement("div");e.classList.add("selector-search-container"),this.selectedContainer=document.createElement("div"),this.selectedContainer.classList.add("selector-search"),this.selectedContainer.append(this.input),e.append(this.selectedContainer),this.selectedScrollable=new u.default(e);let t=document.createElement("hr");this.selectedContainer.addEventListener("click",e=>{if(this.freezed)return;let t=e.target;if(t=h.findUpClassName(t,"selector-user"),!t)return;const s=t.dataset.key,i=this.chatsContainer.querySelector('[data-peerid="'+s+'"]');i?i.click():this.remove(+s||s)}),this.container.append(e,t)}this.chatsContainer.classList.add("chatlist-container"),this.chatsContainer.append(this.list),this.scrollable=new u.default(this.chatsContainer),this.scrollable.setVirtualContainer(this.list),this.chatsContainer.addEventListener("click",e=>{const t=h.findUpAttribute(e.target,"data-peerId");if(h.cancelEvent(e),!t)return;if(this.freezed)return;let s=t.getAttribute("data-peerId");if(s=+s||s,!this.multiSelect)return void this.add(s);t.classList.toggle("active"),this.selected.has(s)?this.remove(s):this.add(s);const i=t.querySelector("input");i.checked=!i.checked}),this.input.addEventListener("input",()=>{const e=this.input.value;this.query!=e&&(this.peerType.includes("contacts")&&(delete this.loadedWhat.contacts,this.cachedContacts=null),delete this.loadedWhat.dialogs,delete this.loadedWhat.archived,this.folderId=0,this.offsetIndex=0,this.promise=null,this.list.innerHTML="",this.query=e,this.renderedPeerIds.clear(),this.getMoreResults())}),this.scrollable.onScrolledBottom=()=>{this.getMoreResults()},this.container.append(this.chatsContainer),e.append(this.container),setTimeout(()=>{let e=this.getMoreResults();i&&e.then(()=>{i()})},0)}renderSaved(){this.offsetIndex||0!=this.folderId||this.query&&!"saved messages".includes(this.query.toLowerCase())&&!c.default.getUser(f.default.myId).sortName.includes(this.query.toLowerCase())||!this.peerType.includes("dialogs")||this.renderResultsFunc([f.default.myId])}getMoreDialogs(){return i(this,void 0,void 0,(function*(){if(this.promise)return this.promise;if(this.loadedWhat.dialogs&&this.loadedWhat.archived)return;const e=l.default.windowH/72*1.25|0;this.promise=r.default.getConversations(this.query,this.offsetIndex,e,this.folderId);const t=yield this.promise;this.promise=null;let s=t.dialogs;if(s.length){const e=s[s.length-1].index||0;s=s.slice(),s.findAndSplice(e=>e.peerId==f.default.myId),this.chatRightsAction&&(s=s.filter(e=>e.peerId>0&&("send"!=this.chatRightsAction||c.default.canSendToUser(e.peerId))||a.default.hasRights(-e.peerId,this.chatRightsAction))),this.renderSaved(),this.offsetIndex=e,this.renderResultsFunc(s.map(e=>e.peerId))}else{if(!this.loadedWhat.dialogs)return this.renderSaved(),this.loadedWhat.dialogs=!0,this.offsetIndex=0,this.folderId=1,this.getMoreDialogs();if(this.loadedWhat.archived=!0,!this.loadedWhat.contacts&&this.peerType.includes("contacts"))return this.getMoreContacts()}}))}getMoreContacts(){return i(this,void 0,void 0,(function*(){if(this.promise)return this.promise;if(!this.loadedWhat.contacts){if(this.cachedContacts||(this.promise=c.default.getContacts(this.query),this.cachedContacts=(yield this.promise).slice(),this.cachedContacts.findAndSplice(e=>e==f.default.myId),this.promise=null),this.cachedContacts.length){const e=l.default.windowH/72*1.25|0,t=this.cachedContacts.splice(0,e);this.renderResultsFunc(t)}return this.cachedContacts.length||(this.loadedWhat.contacts=!0,this.peerType.includes("dialogs"))?void 0:this.getMoreDialogs()}}))}getMoreResults(){const e=(()=>{const e=[];return g||p||(p=r.default.getConversationsAll().then(()=>{g=!0},()=>{p=null}),e.push(p)),!this.peerType.includes("dialogs")&&!this.loadedWhat.contacts||this.loadedWhat.archived||(e.push(this.getMoreDialogs()),this.loadedWhat.archived)?(this.peerType.includes("contacts")&&!this.loadedWhat.contacts&&e.push(this.getMoreContacts()),e):e})(),t=Promise.all(e);return e.length&&t.then(this.checkForTriggers),t}renderResults(e){!this.peerType.includes("dialogs")&&this.loadedWhat.contacts&&(e=e.filter(e=>c.default.isNonContactUser(e))),e.forEach(e=>{const{dom:t}=o.default.addDialogNew({dialog:e,container:this.scrollable,drawStatus:!1,rippleEnabled:!1,avatarSize:48});if(this.multiSelect){const s=this.selected.has(e);t.containerEl.insertAdjacentHTML("afterbegin",`<div class="checkbox"><label class="checkbox-field"><input type="checkbox" ${s?"checked":""}><span></span></label></div>`),s&&t.listEl.classList.add("active")}let s="";e<0?s=a.default.getChatMembersString(-e):e==f.default.myId?s="chat with yourself":(s=c.default.getUserStatusString(e),"online"==s&&(s=`<i>${s}</i>`)),t.lastMessageSpan.innerHTML=s})}add(e,t){if(this.selected.add(e),!this.multiSelect)return void this.onChange(this.selected.size);const s=document.createElement("div");s.classList.add("selector-user","scale-in");const i=document.createElement("avatar-element");return i.classList.add("selector-user-avatar","tgico"),i.setAttribute("dialog","1"),i.classList.add("avatar-32"),s.dataset.key=""+e,"number"==typeof e&&(void 0===t&&(t=e==f.default.myId?"Saved":d.default.getPeerTitle(e,!1,!0)),i.setAttribute("peer",""+e)),t&&(s.innerHTML=t),s.insertAdjacentElement("afterbegin",i),this.selectedContainer.insertBefore(s,this.input),this.selectedScrollable.scrollTo(this.selectedScrollable.scrollHeight,"top",!0,!0),this.onChange&&this.onChange(this.selected.size),s}remove(e){if(!this.multiSelect)return;const t=this.selectedContainer.querySelector(`[data-key="${e}"]`);t.classList.remove("scale-in"),t.offsetWidth,t.classList.add("scale-out"),t.addEventListener("animationend",()=>{this.selected.delete(e),t.remove(),this.onChange&&this.onChange(this.selected.size)},{once:!0})}getSelected(){return[...this.selected]}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MediaProgressLine=t.ProgressLine=void 0;const n=s(0),a=i(s(50)),o=s(12),r=s(11);class d{constructor(e=0){this.duration=1,this.mousedown=!1,this.events={},this.onMouseMove=e=>{this.mousedown&&this.scrub(e)},this.onMouseDown=e=>{var t;this.scrub(e),this.mousedown=!0,(null===(t=this.events)||void 0===t?void 0:t.onMouseDown)&&this.events.onMouseDown(e)},this.onMouseUp=e=>{var t;this.mousedown=!1,(null===(t=this.events)||void 0===t?void 0:t.onMouseUp)&&this.events.onMouseUp(e)},this.container=document.createElement("div"),this.container.classList.add("progress-line"),this.filled=document.createElement("div"),this.filled.classList.add("progress-line__filled");const t=this.seek=document.createElement("input");t.classList.add("progress-line__seek"),t.value=""+e,t.setAttribute("min","0"),t.type="range",t.step="0.1",t.max=""+1e3*this.duration,e>0&&this.setProgress(e),this.container.append(this.filled,t)}setHandlers(e){this.events=e}setListeners(){this.container.addEventListener("mousemove",this.onMouseMove),this.container.addEventListener("mousedown",this.onMouseDown),this.container.addEventListener("mouseup",this.onMouseUp),r.isTouchSupported&&(this.container.addEventListener("touchmove",this.onMouseMove,{passive:!0}),this.container.addEventListener("touchstart",this.onMouseDown,{passive:!0}),this.container.addEventListener("touchend",this.onMouseUp,{passive:!0}))}setProgress(e){this.setFilled(e),this.seek.value=""+1e3*e}setFilled(e){let t=e/this.duration;t=Math.max(0,Math.min(1,t)),this.filled.style.transform="scaleX("+t+")"}scrub(e){var t;let s;if(e instanceof MouseEvent)s=e.offsetX;else{const t=e.target.getBoundingClientRect();s=e.targetTouches[0].pageX-t.left}const i=s/this.container.offsetWidth*this.duration;return this.setFilled(i),(null===(t=this.events)||void 0===t?void 0:t.onScrub)&&this.events.onScrub(i),i}removeListeners(){this.container.removeEventListener("mousemove",this.onMouseMove),this.container.removeEventListener("mousedown",this.onMouseDown),this.container.removeEventListener("mouseup",this.onMouseUp),r.isTouchSupported&&(this.container.removeEventListener("touchmove",this.onMouseMove),this.container.removeEventListener("touchstart",this.onMouseDown),this.container.removeEventListener("touchend",this.onMouseUp)),this.events={}}}t.ProgressLine=d;class l extends d{constructor(e,t=!1){super(),this.media=e,this.streamable=t,this.stopAndScrubTimeout=0,this.progressRAF=0,this.onLoadedData=()=>{this.duration=this.media.duration,this.seek.setAttribute("max",""+1e3*this.duration)},this.onEnded=()=>{this.setProgress()},this.onPlay=()=>{let e=()=>{this.setProgress(),this.progressRAF=this.media.paused?0:window.requestAnimationFrame(e)};this.progressRAF&&window.cancelAnimationFrame(this.progressRAF),this.streamable&&this.setLoadProgress(),this.progressRAF=window.requestAnimationFrame(e)},this.onProgress=e=>{this.setLoadProgress()},t&&(this.filledLoad=document.createElement("div"),this.filledLoad.classList.add("progress-line__filled","progress-line__loaded"),this.container.prepend(this.filledLoad)),(!e.paused||e.currentTime>0)&&this.onPlay(),this.setSeekMax(),this.setListeners(),this.setHandlers({onMouseDown:e=>{this.stopAndScrubTimeout&&clearTimeout(this.stopAndScrubTimeout),this.stopAndScrubTimeout=window.setTimeout(()=>{!this.media.paused&&this.media.pause(),this.stopAndScrubTimeout=0},150)},onMouseUp:e=>{this.stopAndScrubTimeout&&(clearTimeout(this.stopAndScrubTimeout),this.stopAndScrubTimeout=0),this.media.paused&&this.media.play()}})}scrub(e){const t=super.scrub(e);return this.media.currentTime=t,t}setLoadProgress(){if(a.default.isSafariBuffering(this.media))return;const e=this.media.buffered,t=e.length,s=this.media.currentTime;let i=0,n=0;for(let a=0;a<t;++a){const t=e.start(a);s>=t&&t>=i&&(i=t,n=e.end(a))}const o=this.media.duration?n/this.media.duration:0;this.filledLoad.style.transform="scaleX("+o+")"}setSeekMax(){this.duration=this.media.duration,this.duration>0?this.onLoadedData():this.media.addEventListener("loadeddata",this.onLoadedData)}setProgress(){if(a.default.isSafariBuffering(this.media))return;const e=this.media.currentTime;super.setProgress(e)}setListeners(){super.setListeners(),this.media.addEventListener("ended",this.onEnded),this.media.addEventListener("play",this.onPlay),this.streamable&&this.media.addEventListener("progress",this.onProgress)}removeListeners(){super.removeListeners(),this.media.removeEventListener("loadeddata",this.onLoadedData),this.media.removeEventListener("ended",this.onEnded),this.media.removeEventListener("play",this.onPlay),this.streamable&&this.media.removeEventListener("progress",this.onProgress),this.stopAndScrubTimeout&&clearTimeout(this.stopAndScrubTimeout),this.progressRAF&&window.cancelAnimationFrame(this.progressRAF)}}t.MediaProgressLine=l;let c=1,f=!c;class h{constructor(e,t=!1,s=!1){var i;if(this.video=e,this.onFullScreen=()=>{null!==document.webkitFullscreenElement||this.wrapper.classList.remove("ckin__fullscreen")},this.wrapper=document.createElement("div"),this.wrapper.classList.add("ckin__player"),e.parentNode.insertBefore(this.wrapper,e),this.wrapper.appendChild(e),this.skin=null!==(i=e.dataset.ckin)&&void 0!==i?i:"default",this.stylePlayer(),"default"==this.skin){let t=this.wrapper.querySelector(".default__controls.ckin__controls");this.progress=new l(e,s),t.prepend(this.progress.container)}if(t){e.play().catch(t=>{"NotAllowedError"==t.name&&(e.muted=!0,e.autoplay=!0,e.play())}).finally(()=>{this.wrapper.classList.toggle("is-playing",!this.video.paused)})}}stylePlayer(){const{wrapper:e,video:t,skin:s}=this;e.classList.add(s);const i=this.buildControls();e.insertAdjacentHTML("beforeend",i);let a,o=0,l=0;if("default"===s){const s=e.querySelectorAll(".toggle"),i=e.querySelector(".fullscreen"),o=e.querySelector("#time-elapsed");a=e.querySelector("#time-duration"),a.innerHTML=String(0|t.duration).toHHMMSS();const l=document.createElement("div");l.classList.add("player-volume"),l.innerHTML='\n      <svg class="player-volume__icon" focusable="false" viewBox="0 0 24 24" aria-hidden="true"></svg>\n      ';const h=l.firstElementChild;h.addEventListener("click",e=>{n.cancelEvent(e),t.muted=!t.muted});const u=new d;u.setListeners(),u.setHandlers({onScrub:e=>{const s=Math.max(Math.min(e,1),0);t.muted=!1,t.volume=s}}),l.append(u.container);const p=()=>{const e=t.volume;let s;s=!e||t.muted?"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z":e>.5?"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z":e>0&&e<.25?"M7 9v6h4l5 5V4l-5 5H7z":"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z";try{h.innerHTML=`<path d="${s}"></path>`}catch(e){}u.mousedown||u.setProgress(t.muted?0:e)};t.addEventListener("volumechange",()=>{f=t.muted,c=t.volume,p()}),t.volume=c,t.muted=f,p();if(e.querySelector(".left-controls").insertBefore(l,o.parentElement),Array.from(s).forEach(e=>e.addEventListener("click",()=>{this.togglePlay()})),t.addEventListener("click",()=>{r.isTouchSupported||this.togglePlay()}),r.isTouchSupported){let t=0;const s=()=>{t=window.setTimeout(()=>{t=0,e.classList.remove("show-controls")},3e3)};e.addEventListener("click",()=>{t?clearTimeout(t):e.classList.add("show-controls"),s()}),e.addEventListener("touchstart",()=>{e.classList.add("show-controls"),clearTimeout(t)}),e.addEventListener("touchend",()=>{e.classList.contains("is-playing")&&s()})}t.addEventListener("dblclick",()=>{if(!r.isTouchSupported)return this.toggleFullScreen(i)}),i.addEventListener("click",e=>this.toggleFullScreen(i)),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange".split(" ").forEach(t=>{e.addEventListener(t,this.onFullScreen,!1)}),t.addEventListener("timeupdate",()=>{o.innerHTML=String(0|t.currentTime).toHHMMSS()})}else if("circle"===s){const s=document.createElement("div");s.classList.add("circle-time-left"),t.parentNode.insertBefore(s,t),s.innerHTML='<div class="circle-time"></div><div class="iconVolume tgico-nosound"></div>';const i=e.querySelector(".progress-ring__circle"),n=i.r.baseVal.value,r=2*Math.PI*n;a=e.querySelector(".circle-time");const d=e.querySelector(".iconVolume");i.style.strokeDasharray=r+" "+r,i.style.strokeDashoffset=""+r,i.addEventListener("click",()=>{this.togglePlay()}),t.addEventListener("play",()=>{d.style.display="none",c=window.setInterval(()=>{t.currentTime!=l&&(o=t.currentTime,l=t.currentTime);const e=r-o/t.duration*r;i.style.strokeDashoffset=""+e,t.paused&&clearInterval(c)},20)}),t.addEventListener("pause",()=>{d.style.display=""});let c=0;t.addEventListener("timeupdate",()=>{clearInterval(c);let e=0,s=0;c=window.setInterval(()=>{t.currentTime!=s&&(e=t.currentTime,s=t.currentTime);const n=r-e/t.duration*r;i.style.strokeDashoffset=""+n,t.paused&&clearInterval(c)},20);const n=String(t.duration-t.currentTime|0).toHHMMSS();"0"!=n&&(a.innerHTML=n)})}t.addEventListener("play",()=>{this.wrapper.classList.add("is-playing")}),t.addEventListener("pause",()=>{this.wrapper.classList.remove("is-playing")}),t.duration>0?a.innerHTML=String(Math.round(t.duration)).toHHMMSS():t.addEventListener("loadeddata",()=>{a.innerHTML=String(Math.round(t.duration)).toHHMMSS()})}togglePlay(e){return e?(this.video.pause(),void this.wrapper.classList.remove("is-playing")):!1===e?(this.video.play(),void this.wrapper.classList.add("is-playing")):void this.video[this.video.paused?"play":"pause"]()}buildControls(){const e=this.skin;return"default"===e?`\n      <button class="${e}__button--big toggle tgico" title="Toggle Play"></button>\n      <div class="${e}__gradient-bottom ckin__controls"></div>\n      <div class="${e}__controls ckin__controls">\n        <div class="bottom-controls">\n          <div class="left-controls">\n            <button class="${e}__button toggle tgico" title="Toggle Video"></button>\n            <div class="time">\n              <time id="time-elapsed">0:00</time>\n              <span> / </span>\n              <time id="time-duration">0:00</time>\n            </div>\n          </div>\n          <div class="right-controls">\n            <button class="${e}__button fullscreen tgico-fullscreen" title="Full Screen"></button>\n          </div>\n        </div>\n      </div>`:"circle"===e?'\n      <svg class="progress-ring" width="200px" height="200px">\n        <circle class="progress-ring__circle" stroke="white" stroke-opacity="0.3" stroke-width="3.5" cx="100" cy="100" r="93" fill="transparent" transform="rotate(-90, 100, 100)"/>\n      </svg>\n      ':void 0}static isFullScreen(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)}toggleFullScreen(e){const t=this.wrapper;if(o.isAppleMobile){const e=this.video;return e.webkitEnterFullscreen(),void e.enterFullscreen()}h.isFullScreen()?(t.classList.remove("ckin__fullscreen"),document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),e.classList.remove("tgico-smallscreen"),e.classList.add("tgico-fullscreen"),e.setAttribute("title","Full Screen")):(t.classList.add("ckin__fullscreen"),t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),e.classList.remove("tgico-fullscreen"),e.classList.add("tgico-smallscreen"),e.setAttribute("title","Exit Full Screen"))}}t.default=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.className=e,this.fill=t,this.container=document.createElement("div"),this.container.className=e,this.border=document.createElement("div"),this.border.classList.add(e+"-border"),this.content=document.createElement("div"),this.content.classList.add(e+"-content"),this.title=document.createElement("div"),this.title.classList.add(e+"-title"),this.subtitle=document.createElement("div"),this.subtitle.classList.add(e+"-subtitle"),this.content.append(this.title,this.subtitle),this.container.append(this.border,this.content)}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(37)),a=s(18),o=i(s(9)),r=i(s(28));class d extends n.default{constructor(e,t,s={}){if(super("popup-date-picker",s.noButtons?[]:[{text:"CANCEL",isCancel:!0},{text:"JUMP TO DATE",callback:()=>{this.onPick&&this.onPick(this.selectedDate.getTime()/1e3|0)}}],Object.assign({body:!0},s)),this.onPick=t,this.options=s,this.onPrevClick=e=>{this.selectedMonth.setMonth(this.selectedMonth.getMonth()-1),this.setMonth(),this.selectedMonth.getTime()==this.minMonth.getTime()&&this.prevBtn.setAttribute("disabled","true"),this.nextBtn.removeAttribute("disabled")},this.onNextClick=e=>{this.selectedMonth.setMonth(this.selectedMonth.getMonth()+1),this.setMonth(),this.selectedMonth.getTime()==this.maxMonth.getTime()&&this.nextBtn.setAttribute("disabled","true"),this.prevBtn.removeAttribute("disabled")},this.onDateClick=e=>{const t=e.target;if(!t.dataset.timestamp)return;if(this.selectedEl){if(this.selectedEl==t)return;this.selectedEl.classList.remove("active")}t.classList.add("active");const s=+t.dataset.timestamp;this.selectedDate=new Date(s),this.setTitle(),this.setMonth(),this.setTimeTitle()},this.minDate=s.minDate||new Date("2013-08-01T00:00:00"),e<this.minDate&&e.setFullYear(this.minDate.getFullYear(),this.minDate.getMonth(),this.minDate.getDate()),this.controlsDiv=document.createElement("div"),this.controlsDiv.classList.add("date-picker-controls"),this.prevBtn=document.createElement("button"),this.prevBtn.classList.add("btn-icon","tgico-down","date-picker-prev"),this.prevBtn.addEventListener("click",this.onPrevClick),this.nextBtn=document.createElement("button"),this.nextBtn.classList.add("btn-icon","tgico-down","date-picker-next"),this.nextBtn.addEventListener("click",this.onNextClick),this.monthTitle=document.createElement("div"),this.monthTitle.classList.add("date-picker-month-title"),this.controlsDiv.append(this.prevBtn,this.monthTitle,this.nextBtn),this.monthsContainer=document.createElement("div"),this.monthsContainer.classList.add("date-picker-months"),this.monthsContainer.addEventListener("click",this.onDateClick),this.body.append(this.controlsDiv,this.monthsContainer),s.withTime){this.timeDiv=document.createElement("div"),this.timeDiv.classList.add("date-picker-time");const t=document.createElement("div");t.classList.add("date-picker-time-delimiter"),t.append(":");const s=(e,t,s,i)=>{const n=""+e;t.input.addEventListener("input",a=>{let o=t.value.replace(/\D/g,"");o.length>2?o=o.slice(0,2):(1===o.length&&+o[0]>+n[0]||2===o.length&&+o>e)&&(2===o.length&&i&&i(+o[1]),o="0"+o[0]),t.setValueSilently(o),s(o.length)})};this.hoursInputField=new r.default({plainText:!0}),this.minutesInputField=new r.default({plainText:!0}),s(23,this.hoursInputField,e=>{2===e&&this.minutesInputField.input.focus(),this.setTimeTitle()},e=>{this.minutesInputField.value=(e+this.minutesInputField.value).slice(0,2)}),s(59,this.minutesInputField,e=>{e||this.hoursInputField.input.focus(),this.setTimeTitle()}),this.selectedDate=e,e.setMinutes(e.getMinutes()+10),this.hoursInputField.setValueSilently(("0"+e.getHours()).slice(-2)),this.minutesInputField.setValueSilently(("0"+e.getMinutes()).slice(-2)),e.setHours(0,0,0,0),this.timeDiv.append(this.hoursInputField.container,t,this.minutesInputField.container),this.btnConfirm.addEventListener("click",()=>{this.onPick&&(this.selectedDate.setHours(+this.hoursInputField.value||0,+this.minutesInputField.value||0,0,0),this.onPick(this.selectedDate.getTime()/1e3|0)),this.destroy()},{once:!0}),this.body.append(this.timeDiv)}const i=document.createElement("div");i.classList.add("popup-centerer"),i.append(this.container),this.element.append(i),e.setHours(0,0,0,0),this.selectedDate=e,this.maxDate=s.maxDate||new Date,this.maxDate.setHours(0,0,0,0),this.selectedMonth=new Date(this.selectedDate),this.selectedMonth.setDate(1),this.maxMonth=new Date(this.maxDate),this.maxMonth.setDate(1),this.minMonth=new Date(this.minDate),this.minMonth.setHours(0,0,0,0),this.minMonth.setDate(1),this.selectedMonth.getTime()==this.minMonth.getTime()&&this.prevBtn.setAttribute("disabled","true"),this.selectedMonth.getTime()==this.maxMonth.getTime()&&this.nextBtn.setAttribute("disabled","true"),s.noTitle&&(this.setTitle=()=>{}),this.setTimeTitle(),this.setTitle(),this.setMonth()}setTimeTitle(){if(this.btnConfirm&&this.selectedDate){let e="";const t=new Date;t.setHours(0,0,0,0),e=this.selectedDate.getTime()===t.getTime()?"Today":this.selectedDate.getTime()===t.getTime()+864e5?"Tomorrow":"on "+a.getFullDate(this.selectedDate,{noTime:!0,monthAsNumber:!0,leadingZero:!0}),this.btnConfirm.firstChild.nodeValue="Send "+e+" at "+("00"+this.hoursInputField.value).slice(-2)+":"+("00"+this.minutesInputField.value).slice(-2)}}setTitle(){const e=this.selectedDate.toString().split(" ",3);this.title.innerText=e[0]+", "+e[1]+" "+e[2]}renderElement(e,t=""){const s=document.createElement("button");return s.classList.add("btn-icon","date-picker-month-date"),e&&s.setAttribute("disabled","true"),t&&(s.innerText=t),s}setMonth(){const e=a.months[this.selectedMonth.getMonth()];this.monthTitle.innerText=(this.timeDiv&&o.default.isMobile?e.slice(0,3):e)+" "+this.selectedMonth.getFullYear(),this.month&&this.month.remove(),this.month=document.createElement("div"),this.month.classList.add("date-picker-month");const t=["M","T","W","T","F","S","S"];this.month.append(...t.map(e=>{const t=this.renderElement(!0,e);return t.classList.remove("date-picker-month-date"),t.classList.add("date-picker-month-day"),t}));const s=new Date(this.selectedMonth);let i=s.getDay()-1;-1==i&&(i=t.length-1);const n=new Date(s.getTime());n.setDate(n.getDate()-i-1);for(let e=0;e<i;++e)this.options.showOverflowMonths?(n.setDate(n.getDate()+1),this.month.append(this.renderElement(!0,""+n.getDate()))):this.month.append(this.renderElement(!0));do{const e=s.getDate(),t=this.renderElement(s>this.maxDate||s<this.minDate,""+e);t.dataset.timestamp=""+s.getTime(),s.getTime()===this.selectedDate.getTime()&&(this.selectedEl=t,t.classList.add("active")),this.month.append(t),s.setDate(e+1)}while(1!==s.getDate());const r=this.month.childElementCount%7;if(this.options.showOverflowMonths&&r)for(let e=r;e<7;++e)this.month.append(this.renderElement(!0,""+s.getDate())),s.setDate(s.getDate()+1);const d=this.month.childElementCount/7;this.container.dataset.lines=""+d,this.container.classList.toggle("is-max-lines",d>6),this.monthsContainer.append(this.month)}}t.default=d},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(7)),a=i(s(62)),o=i(s(10)),r=i(s(1));t.default=class{constructor(e,t,s,i){let d,l,c=[];const f=o.default.canPinMessage(e),h=(a,o)=>{setTimeout(()=>{let r;r=s&&!t?f?n.default.unpinAllMessages(e):n.default.hidePinnedMessages(e):n.default.updatePinnedMessage(e,t,s,o,a),i&&r.then(i)},300)},u=o.default.getPeerTitle(e,!1,!0);if(s){let e="UNPIN";t?(d="Unpin Message?",l="Would you like to unpin this message?"):f?(d="Unpin All Messages?",l="Would you like to unpin all messages?"):(d="Hide Pinned Messages?",l="Do you want to hide the pinned message bar? It wil stay hidden until a new message is pinned.",e="HIDE"),c.push({text:e,isDanger:!0,callback:()=>h()})}else d="Pin Message?",e<0?(l="Do you want to pin this message for all members in the group?",c.push({text:"PIN AND NOTIFY",callback:()=>h()}),c.push({text:"PIN WITHOUT NOTIFYING",callback:()=>h(void 0,!0)})):(l="Would you like to pin this message?",e===r.default.myId?c.push({text:"PIN",callback:()=>h()}):(c.push({text:"PIN JUST FOR ME",callback:()=>h(!0)}),c.push({text:"PIN FOR ME AND "+u,callback:()=>h()})));c.push({text:"CANCEL",isCancel:!0});new a.default("popup-delete-chat",{peerId:e,title:d,description:l,buttons:c}).show()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=(e,t,s=!1)=>{const i=document.createElement("label");i.classList.add(s?"checkbox-field-round":"checkbox-field");const n=document.createElement("input");n.type="checkbox",n.id="input-"+t;const a=document.createElement("span");return a.classList.add("checkbox-caption"),s&&a.classList.add("tgico-check"),e&&(a.innerText=e),i.append(n,a),{label:i,input:n,span:a}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),a=i(s(1)),o=i(s(61)),r=s(4);t.default=class{constructor(e){this.sendMenuButtons=[{icon:"mute",text:"Send Without Sound",onClick:e.onSilentClick,verify:()=>"schedule"===this.type},{icon:"schedule",text:"Schedule Message",onClick:e.onScheduleClick,verify:()=>"schedule"===this.type},{icon:"schedule",text:"Set a reminder",onClick:e.onScheduleClick,verify:()=>"reminder"===this.type}],this.sendMenu=o.default(this.sendMenuButtons,e.listenerSetter),this.sendMenu.classList.add("menu-send",e.openSide),r.attachContextMenuListener(e.onContextElement,t=>{e.onOpen&&!e.onOpen()||(this.sendMenuButtons.forEach(e=>{e.element.classList.toggle("hide",!e.verify())}),n.cancelEvent(t),r.openBtnMenu(this.sendMenu))},e.listenerSetter)}setPeerId(e){this.type=e==a.default.myId?"reminder":"schedule"}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(4),a=i(s(9)),o=i(s(13)),r=i(s(31)),d=i(s(5)),l=i(s(165)),c=s(0),f=i(s(41)),h=i(s(48));let u;const p=new f.default("page-password",!0,()=>{let e,t=0,s=!1;const i=p.pageEl.querySelector("button");u=document.getElementById("password");const o=u.nextElementSibling,f=p.pageEl.querySelector(".toggle-visible");let g,m=()=>(g||(g=window.setInterval(m,1e4)),l.default.getState().then(e=>{var t;y=e,o.innerText=null!==(t=y.hint)&&void 0!==t?t:"Password"})),b=e=>{i.removeAttribute("disabled"),u.classList.add("error"),e.type,i.innerText="INVALID PASSWORD",m()};const v=function(i){c.cancelEvent(i),s=!s,this.classList.toggle("eye-hidden",s),s?(u.setAttribute("type","text"),e.setDirection(1),e.curFrame=0,t=16,e.play()):(u.setAttribute("type","password"),e.setDirection(-1),e.curFrame=16,t=0,e.play())};let y;f.addEventListener("click",v),f.addEventListener("touchend",v),i.addEventListener("click",(function(t){if(!u.value.length)return void u.classList.add("error");this.setAttribute("disabled","true");let s=u.value;this.textContent="PLEASE WAIT...",n.putPreloader(this),l.default.check(s,y).then(t=>{switch(t._){case"auth.authorization":d.default.setUserAuth(t.user.id),clearInterval(g),h.default.mount(),e&&e.remove();break;default:i.removeAttribute("disabled"),i.innerText=t._}}).catch(b)})),u.addEventListener("keypress",(function(e){if(this.classList.remove("error"),i.innerText="NEXT","Enter"==e.key)return i.click()}));const M=a.default.isMobile?100:166;return Promise.all([r.default.loadAnimationFromURL({container:p.pageEl.querySelector(".auth-image"),loop:!1,autoplay:!1,width:M,height:M,noCache:!0},"assets/img/TwoFactorSetupMonkeyPeek.tgs").then(s=>{e=s,e.addListener("enterFrame",s=>{(1==e.direction&&s>=t||-1==e.direction&&s<=t)&&(e.setSpeed(1),e.pause())}),t=49}),m()])},null,()=>{u.focus(),o.default.pushToState("authState",{_:"authStatePassword"}),o.default.saveState()});t.default=p},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(56),o=n(s(110));t.default=class{constructor(e){this.dbName=e,this.openDatabase()}openDatabase(){return this.openDbPromise?this.openDbPromise:this.openDbPromise=caches.open(this.dbName)}delete(e){return this.timeoutOperation(t=>i(this,void 0,void 0,(function*(){yield t.delete("/"+e)})))}deleteAll(){return caches.delete(this.dbName)}save(e,t){return this.timeoutOperation(s=>s.put("/"+e,t))}saveFile(e,t){return t instanceof Blob||(t=a.blobConstruct(t)),this.save(e,new Response(t)).then(()=>t)}getFile(e,t="blob"){return this.timeoutOperation(s=>i(this,void 0,void 0,(function*(){const i=yield s.match("/"+e);if(!i||!s)throw"NO_ENTRY_FOUND";return i[t]()})))}timeoutOperation(e){return new Promise((t,s)=>i(this,void 0,void 0,(function*(){let i=!1;const n=setTimeout(()=>{s(),i=!0},5e3);try{const s=yield this.openDatabase();if(!s)throw"no cache?";const n=yield e(s);if(i)return;t(n)}catch(e){s(e)}clearTimeout(n)})))}getFileWriter(e,t){const s=o.default.getFakeFileWriter(t,t=>this.saveFile(e,t));return Promise.resolve(s)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhoneCodesMain=void 0;const i=s(2),n=[{phoneCode:"7 840",code:"AB",name:"Abkhazia",pattern:"",emoji:""},{phoneCode:"93",code:"AF",name:"Afghanistan",pattern:"93 XXX XXX XXX",emoji:"🇦🇫"},{phoneCode:"358 18",code:"AX",name:"Aland Islands",pattern:"",emoji:"🇦🇽"},{phoneCode:"355",code:"AL",name:"Albania",pattern:"355 XX XXX XXXX",emoji:"🇦🇱"},{phoneCode:"213",code:"DZ",name:"Algeria",pattern:"213 XXX XX XX XX",emoji:"🇩🇿"},{phoneCode:"1 684",code:"AS",name:"American Samoa",pattern:"1684 XXX XXXX",emoji:"🇦🇸"},{phoneCode:"376",code:"AD",name:"Andorra",pattern:"376 XX XX XX",emoji:"🇦🇩"},{phoneCode:"244",code:"AO",name:"Angola",pattern:"244 XXX XXX XXX",emoji:"🇦🇴"},{phoneCode:"1 264",code:"AI",name:"Anguilla",pattern:"1264 XXX XXXX",emoji:"🇦🇮"},{phoneCode:"1 268",code:"AG",name:"Antigua & Barbuda",pattern:"1268 XXX XXXX",emoji:"🇦🇬"},{phoneCode:"54",code:"AR",name:"Argentina",pattern:"",emoji:"🇦🇷"},{phoneCode:"374",code:"AM",name:"Armenia",pattern:"374 XX XXX XXX",emoji:"🇦🇲"},{phoneCode:"297",code:"AW",name:"Aruba",pattern:"297 XXX XXXX",emoji:"🇦🇼"},{phoneCode:"247",code:"SH",name:"Ascension",pattern:"290 XX XXX",emoji:"🇸🇭"},{phoneCode:"61",code:"AU",name:"Australia",pattern:"61 XXX XXX XXX",emoji:"🇦🇺"},{phoneCode:"672",code:"AU",name:"Australian External Territories",pattern:"61 XXX XXX XXX",emoji:"🇦🇺"},{phoneCode:"43",code:"AT",name:"Austria",pattern:"",emoji:"🇦🇹"},{phoneCode:"994",code:"AZ",name:"Azerbaijan",pattern:"994 XX XXX XX XX",emoji:"🇦🇿"},{phoneCode:"1 242",code:"BS",name:"Bahamas",pattern:"1242 XXX XXXX",emoji:"🇧🇸"},{phoneCode:"973",code:"BH",name:"Bahrain",pattern:"973 XXXX XXXX",emoji:"🇧🇭"},{phoneCode:"880",code:"BD",name:"Bangladesh",pattern:"",emoji:"🇧🇩"},{phoneCode:"1 246",code:"BB",name:"Barbados",pattern:"1246 XXX XXXX",emoji:"🇧🇧"},{phoneCode:"1 268",code:"AG",name:"Barbuda",pattern:"1268 XXX XXXX",emoji:"🇦🇬"},{phoneCode:"375",code:"BY",name:"Belarus",pattern:"375 XX XXX XXXX",emoji:"🇧🇾"},{phoneCode:"32",code:"BE",name:"Belgium",pattern:"32 XXX XX XX XX",emoji:"🇧🇪"},{phoneCode:"501",code:"BZ",name:"Belize",pattern:"",emoji:"🇧🇿"},{phoneCode:"229",code:"BJ",name:"Benin",pattern:"229 XX XXX XXX",emoji:"🇧🇯"},{phoneCode:"1 441",code:"BM",name:"Bermuda",pattern:"1441 XXX XXXX",emoji:"🇧🇲"},{phoneCode:"975",code:"BT",name:"Bhutan",pattern:"",emoji:"🇧🇹"},{phoneCode:"591",code:"BO",name:"Bolivia",pattern:"591 X XXX XXXX",emoji:"🇧🇴"},{phoneCode:"599 7",code:"BQ",name:"Caribbean Netherlands",pattern:"",emoji:"🇧🇶"},{phoneCode:"387",code:"BA",name:"Bosnia & Herzegovina",pattern:"",emoji:"🇧🇦"},{phoneCode:"267",code:"BW",name:"Botswana",pattern:"267 XX XXX XXX",emoji:"🇧🇼"},{phoneCode:"55",code:"BR",name:"Brazil",pattern:"55 XX XXXXX XXXX",emoji:"🇧🇷"},{phoneCode:"246",code:"IO",name:"British Indian Ocean Territory",pattern:"246 XXX XXXX",emoji:"🇮🇴"},{phoneCode:"1 284",code:"VG",name:"British Virgin Islands",pattern:"1284 XXX XXXX",emoji:"🇻🇬"},{phoneCode:"673",code:"BN",name:"Brunei",pattern:"673 XXX XXXX",emoji:"🇧🇳"},{phoneCode:"359",code:"BG",name:"Bulgaria",pattern:"",emoji:"🇧🇬"},{phoneCode:"226",code:"BF",name:"Burkina Faso",pattern:"226 XX XX XX XX",emoji:"🇧🇫"},{phoneCode:"95",code:"MM",name:"Myanmar (Burma)",pattern:"",emoji:"🇲🇲"},{phoneCode:"257",code:"BI",name:"Burundi",pattern:"257 XX XX XXXX",emoji:"🇧🇮"},{phoneCode:"855",code:"KH",name:"Cambodia",pattern:"",emoji:"🇰🇭"},{phoneCode:"237",code:"CM",name:"Cameroon",pattern:"237 XXXX XXXX",emoji:"🇨🇲"},{phoneCode:"1",code:"CA",name:"Canada",pattern:"1 XXX XXX XXXX",emoji:"🇨🇦"},{phoneCode:"238",code:"CV",name:"Cape Verde",pattern:"238 XXX XXXX",emoji:"🇨🇻"},{phoneCode:"1 345",code:"KY",name:"Cayman Islands",pattern:"1345 XXX XXXX",emoji:"🇰🇾"},{phoneCode:"236",code:"CF",name:"Central African Republic",pattern:"236 XX XX XX XX",emoji:"🇨🇫"},{phoneCode:"235",code:"TD",name:"Chad",pattern:"235 XX XX XX XX",emoji:"🇹🇩"},{phoneCode:"56",code:"CL",name:"Chile",pattern:"56 X XXXX XXXX",emoji:"🇨🇱"},{phoneCode:"86",code:"CN",name:"China",pattern:"86 XXX XXXX XXXX",emoji:"🇨🇳"},{phoneCode:"61",code:"CX",name:"Christmas Island",pattern:"",emoji:"🇨🇽"},{phoneCode:"61",code:"CC",name:"Cocos (Keeling) Islands",pattern:"",emoji:"🇨🇨"},{phoneCode:"57",code:"CO",name:"Colombia",pattern:"57 XXX XXX XXXX",emoji:"🇨🇴"},{phoneCode:"269",code:"KM",name:"Comoros",pattern:"269 XXX XXXX",emoji:"🇰🇲"},{phoneCode:"242",code:"CG",name:"Congo - Brazzaville",pattern:"242 XX XXX XXXX",emoji:"🇨🇬"},{phoneCode:"243",code:"CD",name:"Congo - Kinshasa",pattern:"243 XX XXX XXXX",emoji:"🇨🇩"},{phoneCode:"682",code:"CK",name:"Cook Islands",pattern:"",emoji:"🇨🇰"},{phoneCode:"506",code:"CR",name:"Costa Rica",pattern:"",emoji:"🇨🇷"},{phoneCode:"225",code:"CI",name:"Cote d’Ivoire",pattern:"225 XX XXX XXX",emoji:"🇨🇮"},{phoneCode:"385",code:"HR",name:"Croatia",pattern:"",emoji:"🇭🇷"},{phoneCode:"53",code:"CU",name:"Cuba",pattern:"53 XXXX XXXX",emoji:"🇨🇺"},{phoneCode:"599 9",code:"CW",name:"Curacao",pattern:"",emoji:"🇨🇼"},{phoneCode:"357",code:"CY",name:"Cyprus",pattern:"357 XXXX XXXX",emoji:"🇨🇾"},{phoneCode:"420",code:"CZ",name:"Czech Republic",pattern:"",emoji:"🇨🇿"},{phoneCode:"45",code:"DK",name:"Denmark",pattern:"45 XXXX XXXX",emoji:"🇩🇰"},{phoneCode:"246",code:"DG",name:"Diego Garcia",pattern:"",emoji:"🇩🇬"},{phoneCode:"253",code:"DJ",name:"Djibouti",pattern:"253 XX XX XX XX",emoji:"🇩🇯"},{phoneCode:"1 767",code:"DM",name:"Dominica",pattern:"1767 XXX XXXX",emoji:"🇩🇲"},{phoneCode:"1 809 and 1 829",code:"DO",name:"Dominican Republic",pattern:"1 XXX XXX XXXX",emoji:"🇩🇴"},{phoneCode:"670",code:"TL",name:"Timor-Leste",pattern:"",emoji:"🇹🇱"},{phoneCode:"593",code:"EC",name:"Ecuador",pattern:"",emoji:"🇪🇨"},{phoneCode:"20",code:"EG",name:"Egypt",pattern:"20 XX XXX XXXX",emoji:"🇪🇬"},{phoneCode:"503",code:"SV",name:"El Salvador",pattern:"503 XXXX XXXX",emoji:"🇸🇻"},{phoneCode:"240",code:"GQ",name:"Equatorial Guinea",pattern:"240 XXX XXX XXX",emoji:"🇬🇶"},{phoneCode:"291",code:"ER",name:"Eritrea",pattern:"291 X XXX XXX",emoji:"🇪🇷"},{phoneCode:"372",code:"EE",name:"Estonia",pattern:"",emoji:"🇪🇪"},{phoneCode:"251",code:"ET",name:"Ethiopia",pattern:"251 XX XXX XXXX",emoji:"🇪🇹"},{phoneCode:"500",code:"FK",name:"Falkland Islands",pattern:"",emoji:"🇫🇰"},{phoneCode:"298",code:"FO",name:"Faroe Islands",pattern:"298 XXX XXX",emoji:"🇫🇴"},{phoneCode:"679",code:"FJ",name:"Fiji",pattern:"",emoji:"🇫🇯"},{phoneCode:"358",code:"FI",name:"Finland",pattern:"",emoji:"🇫🇮"},{phoneCode:"33",code:"FR",name:"France",pattern:"33 X XX XX XX XX",emoji:"🇫🇷"},{phoneCode:"594",code:"GF",name:"French Guiana",pattern:"",emoji:"🇬🇫"},{phoneCode:"689",code:"PF",name:"French Polynesia",pattern:"",emoji:"🇵🇫"},{phoneCode:"241",code:"GA",name:"Gabon",pattern:"241 X XX XX XX",emoji:"🇬🇦"},{phoneCode:"220",code:"GM",name:"Gambia",pattern:"220 XXX XXXX",emoji:"🇬🇲"},{phoneCode:"995",code:"GE",name:"Georgia",pattern:"",emoji:"🇬🇪"},{phoneCode:"49",code:"DE",name:"Germany",pattern:"49 XXX XXXXXXXX",emoji:"🇩🇪"},{phoneCode:"233",code:"GH",name:"Ghana",pattern:"",emoji:"🇬🇭"},{phoneCode:"350",code:"GI",name:"Gibraltar",pattern:"350 XXXX XXXX",emoji:"🇬🇮"},{phoneCode:"30",code:"GR",name:"Greece",pattern:"30 XX XXXX XXXX",emoji:"🇬🇷"},{phoneCode:"299",code:"GL",name:"Greenland",pattern:"299 XXX XXX",emoji:"🇬🇱"},{phoneCode:"1 473",code:"GD",name:"Grenada",pattern:"1473 XXX XXXX",emoji:"🇬🇩"},{phoneCode:"590",code:"GP",name:"Guadeloupe",pattern:"",emoji:"🇬🇵"},{phoneCode:"1 671",code:"GU",name:"Guam",pattern:"1671 XXX XXXX",emoji:"🇬🇺"},{phoneCode:"502",code:"GT",name:"Guatemala",pattern:"502 X XXX XXXX",emoji:"🇬🇹"},{phoneCode:"44",code:"GG",name:"Guernsey",pattern:"",emoji:"🇬🇬"},{phoneCode:"224",code:"GN",name:"Guinea",pattern:"224 XXX XXX XXX",emoji:"🇬🇳"},{phoneCode:"245",code:"GW",name:"Guinea-Bissau",pattern:"245 XXX XXXX",emoji:"🇬🇼"},{phoneCode:"592",code:"GY",name:"Guyana",pattern:"",emoji:"🇬🇾"},{phoneCode:"509",code:"HT",name:"Haiti",pattern:"",emoji:"🇭🇹"},{phoneCode:"504",code:"HN",name:"Honduras",pattern:"504 XXXX XXXX",emoji:"🇭🇳"},{phoneCode:"852",code:"HK",name:"Hong Kong SAR China",pattern:"",emoji:"🇭🇰"},{phoneCode:"36",code:"HU",name:"Hungary",pattern:"36 XX XXX XXXX",emoji:"🇭🇺"},{phoneCode:"354",code:"IS",name:"Iceland",pattern:"354 XXX XXXX",emoji:"🇮🇸"},{phoneCode:"91",code:"IN",name:"India",pattern:"91 XXXXX XXXXX",emoji:"🇮🇳"},{phoneCode:"62",code:"ID",name:"Indonesia",pattern:"",emoji:"🇮🇩"},{phoneCode:"98",code:"IR",name:"Iran",pattern:"98 XXX XXX XXXX",emoji:"🇮🇷"},{phoneCode:"964",code:"IQ",name:"Iraq",pattern:"964 XXX XXX XXXX",emoji:"🇮🇶"},{phoneCode:"353",code:"IE",name:"Ireland",pattern:"353 XX XXX XXXX",emoji:"🇮🇪"},{phoneCode:"972",code:"IL",name:"Israel",pattern:"972 XX XXX XXXX",emoji:"🇮🇱"},{phoneCode:"39",code:"IT",name:"Italy",pattern:"39 XXX XXX XXXX",emoji:"🇮🇹"},{phoneCode:"1 876",code:"JM",name:"Jamaica",pattern:"1876 XXX XXXX",emoji:"🇯🇲"},{phoneCode:"47 79",code:"SJ",name:"Svalbard & Jan Mayen",pattern:"",emoji:"🇸🇯"},{phoneCode:"81",code:"JP",name:"Japan",pattern:"81 XX XXXX XXXX",emoji:"🇯🇵"},{phoneCode:"44",code:"JE",name:"Jersey",pattern:"",emoji:"🇯🇪"},{phoneCode:"962",code:"JO",name:"Jordan",pattern:"962 X XXXX XXXX",emoji:"🇯🇴"},{phoneCode:"7 7",code:"KZ",name:"Kazakhstan",pattern:"7 XXX XXX XX XX",emoji:"🇰🇿"},{phoneCode:"254",code:"KE",name:"Kenya",pattern:"254 XXX XXX XXX",emoji:"🇰🇪"},{phoneCode:"686",code:"KI",name:"Kiribati",pattern:"",emoji:"🇰🇮"},{phoneCode:"850",code:"KP",name:"North Korea",pattern:"",emoji:"🇰🇵"},{phoneCode:"82",code:"KR",name:"South Korea",pattern:"",emoji:"🇰🇷"},{phoneCode:"965",code:"KW",name:"Kuwait",pattern:"965 XXXX XXXX",emoji:"🇰🇼"},{phoneCode:"996",code:"KG",name:"Kyrgyzstan",pattern:"",emoji:"🇰🇬"},{phoneCode:"856",code:"LA",name:"Laos",pattern:"",emoji:"🇱🇦"},{phoneCode:"371",code:"LV",name:"Latvia",pattern:"371 XXX XXXXX",emoji:"🇱🇻"},{phoneCode:"961",code:"LB",name:"Lebanon",pattern:"",emoji:"🇱🇧"},{phoneCode:"266",code:"LS",name:"Lesotho",pattern:"266 XX XXX XXX",emoji:"🇱🇸"},{phoneCode:"231",code:"LR",name:"Liberia",pattern:"",emoji:"🇱🇷"},{phoneCode:"218",code:"LY",name:"Libya",pattern:"218 XX XXX XXXX",emoji:"🇱🇾"},{phoneCode:"423",code:"LI",name:"Liechtenstein",pattern:"",emoji:"🇱🇮"},{phoneCode:"370",code:"LT",name:"Lithuania",pattern:"370 XXX XXXXX",emoji:"🇱🇹"},{phoneCode:"352",code:"LU",name:"Luxembourg",pattern:"",emoji:"🇱🇺"},{phoneCode:"853",code:"MO",name:"Macau SAR China",pattern:"",emoji:"🇲🇴"},{phoneCode:"389",code:"MK",name:"Macedonia",pattern:"",emoji:"🇲🇰"},{phoneCode:"261",code:"MG",name:"Madagascar",pattern:"261 XX XX XXX XX",emoji:"🇲🇬"},{phoneCode:"265",code:"MW",name:"Malawi",pattern:"",emoji:"🇲🇼"},{phoneCode:"60",code:"MM",name:"Malaysia",pattern:"",emoji:"🇲🇲"},{phoneCode:"960",code:"MV",name:"Maldives",pattern:"",emoji:"🇲🇻"},{phoneCode:"223",code:"ML",name:"Mali",pattern:"223 XXXX XXXX",emoji:"🇲🇱"},{phoneCode:"356",code:"MT",name:"Malta",pattern:"356 XX XX XX XX",emoji:"🇲🇹"},{phoneCode:"692",code:"MH",name:"Marshall Islands",pattern:"",emoji:"🇲🇭"},{phoneCode:"596",code:"MQ",name:"Martinique",pattern:"",emoji:"🇲🇶"},{phoneCode:"222",code:"MR",name:"Mauritania",pattern:"222 XXXX XXXX",emoji:"🇲🇷"},{phoneCode:"230",code:"MU",name:"Mauritius",pattern:"",emoji:"🇲🇺"},{phoneCode:"262",code:"YT",name:"Mayotte",pattern:"",emoji:"🇾🇹"},{phoneCode:"52",code:"MX",name:"Mexico",pattern:"",emoji:"🇲🇽"},{phoneCode:"691",code:"FM",name:"Micronesia",pattern:"",emoji:"🇫🇲"},{phoneCode:"373",code:"MD",name:"Moldova",pattern:"373 XX XXX XXX",emoji:"🇲🇩"},{phoneCode:"377",code:"MC",name:"Monaco",pattern:"377 XXXX XXXX",emoji:"🇲🇨"},{phoneCode:"976",code:"MN",name:"Mongolia",pattern:"",emoji:"🇲🇳"},{phoneCode:"382",code:"ME",name:"Montenegro",pattern:"",emoji:"🇲🇪"},{phoneCode:"1 664",code:"MS",name:"Montserrat",pattern:"1664 XXX XXXX",emoji:"🇲🇸"},{phoneCode:"212",code:"MA",name:"Morocco",pattern:"212 XX XXX XXXX",emoji:"🇲🇦"},{phoneCode:"258",code:"MZ",name:"Mozambique",pattern:"258 XX XXX XXXX",emoji:"🇲🇿"},{phoneCode:"264",code:"NA",name:"Namibia",pattern:"264 XX XXX XXXX",emoji:"🇳🇦"},{phoneCode:"674",code:"NR",name:"Nauru",pattern:"",emoji:"🇳🇷"},{phoneCode:"977",code:"NP",name:"Nepal",pattern:"",emoji:"🇳🇵"},{phoneCode:"31",code:"NL",name:"Netherlands",pattern:"31 X XX XX XX XX",emoji:"🇳🇱"},{phoneCode:"687",code:"NC",name:"New Caledonia",pattern:"",emoji:"🇳🇨"},{phoneCode:"64",code:"NZ",name:"New Zealand",pattern:"",emoji:"🇳🇿"},{phoneCode:"505",code:"NI",name:"Nicaragua",pattern:"505 XXXX XXXX",emoji:"🇳🇮"},{phoneCode:"227",code:"NE",name:"Niger",pattern:"227 XX XX XX XX",emoji:"🇳🇪"},{phoneCode:"234",code:"NG",name:"Nigeria",pattern:"",emoji:"🇳🇬"},{phoneCode:"683",code:"NU",name:"Niue",pattern:"",emoji:"🇳🇺"},{phoneCode:"672",code:"NF",name:"Norfolk Island",pattern:"",emoji:"🇳🇫"},{phoneCode:"1 670",code:"MP",name:"Northern Mariana Islands",pattern:"1670 XXX XXXX",emoji:"🇲🇵"},{phoneCode:"47",code:"NO",name:"Norway",pattern:"47 XXXX XXXX",emoji:"🇳🇴"},{phoneCode:"968",code:"OM",name:"Oman",pattern:"968 XXXX XXXX",emoji:"🇴🇲"},{phoneCode:"92",code:"PK",name:"Pakistan",pattern:"92 XXX XXX XXXX",emoji:"🇵🇰"},{phoneCode:"680",code:"PW",name:"Palau",pattern:"",emoji:"🇵🇼"},{phoneCode:"970",code:"PS",name:"Palestinian Territories",pattern:"970 XXX XX XXXX",emoji:"🇵🇸"},{phoneCode:"507",code:"PA",name:"Panama",pattern:"507 XXXX XXXX",emoji:"🇵🇦"},{phoneCode:"675",code:"PG",name:"Papua New Guinea",pattern:"",emoji:"🇵🇬"},{phoneCode:"595",code:"PY",name:"Paraguay",pattern:"595 XXX XXX XXX",emoji:"🇵🇾"},{phoneCode:"51",code:"PE",name:"Peru",pattern:"51 XXX XXX XXX",emoji:"🇵🇪"},{phoneCode:"63",code:"PH",name:"Philippines",pattern:"63 XXX XXX XXXX",emoji:"🇵🇭"},{phoneCode:"64",code:"PN",name:"Pitcairn Islands",pattern:"",emoji:"🇵🇳"},{phoneCode:"48",code:"PL",name:"Poland",pattern:"48 XXX XXX XXX",emoji:"🇵🇱"},{phoneCode:"351",code:"PT",name:"Portugal",pattern:"351 X XXXX XXXX",emoji:"🇵🇹"},{phoneCode:"1 787 and 1 939",code:"PR",name:"Puerto Rico",pattern:"1 XXX XXX XXXX",emoji:"🇵🇷"},{phoneCode:"974",code:"QA",name:"Qatar",pattern:"",emoji:"🇶🇦"},{phoneCode:"262",code:"RE",name:"Reunion",pattern:"262 XXX XXX XXX",emoji:"🇷🇪"},{phoneCode:"40",code:"RO",name:"Romania",pattern:"40 XXX XXX XXX",emoji:"🇷🇴"},{phoneCode:"7",code:"RU",name:"Russia",pattern:"7 XXX XXX XX XX",emoji:"🇷🇺"},{phoneCode:"250",code:"RW",name:"Rwanda",pattern:"250 XXX XXX XXX",emoji:"🇷🇼"},{phoneCode:"590",code:"BL",name:"St. Barthelemy",pattern:"",emoji:"🇧🇱"},{phoneCode:"290",code:"SH",name:"St. Helena",pattern:"290 XX XXX",emoji:"🇸🇭"},{phoneCode:"1 869",code:"KN",name:"St. Kitts & Nevis",pattern:"1869 XXX XXXX",emoji:"🇰🇳"},{phoneCode:"1 758",code:"LC",name:"St. Lucia",pattern:"1758 XXX XXXX",emoji:"🇱🇨"},{phoneCode:"590",code:"MF",name:"St. Martin (France)",pattern:"",emoji:"🇲🇫"},{phoneCode:"508",code:"PM",name:"St. Pierre and Miquelon",pattern:"",emoji:"🇵🇲"},{phoneCode:"1 784",code:"VC",name:"St. Vincent and the Grenadines",pattern:"1784 XXX XXXX",emoji:"🇻🇨"},{phoneCode:"685",code:"WS",name:"Samoa",pattern:"",emoji:"🇼🇸"},{phoneCode:"378",code:"SM",name:"San Marino",pattern:"378 XXX XXX XXXX",emoji:"🇸🇲"},{phoneCode:"239",code:"ST",name:"São Tome & Principe",pattern:"239 XX XXXXX",emoji:"🇸🇹"},{phoneCode:"966",code:"SA",name:"Saudi Arabia",pattern:"",emoji:"🇸🇦"},{phoneCode:"221",code:"SN",name:"Senegal",pattern:"221 XX XXX XXXX",emoji:"🇸🇳"},{phoneCode:"381",code:"RS",name:"Serbia",pattern:"381 XX XXX XXXX",emoji:"🇷🇸"},{phoneCode:"248",code:"SC",name:"Seychelles",pattern:"248 X XX XX XX",emoji:"🇸🇨"},{phoneCode:"232",code:"SL",name:"Sierra Leone",pattern:"232 XX XXX XXX",emoji:"🇸🇱"},{phoneCode:"65",code:"SG",name:"Singapore",pattern:"65 XXXX XXXX",emoji:"🇸🇬"},{phoneCode:"599 3",code:"BQ",name:"Sint Eustatius",pattern:"",emoji:"🇧🇶"},{phoneCode:"1 721",code:"SX",name:"Sint Maarten",pattern:"1721 XXX XXXX",emoji:"🇸🇽"},{phoneCode:"421",code:"SK",name:"Slovakia",pattern:"",emoji:"🇸🇰"},{phoneCode:"386",code:"SI",name:"Slovenia",pattern:"",emoji:"🇸🇮"},{phoneCode:"677",code:"SB",name:"Solomon Islands",pattern:"",emoji:"🇸🇧"},{phoneCode:"252",code:"SO",name:"Somalia",pattern:"252 XX XXX XXX",emoji:"🇸🇴"},{phoneCode:"27",code:"ZA",name:"South Africa",pattern:"27 XX XXX XXXX",emoji:"🇿🇦"},{phoneCode:"500",code:"GS",name:"South Georgia & South Sandwich Islands",pattern:"",emoji:"🇬🇸"},{phoneCode:"995 34",code:"",name:"South Ossetia",pattern:"",emoji:""},{phoneCode:"211",code:"SS",name:"South Sudan",pattern:"211 XX XXX XXXX",emoji:"🇸🇸"},{phoneCode:"34",code:"ES",name:"Spain",pattern:"34 XXX XXX XXX",emoji:"🇪🇸"},{phoneCode:"94",code:"LK",name:"Sri Lanka",pattern:"94 XX XXX XXXX",emoji:"🇱🇰"},{phoneCode:"249",code:"SD",name:"Sudan",pattern:"249 XX XXX XXXX",emoji:"🇸🇩"},{phoneCode:"597",code:"SR",name:"Suriname",pattern:"597 XXX XXXX",emoji:"🇸🇷"},{phoneCode:"47 79",code:"SJ",name:"Svalbard",pattern:"",emoji:"🇸🇯"},{phoneCode:"268",code:"SZ",name:"Swaziland",pattern:"268 XXXX XXXX",emoji:"🇸🇿"},{phoneCode:"46",code:"SE",name:"Sweden",pattern:"46 XX XXX XXXX",emoji:"🇸🇪"},{phoneCode:"41",code:"CH",name:"Switzerland",pattern:"41 XX XXX XXXX",emoji:"🇨🇭"},{phoneCode:"963",code:"SY",name:"Syria",pattern:"",emoji:"🇸🇾"},{phoneCode:"886",code:"TW",name:"Taiwan",pattern:"",emoji:"🇹🇼"},{phoneCode:"992",code:"TJ",name:"Tajikistan",pattern:"",emoji:"🇹🇯"},{phoneCode:"255",code:"TZ",name:"Tanzania",pattern:"255 XX XXX XXXX",emoji:"🇹🇿"},{phoneCode:"66",code:"TH",name:"Thailand",pattern:"66 X XXXX XXXX",emoji:"🇹🇭"},{phoneCode:"228",code:"TG",name:"Togo",pattern:"228 XX XXX XXX",emoji:"🇹🇬"},{phoneCode:"690",code:"TK",name:"Tokelau",pattern:"",emoji:"🇹🇰"},{phoneCode:"676",code:"TO",name:"Tonga",pattern:"",emoji:"🇹🇴"},{phoneCode:"1 868",code:"TT",name:"Trinidad & Tobago",pattern:"1868 XXX XXXX",emoji:"🇹🇹"},{phoneCode:"216",code:"TN",name:"Tunisia",pattern:"216 XX XXX XXX",emoji:"🇹🇳"},{phoneCode:"90",code:"TR",name:"Turkey",pattern:"90 XXX XXX XXXX",emoji:"🇹🇷"},{phoneCode:"993",code:"TM",name:"Turkmenistan",pattern:"993 XX XXXXXX",emoji:"🇹🇲"},{phoneCode:"1 649",code:"TC",name:"Turks & Caicos Islands",pattern:"1649 XXX XXXX",emoji:"🇹🇨"},{phoneCode:"688",code:"TV",name:"Tuvalu",pattern:"",emoji:"🇹🇻"},{phoneCode:"256",code:"UG",name:"Uganda",pattern:"256 XX XXX XXXX",emoji:"🇺🇬"},{phoneCode:"380",code:"UA",name:"Ukraine",pattern:"380 XX XXX XX XX",emoji:"🇺🇦"},{phoneCode:"971",code:"AE",name:"United Arab Emirates",pattern:"971 XX XXX XXXX",emoji:"🇦🇪"},{phoneCode:"44",code:"GB",name:"United Kingdom",pattern:"44 XXXX XXXXXX",emoji:"🇬🇧"},{phoneCode:"1",code:"US",name:"United States",pattern:"1 XXX XXX XXXX",emoji:"🇺🇸"},{phoneCode:"598",code:"UY",name:"Uruguay",pattern:"598 XXXX XXXX",emoji:"🇺🇾"},{phoneCode:"1 340",code:"VI",name:"U.S. Virgin Islands",pattern:"1340 XXX XXXX",emoji:"🇻🇮"},{phoneCode:"998",code:"UZ",name:"Uzbekistan",pattern:"998 XX XXXXXXX",emoji:"🇺🇿"},{phoneCode:"678",code:"VU",name:"Vanuatu",pattern:"",emoji:"🇻🇺"},{phoneCode:"58",code:"VE",name:"Venezuela",pattern:"58 XXX XXX XXXX",emoji:"🇻🇪"},{phoneCode:"39 06 698",code:"VA",name:"Vatican City",pattern:"",emoji:"🇻🇦"},{phoneCode:"84",code:"VN",name:"Vietnam",pattern:"",emoji:"🇻🇳"},{phoneCode:"681",code:"WF",name:"Wallis & Futuna",pattern:"",emoji:"🇼🇫"},{phoneCode:"967",code:"YE",name:"Yemen",pattern:"967 XXX XXX XXX",emoji:"🇾🇪"},{phoneCode:"260",code:"ZM",name:"Zambia",pattern:"260 XX XXX XXXX",emoji:"🇿🇲"},{phoneCode:"255",code:"",name:"Zanzibar",pattern:"",emoji:""},{phoneCode:"263",code:"ZW",name:"Zimbabwe",pattern:"263 XX XXX XXXX",emoji:"🇿🇼"}],a={1:n.find(e=>"United States"==e.name),44:n.find(e=>"United Kingdom"==e.name),61:n.find(e=>"Australia"==e.name),64:n.find(e=>"New Zealand"==e.name),246:n.find(e=>"Diego Garcia"==e.name),255:n.find(e=>"Tanzania"==e.name),262:n.find(e=>"Reunion"==e.name),500:n.find(e=>"Falkland Islands"==e.name),590:n.find(e=>"Guadeloupe"==e.name),672:n.find(e=>"Norfolk Island"==e.name),"1 268":n.find(e=>"Antigua & Barbuda"==e.name)};t.PhoneCodesMain=a,i.MOUNT_CLASS_TO&&(i.MOUNT_CLASS_TO.Countries=n),t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEmojiToneIndex=t.toCodePoints=t.encodeEmoji=void 0,t.encodeEmoji=function(e){return o(a(e)).join("-")};const i=/\uFE0F/g,n=String.fromCharCode(8205),a=e=>e.indexOf(n)<0?e.replace(i,""):e;function o(e){const t=[];let s=0,i=0,n=0;for(;n<e.length;)s=e.charCodeAt(n++),i?(t.push((65536+(i-55296<<10)+(s-56320)).toString(16)),i=0):s>55296&&s<=56319?i=s:t.push(s.toString(16));return t.length&&2==t[0].length&&(t[0]="00"+t[0]),t}t.toCodePoints=o,t.getEmojiToneIndex=function(e){let t=e.match(/[\uDFFB-\uDFFF]/);return t?5-(57343-t[0].charCodeAt(0)):0}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createPosterForVideo=t.createPosterFromVideo=t.preloadVideo=void 0;const n=s(34);function a(e){return new Promise((t,s)=>{const i=document.createElement("video");i.volume=0,i.onloadedmetadata=()=>t(i),i.onerror=s,i.src=e})}function o(e){return new Promise((t,s)=>{e.onseeked=()=>{const s=document.createElement("canvas");s.width=Math.min(1280,e.videoWidth),s.height=Math.min(720,e.videoHeight);s.getContext("2d").drawImage(e,0,0),s.toBlob(e=>{t(e)},"image/jpeg",1)},e.onerror=s,e.currentTime=Math.min(e.duration,1)})}t.preloadVideo=a,t.createPosterFromVideo=o,t.createPosterForVideo=function(e){return i(this,void 0,void 0,(function*(){const t=yield a(e);return Promise.race([n.pause(2e3),o(t)])}))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.langPack=void 0,t.langPack={messageActionChatCreate:"created the group",messageActionChatEditTitle:"changed group name",messageActionChatEditPhoto:"changed group photo",messageActionChatDeletePhoto:"removed group photo",messageActionChatReturn:"returned to group",messageActionChatJoined:"joined the group",messageActionChatAddUser:"invited {}",messageActionChatAddUsers:"invited {} users",messageActionChatLeave:"left the group",messageActionChatDeleteUser:"removed user {}",messageActionChatJoinedByLink:"joined the group",messageActionPinMessage:"pinned message",messageActionContactSignUp:"joined Telegram",messageActionChannelCreate:"Channel created",messageActionChannelEditTitle:"Channel renamed",messageActionChannelEditPhoto:"Channel photo updated",messageActionChannelDeletePhoto:"Channel photo removed",messageActionHistoryClear:"History was cleared",messageActionChannelMigrateFrom:"","messageActionPhoneCall.in_ok":"Incoming Call","messageActionPhoneCall.out_ok":"Outgoing Call","messageActionPhoneCall.in_missed":"Missed Call","messageActionPhoneCall.out_missed":"Cancelled Call",messageActionBotAllowed:"You allowed this bot to message you when logged in {}"}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OpusDecodeController=void 0;const n=s(12),a=s(16),o=s(2);class r{constructor(){this.sampleRate=48e3,this.tasks=[],this.keepAlive=!1,this.log=a.logger("OPUS",a.LogLevels.error)}isPlaySupported(){if(void 0!==this.isPlaySupportedResult)return this.isPlaySupportedResult;const e=document.createElement("audio");return this.isPlaySupportedResult=!(!e.canPlayType||!e.canPlayType("audio/ogg;").replace(/no/,""))}loadWavWorker(){this.wavWorker||(this.wavWorker=new Worker("waveWorker.min.js"),this.wavWorker.addEventListener("message",e=>{const t=e.data;if(this.log("[WAV] got message:",t),t&&t.page){const e=t.page;this.onTaskEnd(this.tasks.shift(),e)}}))}loadWorker(){this.worker||(this.worker=new Worker("decoderWorker.min.js"),this.worker.addEventListener("message",e=>{const t=e.data;this.log("[DECODER] got message",t),"done"==t.type?(this.wavWorker.postMessage({command:"done"}),t.waveform&&(this.tasks[0].waveform=t.waveform)):this.wavWorker.postMessage({command:"encode",buffers:e.data},n.isSafari?void 0:t.map(e=>e.buffer))}))}setKeepAlive(e){this.keepAlive=e,this.keepAlive?(this.loadWorker(),this.loadWavWorker()):this.tasks.length||this.terminateWorkers()}onTaskEnd(e,t){t?(clearTimeout(e.timeout),e.callback.resolve({bytes:t,waveform:e.waveform})):e.callback.reject("timeout"),this.tasks.length&&this.executeNewTask(this.tasks[0]),this.terminateWorkers()}terminateWorkers(e=!1){(!this.keepAlive&&!this.tasks.length||e)&&(this.worker&&(this.worker.terminate(),this.worker=null),this.wavWorker&&(this.wavWorker.terminate(),this.wavWorker=null))}executeNewTask(e){this.worker.postMessage({command:"init",decoderSampleRate:this.sampleRate,outputBufferSampleRate:this.sampleRate}),this.wavWorker.postMessage({command:"init",wavBitDepth:16,wavSampleRate:this.sampleRate}),this.log("[DECODER] send decode"),this.worker.postMessage({command:"decode",pages:e.pages,waveform:e.withWaveform},n.isSafari?void 0:[e.pages.buffer]),e.timeout=window.setTimeout(()=>{this.log.error("decode timeout"),this.terminateWorkers(!0),this.tasks.length&&(this.loadWorker(),this.loadWavWorker()),this.onTaskEnd(this.tasks.shift())},1e4)}pushDecodeTask(e,t){return new Promise((s,i)=>{const n={pages:e,withWaveform:t,callback:{resolve:s,reject:i},timeout:0};this.loadWorker(),this.loadWavWorker(),1==this.tasks.push(n)&&this.executeNewTask(n)})}decode(e,t=!1){return i(this,void 0,void 0,(function*(){return this.pushDecodeTask(e,t).then(e=>{const t=new Blob([e.bytes],{type:"audio/wav"});return{url:URL.createObjectURL(t),waveform:e.waveform}})}))}}t.OpusDecodeController=r;const d=new r;o.MOUNT_CLASS_TO&&(o.MOUNT_CLASS_TO.opusDecodeController=d),t.default=d},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppWebPagesManager=void 0;const n=i(s(20)),a=i(s(21)),o=s(3),r=i(s(1)),d=s(14),l=s(33);class c{constructor(){this.webpages={},this.pendingWebPages={},r.default.on("apiUpdate",e=>{const t=e.detail;switch(t._){case"updateWebPage":this.saveWebPage(t.webpage)}})}saveWebPage(e,t,s){e.photo&&"photo"===e.photo._?e.photo=n.default.savePhoto(e.photo,s):delete e.photo,e.document&&"document"===e.document._?e.document=a.default.saveDoc(e.document,s):("document"==e.type&&delete e.type,delete e.document);const i=e.site_name;let c=e.title||e.author||i||"";i&&c==i&&delete e.site_name,c=l.limitSymbols(c,80,100),e.rTitle=o.RichTextProcessor.wrapRichText(c,{noLinks:!0,noLinebreaks:!0});let f="";if("GitHub"==i){const t=e.url.match(/(https?:\/\/github\.com\/[^\/]+\/[^\/]+)/);t&&(f=t[0]+"/issues/{1}")}const h=l.limitSymbols(e.description||"",150,180);if(e.rDescription=o.RichTextProcessor.wrapRichText(h,{contextSite:i||"external",contextHashtag:f}),"photo"!=e.type&&"video"!=e.type&&"gif"!=e.type&&"document"!=e.type&&!e.description&&e.photo&&(e.type="photo"),t&&(void 0===this.pendingWebPages[e.id]&&(this.pendingWebPages[e.id]={}),this.pendingWebPages[e.id][t]=!0),void 0===this.webpages[e.id]?this.webpages[e.id]=e:d.safeReplaceObject(this.webpages[e.id],e),!t&&void 0!==this.pendingWebPages[e.id]){const t=[];for(const s in this.pendingWebPages[e.id])t.push(+s);r.default.broadcast("webpage_updated",{id:e.id,msgs:t})}return e}deleteWebPageFromPending(e,t){const s=e.id;this.pendingWebPages[s]&&this.pendingWebPages[s][t]&&(delete this.pendingWebPages[s][t],Object.keys(this.pendingWebPages[s]).length||delete this.pendingWebPages[s])}getWebPage(e){return this.webpages[e]}}t.AppWebPagesManager=c,t.default=new c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransitionSlider=void 0;const i=s(0);function n(e,t,s){const i=t.getBoundingClientRect().width,n=[e,t];return s&&n.reverse(),n[0].style.filter="brightness(80%)",n[0].style.transform=`translate3d(${.25*-i}px, 0, 0)`,n[1].style.transform=`translate3d(${i}px, 0, 0)`,e.classList.add("active"),e.offsetWidth,e.style.transform="",e.style.filter="",()=>{t.style.transform=t.style.filter=""}}function a(e,t,s){const i=t.getBoundingClientRect().width,n=[e,t];return s&&n.reverse(),n[0].style.transform=`translate3d(${-i}px, 0, 0)`,n[1].style.transform=`translate3d(${i}px, 0, 0)`,e.classList.add("active"),e.offsetWidth,e.style.transform="",()=>{t.style.transform=""}}t.TransitionSlider=(e,t,s,i)=>{let r=null;switch(t){case"tabs":r=a;break;case"navigation":r=n}return o(e,r,s,i)};const o=(e,t,s,n)=>{const a={};let o,r=null;function d(l,c=!0){const f=d;if(l instanceof HTMLElement&&(l=i.whichChild(l)),l==f.prevId)return!1;const h=r,u=e.children[l];if(!c)return h&&h.classList.remove("active"),u.classList.add("active"),f.prevId=l,r=u,void(n&&n(f.prevId));r&&(r.classList.remove("to"),r.classList.add("from")),e.classList.add("animating");const p=f.prevId<l;let g;e.classList.toggle("backwards",!p),u&&(-1!=f.prevId?(t&&(g=t(u,r,p)),u.classList.add("to")):u.classList.add("active"));const m=f.prevId;a.hasOwnProperty(l)&&clearTimeout(a[l]),h&&(a[m]=window.setTimeout(()=>{g&&g(),h.classList.remove("active","from"),u&&(u.classList.remove("to"),u.classList.add("active")),delete a[m]},s),o&&clearTimeout(o),o=window.setTimeout(()=>{n&&n(f.prevId),e.classList.remove("animating","backwards"),o=0},s)),f.prevId=l,r=u}return d.prevId=-1,d};t.default=o},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(s(9)),o=n(s(13)),r=n(s(31)),d=n(s(5)),l=n(s(41)),c=n(s(48)),f=n(s(79)),h=n(s(66)),u=n(s(104));let p,g=null,m=null,b=null;const v=new l.default("page-authCode",!0,()=>{let e,t,s=0,n=0;const o=g.type.length;p=v.pageEl.querySelector("#code");const l=p.nextElementSibling;v.pageEl.querySelector(".phone-edit").addEventListener("click",(function(){return h.default.mount()}));let m=()=>{setTimeout(()=>{e&&e.remove(),t&&t.remove()},300)};p.addEventListener("input",(function(e){this.classList.remove("error"),l.innerText="Code",this.value=this.value.replace(/\D/g,""),this.value.length>o&&(this.value=this.value.slice(0,o));let t=this.value.length;if(t==o)(e=>{p.setAttribute("disabled","true");let t={phone_number:g.phone_number,phone_code_hash:g.phone_code_hash,phone_code:e};d.default.invokeApi("auth.signIn",t,{ignoreErrors:!0}).then(e=>{switch(e._){case"auth.authorization":d.default.setUserAuth(e.user.id),c.default.mount(),m();break;case"auth.authorizationSignUpRequired":u.default.mount({phone_number:g.phone_number,phone_code_hash:g.phone_code_hash}),m()}}).catch(e=>i(void 0,void 0,void 0,(function*(){switch(e.type){case"SESSION_PASSWORD_NEEDED":e.handled=!0,yield f.default.mount();break;case"PHONE_CODE_EMPTY":case"PHONE_CODE_INVALID":p.classList.add("error"),l.innerText="Invalid Code";break;default:l.innerText=e.type}p.removeAttribute("disabled")})))})(this.value);else if(t==n)return;n=t,b(t)}));const b=i=>{if(!e)return;let n;i?(n=Math.round(Math.min(45,i)*(165/45)+11.33),t&&(t.stop(!0),t.canvas.style.display="none"),e.canvas.style.display=""):n=0;const a=s>n?-1:1;e.setDirection(a),0!=s&&0==n&&e.setSpeed(7),s=n,e.play()};p.addEventListener("blur",()=>{b(0)});let y=v.pageEl.querySelector(".auth-image");const M=a.default.isMobile?100:166;return Promise.all([r.default.loadAnimationFromURL({container:y,loop:!0,autoplay:!0,width:M,height:M},"assets/img/TwoFactorSetupMonkeyIdle.tgs").then(e=>{t=e,p.value.length||e.play()}),r.default.loadAnimationFromURL({container:y,loop:!1,autoplay:!1,width:M,height:M},"assets/img/TwoFactorSetupMonkeyTracking.tgs").then(i=>{e=i,p.value.length||(e.canvas.style.display="none"),e.addListener("enterFrame",i=>{(1==e.direction&&i>=s||-1==e.direction&&i<=s)&&(e.setSpeed(1),e.pause()),0==i&&0==s&&t&&(t.canvas.style.display="",t.play(),e.canvas.style.display="none")})})])},e=>{if(g=e,m){p.value="";const e=document.createEvent("HTMLEvents");e.initEvent("input",!1,!0),p.dispatchEvent(e)}else m=v.pageEl.getElementsByClassName("phone")[0],b=v.pageEl.getElementsByClassName("sent-type")[0];switch(m.innerText=g.phone_number,g.type._){case"auth.sentCodeTypeSms":b.innerHTML="We have sent you an SMS<br>with the code.";break;case"auth.sentCodeTypeApp":b.innerHTML="We have sent you a message in Telegram<br>with the code.";break;case"auth.sentCodeTypeCall":b.innerHTML="We will call you and voice<br>the code.";break;default:b.innerHTML=`Please check everything<br>for a code (type: ${g.type._})`}o.default.pushToState("authState",{_:"authStateAuthCode",sentCode:e}),o.default.saveState()},()=>{p.focus()});t.default=v},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuperSliderTab=void 0;const i=s(0),n=s(47);class a{constructor(e,t){this.slider=e,this.container=t,this.closeBtn=this.container.querySelector(".sidebar-close-button"),this.id=this.slider.addTab(this)}close(){return this.slider.closeTab(this.id)}open(){return this.slider.selectTab(this)}}t.SuperSliderTab=a;t.default=class{constructor(e,t={},s=!1){this.sidebarEl=e,this.tabs=t,this.canHideFirst=s,this.historyTabIds=[],this.closeTab=e=>{var t;if(void 0!==e&&this.historyTabIds[this.historyTabIds.length-1]!==e)return!1;let s=this.historyTabIds.pop();return this.onCloseTab(s),this._selectTab(null!==(t=this.historyTabIds[this.historyTabIds.length-1])&&void 0!==t?t:this.canHideFirst?-1:0),!0},this._selectTab=n.horizontalMenu(null,this.sidebarEl.querySelector(".sidebar-slider"),null,null,250),s||this._selectTab(0),Array.from(this.sidebarEl.querySelectorAll(".sidebar-close-button")).forEach(e=>{i.attachClickEvent(e,()=>this.closeTab())})}selectTab(e){if(e instanceof a&&(e=e.id),this.historyTabIds[this.historyTabIds.length-1]===e)return!1;const t=this.tabs[e];return t&&(t.onOpen&&t.onOpen(),t.onOpenAfterTimeout&&setTimeout(()=>{t.onOpenAfterTimeout()},250)),this.historyTabIds.push(e),this._selectTab(e),!0}removeTabFromHistory(e){this.historyTabIds.findAndSplice(t=>t===e),this.onCloseTab(e)}onCloseTab(e){let t=this.tabs[e];t&&(t.onClose&&t.onClose(),t.onCloseAfterTimeout&&setTimeout(()=>{t.onCloseAfterTimeout()},250))}addTab(e){let t;return e.container.parentElement?t=Array.from(this.sidebarEl.children).findIndex(t=>t===e.container):(t=this.sidebarEl.childElementCount,this.sidebarEl.append(e.container),e.closeBtn&&e.closeBtn.addEventListener("click",()=>this.closeTab())),this.tabs[t]=e,t}}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(18),o=s(0),r=s(14),d=s(33),l=n(s(19)),c=n(s(23)),f=n(s(7)),h=n(s(10)),u=n(s(20)),p=n(s(13)),g=n(s(8)),m=s(16),b=n(s(3)),v=n(s(1)),y=n(s(69)),M=n(s(71)),_=s(49),w=s(47),S=n(s(25)),I=s(4),L=s(17),E=s(6),C=s(24);t.default=class{constructor(e,t,s,i=!1){this.types=e,this.scrollable=t,this.searchGroups=s,this.asChatList=i,this.tabs={},this.prevTabId=-1,this.lazyLoadQueue=new S.default,this.cleanupObj={cleaned:!1},this.historyStorage={},this.usedFromHistory={},this.urlsToRevoke=[],this.loadMutex=Promise.resolve(),this.nextRates={},this.loadPromises={},this.loaded={},this.loadedChats=!1,this.log=m.logger("SEARCH-SUPER"),this.monthContainers={},this.onTransitionStart=()=>{const e=this.scrollable.container;if("hidden"!==e.style.overflowY){const t=e.offsetWidth-e.clientWidth;e.style.overflowY="hidden",e.style.paddingRight=t+"px",this.container.classList.add("sliding")}},this.onTransitionEnd=()=>{const e=this.scrollable.container;e.style.overflowY="",e.style.paddingRight="0",this.container.classList.remove("sliding")},this.container=document.createElement("div"),this.container.classList.add("search-super");const n=document.createElement("div");n.classList.add("search-super-tabs-scrollable","menu-horizontal-scrollable");const a=new E.ScrollableX(n),r=this.nav=document.createElement("nav");r.classList.add("search-super-tabs","menu-horizontal"),this.tabsMenu=document.createElement("ul"),r.append(this.tabsMenu),a.container.append(r);for(const t of e){const e=document.createElement("li"),s=document.createElement("span"),i=document.createElement("i");s.innerText=t.name,s.append(i),e.append(s),L.ripple(e),this.tabsMenu.append(e)}this.tabsContainer=document.createElement("div"),this.tabsContainer.classList.add("search-super-tabs-container","tabs-container");for(const t of e){const e=document.createElement("div");e.classList.add("search-super-container-"+t.name.toLowerCase());const s=document.createElement("div");s.classList.add("search-super-content-"+t.name.toLowerCase()),e.append(s),this.tabsContainer.append(e),this.tabs[t.inputFilter]=s}this.container.append(n,this.tabsContainer),this.searchGroupMedia=new _.SearchGroup("","messages",!0),this.scrollable.onScrolledBottom=()=>{this.tabSelected&&this.tabSelected.childElementCount&&this.load(!0)},this.selectTab=w.horizontalMenu(this.tabsMenu,this.tabsContainer,(e,t)=>{this.prevTabId!==e&&(-1!==this.prevTabId&&this.onTransitionStart(),this.type=this.types[e].inputFilter,this.tabSelected=t.firstElementChild,-1!==this.prevTabId&&r.offsetTop&&(this.scrollable.scrollTop-=r.offsetTop),-1===this.prevTabId||this.tabSelected.childElementCount||this.load(!0),this.prevTabId=e)},()=>{this.scrollable.onScroll(),this.onTransitionEnd()}),this.tabs.inputMessagesFilterPhotoVideo.addEventListener("click",e=>{const t=o.findUpClassName(e.target,"grid-item"),s=+t.dataset.mid;if(!s)return void this.log.warn("no messageId by click on target:",t);const i=+t.dataset.peerId,n=Array.from(this.tabs.inputMessagesFilterPhotoVideo.querySelectorAll(".grid-item")).map(e=>({element:e,mid:+e.dataset.mid,peerId:+e.dataset.peerId})),a=n.findIndex(e=>e.mid===s&&e.peerId===i),r=f.default.getMessageByPeer(i,s);(new M.default).setSearchContext(this.copySearchContext(this.type)).openMedia(r,t,0,!1,n.slice(0,a),n.slice(a+1))}),this.type=this.types[0].inputFilter}filterMessagesByType(e,t){if("inputMessagesFilterEmpty"===t)return e;"inputMessagesFilterUrl"!==t&&(e=e.filter(e=>!!e.media));let s=[];switch(t){case"inputMessagesFilterPhotoVideo":for(let t of e){let e=t.media.photo||t.media.document||t.media.webpage&&t.media.webpage.document;e&&("document"===e._&&"video"!==e.type||s.push(t))}break;case"inputMessagesFilterDocument":for(let t of e)t.media.document&&!["voice","audio","gif","sticker","round"].includes(t.media.document.type)&&s.push(t);break;case"inputMessagesFilterUrl":for(let t of e)s.push(t);break;case"inputMessagesFilterMusic":for(let t of e)t.media.document&&"audio"===t.media.document.type&&s.push(t);break;case"inputMessagesFilterVoice":for(let t of e)t.media.document&&"voice"===t.media.document.type&&s.push(t)}return s}performSearchResult(e,t,s=!0){var n;return i(this,void 0,void 0,(function*(){const i=[],o=this.tabs[t],r=[],l=this.getMiddleware();let h;switch("inputMessagesFilterPhotoVideo"===t&&this.searchContext.query.trim()?(t="inputMessagesFilterEmpty",h=this.searchGroupMedia,o.append(h.container)):"inputMessagesFilterEmpty"===t&&(h=this.searchGroups.messages),t){case"inputMessagesFilterEmpty":for(const t of e){const{dialog:e,dom:s}=c.default.addDialogNew({dialog:t.peerId,container:h.list,drawStatus:!1,avatarSize:54});c.default.setLastMessage(e,t,s,this.searchContext.query)}h.list.childElementCount&&h.setActive();break;case"inputMessagesFilterPhotoVideo":for(const t of e){const e=t.media.photo||t.media.document||t.media.webpage&&t.media.webpage.document,s=document.createElement("div");s.classList.add("grid-item");const n="photo"===e._,a=n?u.default.getPhoto(e.id):null;let o;if(a)o=a.downloaded>0;else{const t=u.default.getDocumentCachedThumb(e.id);o=(null==t?void 0:t.downloaded)>0}if(!n){const t=document.createElement("span");t.classList.add("video-time"),s.append(t),"gif"!==e.type?t.innerText=(e.duration+"").toHHMMSS(!1):t.innerText="GIF"}const d=()=>u.default.preloadPhoto(n?e.id:e,u.default.choosePhotoSize(e,200,200)).then(()=>{if(!l())return;const t=a&&a.url||u.default.getDocumentCachedThumb(e.id).url;if(t){const e=p?()=>{g.style.opacity="",c&&window.setTimeout(()=>{c.remove()},200)}:void 0;I.renderImageFromUrl(g,t,e)}});let c;const f=e.sizes||e.thumbs,h=!o&&f&&f[0].bytes;h&&(c=new Image,c.classList.add("grid-item-media","thumbnail"),c.dataset.mid=""+t.mid,u.default.setAttachmentPreview(f[0].bytes,c,!1,!1),s.append(c));const p=!o||!h,g=new Image;if(g.dataset.mid=""+t.mid,g.classList.add("grid-item-media"),p&&(g.style.opacity="0"),s.append(g),o||h){const e=new Promise((e,t)=>{(c||g).addEventListener("load",()=>{clearTimeout(s),e()});const s=setTimeout(()=>{t()},1e3)});r.push(e)}(null==f?void 0:f.length)&&(o?d():this.lazyLoadQueue.push({div:s,load:d})),i.push({element:s,message:t})}break;case"inputMessagesFilterVoice":case"inputMessagesFilterMusic":case"inputMessagesFilterDocument":for(const s of e){const e=C.wrapDocument({message:s,withTime:!this.asChatList,fontWeight:400,voiceAsMusic:!0,showSender:this.asChatList,searchContext:this.copySearchContext(t)});"audio"===s.media.document.type&&e.classList.add("audio-48"),i.push({element:e,message:s})}break;case"inputMessagesFilterUrl":for(let t of e){let e;if((null===(n=t.media)||void 0===n?void 0:n.webpage)&&"webPageEmpty"!=t.media.webpage._)e=t.media.webpage;else{const s=t.totalEntities?t.totalEntities.find(e=>"messageEntityUrl"==e._||"messageEntityTextUrl"==e._):null;let i,n,a;if(s)a=t.message.slice(s.offset,s.offset+s.length);else{const e=b.default.matchUrl(t.message);if(!e)continue;i=e[0]}i="messageEntityTextUrl"==(null==s?void 0:s._)?s.url:i||a,n=i;const o=t.message==i;i.match(/^(ftp|http|https):\/\//)||(n="https://"+i,i=i.includes("@")?i:"https://"+i),n=new URL(n).hostname,e={url:i,display_url:n},o||(e.description=t.message,e.rDescription=b.default.wrapRichText(d.limitSymbols(t.message,150,180)))}let s=document.createElement("div"),o=document.createElement("div");if(o.classList.add("preview"),o.innerHTML=b.default.getAbbreviation(e.title||e.display_url||e.description||e.url,!0),o.classList.add("empty"),e.photo){let t=()=>u.default.preloadPhoto(e.photo.id,u.default.choosePhotoSize(e.photo,60,60)).then(()=>{l()&&(o.classList.remove("empty"),o.innerText="",I.renderImageFromUrl(o,e.photo.url))});this.lazyLoadQueue.push({div:o,load:t})}let r=e.rTitle||"",c=e.rDescription||"",h=b.default.wrapRichText(e.url||"");r||(r=b.default.wrapPlainText(e.display_url.split("/",1)[0]));let p=this.asChatList?`<div class="subtitle sender">${f.default.getSenderToPeerText(t)}</div>`:"",g="";this.asChatList&&(g=`<div class="sent-time">${a.formatDateAccordingToToday(new Date(1e3*t.date))}</div>`),s.append(o),s.insertAdjacentHTML("beforeend",`\n          <div class="title">${r}${g}</div>\n          <div class="subtitle">${c}</div>\n          <div class="url">${h}</div>\n          ${p}\n          `),s.innerText.trim().length&&i.push({element:s,message:t})}}if(this.loadMutex&&r.push(this.loadMutex),!r.length||(yield Promise.all(r),l())){if(i.length){const e=s?"append":"prepend";i.forEach(s=>{const{element:i,message:n}=s,a=this.getMonthContainerByTimestamp(n.date,t);i.classList.add("search-super-item"),i.dataset.mid=""+n.mid,i.dataset.peerId=""+n.peerId,a.items[e](i)})}this.afterPerforming("inputMessagesFilterEmpty"===t?1:e.length,o)}}))}afterPerforming(e,t){if(t){const s=t.parentElement;if(Array.from(s.children).slice(1).forEach(e=>{e.remove()}),!e&&!t.childElementCount){const e=document.createElement("div");e.innerText="Nothing interesting here yet...",e.classList.add("position-center","text-center","content-empty","no-select"),s.append(e)}}}loadChats(){const e=new Set,t=this.getMiddleware();for(let e in this.searchGroups){const t=this.searchGroups[e];this.tabs.inputMessagesFilterEmpty.append(t.container),t.clear()}const s=this.searchContext.query;if(s){const i=(t,i,n=!1)=>{t.forEach(t=>{if(e.has(t))return;e.add(t);const a=h.default.getPeer(t),{dom:o}=c.default.addDialogNew({dialog:t,container:i.list,drawStatus:!1,avatarSize:48,autonomous:i.autonomous});if(n&&(a.participants_count||a.participants)){const e=new RegExp(`(${d.escapeRegExp(s)}|${d.escapeRegExp(y.default.cleanSearchText(s))})`,"gi");o.titleSpan.innerHTML=o.titleSpan.innerHTML.replace(e,"<i>$1</i>"),o.lastMessageSpan.innerText=l.default.getChatMembersString(-t)}else if(t===v.default.myId)o.lastMessageSpan.innerHTML="chat with yourself";else{let e=h.default.getPeerUsername(t);if(e)e="@"+e;else{const s=g.default.getUser(t);s&&s.phone&&(e="+"+I.formatPhoneNumber(s.phone).formatted)}o.lastMessageSpan.innerHTML="<i>"+e+"</i>"}}),i.toggle()},n=e=>{if(t())return e};return Promise.all([g.default.getContacts(s,!0).then(n).then(e=>{e&&i(e,this.searchGroups.contacts,!0)}),g.default.searchContacts(s,20).then(n).then(e=>{if(e&&(i(e.my_results,this.searchGroups.contacts,!0),i(e.results,this.searchGroups.globalContacts),this.searchGroups.globalContacts.nameEl.lastElementChild&&this.searchGroups.globalContacts.nameEl.lastElementChild.remove(),this.searchGroups.globalContacts.container.classList.add("is-short"),this.searchGroups.globalContacts.list.childElementCount>3)){const e=document.createElement("div");e.classList.add("search-group__show-more"),e.innerText="Show more",this.searchGroups.globalContacts.nameEl.append(e),e.addEventListener("click",()=>{const t=this.searchGroups.globalContacts.container.classList.toggle("is-short");e.innerText=t?"Show more":"Show less"})}}),f.default.getConversations(s,0,20,0).then(n).then(e=>{e&&i(e.dialogs.map(e=>e.peerId),this.searchGroups.contacts,!0)})])}if(this.searchContext.peerId||this.searchContext.minDate)return Promise.resolve();{const e=(e=!0)=>p.default.getState().then(s=>{t()&&(this.searchGroups.recent.list.innerHTML="",s.recentSearch.slice(0,20).forEach(e=>{let{dialog:t,dom:s}=c.default.addDialogNew({dialog:e,container:this.searchGroups.recent.list,drawStatus:!1,meAsSaved:!0,avatarSize:48,autonomous:!1});s.lastMessageSpan.innerText=e>0?g.default.getUserStatusString(e):l.default.getChatMembersString(e)}),s.recentSearch.length?e&&this.searchGroups.recent.setActive():this.searchGroups.recent.clear())});return Promise.all([g.default.getTopPeers().then(e=>{t()&&(e.length&&e.forEach(e=>{c.default.addDialogNew({dialog:e,container:this.searchGroups.people.list,drawStatus:!1,onlyFirstName:!0,avatarSize:54,autonomous:!1})}),this.searchGroups.people.setActive())}),e()])}}load(e=!1,t=!1){var s;const i=this.searchContext.peerId;this.log("load",e,i,this.loadPromises);let n=e?[this.type]:this.types.filter(e=>e.inputFilter!==this.type).map(e=>e.inputFilter);if(n=n.filter(e=>!this.loaded[e]||this.historyStorage[e]&&this.usedFromHistory[e]<this.historyStorage[e].length),!n.length)return;const a=t?50:Math.round(3*(u.default.windowH/130|0)*1.25),o=null!==(s=this.historyStorage)&&void 0!==s?s:this.historyStorage={},r=this.getMiddleware(),d=n.map(e=>{var s,n;if(this.loadPromises[e])return this.loadPromises[e];const d=null!==(s=o[e])&&void 0!==s?s:o[e]=[];if(!("inputMessagesFilterEmpty"!==e||d.length||(this.loadedChats||(this.loadChats(),this.loadedChats=!0),this.searchContext.query.trim()||this.searchContext.peerId||this.searchContext.minDate)))return this.loaded[e]=!0,Promise.resolve();const l="load ["+e+"]: ";if(d.length&&this.usedFromHistory[e]<d.length&&!t){let t=[],s=Math.max(0,this.usedFromHistory[e]),i=0;do{let n=d.slice(s,s+a);s+=n.length,i+=n.length,t.push(...this.filterMessagesByType(n.map(e=>f.default.getMessageByPeer(e.peerId,e.mid)),e))}while(i<a&&s<d.length);return this.usedFromHistory[e]=s,this.performSearchResult(t,e).finally(()=>{setTimeout(()=>{this.scrollable.checkForTriggers()},0)})}let c=d.length?d[d.length-1].mid:0;return this.loadPromises[e]=f.default.getSearch({peerId:i,query:this.searchContext.query,inputFilter:{_:e},maxId:c,limit:a,nextRate:null!==(n=this.nextRates[e])&&void 0!==n?n:this.nextRates[e]=0,threadId:this.searchContext.threadId,folderId:this.searchContext.folderId,minDate:this.searchContext.minDate,maxDate:this.searchContext.maxDate}).then(s=>{if(d.push(...s.history.map(e=>({mid:e.mid,peerId:e.peerId}))),this.log(l+"search house of glass",e,s),r())return s.history.length<a&&(this.loaded[e]=!0),this.nextRates[e]=s.next_rate,t?Promise.resolve():(this.usedFromHistory[e]=d.length,this.loaded[e]||(this.loadPromises[e]||Promise.resolve()).then(()=>{setTimeout(()=>{if(r()&&this.type===e){const e=this.load(!0,!0);e&&e.then(()=>{r()&&setTimeout(()=>{this.scrollable.checkForTriggers()},0)})}},0)}),this.performSearchResult(this.filterMessagesByType(s.history,e),e))}).catch(e=>{this.log.error("load error:",e)}).finally(()=>{this.loadPromises[e]=null})});return Promise.all(d).catch(e=>{this.log.error("Load error all promises:",e)})}getMonthContainerByTimestamp(e,t){var s;const i=new Date(1e3*e);i.setHours(0,0,0),i.setDate(1);const n=i.getTime(),d=null!==(s=this.monthContainers[t])&&void 0!==s?s:this.monthContainers[t]={};if(!(n in d)){const e=a.months[i.getMonth()]+" "+i.getFullYear(),s=document.createElement("div");s.className="search-super-month";const l=document.createElement("div");l.classList.add("search-super-month-name"),l.innerText=e,s.append(l);const c=document.createElement("div");c.classList.add("search-super-month-items"),s.append(l,c);const f=r.getObjectKeysAndSort(d,"desc");let h=0;for(;h<f.length;++h){if(n>f[h])break}d[n]={container:s,items:c},o.positionElementByIndex(s,this.tabs[t],h)}return d[n]}cleanup(){this.loadPromises={},this.loaded={},this.loadedChats=!1,this.nextRates={},this.lazyLoadQueue.clear(),this.types.forEach(e=>{this.usedFromHistory[e.inputFilter]=-1}),this.cleanupObj.cleaned=!0,this.cleanupObj={cleaned:!1}}cleanupHTML(){this.urlsToRevoke.length&&(this.urlsToRevoke.forEach(e=>{URL.revokeObjectURL(e)}),this.urlsToRevoke.length=0),Object.keys(this.tabs).forEach(e=>{if(this.tabs[e].innerHTML="",!("inputMessagesFilterEmpty"===e||this.historyStorage&&this.historyStorage[e])){const t=this.tabs[e].parentElement;t.querySelector(".preloader")||I.putPreloader(t,!0);const s=t.querySelector(".content-empty");s&&s.remove()}}),this.monthContainers={},this.searchGroupMedia.clear()}getMiddleware(){const e=this.cleanupObj;return()=>!e.cleaned}copySearchContext(e){const t=r.copy(this.searchContext);return t.inputFilter=e,t.nextRate=this.nextRates[e],t}setQuery({peerId:e,query:t,threadId:s,historyStorage:i,folderId:n,minDate:a,maxDate:o}){this.searchContext={peerId:e||0,query:t||"",inputFilter:this.type,threadId:s,folderId:n,minDate:a,maxDate:o},this.historyStorage=null!=i?i:{},this.cleanup()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MiddleEllipsisElement=void 0;const i=s(26),n=new Map,a=new Set;let o;const r=()=>{cancelAnimationFrame(o),o=window.requestAnimationFrame(d)},d=()=>{a.forEach(l),a.clear()};window.addEventListener("resize",()=>{for(const[e]of n)a.add(e);r()},{capture:!0,passive:!0});const l=e=>{let t=n.get(e);const s=!t;let{text:a,textLength:o,from:r,multiplier:d,font:l,textWidth:c,elementWidth:h}=t||{};s&&(a=e.textContent,o=a.length,r=50,d=r>0&&r/100,l=(e.dataset.fontWeight||400)+' 16px Roboto, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',c=f(a,l),h=e.getBoundingClientRect().width,t={text:a,textLength:o,from:r,multiplier:d,font:l,textWidth:c,elementWidth:h},n.set(e,t));const u=e.getBoundingClientRect().width,p=s||h!==u;if(!s&&p&&(t.elementWidth=h=u),p)if(c>h){e.setAttribute("title",a);let s=a,n=h;for(;s.length>3;){let t=s.length;const a=d&&i.clamp(d*t<<0,1,t-2)||Math.max(t+r-1,1),o=s.substr(0,a).replace(/\s*$/,""),c=s.substr(a+1).replace(/^\s*/,"");if(s=o+c,n=f(s+"…",l),n<h){e.textContent=o+"…"+c;break}}t.elementWidth=e.getBoundingClientRect().width}else e.removeAttribute("title")};let c;function f(e,t){if(!c){const e=document.createElement("canvas");c=e.getContext("2d"),c.font=t}return c.measureText(e).width}class h extends HTMLElement{constructor(){super()}connectedCallback(){n.set(this,null),a.add(this),r()}disconnectedCallback(){n.delete(this)}}t.MiddleEllipsisElement=h,customElements.define("middle-ellipsis-element",h)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.wrapReplyDivAndCaption=void 0;const r=s(33),d=a(s(15)),l=o(s(20)),c=s(3),f=o(s(74)),h=s(4),u=s(24);function p(e){var t;let{title:s,titleEl:i,subtitle:n,subtitleEl:a,mediaEl:o,message:f}=e;void 0!==s&&(r.limitSymbols(s,140),s=s?c.RichTextProcessor.wrapEmojiText(s):"",i.innerHTML=s),n=r.limitSymbols(n,140);const p=f&&f.media;let g=!1;if(p&&o){if(n=f.rReply,p.photo||p.document&&-1!==["video","sticker","gif"].indexOf(p.document.type)){const e=32;if("sticker"==(null===(t=p.document)||void 0===t?void 0:t.type))o.style.backgroundImage&&(o.style.backgroundImage=""),g=!0,u.wrapSticker({doc:p.document,div:o,lazyLoadQueue:d.default.chat.bubbles.lazyLoadQueue,group:d.CHAT_ANIMATION_GROUP,width:e,height:e});else{o.firstElementChild&&(o.innerHTML="");const t=p.photo||p.document;if(!l.default.getCacheContext(t).downloaded){const e=t.sizes||t.thumbs;e&&e[0].bytes&&(g=!0,h.renderImageFromUrl(o,l.default.getPreviewURLFromThumb(e[0])))}const s=l.default.choosePhotoSize(t,e,e);"photoSizeEmpty"!=s._&&(g=!0,l.default.preloadPhoto(t,s).then(()=>{h.renderImageFromUrl(o,"photo"==t._?t.url:l.default.getDocumentCachedThumb(t.id).url)}))}}}else n=n?c.RichTextProcessor.wrapEmojiText(n):"";return a.innerHTML=n,g}t.wrapReplyDivAndCaption=p;class g extends f.default{constructor(e){super(e,(e,t="",s)=>{this.mediaEl||(this.mediaEl=document.createElement("div"),this.mediaEl.classList.add(this.className+"-media"));const i=p({title:e,titleEl:this.title,subtitle:t,subtitleEl:this.subtitle,mediaEl:this.mediaEl,message:s});this.container.classList.toggle("is-media",i),i?this.content.prepend(this.mediaEl):this.mediaEl.remove()}),this.className=e}}t.default=g},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.roundPercents=void 0;const n=i(s(9)),a=s(11),o=i(s(15)),r=i(s(58)),d=i(s(57)),l=s(3),c=i(s(1)),f=s(0),h=s(17),u=i(s(29));let p=0;t.roundPercents=e=>{const t=e.reduce((e,t)=>e+Math.round(t),0);if(t>100){const s=t-100,i=e.length;for(let t=0;t<s;++t){let t=-1,s=1;for(let n=0;n<i;++n){let i=e[n]%1;i>=.5&&i<s&&(s=i,t=n)}if(-1==t)return;e[t]-=s}}else if(t<100){const s=100-t,i=e.length;for(let t=0;t<s;++t){let t=-1,s=0;for(let n=0;n<i;++n){let i=e[n]%1;i<.5&&i>s&&(s=i,t=n)}if(-1==t)return;e[t]+=1-s}}},c.default.on("poll_update",e=>{const{poll:t,results:s}=e.detail,i=document.querySelector(`poll-element[poll-id="${t.id}"]`);i&&(i.isClosed=!!t.pFlags.closed,i.performResults(s,t.chosenIndexes))}),c.default.on("peer_changed",()=>{m&&g(m,b,v)});const g=(e,t,s)=>{e.classList.remove("active"),clearTimeout(s),setTimeout(()=>{t(),e.remove(),m==e&&b==t&&v==s&&(m=b=null,v=0)},200)};let m,b,v;class y extends HTMLElement{constructor(){super(),this.maxOffset=-46.5,this.isClosed=!1,this.isQuiz=!1,this.isRetracted=!1,this.isPublic=!1,this.isMultiple=!1,this.chosenIndexes=[],this.chosingIndexes=[],this.sentVote=!1}render(){p||(p=document.getElementById("poll-line").getTotalLength());const e=this.message.media.poll.id,{poll:t,results:s}=r.default.getPoll(e);this.message.pFlags.is_scheduled&&this.classList.add("disable-hover");let i="";if(t.pFlags)if(this.isPublic=!!t.pFlags.public_voters,this.isQuiz=!!t.pFlags.quiz,this.isClosed=!!t.pFlags.closed,this.isMultiple=!!t.pFlags.multiple_choice,this.isClosed)i="Final results",this.classList.add("is-closed");else{let e=this.isQuiz?"Quiz":"Poll";i=(this.isPublic?"":"Anonymous ")+e}const a=this.isMultiple?'<span class="poll-answer-selected tgico-check"></span>':"",o=t.answers.map((e,t)=>`\n        <div class="poll-answer" data-index="${t}">\n          <div class="circle-hover">\n            <div class="animation-ring"></div>\n            <svg class="progress-ring">\n              <circle class="progress-ring__circle" cx="13" cy="13" r="9"></circle>\n            </svg>\n            ${a}\n          </div>\n          <div class="poll-answer-percents"></div>\n          <div class="poll-answer-text">${l.RichTextProcessor.wrapEmojiText(e.text)}</div>\n          <svg version="1.1" class="poll-line" style="display: none;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 ${n.default.active.regular.width} 35" xml:space="preserve">\n            <use href="#poll-line"></use>\n          </svg>\n          <span class="poll-answer-selected tgico"></span>\n        </div>\n      `).join("");if(this.innerHTML=`\n      <div class="poll-title">${t.rQuestion}</div>\n      <div class="poll-desc">\n        <div class="poll-type">${i}</div>\n        <div class="poll-avatars"></div>\n      </div>\n      ${o}\n      <div class="poll-footer">\n        <div class="poll-footer-button poll-view-results hide">View Results</div>\n        <div class="poll-votes-count"></div>\n      </div>\n    `,this.descDiv=this.firstElementChild.nextElementSibling,this.typeDiv=this.descDiv.firstElementChild,this.avatarsDiv=this.descDiv.lastElementChild,this.isQuiz&&(this.classList.add("is-quiz"),t.close_period&&t.close_date)){const e=document.createElement("div");e.classList.add("poll-time"),this.descDiv.append(e);const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.classList.add("poll-quiz-timer"),this.quizTimer=s;const i=2,n=7,a=2*Math.PI*n,o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.classList.add("poll-quiz-timer-circle"),o.setAttributeNS(null,"cx","16"),o.setAttributeNS(null,"cy","16"),o.setAttributeNS(null,"r",""+n),o.setAttributeNS(null,"stroke-width",""+i),s.append(o),this.descDiv.append(s);const l=1e3*t.close_period,c=1e3*(t.close_date-d.default.serverTimeOffset);this.quizInterval=window.setInterval(()=>{const t=Date.now(),s=(c-t)/l,i=(c-t)/1e3+1|0;e.innerHTML=String(i).toHHMMSS(),i<=5&&(e.style.color="#ee545c",o.style.stroke="#ee545c"),o.style.strokeDashoffset=a+s*a,o.style.strokeDasharray=`${a} ${a}`,t>=c&&(clearInterval(this.quizInterval),e.innerHTML="",o.style.strokeDashoffset=a,this.quizInterval=0,setTimeout(()=>{r.default.getResults(this.message)},3e3))},1e3)}this.answerDivs=Array.from(this.querySelectorAll(".poll-answer")),this.svgLines=Array.from(this.querySelectorAll(".poll-line")),this.numberDivs=Array.from(this.querySelectorAll(".poll-answer-percents"));const c=this.lastElementChild;this.viewResults=c.firstElementChild,this.votersCountDiv=c.lastElementChild,this.viewResults.addEventListener("click",e=>{f.cancelEvent(e),u.default.pollResultsTab.init(this.message)}),h.ripple(this.viewResults),this.isMultiple&&(this.sendVoteBtn=document.createElement("div"),this.sendVoteBtn.classList.add("poll-footer-button","poll-send-vote"),this.sendVoteBtn.innerText="Vote",h.ripple(this.sendVoteBtn),t.chosenIndexes.length||this.votersCountDiv.classList.add("hide"),f.attachClickEvent(this.sendVoteBtn,e=>{f.cancelEvent(e),this.chosingIndexes.length&&this.sendVotes(this.chosingIndexes).then(()=>{this.chosingIndexes.length=0,this.answerDivs.forEach(e=>{e.classList.remove("is-chosing")})})}),c.append(this.sendVoteBtn));const g=this.getBoundingClientRect().width;this.maxLength=g+9+this.maxOffset+-13.7,t.chosenIndexes.length||this.isClosed?this.performResults(s,t.chosenIndexes):this.isClosed||(this.setVotersCount(s),f.attachClickEvent(this,this.clickHandler))}connectedCallback(){this.render()}initQuizHint(e){if(e.solution&&e.solution_entities){const t=document.createElement("div");if(t.classList.add("tgico-tip","poll-hint"),this.descDiv.append(t),f.attachClickEvent(t,s=>{f.cancelEvent(s),t.classList.add("active"),((e,t,s)=>{m&&g(m,b,v);const i=document.createElement("div");i.classList.add("quiz-hint");const n=document.createElement("div");n.classList.add("container","tgico");const r=document.createElement("div");r.classList.add("text"),n.append(r),i.append(n),r.innerHTML=l.RichTextProcessor.wrapRichText(e,{entities:t}),o.default.chat.bubbles.bubblesContainer.append(i),i.offsetLeft,i.classList.add("active"),m=i,b=s,v=window.setTimeout(()=>{g(i,s,v)},a.isTouchSupported?5e3:7e3)})(e.solution,e.solution_entities,()=>{t.classList.remove("active")})}),this.sentVote){const s=e.results.find(e=>e.pFlags.correct);s&&!s.pFlags.chosen&&t.click()}}}clickHandler(e){const t=f.findUpClassName(e.target,"poll-answer");if(!t)return;f.cancelEvent(e);const s=+t.dataset.index;if(this.isMultiple){t.classList.toggle("is-chosing");const e=this.chosingIndexes.indexOf(s);-1!==e?this.chosingIndexes.splice(e,1):this.chosingIndexes.push(s)}else this.sendVotes([s])}sendVotes(e){if(this.sendVotePromise)return this.sendVotePromise;const t=this.answerDivs.filter((t,s)=>e.includes(s));return t.forEach(e=>{e.classList.add("is-voting")}),this.classList.add("disable-hover"),this.sentVote=!0,this.sendVotePromise=r.default.sendVote(this.message,e).then(()=>{t.forEach(e=>{e.classList.remove("is-voting")}),this.classList.remove("disable-hover")}).catch(()=>{this.sentVote=!1}).finally(()=>{this.sendVotePromise=null})}performResults(e,t){var s,i;if(this.isQuiz&&((null===(s=e.results)||void 0===s?void 0:s.length)||this.isClosed)){this.answerDivs.forEach((t,s)=>{t.classList.toggle("is-correct",!!e.results[s].pFlags.correct)}),this.initQuizHint&&(this.initQuizHint(e),this.initQuizHint=null),this.quizInterval&&(clearInterval(this.quizInterval),this.quizInterval=0),(null===(i=this.quizTimer)||void 0===i?void 0:i.parentElement)&&this.quizTimer.remove();const t=this.descDiv.querySelector(".poll-time");t&&t.remove()}if(this.isClosed&&(this.classList.add("is-closed"),this.typeDiv.innerText="Final results"),(this.chosenIndexes.length!=t.length||this.isClosed)&&(this.isRetracted=this.chosenIndexes.length&&!t.length,this.chosenIndexes=t.slice(),this.isRetracted?f.attachClickEvent(this,this.clickHandler):f.detachClickEvent(this,this.clickHandler)),this.chosenIndexes.length||this.isRetracted||this.isClosed){const t=e.results.map(t=>e.total_voters?t.voters/e.total_voters*100:0);this.setResults(this.isRetracted?this.percents:t,this.chosenIndexes),this.percents=t,this.isRetracted=!1}if(this.setVotersCount(e),this.isPublic){this.isMultiple||(this.viewResults.classList.toggle("hide",!e.total_voters||!this.chosenIndexes.length),this.votersCountDiv.classList.toggle("hide",!!this.chosenIndexes.length));let t="";e.recent_voters.forEach((e,s)=>{t+=`<avatar-element class="avatar-18" dialog="0" peer="${e}" ${0==s?"":`style="transform: translateX(-${3*s}px);"`}></avatar-element>`}),this.avatarsDiv.innerHTML=t}this.isMultiple&&(this.sendVoteBtn.classList.toggle("hide",!!this.chosenIndexes.length),this.chosenIndexes.length?this.isPublic?(this.viewResults.classList.toggle("hide",!e.total_voters||!this.chosenIndexes.length),this.votersCountDiv.classList.toggle("hide",!!this.chosenIndexes.length)):this.votersCountDiv.classList.toggle("hide",!this.chosenIndexes.length):(this.votersCountDiv.classList.add("hide"),this.viewResults.classList.add("hide")))}setResults(e,s){this.svgLines.forEach(e=>e.style.display=""),this.answerDivs.forEach((e,t)=>{e.classList.toggle("is-chosen",s.includes(t))});const i=Math.max(...e);if(this.maxLengths=e.map(e=>e/i*this.maxLength),this.isRetracted?this.svgLines.forEach((e,t)=>{this.setLineProgress(t,-1)}):this.svgLines.forEach((e,t)=>{e.getBoundingClientRect(),this.setLineProgress(t,1)}),e=e.slice(),t.roundPercents(e),this.isRetracted)for(let t=9,s=0;t>=0;--t,++s)setTimeout(()=>{e.forEach((e,s)=>{const i=Math.round(e/10*t);this.numberDivs[s].innerText=i+"%"})},34*s);else for(let t=0;t<10;++t)setTimeout(()=>{e.forEach((e,s)=>{const i=Math.round(e/10*(t+1));this.numberDivs[s].innerText=i+"%"})},34*t);this.isRetracted?(this.classList.add("is-retracting"),this.classList.remove("is-voted"),setTimeout(()=>{this.classList.remove("is-retracting"),this.svgLines.forEach(e=>e.style.display="none")},340)):this.classList.add("is-voted")}setVotersCount(e){const t=e.total_voters||0,s=this.isQuiz?t>1||!t?"answers":"answer":t>1||!t?"votes":"vote";this.votersCountDiv.innerText=""+(e.total_voters?e.total_voters+" "+s:"No "+s)}setLineProgress(e,t){const s=this.svgLines[e];-1==t?(s.style.strokeDasharray="",s.style.strokeDashoffset=""):(s.style.strokeDasharray=t*this.maxLengths[e]+", 485.9",s.style.strokeDashoffset=""+t*this.maxOffset)}}t.default=y,customElements.define("poll-element",y)},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(37)),a=i(s(51)),o=s(3),r=i(s(6)),d=s(24),l=i(s(25)),c=s(4),f=i(s(22)),h=s(0),u=i(s(15)),p=i(s(9));class g extends n.default{constructor(e){super("popup-stickers",null,{closable:!0,overlayClosable:!0,body:!0}),this.stickerSetInput=e,this.onFooterClick=()=>{this.stickersFooter.setAttribute("disabled","true"),a.default.toggleStickerSet(this.set).then(()=>{this.btnClose.click()}).catch(()=>{this.stickersFooter.removeAttribute("disabled")})},this.onStickersClick=e=>{const t=h.findUpClassName(e.target,"sticker-set-sticker");if(!t)return;const s=t.dataset.docId;u.default.chat.input.sendMessageWithDocument(s)?this.btnClose.click():console.warn("got no doc by id:",s)},this.h6=document.createElement("h6"),this.h6.innerText="Loading...",this.header.append(this.h6),this.onClose=()=>{f.default.setOnlyOnePlayableGroup(""),f.default.checkAnimations(!1),this.stickersFooter.removeEventListener("click",this.onFooterClick),this.stickersDiv.removeEventListener("click",this.onStickersClick)},this.onCloseAfterTimeout=()=>{f.default.checkAnimations(void 0,"STICKERS-POPUP")};const t=document.createElement("div");t.classList.add("sticker-set"),this.stickersDiv=document.createElement("div"),this.stickersDiv.classList.add("sticker-set-stickers"),c.putPreloader(this.stickersDiv),this.stickersFooter=document.createElement("div"),this.stickersFooter.classList.add("sticker-set-footer"),t.append(this.stickersDiv),this.stickersFooter.innerText="Loading...",this.body.append(t);new r.default(this.body);this.body.append(this.stickersFooter),this.loadStickerSet()}loadStickerSet(){return a.default.getStickerSet(this.stickerSetInput).then(e=>{this.set=e.set,f.default.checkAnimations(!0),f.default.setOnlyOnePlayableGroup("STICKERS-POPUP"),this.h6.innerHTML=o.RichTextProcessor.wrapEmojiText(e.set.title),e.set.installed_date?this.stickersFooter.classList.remove("add"):this.stickersFooter.classList.add("add"),this.stickersFooter.innerHTML=e.set.hasOwnProperty("installed_date")?'<div style="cursor: pointer; margin: 0 auto; width: 150px;">Remove stickers</div>':`<button class="btn-primary">ADD ${e.set.count} STICKERS</button>`,this.stickersFooter.addEventListener("click",this.onFooterClick),e.documents.length&&this.stickersDiv.addEventListener("click",this.onStickersClick);const t=new l.default;this.stickersDiv.innerHTML="";for(let s of e.documents){if("documentEmpty"==s._)continue;const e=document.createElement("div");e.classList.add("sticker-set-sticker");const i=p.default.active.esgSticker.width;d.wrapSticker({doc:s,div:e,lazyLoadQueue:t,group:"STICKERS-POPUP",play:!0,loop:!0,width:i,height:i}),this.stickersDiv.append(e)}})}}t.default=g},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AppInlineBotsManager=void 0;const n=s(36),a=i(s(10)),o=i(s(5)),r=s(3),d=i(s(21)),l=i(s(20)),c=i(s(8));class f{constructor(){this.inlineResults={}}getInlineResults(e,t,s="",i="",n){return o.default.invokeApi("messages.getInlineBotResults",{bot:c.default.getUserInput(t),peer:a.default.getInputPeerById(e),query:s,geo_point:n&&{_:"inputGeoPoint",lat:n.lat,long:n.long}||void 0,offset:i},{stopTime:-1,noErrorBox:!0}).then(e=>{const t=e.query_id;return e.results.forEach(e=>{const s=t+"_"+e.id;"botInlineMediaResult"==e._&&(e.document&&(e.document=d.default.saveDoc(e.document)),e.photo&&(e.photo=l.default.savePhoto(e.photo))),this.inlineResults[s]=e}),e})}callbackButtonClick(e,t,s){return o.default.invokeApi("messages.getBotCallbackAnswer",{peer:a.default.getInputPeerById(e),msg_id:t,data:s.data},{timeout:1,stopTime:-1,noErrorBox:!0}).then(e=>{"string"==typeof e.message&&e.message.length&&n.toast(r.RichTextProcessor.wrapRichText(e.message,{noLinks:!0,noLinebreaks:!0}))})}}t.AppInlineBotsManager=f;const h=new f;t.default=h},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(0),o=n(s(21)),r=s(24),d=s(4),l=s(25),c=n(s(22)),f=s(30);t.default=class{constructor(e,t,s){this.element=e,this.group=t,this.scrollable=s,this.scrollPromise=Promise.resolve(),this.processVisibleDiv=e=>{if(e.querySelector("video"))return;this.lazyLoadQueue.push({div:e,load:()=>{const t=e.dataset.docId,s=o.default.getDoc(t);return this.scrollPromise.then(()=>{const t=r.wrapVideo({doc:s,container:e,lazyLoadQueue:null,group:this.group,noInfo:!0});return t.finally(()=>{const t=e.querySelector("video");e.style.opacity="";const s=e.querySelector("img");s&&s.classList.add("hide"),t&&!t.parentElement&&setTimeout(()=>{t.src="",t.load();c.default.getAnimations(t).forEach(e=>{c.default.checkAnimation(e,!0,!0)})},0),this.lazyLoadQueue.intersector.isVisible(e)||this.processInvisibleDiv(e)}),t})}})},this.processInvisibleDiv=e=>i(this,void 0,void 0,(function*(){return this.scrollPromise.then(()=>i(this,void 0,void 0,(function*(){if(this.lazyLoadQueue.intersector.isVisible(e))return;const t=e.querySelector("video"),s=e.querySelector("img");if(s&&(s&&s.classList.remove("hide"),yield new Promise(e=>{window.requestAnimationFrame(()=>window.requestAnimationFrame(e))})),!this.lazyLoadQueue.intersector.isVisible(e)&&t){t.remove(),t.src="",t.load();c.default.getAnimations(t).forEach(e=>{c.default.checkAnimation(e,!0,!0)})}})))})),this.lazyLoadQueue=new l.LazyLoadQueueRepeat2(void 0,(e,t)=>{t?this.processVisibleDiv(e):this.processInvisibleDiv(e)});let n=0;s.container.addEventListener("scroll",()=>{n?clearTimeout(n):this.scrollPromise=f.deferredPromise(),n=window.setTimeout(()=>{n=0,this.scrollPromise.resolve()},150)})}add(e){var t;let s=e.w,i=e.h;i<100&&(s*=100/i,i=100);const n=Math.min(300,400,s),{w:r,h:l}=a.calcImageInBox(s,i,n,100),c=document.createElement("div");c.classList.add("gif","fade-in-transition"),c.style.width=r+"px",c.style.opacity="0",c.dataset.docId=e.id,this.element.append(c),this.lazyLoadQueue.observe(c);const f=o.default.getThumb(e,!1);let h;!!f&&(h=new Image,f.thumb.url||f.promise.then(()=>{h.src=f.thumb.url}));const u=()=>{h&&(c.append(h),c.style.opacity="")};(null===(t=null==f?void 0:f.thumb)||void 0===t?void 0:t.url)?d.renderImageFromUrl(h,f.thumb.url,u):u()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.container=e,this.handler=t,this.observeHeaders(),this.observeElements()}observeHeaders(){this.headersObserver=new IntersectionObserver(e=>{for(const t of e){const e=t.boundingClientRect,s=t.target.parentElement,i=t.rootBounds;e.bottom<i.top&&this.handler(!0,s),e.bottom>=i.top&&e.bottom<i.bottom&&this.handler(!1,s)}},{threshold:0,root:this.container})}observeElements(){this.elementsObserver=new IntersectionObserver(e=>{let t=e.filter(e=>e.boundingClientRect.top<0).sort((e,t)=>e.boundingClientRect.top-t.boundingClientRect.top)[0];if(!t)return;let s=t.isIntersecting?t.target:t.target.nextElementSibling;this.handler(!0,s)},{root:this.container})}addSentinel(e,t){const s=document.createElement("div");return s.classList.add("sticky_sentinel",t),e.appendChild(s)}observeStickyHeaderChanges(e){const t=this.addSentinel(e,"sticky_sentinel--top");this.headersObserver.observe(t),this.elementsObserver.observe(e)}disconnect(){this.headersObserver.disconnect(),this.elementsObserver.disconnect()}unobserve(e,t){this.elementsObserver.unobserve(e),this.headersObserver.unobserve(t)}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(19)),a=i(s(7)),o=i(s(10)),r=i(s(1)),d=i(s(62));t.default=class{constructor(e,t,s,i){const l=o.default.getPeerTitle(e,!1,!0);t=t.slice();const c=n=>{i&&i(),"scheduled"===s?a.default.deleteScheduledMessages(e,t):a.default.deleteMessages(e,t,n)};let f,h,u;if(f=`Delete ${1==t.length?"":t.length+" "}Message${1==t.length?"":"s"}?`,h=`Are you sure you want to delete ${1==t.length?"this message":"these messages"}?`,e==r.default.myId||"scheduled"===s)u=[{text:"DELETE",isDanger:!0,callback:()=>c()}];else if(u=[{text:"DELETE JUST FOR ME",isDanger:!0,callback:()=>c()}],e>0)u.push({text:"DELETE FOR ME AND "+l,isDanger:!0,callback:()=>c(!0)});else{const s=n.default.getChat(-e),i=n.default.hasRights(-e,"deleteRevoke");if("chat"==s._){const s=i?t.slice():t.filter(t=>a.default.getMessageByPeer(e,t).fromId==r.default.myId);if(s.length)if(s.length==t.length)u.push({text:"DELETE FOR ALL",isDanger:!0,callback:()=>c(!0)});else{const e="Unsend my and delete";u.push({text:e,isDanger:!0,callback:()=>c(!0)}),h=`You can also delete the ${s.length} message${s.length>1?"s":""} you sent from the inboxes of other group members by pressing "${e}".`}}else i&&!n.default.isBroadcast(-e)||u.shift(),u.push({text:"DELETE FOR ALL",isDanger:!0,callback:()=>c(!0)})}u.push({text:"CANCEL",isCancel:!0});new d.default("popup-delete-chat",{peerId:e,title:f,description:h,buttons:u}).show()}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(7)),a=i(s(62));t.default=class{constructor(e,t,s){let i,o,r=[];i=`Send Message${t.length>1?"s":""} Now`,o=t.length>1?"Send "+t.length+" messages now?":"Send message now?";r.push({text:"SEND",callback:()=>{s&&s(),n.default.sendScheduledMessages(e,t)}}),r.push({text:"CANCEL",isCancel:!0});new a.default("popup-delete-chat",{peerId:e,title:i,description:o,buttons:r}).show()}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SuperStickerRenderer=void 0;const d=a(s(53)),l=s(56),c=r(s(9)),f=r(s(21)),h=r(s(40)),u=r(s(51)),p=r(s(31)),g=s(3),m=r(s(1)),b=r(s(22)),v=s(25),y=s(4),M=a(s(6)),_=s(24);class w{constructor(e,t){this.regularLazyLoadQueue=e,this.group=t,this.animatedDivs=new Set,this.checkAnimationContainer=(e,t)=>{b.default.getAnimations(e).forEach(e=>{t?b.default.checkAnimation(e,!1):b.default.checkAnimation(e,!0,!0)})},this.processVisibleDiv=e=>{const t=e.dataset.docId,s=f.default.getDoc(t),i=c.default.active.esgSticker.width,n=_.wrapSticker({doc:s,div:e,width:i,height:i,lazyLoadQueue:null,group:this.group,onlyThumb:!1,play:!0,loop:!0});return n.then(()=>{this.checkAnimationContainer(e,this.lazyLoadQueue.intersector.isVisible(e))}),n},this.processInvisibleDiv=e=>{const t=e.dataset.docId,s=f.default.getDoc(t);this.checkAnimationContainer(e,!1),e.innerHTML="",this.renderSticker(s,e)},this.lazyLoadQueue=new v.LazyLoadQueueRepeat(void 0,(e,t)=>{t||this.processInvisibleDiv(e)})}renderSticker(e,t){return t||((t=document.createElement("div")).classList.add("grid-item","super-sticker"),2==e.sticker&&(this.animatedDivs.add(t),this.lazyLoadQueue.observe({div:t,load:this.processVisibleDiv}))),_.wrapSticker({doc:e,div:t,lazyLoadQueue:this.regularLazyLoadQueue,group:this.group,onlyThumb:2==e.sticker}),t}}t.SuperStickerRenderer=w;t.default=class{constructor(){this.stickerSets={},this.recentStickers=[],this.mounted=!1,this.queueCategoryPush=[]}categoryPush(e,t,s,i){const n=document.createElement("div");n.classList.add("category-items","super-stickers");const a=document.createElement("div");a.classList.add("category-title"),a.innerHTML=t,e.append(a,n),this.stickyIntersector.observeStickyHeaderChanges(e),this.queueCategoryPush.push({element:e,prepend:i}),s.then(e=>{e.forEach(e=>{n.append(this.superStickerRenderer.renderSticker(e))}),this.queueCategoryPush.length&&(this.queueCategoryPush.forEach(({element:e,prepend:t})=>{t?this.recentDiv.parentElement?(this.stickersDiv.prepend(e),this.stickersDiv.prepend(this.recentDiv)):this.stickersDiv.prepend(e):this.stickersDiv.append(e)}),this.queueCategoryPush.length=0)})}renderStickerSet(e,t=!1){return o(this,void 0,void 0,(function*(){const s=document.createElement("div");s.classList.add("sticker-category");const i=document.createElement("button");i.classList.add("btn-icon","menu-horizontal-div-item"),this.stickerSets[e.id]={stickers:s,tab:i},t?this.menu.insertBefore(i,this.menu.firstElementChild.nextSibling):this.menu.append(i);const n=u.default.getStickerSet(e);this.categoryPush(s,g.RichTextProcessor.wrapEmojiText(e.title),n.then(e=>e.documents),t);const a=yield n;if(a.set.thumb){const e=u.default.getStickerSetThumbDownloadOptions(a.set),t=h.default.download(e);if(a.set.pFlags.animated)t.then(l.readBlobAsText).then(e=>{p.default.loadAnimationWorker({container:i,loop:!0,autoplay:!1,animationData:e,width:32,height:32,needUpscale:!0},d.EMOTICONSSTICKERGROUP)});else{const e=new Image;t.then(t=>{y.renderImageFromUrl(e,URL.createObjectURL(t),()=>{i.append(e)})})}}else"documentEmpty"!=a.documents[0]._&&_.wrapSticker({doc:a.documents[0],div:i,group:d.EMOTICONSSTICKERGROUP})}))}init(){this.content=document.getElementById("content-stickers"),this.recentDiv=document.createElement("div"),this.recentDiv.classList.add("sticker-category");let e=this.content.previousElementSibling;this.menu=e.firstElementChild;let t=new M.ScrollableX(e);this.stickersDiv=document.createElement("div"),this.stickersDiv.classList.add("stickers-categories"),this.content.append(this.stickersDiv),m.default.on("stickers_installed",e=>{const t=e.detail;!this.stickerSets[t.id]&&this.mounted&&this.renderStickerSet(t,!0)}),m.default.on("stickers_deleted",e=>{const t=e.detail;if(this.stickerSets[t.id]&&this.mounted){const e=this.stickerSets[t.id];e.stickers.remove(),e.tab.remove(),delete this.stickerSets[t.id]}}),this.stickersDiv.addEventListener("click",d.EmoticonsDropdown.onMediaClick),this.scroll=new M.default(this.content,"STICKERS"),this.scroll.setVirtualContainer(this.stickersDiv),this.stickyIntersector=d.EmoticonsDropdown.menuOnClick(this.menu,this.scroll,t);const s=y.putPreloader(this.content,!0);Promise.all([u.default.getRecentStickers().then(e=>{this.recentStickers=e.stickers.slice(0,20),this.stickerSets.recent={stickers:this.recentDiv,tab:this.menu.firstElementChild},s.remove(),this.categoryPush(this.recentDiv,"Recent",Promise.resolve(this.recentStickers),!0)}),u.default.getAllStickers().then(e=>{s.remove();for(let t of e.sets)this.renderStickerSet(t)})]).finally(()=>{this.mounted=!0}),this.superStickerRenderer=new w(d.EmoticonsDropdown.lazyLoadQueue,d.EMOTICONSSTICKERGROUP),d.default.addLazyLoadQueueRepeat(this.superStickerRenderer.lazyLoadQueue,this.superStickerRenderer.processInvisibleDiv),this.init=null}pushRecentSticker(e){var t;if(!(null===(t=this.recentDiv)||void 0===t?void 0:t.parentElement))return;let s=this.recentDiv.querySelector(`[data-doc-id="${e.id}"]`);s||(s=this.superStickerRenderer.renderSticker(e));const i=this.recentDiv.querySelector(".category-items");i.prepend(s),i.childElementCount>20&&Array.from(i.children).slice(20).forEach(e=>e.remove())}onClose(){}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(11),a=s(0),o=i(s(28)),r=i(s(37)),d=i(s(6)),l=s(36),c=s(24),f=i(s(77)),h=i(s(78)),u=s(83);class p extends r.default{constructor(e,t,s){if(super("popup-send-photo popup-new-media",null,{closable:!0,withConfirm:"SEND"}),this.chat=e,this.wasInputValue="",this.willAttach={sendFileDetails:[],group:!1},this.onKeyDown=e=>{e.target!==this.input&&(this.input.focus(),a.placeCaretAtEnd(this.input)),"Enter"!=e.key||n.isTouchSupported||this.btnConfirm.click()},this.attachFile=e=>{const t=this.willAttach;return new Promise(s=>{const i={};i.file=e;const n=document.createElement("div");switch(t.type){case"media":{const t=0===e.type.indexOf("video/");if(n.classList.add("popup-item-media"),t){const t=document.createElement("video"),a=document.createElement("source");a.src=i.objectURL=URL.createObjectURL(e),t.autoplay=!1,t.controls=!1,t.muted=!0,t.setAttribute("playsinline","true"),t.onloadeddata=()=>{i.width=t.videoWidth,i.height=t.videoHeight,i.duration=Math.floor(t.duration),n.append(t),u.createPosterFromVideo(t).then(e=>{i.thumbBlob=e,i.thumbURL=URL.createObjectURL(e),s(n)})},t.append(a)}else{const t=new Image;t.src=i.objectURL=URL.createObjectURL(e),t.onload=()=>{i.width=t.naturalWidth,i.height=t.naturalHeight,n.append(t),s(n)}}break}case"document":{const t=-1!==e.type.indexOf("image/"),a=-1!==e.type.indexOf("audio/");(t||a)&&(i.objectURL=URL.createObjectURL(e));const o=c.wrapDocument({message:{_:"message",pFlags:{is_outgoing:!0},mid:0,peerId:0,media:{_:"messageMediaDocument",document:{_:"document",file:e,file_name:e.name||"",size:e.size,type:t?"photo":"doc",url:i.objectURL}}}}),r=()=>{n.append(o),s(n)};if(t){const e=new Image;e.src=i.objectURL,e.onload=()=>{i.width=e.naturalWidth,i.height=e.naturalHeight,r()},e.onerror=r}else r();break}}t.sendFileDetails.push(i)})},this.willAttach.type=s,this.btnConfirm.addEventListener("click",()=>this.send()),"scheduled"!==this.chat.type){const e=new h.default({onSilentClick:()=>{this.chat.input.sendSilent=!0,this.send()},onScheduleClick:()=>{this.chat.input.scheduleSending(()=>{this.send()})},openSide:"bottom-left",onContextElement:this.btnConfirm});e.setPeerId(this.chat.peerId),this.header.append(e.sendMenu)}this.mediaContainer=document.createElement("div"),this.mediaContainer.classList.add("popup-photo");const i=new d.default(null);i.container.append(this.mediaContainer),this.inputField=new o.default({placeholder:"Add a caption...",label:"Caption",name:"photo-caption",maxLength:1024,showLengthOn:80}),this.input=this.inputField.input,this.inputField.value=this.wasInputValue=this.chat.input.messageInputField.value,this.chat.input.messageInputField.value="",this.container.append(i.container),t.length>1&&(this.groupCheckboxField=f.default("Group items","group-items"),this.container.append(this.groupCheckboxField.label,this.inputField.container),this.groupCheckboxField.input.checked=!0,this.willAttach.group=!0,this.groupCheckboxField.input.addEventListener("change",()=>{const e=this.groupCheckboxField.input.checked;this.willAttach.group=e,this.willAttach.sendFileDetails.length=0,this.attachFiles(t)})),this.container.append(this.inputField.container),this.attachFiles(t)}send(e=!1){if("scheduled"===this.chat.type&&!e)return void this.chat.input.scheduleSending(()=>{this.send(!0)});let t=this.inputField.value;if(t.length>1024)return void l.toast("Caption is too long.");this.destroy();const s=this.willAttach;s.isMedia="media"==s.type||void 0;const i=this.chat.peerId,n=this.chat.input,a=n.sendSilent,o=n.scheduleDate;if(s.sendFileDetails.length>1&&s.group)for(let e=0;e<s.sendFileDetails.length;){let d=s.sendFileDetails[e].file.type.split("/")[0];for(var r=0;r<10&&e<s.sendFileDetails.length;++e,++r){if(d!=s.sendFileDetails[e].file.type.split("/")[0])break}const l=Object.assign({},s);l.sendFileDetails=s.sendFileDetails.slice(e-r,e),this.chat.appMessagesManager.sendAlbum(i,l.sendFileDetails.map(e=>e.file),Object.assign({caption:t,replyToMsgId:n.replyToMsgId,threadId:this.chat.threadId,isMedia:s.isMedia,silent:a,scheduleDate:o},l)),t=void 0,n.replyToMsgId=this.chat.threadId}else{t&&s.sendFileDetails.length>1&&(this.chat.appMessagesManager.sendText(i,t,{replyToMsgId:n.replyToMsgId,threadId:this.chat.threadId,silent:a,scheduleDate:o}),t="");s.sendFileDetails.map(e=>{const r=this.chat.appMessagesManager.sendFile(i,e.file,Object.assign({isMedia:s.isMedia,caption:t,replyToMsgId:n.replyToMsgId,threadId:this.chat.threadId,silent:a,scheduleDate:o},e));return t="",r});n.replyToMsgId=this.chat.threadId}n.onMessageSent()}attachFiles(e){const t=this.container,s=this.willAttach;e=e.filter(e=>"media"!=s.type||["image/","video/"].find(t=>0===e.type.indexOf(t))),Promise.all(e.map(this.attachFile)).then(i=>{if(this.container.classList.remove("is-media","is-document","is-album"),this.mediaContainer.innerHTML="",e.length)if("document"==s.type)this.title.innerText="Send "+(e.length>1?e.length+" Files":"File"),t.classList.add("is-document");else{t.classList.add("is-media");let i=0,n=0;e.forEach(e=>{0===e.type.indexOf("image/")?++i:0===e.type.indexOf("video/")&&++n}),i&&n&&s.group?this.title.innerText="Send Album":i?this.title.innerText="Send "+(i>1?i+" Photos":"Photo"):n&&(this.title.innerText="Send "+(n>1?n+" Videos":"Video"))}if("media"==s.type)if(s.sendFileDetails.length>1&&s.group){t.classList.add("is-album");for(let e=0;e<i.length;e+=10){const t=document.createElement("div");t.classList.add("popup-album"),t.append(...i.slice(e,e+10)),c.prepareAlbum({container:t,items:s.sendFileDetails.slice(e,e+10).map(e=>({w:e.width,h:e.height})),maxWidth:380,minWidth:100,spacing:4}),this.mediaContainer.append(t)}}else for(let e=0;e<i.length;++e){const t=s.sendFileDetails[e],n=i[e],{w:o,h:r}=a.calcImageInBox(t.width,t.height,380,320);n.style.width=o+"px",n.style.height=r+"px",this.mediaContainer.append(n)}else this.mediaContainer.append(...i);this.element.classList.contains("active")||(document.body.addEventListener("keydown",this.onKeyDown),this.onClose=()=>{this.wasInputValue&&(this.chat.input.messageInputField.value=this.wasInputValue),document.body.removeEventListener("keydown",this.onKeyDown)},this.show())})}}t.default=p},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(9)),a=s(0),o=s(17),r=["is-pinned-message-shown","is-pinned-audio-shown"];t.default=class{constructor(e,t,s,i,n,r){this.topbar=e,this.chat=t,this.listenerSetter=s,this.className=i,this.divAndCaption=n,n.container.classList.add("pinned-container","hide"),n.title.classList.add("pinned-container-title"),n.subtitle.classList.add("pinned-container-subtitle"),n.content.classList.add("pinned-container-content"),this.close=document.createElement("button"),this.close.classList.add("pinned-container-close",`pinned-${i}-close`,"btn-icon","tgico-close"),this.wrapper=document.createElement("div"),this.wrapper.classList.add("pinned-container-wrapper"),this.wrapper.append(...Array.from(n.container.children)),o.ripple(this.wrapper),n.container.append(this.close,this.wrapper),a.attachClickEvent(this.close,e=>{a.cancelEvent(e),((r?r():null)||Promise.resolve(!0)).then(e=>{e&&this.toggle(!0)})},{listenerSetter:this.listenerSetter})}toggle(e){const t=this.divAndCaption.container.classList.contains("hide");if(void 0===e)e=!t;else if(e==t)return;this.divAndCaption.container.classList.toggle("is-floating",n.default.isMobile);const s=this.chat.bubbles.scrollable,i=n.default.isMobile?s.scrollTop:void 0;this.divAndCaption.container.classList.toggle("hide",e);const a=`is-pinned-${this.className}-shown`;this.topbar.container.classList.toggle(a,!e);const o=r.filter(e=>this.topbar.container.classList.contains(e)),d=e?0:1;void 0!==i&&o.length<=d&&(s.scrollTop=i+52*(e?-1:1)),this.topbar.setUtilsWidth()}fill(e,t,s){this.divAndCaption.container.dataset.peerId=""+s.peerId,this.divAndCaption.container.dataset.mid=""+s.mid,this.divAndCaption.fill(e,t,s),this.topbar.setUtilsWidth()}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(19)),a=i(s(7)),o=i(s(10)),r=i(s(62));t.default=class{constructor(e,t=o.default.getDialogType(e)){let s,i,d,l=o.default.getPeerTitle(e,!1,!0),c=t=>{a.default.flushHistory(e,t)},f=()=>{n.default.leave(-e)};switch(t){case"channel":s="Leave Channel?",i="Are you sure you want to leave this channel?",d=[{text:"LEAVE "+l,isDanger:!0,callback:f}];break;case"megagroup":s="Leave Group?",i="Are you sure you want to leave this group?",d=[{text:"LEAVE "+l,isDanger:!0,callback:f}];break;case"chat":s="Delete Chat?",i=`Are you sure you want to delete chat with <b>${l}</b>?`,d=[{text:"DELETE FOR ME AND "+l,isDanger:!0,callback:()=>c()},{text:"DELETE JUST FOR ME",isDanger:!0,callback:()=>c(!0)}];break;case"saved":s="Delete Saved Messages?",i="Are you sure you want to delete all your saved messages?",d=[{text:"DELETE SAVED MESSAGES",isDanger:!0,callback:()=>c()}];break;case"group":s="Delete and leave Group?",i=`Are you sure you want to delete all message history and leave <b>${l}</b>?`,d=[{text:"DELETE AND LEAVE "+l,isDanger:!0,callback:()=>f()}]}d.push({text:"CANCEL",isCancel:!0}),new r.default("popup-delete-chat",{peerId:e,title:s,description:i,buttons:d}).show()}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(s(32)),d=o(s(28)),l=s(4),c=o(s(59)),f=o(s(13)),h=o(s(5)),u=o(s(3)),p=o(s(41)),g=o(s(48));let m=null;const b=new p.default("page-signUp",!0,()=>Promise.resolve().then(()=>a(s(39))).then(e=>{const t=b.pageEl,s=t.querySelector("#canvas-avatar"),i=e.default;let n;t.querySelector(".auth-image").addEventListener("click",()=>{(new c.default).open(s,e=>{n=e})});const a=t.getElementsByClassName("fullName")[0],o=e=>{const t=p.value||"",s=v.value||"",i=t||s?(t+" "+s).trim():"Your Name";a.innerHTML!=i&&(a.innerHTML=u.default.wrapEmojiText(i))};const f=document.createElement("div");f.classList.add("input-wrapper");const p=new d.default({label:"Name",maxLength:70}),v=new d.default({label:"Last Name (optional)",maxLength:64}),y=r.default("btn-primary");y.append("START MESSAGING"),f.append(p.container,v.container,y),a.parentElement.append(f),p.input.addEventListener("input",o),v.input.addEventListener("input",o),y.addEventListener("click",(function(e){if(p.input.classList.contains("error")||v.input.classList.contains("error"))return!1;if(!p.value.length)return p.input.classList.add("error"),!1;this.setAttribute("disabled","true");const t=p.value.trim(),s=v.value.trim(),a={phone_number:m.phone_number,phone_code_hash:m.phone_code_hash,first_name:t,last_name:s};this.textContent="PLEASE WAIT...",l.putPreloader(this),h.default.invokeApi("auth.signUp",a).then(e=>{switch(e._){case"auth.authorization":h.default.setUserAuth(e.user.id),new Promise((e,t)=>{if(!n)return e();n().then(s=>{i.uploadProfilePhoto(s).then(e,t)},t)}).finally(()=>{g.default.mount()});break;default:this.innerText=e._}}).catch(e=>{this.removeAttribute("disabled"),e.type,this.innerText=e.type})}))}),e=>{m=e,f.default.pushToState("authState",{_:"authStateSignUp",authCode:e}),f.default.saveState()});t.default=b},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),s(106),s(107),s(108),document.addEventListener("DOMContentLoaded",()=>o(void 0,void 0,void 0,(function*(){Element.prototype.toggleAttribute||(Element.prototype.toggleAttribute=function(e,t){return void 0!==t&&(t=!!t),this.hasAttribute(e)?!!t||(this.removeAttribute(e),!1):!1!==t&&(this.setAttribute(e,""),!0)});const e=()=>{const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")};window.addEventListener("resize",e),e();const[t,i,n,o,r]=yield Promise.all([Promise.resolve().then(()=>a(s(109))),Promise.resolve().then(()=>a(s(11))),Promise.resolve().then(()=>a(s(12))),Promise.resolve().then(()=>a(s(1))),Promise.resolve().then(()=>a(s(13)))]);n.isApple?(n.isSafari&&document.documentElement.classList.add("is-safari"),document.documentElement.classList.add("is-mac","emoji-supported"),n.isAppleMobile&&document.documentElement.classList.add("is-ios")):n.isAndroid&&document.documentElement.classList.add("is-android"),i.isTouchSupported?document.documentElement.classList.add("is-touch"):document.documentElement.classList.add("no-touch");const d=(yield r.default.getState()).authState;if("authStateSignedIn"!=d._)switch(console.log("Will mount auth page:",d._,Date.now()/1e3),d._){case"authStateSignIn":(yield Promise.resolve().then(()=>a(s(66)))).default.mount();break;case"authStateAuthCode":(yield Promise.resolve().then(()=>a(s(88)))).default.mount(d.sentCode);break;case"authStatePassword":(yield Promise.resolve().then(()=>a(s(79)))).default.mount();break;case"authStateSignUp":(yield Promise.resolve().then(()=>a(s(104)))).default.mount(d.authCode)}else console.log("Will mount IM page:",Date.now()/1e3),(yield Promise.resolve().then(()=>a(s(48)))).default.mount();const l=(yield Promise.resolve().then(()=>a(s(17)))).ripple;Array.from(document.getElementsByClassName("rp")).forEach(e=>l(e))})))},function(e,t,s){},function(e,t,s){},function(e,t,s){},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(44),n=s(65);Object.defineProperty(Uint8Array.prototype,"hex",{get:function(){return i.bytesToHex([...this])},set:function(e){this.set(i.bytesFromHex(e))},enumerable:!0,configurable:!0}),Uint8Array.prototype.randomize=function(){for(let e=0;e<this.length;++e)this[e]=n.nextRandomInt(255);return this},Uint8Array.prototype.concat=function(...e){return i.bufferConcats(this,...e)},Uint8Array.prototype.toJSON=function(){return[...this]},Array.prototype.forEachReverse=function(e){for(var t=this.length-1;t>=0;--t)e(this[t],t,this)},Array.prototype.findAndSplice=function(e){let t=this.findIndex(e);return-1!==t?this.splice(t,1)[0]:void 0},String.prototype.toHHMMSS=function(e=!1){const t=parseInt(this+"",10),s=Math.floor(t/3600);let i=Math.floor((t-3600*s)/60),n=t-3600*s-60*i;return s&&(e=!0),i<10&&(i=e?"0"+i:i),n<10&&(n="0"+n),(s?s+":":"")+i+":"+n},Promise.prototype.finally=Promise.prototype.finally||function(e){const t=t=>Promise.resolve(e()).then(t);return this.then(e=>t(()=>e),e=>t(()=>Promise.reject(e)))}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileManager=void 0;const n=s(56);class a{constructor(){this.blobSupported=!0;try{n.blobConstruct([],"")}catch(e){this.blobSupported=!1}}isAvailable(){return this.blobSupported}write(e,t){return t instanceof Blob?new Promise((s,i)=>{let n=new FileReader;n.onload=function(t){let n=t.target.result,a=new Uint8Array(n);e.write(a).then(s,i)},n.readAsArrayBuffer(t)}):e.write(t)}getFakeFileWriter(e,t){const s=[];return{write:e=>i(this,void 0,void 0,(function*(){if(!this.blobSupported)throw!1;s.push(e)})),truncate:()=>{s.length=0},finalize:(i=!0)=>{const a=n.blobConstruct(s,e);return i&&t&&t(a),a}}}}t.FileManager=a,t.default=new a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="(?:👨🏻‍🤝‍👨\ud83c[\udffc-\udfff]|👨🏼‍🤝‍👨\ud83c[\udffb\udffd-\udfff]|👨🏽‍🤝‍👨\ud83c[\udffb\udffc\udffe\udfff]|👨🏾‍🤝‍👨\ud83c[\udffb-\udffd\udfff]|👨🏿‍🤝‍👨\ud83c[\udffb-\udffe]|👩🏻‍🤝‍👨\ud83c[\udffc-\udfff]|👩🏻‍🤝‍👩\ud83c[\udffc-\udfff]|👩🏼‍🤝‍👨\ud83c[\udffb\udffd-\udfff]|👩🏼‍🤝‍👩\ud83c[\udffb\udffd-\udfff]|👩🏽‍🤝‍👨\ud83c[\udffb\udffc\udffe\udfff]|👩🏽‍🤝‍👩\ud83c[\udffb\udffc\udffe\udfff]|👩🏾‍🤝‍👨\ud83c[\udffb-\udffd\udfff]|👩🏾‍🤝‍👩\ud83c[\udffb-\udffd\udfff]|👩🏿‍🤝‍👨\ud83c[\udffb-\udffe]|👩🏿‍🤝‍👩\ud83c[\udffb-\udffe]|🧑🏻‍🤝‍🧑\ud83c[\udffb-\udfff]|🧑🏼‍🤝‍🧑\ud83c[\udffb-\udfff]|🧑🏽‍🤝‍🧑\ud83c[\udffb-\udfff]|🧑🏾‍🤝‍🧑\ud83c[\udffb-\udfff]|🧑🏿‍🤝‍🧑\ud83c[\udffb-\udfff]|🧑‍🤝‍🧑|👫\ud83c[\udffb-\udfff]|👬\ud83c[\udffb-\udfff]|👭\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|🧑)(?:\ud83c[\udffb-\udfff])?‍(?:⚕️|⚖️|✈️|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|⛹)((?:\ud83c[\udffb-\udfff]|️)‍[♀♂]️)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?‍[♀♂]️|(?:👨‍❤️‍💋‍👨|👨‍👨‍👦‍👦|👨‍👨‍👧‍\ud83d[\udc66\udc67]|👨‍👩‍👦‍👦|👨‍👩‍👧‍\ud83d[\udc66\udc67]|👩‍❤️‍💋‍\ud83d[\udc68\udc69]|👩‍👩‍👦‍👦|👩‍👩‍👧‍\ud83d[\udc66\udc67]|👨‍❤️‍👨|👨‍👦‍👦|👨‍👧‍\ud83d[\udc66\udc67]|👨‍👨‍\ud83d[\udc66\udc67]|👨‍👩‍\ud83d[\udc66\udc67]|👩‍❤️‍\ud83d[\udc68\udc69]|👩‍👦‍👦|👩‍👧‍\ud83d[\udc66\udc67]|👩‍👩‍\ud83d[\udc66\udc67]|🏳️‍⚧️|🏳️‍🌈|🏴‍☠️|🐕‍🦺|🐻‍❄️|👁‍🗨|👨‍\ud83d[\udc66\udc67]|👩‍\ud83d[\udc66\udc67]|👯‍♀️|👯‍♂️|🤼‍♀️|🤼‍♂️|🧞‍♀️|🧞‍♂️|🧟‍♀️|🧟‍♂️|🐈‍⬛)|[#*0-9]️?⃣|(?:[©®™♟]️)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[‼⁉ℹ↔-↙↩↪⌚⌛⌨⏏⏭-⏯⏱⏲⏸-⏺Ⓜ▪▫▶◀◻-◾☀-☄☎☑☔☕☘☠☢☣☦☪☮☯☸-☺♀♂♈-♓♠♣♥♦♨♻♿⚒-⚗⚙⚛⚜⚠⚡⚧⚪⚫⚰⚱⚽⚾⛄⛅⛈⛏⛑⛓⛔⛩⛪⛰-⛵⛸⛺⛽✂✈✉✏✒✔✖✝✡✳✴❄❇❗❣❤➡⤴⤵⬅-⬇⬛⬜⭐⭕〰〽㊗㊙])(?:️|(?!︎))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[☝⛷⛹✌✍])(?:️|(?!︎))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[✊✋]))(?:\ud83c[\udffb-\udfff])?|(?:🏴󠁧󠁢󠁥󠁮󠁧󠁿|🏴󠁧󠁢󠁳󠁣󠁴󠁿|🏴󠁧󠁢󠁷󠁬󠁳󠁿|🇦\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|🇧\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|🇨\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|🇩\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|🇪\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|🇫\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|🇬\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|🇭\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|🇮\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|🇯\ud83c[\uddea\uddf2\uddf4\uddf5]|🇰\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|🇱\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|🇲\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|🇳\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|🇴🇲|🇵\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|🇶🇦|🇷\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|🇸\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|🇹\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|🇺\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|🇻\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|🇼\ud83c[\uddeb\uddf8]|🇽🇰|🇾\ud83c[\uddea\uddf9]|🇿\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udeeb\udeec\udef4-\udefc\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78\udd7a-\uddb4\uddb7\uddba\uddbc-\uddcb\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7a\ude80-\ude86\ude90-\udea8\udeb0-\udeb6\udec0-\udec2\uded0-\uded6]|[⏩-⏬⏰⏳♾⛎✅✨❌❎❓-❕➕-➗➰➿])|️"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCROLL_TIME=void 0,t.SCROLL_TIME=468,t.default=function(){var e=window,s=document;if(!("scrollBehavior"in s.documentElement.style)||!0===e.__forceSmoothScrollPolyfill__){var i,n=e.HTMLElement||e.Element,a={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:n.prototype.scroll||d,scrollIntoView:n.prototype.scrollIntoView},o=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now,r=(i=e.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(i)?1:0);e.scroll=e.scrollTo=function(){const t=arguments[0];void 0!==t&&(!0!==l(t)?g.call(e,s.body,void 0!==t.left?~~t.left:e.scrollX||e.pageXOffset,void 0!==t.top?~~t.top:e.scrollY||e.pageYOffset,t.scrollTime):a.scroll.call(e,void 0!==t.left?t.left:"object"!=typeof t?t:e.scrollX||e.pageXOffset,void 0!==t.top?t.top:void 0!==arguments[1]?arguments[1]:e.scrollY||e.pageYOffset))},e.scrollBy=function(){const t=arguments[0];void 0!==t&&(l(t)?a.scrollBy.call(e,void 0!==t.left?t.left:"object"!=typeof t?t:0,void 0!==t.top?t.top:void 0!==arguments[1]?arguments[1]:0):g.call(e,s.body,~~t.left+(e.scrollX||e.pageXOffset),~~t.top+(e.scrollY||e.pageYOffset),t.scrollTime))},n.prototype.scroll=n.prototype.scrollTo=function(){const e=arguments[0];if(void 0!==e)if(!0!==l(e)){var t=e.left,s=e.top;g.call(this,this,void 0===t?this.scrollLeft:~~t,void 0===s?this.scrollTop:~~s,e.scrollTime)}else{if("number"==typeof e&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");a.elementScroll.call(this,void 0!==e.left?~~e.left:"object"!=typeof e?~~e:this.scrollLeft,void 0!==e.top?~~e.top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}},n.prototype.scrollBy=function(){const e=arguments[0];void 0!==e&&(!0!==l(e)?this.scroll({left:~~e.left+this.scrollLeft,top:~~e.top+this.scrollTop,behavior:e.behavior,scrollTime:e.scrollTime}):a.elementScroll.call(this,void 0!==e.left?~~e.left+this.scrollLeft:~~e+this.scrollLeft,void 0!==e.top?~~e.top+this.scrollTop:~~arguments[1]+this.scrollTop))},n.prototype.scrollIntoView=function(){const t=arguments[0];if(!0!==l(t)){var i=u(this),n=i.getBoundingClientRect(),o=this.getBoundingClientRect();i!==s.body?(g.call(this,i,i.scrollLeft+o.left-n.left,i.scrollTop+o.top-n.top,t.scrollTime),"fixed"!==e.getComputedStyle(i).position&&e.scrollBy({left:n.left,top:n.top,behavior:"smooth",scrollTime:t.scrollTime})):e.scrollBy({left:o.left,top:o.top,behavior:"smooth",scrollTime:t.scrollTime})}else a.scrollIntoView.call(this,void 0===t||t)}}function d(e,t){this.scrollLeft=e,this.scrollTop=t}function l(e){if(null===e||"object"!=typeof e||void 0===e.behavior||"auto"===e.behavior||"instant"===e.behavior)return!0;if("object"==typeof e&&"smooth"===e.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+e.behavior+" is not a valid value for enumeration ScrollBehavior.")}function c(e,t){return"Y"===t?e.clientHeight+r<e.scrollHeight:"X"===t?e.clientWidth+r<e.scrollWidth:void 0}function f(t,s){var i=e.getComputedStyle(t,null)["overflow"+s];return"auto"===i||"scroll"===i}function h(e){var t=c(e,"Y")&&f(e,"Y"),s=c(e,"X")&&f(e,"X");return t||s}function u(e){for(;e!==s.body&&!1===h(e);)e=e.parentNode||e.host;return e}function p(t){var s,i,n,a,r=(o()-t.startTime)/t.scrollTime;a=r=r>1?1:r,s=.5*(1-Math.cos(Math.PI*a)),i=t.startX+(t.x-t.startX)*s,n=t.startY+(t.y-t.startY)*s,t.method.call(t.scrollable,i,n),i===t.x&&n===t.y||e.requestAnimationFrame(p.bind(e,t))}function g(i,n,r,l=t.SCROLL_TIME){var c,f,h,u,g=o();i===s.body?(c=e,f=e.scrollX||e.pageXOffset,h=e.scrollY||e.pageYOffset,u=a.scroll):(c=i,f=i.scrollLeft,h=i.scrollTop,u=d),p({scrollable:c,method:u,scrollTime:l,startTime:g,startX:f,startY:h,x:n,y:r})}}},function(e,t,s){e.exports=function(){return new Worker(s.p+"1a2cca1b382536b30ff2.worker.js")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(44);t.default=class{sha1Hash(e){return this.performTaskWorker("sha1-hash",e)}sha256Hash(e){return this.performTaskWorker("sha256-hash",e)}pbkdf2(e,t,s){return this.performTaskWorker("pbkdf2",e,t,s)}aesEncrypt(e,t,s){return this.performTaskWorker("aes-encrypt",i.convertToArrayBuffer(e),i.convertToArrayBuffer(t),i.convertToArrayBuffer(s))}aesDecrypt(e,t,s){return this.performTaskWorker("aes-decrypt",e,t,s).then(e=>i.convertToArrayBuffer(e))}rsaEncrypt(e,t){return this.performTaskWorker("rsa-encrypt",e,t)}factorize(e){return this.performTaskWorker("factorize",[...e])}modPow(e,t,s){return this.performTaskWorker("mod-pow",e,t,s)}gzipUncompress(e,t){return this.performTaskWorker("gzipUncompress",e,t)}computeSRP(e,t){return this.performTaskWorker("computeSRP",e,t)}}},function(e,t,s){e.exports=function(){return new Worker(s.p+"608dbdcf64455bd4cc24.worker.js")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.items=new Map,this.locked=!1,this.observer=new IntersectionObserver(t=>{if(this.locked)return;const s=[];t.forEach(e=>{const t=e.target;this.items.get(t)!=e.isIntersecting&&(this.items.set(t,e.isIntersecting),s[e.isIntersecting?"unshift":"push"]({target:t,visible:e.isIntersecting}))}),s.forEach(t=>{e(t.target,t.visible)})})}getVisible(){const e=[];return this.items.forEach((t,s)=>{t&&e.push(s)}),e}clearVisible(){const e=this.getVisible();for(const t of e)this.items.set(t,!1)}isVisible(e){return this.items.get(e)}disconnect(){this.observer.disconnect(),this.items.clear()}refresh(){this.observer.disconnect();const e=[...this.items.keys()];for(const t of e)this.observer.observe(t)}refreshVisible(){const e=this.getVisible();for(const t of e)this.observer.unobserve(t);for(const t of e)this.observer.observe(t)}observe(e){this.items.set(e,!1),this.observer.observe(e)}unobserve(e){this.observer.unobserve(e),this.items.delete(e)}unlock(){this.locked=!1}unlockAndRefresh(){this.unlock(),this.refresh()}lock(){this.locked=!0}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(18);t.default=class{constructor(e,t,s,i){this.appMessagesManager=e,this.appChatsManager=t,this.appPeersManager=s,this.serverTimeManager=i,this.dialogs={},this.byFolders={},this.allDialogsLoaded={},this.dialogsOffsetDate={},this.pinnedOrders={0:[],1:[]},this.dialogsNum=0}getFolder(e){var t,s;if(e<=1)return null!==(t=this.byFolders[e])&&void 0!==t?t:this.byFolders[e]=[];const i=[],n=this.appMessagesManager.filtersStorage.filters[e];for(const e in this.dialogs){const t=this.dialogs[e];if(this.appMessagesManager.filtersStorage.testDialogForFilter(t,n)){let e;const a=n.pinned_peers.indexOf(t.peerId);e=-1!==a?this.generateDialogIndex(this.generateDialogPinnedDateByIndex(n.pinned_peers.length-1-a)):(null===(s=t.pFlags)||void 0===s?void 0:s.pinned)?this.generateIndexForDialog(t,!0):t.index,i.push({dialog:t,index:e})}}return i.sort((e,t)=>t.index-e.index),i.map(e=>e.dialog)}getDialog(e,t){const s=[];if(void 0===t){const e=this.byFolders;for(const t in e)s.push(e[t])}else s.push(this.getFolder(t));for(let t of s){const s=t.findIndex(t=>t.peerId==e);if(-1!==s)return[t[s],s]}return[]}generateDialogIndex(e){return void 0===e&&(e=i.tsNow(!0)+this.serverTimeManager.serverTimeOffset),65536*e+(65535&++this.dialogsNum)}generateIndexForDialog(e,t=!1){const s=this.appPeersManager.isChannel(e.peerId)?-e.peerId:0,i=e.top_message;let n=this.appMessagesManager.getMessageByPeer(e.peerId,i).date||Date.now()/1e3;if(s){const e=this.appChatsManager.getChat(s);(!n||e.date&&e.date>n)&&(n=e.date)}const a={};a&&a.date>n&&(n=a.date),e.pFlags.pinned&&!t&&(n=this.generateDialogPinnedDate(e));const o=this.generateDialogIndex(n);if(t)return o;e.index=o}generateDialogPinnedDateByIndex(e){return 2147418112+(65535&e)}generateDialogPinnedDate(e){const t=this.pinnedOrders[e.folder_id],s=t.indexOf(e.peerId),i=-1===s?t.push(e.peerId)-1:s;return this.generateDialogPinnedDateByIndex(i)}pushDialog(e,t){const s=this.getFolder(e.folder_id),i=s.findIndex(t=>t.peerId==e.peerId);if(-1!==i&&s.splice(i,1),this.dialogs[e.peerId]=e,t&&!e.pFlags.pinned&&(!this.dialogsOffsetDate[e.folder_id]||t<this.dialogsOffsetDate[e.folder_id])){if(-1!==i)return!1;this.dialogsOffsetDate[e.folder_id]=t}const n=e.index,a=s.length;if(!a||n<s[a-1].index)s.push(e);else if(n>=s[0].index)s.unshift(e);else for(let t=0;t<a;t++)if(n>s[t].index){s.splice(t,0,e);break}}dropDialog(e){const t=this.getDialog(e);return t[0]&&(this.byFolders[t[0].folder_id].splice(t[1],1),delete this.dialogs[e]),t}}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=s(14),o=n(s(5));t.default=class{constructor(e,t,s){this.appPeersManager=e,this.appUsersManager=t,this.rootScope=s,this.filters={},this.orderIndex=1,s.on("apiUpdate",e=>{this.handleUpdate(e.detail)})}handleUpdate(e){switch(e._){case"updateDialogFilter":e.filter?this.saveDialogFilter(e.filter):this.filters[e.id]&&(this.rootScope.broadcast("filter_delete",this.filters[e.id]),delete this.filters[e.id]);break;case"updateDialogFilters":{const e=a.copy(this.filters);this.getDialogFilters(!0).then(t=>{for(const s in e){const e=+s;t.find(t=>t.id==e)||this.handleUpdate({_:"updateDialogFilter",id:e})}this.handleUpdate({_:"updateDialogFilterOrder",order:t.map(e=>e.id)})});break}case"updateDialogFilterOrder":this.orderIndex=1,e.order.forEach((e,t)=>{const s=this.filters[e];delete s.orderIndex,this.setOrderIndex(s)}),this.rootScope.broadcast("filter_order",e.order)}}testDialogForFilter(e,t){var s;for(const s of t.exclude_peers)if(s==e.peerId)return!1;for(const s of t.include_peers)if(s==e.peerId)return!0;const i=t.pFlags;if(i.exclude_archived&&1==e.folder_id)return!1;if(i.exclude_read&&!e.unread_count)return!1;if(i.exclude_muted){if(1e3*(null===(s=e.notify_settings)||void 0===s?void 0:s.mute_until)>Date.now())return!1}const n=e.peerId;if(n<0){if(i.broadcasts&&this.appPeersManager.isBroadcast(n))return!0;if(i.groups&&this.appPeersManager.isAnyGroup(n))return!0}else{if(this.appPeersManager.isBot(n))return!!i.bots;if(i.non_contacts&&!this.appUsersManager.contactsList.has(n))return!0;if(i.contacts&&this.appUsersManager.contactsList.has(n))return!0}return!1}toggleDialogPin(e,t){const s=this.filters[t];return s.pinned_peers.findAndSplice(t=>t==e)||s.pinned_peers.unshift(e),this.updateDialogFilter(s)}createDialogFilter(e){let t=Math.max(1,...Object.keys(this.filters).map(e=>+e));return(e=a.copy(e)).id=t+1,this.updateDialogFilter(e)}updateDialogFilter(e,t=!1){const s=t?0:1;return o.default.invokeApi("messages.updateDialogFilter",{flags:s,id:e.id,filter:t?void 0:this.getOutputDialogFilter(e)}).then(s=>(s&&this.handleUpdate({_:"updateDialogFilter",id:e.id,filter:t?void 0:e}),s))}getOutputDialogFilter(e){const t=a.copy(e);return["pinned_peers","exclude_peers","include_peers"].forEach(e=>{t[e]=t[e].map(e=>this.appPeersManager.getInputPeerById(e))}),t.include_peers.forEachReverse((e,s)=>{t.pinned_peers.includes(e)&&t.include_peers.splice(s,1)}),t}getDialogFilters(e=!1){return i(this,void 0,void 0,(function*(){const t=Object.keys(this.filters);if(t.length&&!e)return t.map(e=>this.filters[e]).sort((e,t)=>e.orderIndex-t.orderIndex);const s=yield o.default.invokeApi("messages.getDialogFilters");for(const t of s)this.saveDialogFilter(t,e);return s}))}saveDialogFilter(e,t=!0){["pinned_peers","exclude_peers","include_peers"].forEach(t=>{e[t]=e[t].map(e=>this.appPeersManager.getPeerId(e))}),e.include_peers.forEachReverse((t,s)=>{e.pinned_peers.includes(t)&&e.include_peers.splice(s,1)}),e.include_peers=e.pinned_peers.concat(e.include_peers),this.filters[e.id]?Object.assign(this.filters[e.id],e):this.filters[e.id]=e,this.setOrderIndex(e),t&&this.rootScope.broadcast("filter_update",e)}setOrderIndex(e){e.hasOwnProperty("orderIndex")?e.orderIndex>=this.orderIndex&&(this.orderIndex=e.orderIndex+1):e.orderIndex=this.orderIndex++}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),a=i(s(31)),o=s(47),r=s(2);const d=new class{constructor(){this.pageId=-1,this.pagesDiv=document.getElementById("auth-pages"),this.selectTab=o.horizontalMenu(null,this.pagesDiv.firstElementChild.firstElementChild,null,()=>{this.page.onShown&&this.page.onShown()})}setPage(e){if(e.isAuthPage){this.pagesDiv.style.display="";let t=n.whichChild(e.pageEl);if(this.pageId==t)return;this.selectTab(t),-1!=this.pageId&&t>1&&a.default.loadLottieWorkers(),this.pageId=t}else this.pagesDiv.style.display="none",e.pageEl.style.display="",this.pageId=-1;this.page=e}};r.MOUNT_CLASS_TO&&(r.MOUNT_CLASS_TO.pagesManager=d),t.default=d},function(e,t,s){e.exports=function(){return new Worker(s.p+"f803f3468d66b7343a3a.worker.js")}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(s(72)),d=s(4),l=o(s(19)),c=a(s(27));t.default=class{constructor(){this.container=document.querySelector(".addmembers-container"),this.contentDiv=this.container.querySelector(".sidebar-content"),this.backBtn=this.container.querySelector(".sidebar-close-button"),this.nextBtn=this.contentDiv.querySelector(".btn-corner"),this.nextBtn.addEventListener("click",()=>{if(this.skippable)return void c.default.closeTab(c.AppSidebarLeft.SLIDERITEMSIDS.addMembers);const e=this.selector.getSelected();if(e.length){if(this.takeOut)return void this.takeOut(e);this.nextBtn.classList.remove("tgico-arrow-next"),this.nextBtn.disabled=!0,d.putPreloader(this.nextBtn),this.selector.freezed=!0,l.default.inviteToChannel(this.peerId,e).then(()=>{c.default.closeTab(c.AppSidebarLeft.SLIDERITEMSIDS.addMembers)})}})}onCloseAfterTimeout(){this.selector&&(this.selector.container.remove(),this.selector=null)}init(e,t,s,i){this.peerId=Math.abs(e),this.peerType=t,this.takeOut=i,this.skippable=s,this.onCloseAfterTimeout(),this.selector=new r.default(this.contentDiv,s?null:e=>{this.nextBtn.classList.toggle("is-visible",!!e)},["contacts"]),this.nextBtn.innerHTML="",this.nextBtn.disabled=!1,this.nextBtn.classList.add("tgico-arrow-next"),this.nextBtn.classList.toggle("is-visible",s),c.default.selectTab(c.AppSidebarLeft.SLIDERITEMSIDS.addMembers)}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(23)),a=i(s(6));t.default=class{constructor(){this.container=document.getElementById("chats-archived-container"),this.chatList=document.getElementById("dialogs-archived"),this.scroll=null}init(){this.scroll=new a.default(this.container,"CLA",500),this.scroll.container.addEventListener("scroll",n.default.onChatsRegularScroll),this.scroll.setVirtualContainer(this.chatList),this.scroll.onScrolledBottom=n.default.onChatsScroll,n.default.setListClickListener(this.chatList,null,!0),window.addEventListener("resize",()=>{setTimeout(n.default.scroll.checkForTriggers,0)})}onOpen(){this.init&&(this.init(),this.init=null),this.wasFilterId=n.default.filterId,n.default.scroll=this.scroll,n.default.filterId=1,n.default.onTabChange()}onOpenAfterTimeout(){n.default.chatLists[this.wasFilterId].innerHTML=""}onClose(){n.default.scroll=n.default._scroll,n.default.filterId=this.wasFilterId,n.default.onTabChange()}onCloseAfterTimeout(){this.chatList.innerHTML=""}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(31)),a=s(3),o=s(0),r=s(17),d=s(36);t.default=class{constructor(e,t,s,i,n){this.appMessagesManager=e,this.appPeersManager=t,this.appSidebarLeft=s,this.apiManager=i,this.rootScope=n,this.filtersRendered={}}renderFolder(e,t,s=document.createElement("div")){let i,n="",d=[];if("dialogFilterSuggested"==e._)i=e.filter,n=e.description;else{i=e,n="";const t=i.id;if(this.filtersRendered.hasOwnProperty(i.id)||s.addEventListener("click",()=>{this.appSidebarLeft.editFolderTab.open(this.appMessagesManager.filtersStorage.filters[t])}),this.filtersRendered[i.id]=s,1==Object.keys(i.pFlags).length){n="All ";const e=i.pFlags;e.contacts?n+="Contacts":e.non_contacts?n+="Non-Contacts":e.groups?n+="Groups":e.broadcasts?n+="Channels":e.bots?n+="Bots":e.exclude_muted?n+="Unmuted":e.exclude_read?n+="Unread":e.exclude_archived&&(n+="Unarchived"),d.push(n)}else{const e=this.appMessagesManager.dialogsStorage.getFolder(i.id);let t=0,s=0,n=0;for(const i of e)this.appPeersManager.isAnyGroup(i.peerId)?n++:this.appPeersManager.isBroadcast(i.peerId)?s++:t++;t&&d.push(t+" chats"),s&&d.push(s+" channels"),n&&d.push(n+" groups")}}return s.classList.add("category","rp-square"),s.innerHTML=`\n      <div>\n        <p>${a.RichTextProcessor.wrapEmojiText(i.title)}</p>\n        <p>${d.length?d.join(", "):n}</p>\n      </div>\n    `,r.ripple(s),i.hasOwnProperty("orderIndex")?o.positionElementByIndex(s,s.parentElement||t,i.orderIndex):t&&t.append(s),s}init(){this.container=document.querySelector(".chat-folders-container"),this.stickerContainer=this.container.querySelector(".sticker-container"),this.foldersContainer=this.container.querySelector(".folders-my"),this.suggestedContainer=this.container.querySelector(".folders-suggested"),this.createFolderBtn=this.container.querySelector(".btn-create-folder"),this.createFolderBtn.addEventListener("click",()=>{Object.keys(this.filtersRendered).length>=10?d.toast("Sorry, you can't create more folders."):this.appSidebarLeft.editFolderTab.open()}),n.default.loadAnimationFromURL({container:this.stickerContainer,loop:!1,autoplay:!0,width:86,height:86},"assets/img/Folders_1.tgs").then(e=>{this.animation=e}),this.appMessagesManager.filtersStorage.getDialogFilters().then(e=>{for(const t of e)this.renderFolder(t,this.foldersContainer)}),this.rootScope.on("filter_update",e=>{const t=e.detail;this.filtersRendered.hasOwnProperty(t.id)?this.renderFolder(t,null,this.filtersRendered[t.id]):this.renderFolder(t,this.foldersContainer),this.getSuggestedFilters()}),this.rootScope.on("filter_delete",e=>{const t=e.detail;this.filtersRendered.hasOwnProperty(t.id)&&(this.getSuggestedFilters(),this.filtersRendered[t.id].remove(),delete this.filtersRendered[t.id])}),this.rootScope.on("filter_order",e=>{e.detail.forEach((e,t)=>{const s=this.filtersRendered[e];o.positionElementByIndex(s,s.parentElement,t+1)})}),this.getSuggestedFilters()}getSuggestedFilters(){this.apiManager.invokeApi("messages.getSuggestedDialogFilters").then(e=>{this.suggestedContainer.style.display=e.length?"":"none",Array.from(this.suggestedContainer.children).slice(1).forEach(e=>e.remove()),e.forEach(e=>{const t=this.renderFolder(e),s=document.createElement("button");s.classList.add("btn-primary"),s.innerText="Add",t.append(s),this.suggestedContainer.append(t),s.addEventListener("click",i=>{o.cancelEvent(i),Object.keys(this.filtersRendered).length>=10?d.toast("Sorry, you can't create more folders."):(s.setAttribute("disabled","true"),this.appMessagesManager.filtersStorage.createDialogFilter(e.filter).then(e=>{e&&t.remove()}).finally(()=>{s.removeAttribute("disabled")}))})})})}onOpen(){this.init?(this.init(),this.init=null):this.animation&&this.animation.restart()}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(s(6)),d=o(s(23)),l=o(s(8)),c=o(s(20)),f=a(s(27)),h=o(s(1)),u=o(s(43));t.default=class{init(){this.container=document.getElementById("contacts-container"),this.list=this.container.querySelector("#contacts"),d.default.setListClickListener(this.list),this.scrollable=new r.default(this.list.parentElement),this.inputSearch=new u.default("Search",e=>{this.list.innerHTML="",this.openContacts(e)}),this.container.firstElementChild.append(this.inputSearch.container)}onClose(){let e=c.default.windowH/72*1.25|0;Array.from(this.list.children).slice(e).forEach(e=>e.remove())}onCloseAfterTimeout(){this.list.innerHTML="",this.inputSearch.value=""}openContacts(e){if(this.init&&(this.init(),this.init=null),-1===f.default.historyTabIds.indexOf(f.AppSidebarLeft.SLIDERITEMSIDS.contacts)&&f.default.selectTab(f.AppSidebarLeft.SLIDERITEMSIDS.contacts),this.promise)return this.promise;this.scrollable.onScrolledBottom=null,this.promise=l.default.getContacts(e).then(t=>{if(this.promise=null,f.default.historyTabIds[f.default.historyTabIds.length-1]!=f.AppSidebarLeft.SLIDERITEMSIDS.contacts)return void console.warn("user closed contacts before it's loaded");const s=[...t];e||s.findAndSplice(e=>e==h.default.myId);let i=s.map(e=>{let t=l.default.getUser(e);return{user:t,status:l.default.getUserStatusForSort(t.status)}}).sort((e,t)=>t.status-e.status),n=()=>{let e=c.default.windowH/72*1.25|0;i.splice(0,e).forEach(({user:e})=>{let{dialog:t,dom:s}=d.default.addDialogNew({dialog:e.id,container:this.list,drawStatus:!1,avatarSize:48,autonomous:!1}),i=l.default.getUserStatusString(e.id);s.lastMessageSpan.innerHTML="online"==i?`<i>${i}</i>`:i}),i.length||(n=void 0)};n(),this.scrollable.onScrolledBottom=()=>{n?n():this.scrollable.onScrolledBottom=null}})}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(s(27)),d=s(14),l=o(s(23)),c=o(s(31)),f=s(4),h=s(17),u=s(36),p=o(s(7)),g=s(0),m=o(s(28)),b=o(s(3));t.default=class{constructor(){this.flags={}}init(){this.container=document.querySelector(".edit-folder-container"),this.closeBtn=this.container.querySelector(".sidebar-close-button"),this.title=this.container.querySelector(".sidebar-header__title"),this.caption=this.container.querySelector(".caption"),this.stickerContainer=this.container.querySelector(".sticker-container"),this.confirmBtn=this.container.querySelector(".btn-confirm"),this.menuBtn=this.container.querySelector(".btn-menu-toggle"),this.deleteFolderBtn=this.menuBtn.querySelector(".menu-delete");const e=document.createElement("div");e.classList.add("input-wrapper"),this.nameInputField=new m.default({label:"Folder Name",maxLength:12}),this.nameInput=this.nameInputField.input,e.append(this.nameInputField.container),this.caption.parentElement.insertBefore(e,this.caption.nextSibling),this.include_peers=this.container.querySelector(".folder-list-included"),this.exclude_peers=this.container.querySelector(".folder-list-excluded");const t=this.include_peers.querySelector(".folder-categories"),s=this.exclude_peers.querySelector(".folder-categories");f.parseMenuButtonsTo(this.flags,t.children),f.parseMenuButtonsTo(this.flags,s.children),t.firstElementChild.addEventListener("click",()=>{r.default.includedChatsTab.open(this.filter,"included")}),s.firstElementChild.addEventListener("click",()=>{r.default.includedChatsTab.open(this.filter,"excluded")}),c.default.loadAnimationFromURL({container:this.stickerContainer,loop:!1,autoplay:!0,width:86,height:86},"assets/img/Folders_2.tgs").then(e=>{this.animation=e}),g.attachClickEvent(this.deleteFolderBtn,()=>{this.deleteFolderBtn.setAttribute("disabled","true"),p.default.filtersStorage.updateDialogFilter(this.filter,!0).then(e=>{e&&r.default.closeTab(r.AppSidebarLeft.SLIDERITEMSIDS.editFolder)}).finally(()=>{this.deleteFolderBtn.removeAttribute("disabled")})}),this.confirmBtn.addEventListener("click",()=>{if(this.nameInputField.input.classList.contains("error"))return;if(!this.nameInputField.value.trim())return void this.nameInputField.input.classList.add("error");let e,s=Array.from(t.children).slice(1).reduce((e,t)=>e+ +!t.style.display,0);s+=this.filter.include_peers.length,s?(this.confirmBtn.setAttribute("disabled","true"),e=this.filter.id?p.default.filtersStorage.updateDialogFilter(this.filter):p.default.filtersStorage.createDialogFilter(this.filter),e.then(e=>{e&&r.default.closeTab(r.AppSidebarLeft.SLIDERITEMSIDS.editFolder)}).catch(e=>{"DIALOG_FILTERS_TOO_MUCH"==e.type?u.toast("Sorry, you can't create more folders."):console.error("updateDialogFilter error:",e)}).finally(()=>{this.confirmBtn.removeAttribute("disabled")})):u.toast("Please choose at least one chat for this folder.")}),this.nameInput.addEventListener("input",()=>{this.filter.title=this.nameInputField.value,this.editCheckForChange()})}onOpen(){this.init?(this.init(),this.init=null):this.animation&&this.animation.restart()}onCloseAfterTimeout(){Array.from(this.container.querySelectorAll("ul, .show-more")).forEach(e=>e.remove())}onCreateOpen(){this.caption.style.display="",this.title.innerText="New Folder",this.menuBtn.classList.add("hide"),this.confirmBtn.classList.remove("hide"),this.nameInputField.value="";for(const e in this.flags)this.flags[e].style.display="none"}onEditOpen(){this.caption.style.display="none",this.title.innerText="create"==this.type?"New Folder":"Edit Folder","edit"==this.type&&(this.menuBtn.classList.remove("hide"),this.confirmBtn.classList.add("hide"));const e=this.filter;this.nameInputField.value=b.default.wrapEmojiText(e.title);for(const t in this.flags)this.flags[t].style.display=e.pFlags[t]?"":"none";["include_peers","exclude_peers"].forEach(t=>{const s=this[t],i=document.createElement("ul"),n=e[t].slice(),a=e=>{for(let t=0,s=Math.min(n.length,e);t<s;++t){const e=n.shift(),{dom:t}=l.default.addDialogNew({dialog:e,container:i,drawStatus:!1,rippleEnabled:!1,meAsSaved:!0,avatarSize:32});t.lastMessageSpan.parentElement.remove()}n.length?o.innerHTML=`<div class="tgico-down"></div><div>Show ${Math.min(20,n.length)} more chat${n.length>1?"s":""}</div>`:o&&o.remove()};let o;s.append(i),n.length&&(o=document.createElement("div"),o.classList.add("show-more"),o.addEventListener("click",()=>a(20)),o.innerHTML=`<div class="tgico-down"></div><div>Show ${Math.min(20,n.length)} more chat${n.length>1?"s":""}</div>`,h.ripple(o),s.append(o)),a(4)})}editCheckForChange(){if("edit"==this.type){const e=!d.deepEqual(this.originalFilter,this.filter);this.confirmBtn.classList.toggle("hide",!e),this.menuBtn.classList.toggle("hide",e)}}setFilter(e,t){this.onCloseAfterTimeout(),t?(this.originalFilter=e,this.filter=d.copy(e)):(this.filter=e,this.onEditOpen(),this.editCheckForChange())}open(e){r.default.selectTab(r.AppSidebarLeft.SLIDERITEMSIDS.editFolder),void 0===e?(this.setFilter({_:"dialogFilter",id:0,title:"",pFlags:{},pinned_peers:[],include_peers:[],exclude_peers:[]},!0),this.type="create",this.onCreateOpen()):(this.setFilter(e,!0),this.type="edit",this.onEditOpen())}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(27)),a=i(s(39)),o=i(s(8)),r=i(s(5)),d=i(s(3)),l=i(s(1)),c=i(s(28)),f=i(s(59)),h=i(s(6));t.default=class{constructor(){this.uploadAvatar=null,this.originalValues={firstName:"",lastName:"",userName:"",bio:""},this.handleChange=()=>{this.isChanged()?this.nextBtn.classList.add("is-visible"):this.nextBtn.classList.remove("is-visible")}}init(){this.container=document.querySelector(".edit-profile-container"),this.scrollWrapper=this.container.querySelector(".scroll-wrapper"),this.nextBtn=this.container.querySelector(".btn-corner"),this.canvas=this.container.querySelector(".avatar-edit-canvas"),this.avatarElem=document.createElement("avatar-element"),this.avatarElem.classList.add("avatar-placeholder"),this.profileUrlContainer=this.container.querySelector(".profile-url-container"),this.profileUrlAnchor=this.profileUrlContainer.lastElementChild;const e=this.container.querySelector(".avatar-edit");e.addEventListener("click",()=>{(new f.default).open(this.canvas,e=>{this.uploadAvatar=e,this.handleChange(),this.avatarElem.remove()})});{const t=document.createElement("div");t.classList.add("input-wrapper"),this.firstNameInputField=new c.default({label:"Name",name:"first-name",maxLength:70}),this.lastNameInputField=new c.default({label:"Last Name",name:"last-name",maxLength:64}),this.bioInputField=new c.default({label:"Bio (optional)",name:"bio",maxLength:70}),this.firstNameInput=this.firstNameInputField.input,this.lastNameInput=this.lastNameInputField.input,this.bioInput=this.bioInputField.input,t.append(this.firstNameInputField.container,this.lastNameInputField.container,this.bioInputField.container),e.parentElement.insertBefore(t,e.nextElementSibling)}{const e=document.createElement("div");e.classList.add("input-wrapper"),this.userNameInputField=new c.default({label:"Username (optional)",name:"username",plainText:!0}),this.userNameInput=this.userNameInputField.input,e.append(this.userNameInputField.container);const t=this.profileUrlContainer.parentElement;t.parentElement.insertBefore(e,t)}let t=this.userNameInput.nextElementSibling;this.firstNameInput.addEventListener("input",this.handleChange),this.lastNameInput.addEventListener("input",this.handleChange),this.bioInput.addEventListener("input",this.handleChange),this.userNameInput.addEventListener("input",()=>{let e=this.userNameInputField.value;return e!=this.originalValues.userName&&e.length?(this.isUsernameValid(e)?this.userNameInput.classList.remove("valid","error"):(this.userNameInput.classList.add("error"),this.userNameInput.classList.remove("valid"),t.innerText="Username is invalid"),this.userNameInput.classList.contains("error")?(this.setProfileUrl(),void this.handleChange()):void r.default.invokeApi("account.checkUsername",{username:e}).then(s=>{this.userNameInputField.value==e&&(s?(this.userNameInput.classList.add("valid"),this.userNameInput.classList.remove("error"),t.innerText="Username is available"):(this.userNameInput.classList.add("error"),this.userNameInput.classList.remove("valid"),t.innerText="Username is already taken"))},s=>{if(this.userNameInputField.value==e)switch(s.type){case"USERNAME_INVALID":this.userNameInput.classList.add("error"),this.userNameInput.classList.remove("valid"),t.innerText="Username is invalid"}}).then(()=>{this.handleChange(),this.setProfileUrl()})):(this.userNameInput.classList.remove("valid","error"),t.innerText="Username (optional)",this.setProfileUrl(),void this.handleChange())}),this.nextBtn.addEventListener("click",()=>{this.nextBtn.disabled=!0;let e=[];e.push(a.default.updateProfile(this.firstNameInputField.value,this.lastNameInputField.value,this.bioInputField.value).then(()=>{n.default.selectTab(0)},e=>{console.error("updateProfile error:",e)})),this.uploadAvatar&&e.push(this.uploadAvatar().then(e=>{a.default.uploadProfilePhoto(e)})),this.userNameInputField.value!=this.originalValues.userName&&this.userNameInput.classList.contains("valid")&&e.push(a.default.updateUsername(this.userNameInputField.value)),Promise.race(e).finally(()=>{this.nextBtn.removeAttribute("disabled")})});new h.default(this.scrollWrapper)}fillElements(){var e;this.init&&(this.init(),this.init=null);const t=o.default.getSelf();Object.assign(this.originalValues,{firstName:t.first_name,lastName:t.last_name,userName:t.username,bio:""}),this.firstNameInput.innerHTML=t.rFirstName,this.lastNameInput.innerHTML=d.default.wrapRichText(t.last_name,{noLinks:!0,noLinebreaks:!0}),this.bioInput.innerHTML="",this.userNameInputField.value=this.originalValues.userName=null!==(e=t.username)&&void 0!==e?e:"",this.userNameInput.classList.remove("valid","error"),this.userNameInput.nextElementSibling.innerHTML="Username (optional)",a.default.getProfile(t.id,!0).then(e=>{e.about&&(this.originalValues.bio=e.about,this.bioInput.innerHTML=e.rAbout,this.handleChange())}),this.avatarElem.setAttribute("peer",""+l.default.myId),this.avatarElem.parentElement||this.canvas.parentElement.append(this.avatarElem),this.uploadAvatar=null,this.setProfileUrl(),this.handleChange()}isUsernameValid(e){return(e.length>=5&&e.length<=32||!e.length)&&/^[a-zA-Z0-9_]*$/.test(e)}isChanged(){return!!this.uploadAvatar||!this.firstNameInput.classList.contains("error")&&this.firstNameInputField.value!=this.originalValues.firstName||!this.lastNameInput.classList.contains("error")&&this.lastNameInputField.value!=this.originalValues.lastName||!this.bioInput.classList.contains("error")&&this.bioInputField.value!=this.originalValues.bio||this.userNameInputField.value!=this.originalValues.userName&&!this.userNameInput.classList.contains("error")}setProfileUrl(){if(this.userNameInput.classList.contains("error")||!this.userNameInputField.value.length)this.profileUrlContainer.style.display="none";else{this.profileUrlContainer.style.display="";let e="https://t.me/"+this.userNameInputField.value;this.profileUrlAnchor.innerText=e,this.profileUrlAnchor.href=e}}onCloseAfterTimeout(){this.nextBtn.classList.remove("is-visible"),this.firstNameInput.innerHTML=this.lastNameInput.innerHTML=this.bioInput.innerHTML=""}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var s,i,n,a={},o=1,r=0,d=0,l=0,c=0;function f(){if(e.dataset.isCrop)throw"image is already crop";e.dataset.isCrop="true",e.classList.add("crop-blur"),e.draggable=!1,(n=new Image).crossOrigin=e.crossOrigin,n.src=e.src,n.draggable=!1,t||(t=document.createElement("canvas")),(s=document.createElement("div")).classList.add("crop-component"),(i=document.createElement("div")).classList.add("overlay");let a=document.createElement("div");a.classList.add("crop-overlay-color"),s.appendChild(i),e.parentNode.appendChild(s),s.appendChild(n),s.appendChild(e),s.appendChild(a),i.appendChild(n),n.style.maxWidth=e.width+"px",h(e.offsetWidth/2-100,e.offsetHeight/2-100),i.addEventListener("mousedown",b,!1),i.addEventListener("touchstart",b,!1),i.addEventListener("wheel",m,!1),document.addEventListener("keypress",g,!1)}function h(e,t){r=-e*o,d=-t*o,n.style.top=-t+"px",n.style.left=-e+"px"}function u(e,t){let s=t+100+"px",n=e+100+"px";i.style.top=s,i.style.left=n}function p(e){e=e*Math.PI*2;var t,s,a,r,d,l,c=Math.floor(i.clientWidth+e),f=Math.floor(i.clientHeight+e),p=n.clientWidth,g=n.clientHeight;c<50||(c>p||(a=(t=i.offsetLeft-e/2)+c,r=(s=i.offsetTop-e/2)+f,t<0&&(t=0),s<0&&(s=0),a>p||r>g||(o=200/c,d=c,l=c,i.style.width=d+"px",i.style.height=l+"px",h(t,s),u(t,s))))}function g(e){switch(e.preventDefault(),String.fromCharCode(e.charCode)){case"+":p(4);break;case"-":p(-4)}}function m(e){e.preventDefault(),p(e.deltaY>0?1:-1)}function b(e){e.preventDefault(),e.stopPropagation(),function(e){a.container_width=i.offsetWidth,a.container_height=i.offsetHeight,a.container_left=i.offsetLeft,a.container_top=i.offsetTop,a.mouse_x=(e.clientX||e.pageX||e.touches&&e.touches[0].clientX)+window.scrollX,a.mouse_y=(e.clientY||e.pageY||e.touches&&e.touches[0].clientY)+window.scrollY}(e),document.addEventListener("mousemove",y),document.addEventListener("touchmove",y),document.addEventListener("mouseup",v),document.addEventListener("touchend",v)}function v(e){e.preventDefault(),document.removeEventListener("mouseup",v),document.removeEventListener("touchend",v),document.removeEventListener("mousemove",y),document.removeEventListener("touchmove",y)}function y(e){var t,s,o,r,d={x:0,y:0};e.preventDefault(),e.stopPropagation(),d.x=e.pageX||e.touches&&e.touches[0].pageX,d.y=e.pageY||e.touches&&e.touches[0].pageY,t=d.x-(a.mouse_x-a.container_left),s=d.y-(a.mouse_y-a.container_top),o=i.offsetWidth,r=i.offsetHeight,t<0?t=0:t>n.offsetWidth-o&&(t=n.offsetWidth-o),s<0?s=0:s>n.offsetHeight-r&&(s=n.offsetHeight-r),h(t,s),u(t,s)}return e.complete?f():e.onload=f,{crop:function(){l=n.width*o,c=n.height*o,t.width=200,t.height=200,t.getContext("2d").drawImage(n,r,d,l,c)},removeHandlers:function(){i.removeEventListener("mousedown",b),i.removeEventListener("touchstart",b),i.removeEventListener("wheel",m),document.removeEventListener("mouseup",v),document.removeEventListener("touchend",v),document.removeEventListener("mousemove",y),document.removeEventListener("touchmove",y),document.removeEventListener("keypress",g),s.remove(),i.remove(),n.remove()}}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=r(s(72)),l=a(s(27)),c=r(s(23)),f=r(s(10)),h=r(s(8)),u=r(s(1)),p=s(14);t.default=class{constructor(){this.renderResults=e=>o(this,void 0,void 0,(function*(){yield h.default.getContacts(),e.forEach(e=>{const{dom:t}=c.default.addDialogNew({dialog:e,container:this.selector.scrollable,drawStatus:!1,rippleEnabled:!1,avatarSize:46}),s=this.selector.selected.has(e);t.containerEl.insertAdjacentHTML("beforeend",this.checkbox(s)),s&&t.listEl.classList.add("active");let i="";i=e>0?e==u.default.myId?"Chat with yourself":h.default.isBot(e)?"Bot":h.default.contactsList.has(e)?"Contact":"Non-Contact":f.default.isBroadcast(e)?"Channel":"Group",t.lastMessageSpan.innerHTML=i})})),this.onSelectChange=e=>{"included"==this.type&&(this.confirmBtn.style.display=e?"":"none")}}init(){this.container=document.querySelector(".included-chatlist-container"),this.closeBtn=this.container.querySelector(".sidebar-close-button"),this.confirmBtn=this.container.querySelector(".btn-confirm"),this.title=this.container.querySelector(".sidebar-header__title"),this.confirmBtn.addEventListener("click",()=>{const e=this.selector.getSelected();if("included"==this.type)for(const e in this.filter.pFlags)0!==e.indexOf("exclude_")&&delete this.filter.pFlags[e];else for(const e in this.filter.pFlags)0===e.indexOf("exclude_")&&delete this.filter.pFlags[e];const t=[];for(const s of e)"number"==typeof s?t.push(s):this.filter.pFlags[s]=!0;"included"==this.type?this.filter.pinned_peers=this.filter.pinned_peers.filter(e=>t.includes(e)):this.filter.pinned_peers=this.filter.pinned_peers.filter(e=>!t.includes(e));const s="included"==this.type?"exclude_peers":"include_peers";this.filter[s]=this.filter[s].filter(e=>!t.includes(e)),this.filter["included"==this.type?"include_peers":"exclude_peers"]=t,l.default.editFolderTab.setFilter(this.filter,!1),l.default.closeTab(l.AppSidebarLeft.SLIDERITEMSIDS.includedChats)})}checkbox(e){return`<div class="checkbox"><label class="checkbox-field"><input type="checkbox" ${e?"checked":""}><span></span></label></div>`}onOpen(){this.init&&(this.init(),this.init=null),this.confirmBtn.style.display="excluded"==this.type?"":"none",this.title.innerText="included"==this.type?"Included Chats":"Excluded Chats";const e=this.filter,t=document.createDocumentFragment(),s=document.createElement("div");s.classList.add("sidebar-left-h2"),s.innerText="Chat types";const i=document.createElement("div");let n;i.classList.add("folder-categories"),n="excluded"==this.type?{exclude_muted:{ico:"tgico-mute",text:"Muted"},exclude_archived:{ico:"tgico-archive",text:"Archived"},exclude_read:{ico:"tgico-readchats",text:"Read"}}:{contacts:{ico:"tgico-newprivate",text:"Contacts"},non_contacts:{ico:"tgico-noncontacts",text:"Non-Contacts"},groups:{ico:"tgico-group",text:"Groups"},broadcasts:{ico:"tgico-newchannel",text:"Channels"},bots:{ico:"tgico-bots",text:"Bots"}};let a="";for(const e in n)a+=`<div class="folder-category-button ${n[e].ico}" data-peerId="${e}"><p>${n[e].text}</p>${this.checkbox()}</div>`;i.innerHTML=a;const o=document.createElement("hr");o.style.margin="7px 0 9px";const r=document.createElement("div");r.classList.add("sidebar-left-h2"),r.innerText="Chats",t.append(s,i,o,r);const l=("included"==this.type?e.include_peers:e.exclude_peers).slice();this.selector=new d.default(this.container,this.onSelectChange,["dialogs"],null,this.renderResults),this.selector.selected=new Set(l),this.selector.input.placeholder="Search";const c=this.selector.add.bind(this.selector);this.selector.add=(e,t)=>{var s;const i=c(e,null===(s=n[e])||void 0===s?void 0:s.text);return n[e]&&i.querySelector("avatar-element").classList.add(n[e].ico),i},this.selector.list.parentElement.insertBefore(t,this.selector.list),l.forEach(e=>{this.selector.add(e)});for(const t in e.pFlags)n.hasOwnProperty(t)&&e.pFlags[t]&&i.querySelector(`[data-peerId="${t}"]`).click();setTimeout(()=>{this.selector.selectedScrollable.scrollTo(this.selector.selectedScrollable.scrollHeight,"top",!1,!0)},0)}onCloseAfterTimeout(){this.selector&&(this.selector.container.remove(),this.selector=null)}open(e,t){this.originalFilter=e,this.filter=p.copy(this.originalFilter),this.type=t,l.default.selectTab(l.AppSidebarLeft.SLIDERITEMSIDS.includedChats)}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(s(27)),d=o(s(19)),l=o(s(32)),c=o(s(28)),f=o(s(59));t.default=class{constructor(){this.container=document.querySelector(".new-channel-container"),this.canvas=this.container.querySelector(".avatar-edit-canvas"),this.uploadAvatar=null;const e=this.container.querySelector(".sidebar-content");this.container.querySelector(".avatar-edit").addEventListener("click",()=>{(new f.default).open(this.canvas,e=>{this.uploadAvatar=e})});const t=document.createElement("div");t.classList.add("input-wrapper"),this.channelNameInputField=new c.default({label:"Channel Name",maxLength:128}),this.channelDescriptionInputField=new c.default({label:"Description (optional)",maxLength:255}),t.append(this.channelNameInputField.container,this.channelDescriptionInputField.container);const s=()=>{this.nextBtn.classList.toggle("is-visible",!!this.channelNameInputField.value.length&&!this.channelNameInputField.input.classList.contains("error")&&!this.channelDescriptionInputField.input.classList.contains("error"))};this.channelNameInputField.input.addEventListener("input",s),this.channelDescriptionInputField.input.addEventListener("input",s);const i=document.createElement("div");i.classList.add("caption"),i.innerText="You can provide an optional description for your channel.",this.nextBtn=l.default("btn-corner btn-circle",{icon:"next"}),e.append(t,i,this.nextBtn),this.nextBtn.addEventListener("click",()=>{const e=this.channelNameInputField.value,t=this.channelDescriptionInputField.value;this.nextBtn.disabled=!0,d.default.createChannel(e,t).then(e=>{this.uploadAvatar&&this.uploadAvatar().then(t=>{d.default.editPhoto(e,t)}),r.default.removeTabFromHistory(r.AppSidebarLeft.SLIDERITEMSIDS.newChannel),r.default.addMembersTab.init(e,"channel",!0)})})}onCloseAfterTimeout(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.uploadAvatar=null,this.channelNameInputField.value="",this.channelDescriptionInputField.value="",this.nextBtn.disabled=!1}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(s(27)),d=o(s(19)),l=o(s(23)),c=o(s(8)),f=s(49),h=o(s(32)),u=o(s(28)),p=o(s(59)),g=o(s(6));t.default=class{constructor(){this.container=document.querySelector(".new-group-container"),this.contentDiv=this.container.querySelector(".sidebar-content"),this.canvas=this.container.querySelector(".avatar-edit-canvas"),this.searchGroup=new f.SearchGroup(" ","contacts",!0,"new-group-members disable-hover",!1),this.uploadAvatar=null,this.container.querySelector(".avatar-edit").addEventListener("click",()=>{(new p.default).open(this.canvas,e=>{this.uploadAvatar=e})});const e=document.createElement("div");e.classList.add("input-wrapper"),this.groupNameInputField=new u.default({label:"Group Name",maxLength:128}),e.append(this.groupNameInputField.container),this.groupNameInputField.input.addEventListener("input",()=>{const e=this.groupNameInputField.value;this.nextBtn.classList.toggle("is-visible",!!e.length&&!this.groupNameInputField.input.classList.contains("error"))}),this.nextBtn=h.default("btn-corner btn-circle",{icon:"next"}),this.nextBtn.addEventListener("click",()=>{const e=this.groupNameInputField.value;this.nextBtn.disabled=!0,d.default.createChat(e,this.userIds).then(e=>{this.uploadAvatar&&this.uploadAvatar().then(t=>{d.default.editPhoto(e,t)}),r.default.selectTab(0)})});const t=document.createElement("div");t.classList.add("chatlist-container"),t.append(this.searchGroup.container);new g.default(t);this.contentDiv.append(e,t,this.nextBtn)}onClose(){}onCloseAfterTimeout(){this.searchGroup.clear();this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.uploadAvatar=null,this.groupNameInputField.value="",this.nextBtn.disabled=!1,this.searchGroup.clear()}init(e){this.userIds=e,r.default.selectTab(r.AppSidebarLeft.SLIDERITEMSIDS.newGroup),this.userIds.forEach(e=>{let{dom:t}=l.default.addDialogNew({dialog:e,container:this.searchGroup.list,drawStatus:!1,rippleEnabled:!1,avatarSize:48}),s="";s=c.default.getUserStatusString(e),"online"==s&&(s=`<i>${s}</i>`),s&&(t.lastMessageSpan.innerHTML=s)}),this.searchGroup.nameEl.innerText=this.userIds.length+" members",this.searchGroup.setActive()}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(4),d=o(s(5)),l=a(s(27)),c=o(s(8)),f=s(0);t.default=class{constructor(){this.container=document.querySelector(".settings-container"),this.avatarElem=this.container.querySelector(".profile-avatar"),this.nameDiv=this.container.querySelector(".profile-name"),this.phoneDiv=this.container.querySelector(".profile-subtitle"),this.logOutBtn=this.container.querySelector(".menu-logout"),this.buttons={},r.parseMenuButtonsTo(this.buttons,this.container.querySelector(".profile-buttons").children),f.attachClickEvent(this.logOutBtn,e=>{d.default.logOut()}),this.buttons.edit.addEventListener("click",()=>{l.default.editProfileTab.fillElements(),l.default.selectTab(l.AppSidebarLeft.SLIDERITEMSIDS.editProfile)}),this.buttons.folders.addEventListener("click",()=>{l.default.selectTab(l.AppSidebarLeft.SLIDERITEMSIDS.chatFolders)})}fillElements(){let e=c.default.getSelf();this.avatarElem.setAttribute("peer",""+e.id),this.nameDiv.innerHTML=e.rFullName||"",this.phoneDiv.innerHTML=e.rPhone||""}onClose(){}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeWaveform=void 0;const n=i(s(21)),a=s(3),o=s(24),r=i(s(46)),d=s(73),l=i(s(50)),c=i(s(9)),f=s(12),h=i(s(7)),u=i(s(1));s(91);const p=s(0),g=s(18);function m(e){e instanceof Uint8Array||(e=new Uint8Array(e));const t=8*e.length/5|0;if(!t)return new Uint8Array([]);let s;try{const i=new DataView(e.buffer);s=new Uint8Array(t);for(let e=0;e<t;e++){const t=5*e/8|0,n=5*e%8,a=i.getUint16(t,!0);s[e]=a>>n&31}}catch(e){s=new Uint8Array([])}return s}u.default.on("messages_media_read",e=>{const{mids:t,peerId:s}=e.detail;t.forEach(e=>{Array.from(document.querySelectorAll('audio-element[message-id="'+e+'"][peer-id="'+s+'"]')).forEach(e=>{e.classList.remove("is-unread")})})}),t.decodeWaveform=m;class b extends HTMLElement{constructor(){super(),this.withTime=!1,this.voiceAsMusic=!1,this.showSender=!1,this.attachedHandlers={}}render(){this.classList.add("audio");const e=this.message.media.document||this.message.media.webpage.document,t="voice"==e.type,s=!this.voiceAsMusic&&t,i=this.message.pFlags.is_outgoing,b=String(0|e.duration).toHHMMSS();this.innerHTML='<div class="audio-toggle audio-ico tgico-largeplay">    \n                         <div class="part one" x="0" y="0" fill="#fff"></div>\n                         <div class="part two" x="0" y="0" fill="#fff"></div>\n                      </div>';const v=document.createElement("div");v.classList.add("audio-download"),!i&&s&&(v.innerHTML='<div class="tgico-download"></div>'),(s||i)&&this.append(v);const y=s?function(e){e.classList.add("is-voice");const t=e.message,s=t.media.document||t.media.webpage.document,i=t.fromId==u.default.myId&&t.peerId!=u.default.myId;let n=t&&t.pFlags.media_unread;n&&e.classList.add("is-unread");const a=c.default.isMobile?2:1,o=c.default.isMobile?3:2,r=c.default.isMobile?16:23,d=c.default.isMobile?152:190,l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.classList.add("audio-waveform"),l.setAttributeNS(null,"width",""+d),l.setAttributeNS(null,"height",""+r),l.setAttributeNS(null,"viewBox",`0 0 ${d} ${r}`);const f=document.createElement("div");f.classList.add("audio-time"),e.append(l,f);let g=s.attributes.find(e=>"documentAttributeAudio"==e._).waveform||new Uint8Array([]);g=m(g.slice(0,63));const b=Math.max(...g),v=g.length?g.length:100,y=Math.min(d/(2+a)|0,v);let M=0;const _=r-o;let w="";for(let e=0,t=0,s=0;e<v;++e){const i=g[e]||0;if(s+y>=v){s=s+y-v,s<(y+1)/2&&M<i&&(M=i);const e=Math.max((M*_+(b+1)/2)/(b+1),o);w+=`\n      <rect x="${t}" y="${r-e}" width="2" height="${e}" rx="1" ry="1"></rect>\n      `,t+=2+a,M=s<(y+1)/2?0:i}else M<i&&(M=i),s+=y}l.insertAdjacentHTML("beforeend",w);const S=Array.from(l.children);let I=e.querySelector(".audio-waveform");return()=>{let t=0,s=0,a=e.audio;(!a.paused||a.currentTime>0&&a.currentTime!=a.duration)&&(s=Math.round(a.currentTime/a.duration*y),S.slice(0,s+1).forEach(e=>e.classList.add("active")));let o=()=>{clearInterval(t),t=window.setInterval(()=>{s>l.childElementCount||isNaN(a.duration)||a.paused?clearInterval(t):(s=Math.round(a.currentTime/a.duration*y),S.slice(0,s+1).forEach(e=>e.classList.add("active")))},20)};a.paused||o(),e.addAudioListener("playing",()=>{n&&!i&&e.classList.contains("is-unread")&&(e.classList.remove("is-unread"),h.default.readMessages(e.message.peerId,[e.message.mid]),n=!1),o()}),e.addAudioListener("pause",()=>{clearInterval(t)}),e.addAudioListener("ended",()=>{clearInterval(t),S.forEach(e=>e.classList.remove("active"))});let r=!1,c=!1;function f(e){let t;if(e instanceof MouseEvent)t=e.offsetX;else{const s=e.target.getBoundingClientRect();t=e.targetTouches[0].pageX-s.left}const i=t/d*a.duration;s=Math.round(i/a.duration*y),S.slice(0,s+1).forEach(e=>e.classList.add("active"));for(let e=s+1;e<S.length;++e)S[e].classList.remove("active");a.currentTime=i}return I.addEventListener("mouseleave",e=>{r&&(a.play(),r=!1),c=!1}),I.addEventListener("mousemove",e=>{c=!0,r&&f(e)}),I.addEventListener("mousedown",e=>{e.preventDefault(),a.paused||(a.pause(),f(e),r=!0)}),I.addEventListener("mouseup",e=>{c&&r&&(a.play(),r=!1)}),p.attachClickEvent(I,e=>{p.cancelEvent(e),a.paused||f(e)}),()=>{clearInterval(t),I.remove(),I=null,a=null}}}(this):function(e){const t=e.withTime,s=e.message,i=s.media.document||s.media.webpage.document,n=e.showSender?h.default.getSenderToPeerText(s):"";let r,l="voice"===i.type?n:i.audioTitle||i.file_name;"voice"===i.type?r="":(r=i.audioPerformer?a.RichTextProcessor.wrapPlainText(i.audioPerformer):"",t?r+=(r?" • ":"")+o.formatDate(i.date):r||(r="Unknown Artist"),e.showSender?r+=" • "+n:r=" • "+r);let c="";e.showSender&&(c=`<div class="sent-time">${g.formatDateAccordingToToday(new Date(1e3*s.date))}</div>`);const f=`\n  <div class="audio-details">\n    <div class="audio-title"><middle-ellipsis-element data-font-weight="${e.dataset.fontWeight}">${l}</middle-ellipsis-element>${c}</div>\n    <div class="audio-subtitle"><div class="audio-time"></div>${r||"<div></div>"}</div>\n  </div>`;return e.insertAdjacentHTML("beforeend",f),()=>{const t=e.querySelector(".audio-subtitle");let s=!1,n=new d.MediaProgressLine(e.audio,i.supportsStreaming);e.addAudioListener("ended",()=>{e.classList.remove("audio-show-progress"),t.lastChild.replaceWith(r),s=!1});const a=()=>{s||(e.classList.add("audio-show-progress"),s=!0,n&&t.lastChild.replaceWith(n.container))};return e.addAudioListener("playing",a),(!e.audio.paused||e.audio.currentTime>0)&&a(),()=>{n.removeListeners(),n.container.remove(),n=null}}}(this),M=this.querySelector(".audio-time");M.innerHTML=b;const _=(e=!0)=>{const t=this.audio=l.default.addMedia(this.message.peerId,this.message.media.document||this.message.media.webpage.document,this.message.mid,e);this.onTypeDisconnect=y();const i=this.querySelector(".audio-toggle"),n=()=>String(0|t.currentTime).toHHMMSS()+(s?" / "+b:""),a=()=>{M.innerText=n(),t.paused||i.classList.add("tgico-largepause")};(!t.paused||t.currentTime>0&&t.currentTime!=t.duration)&&a(),p.attachClickEvent(i,e=>{p.cancelEvent(e),t.paused?t.play().catch(()=>{}):t.pause()}),this.addAudioListener("ended",()=>{i.classList.remove("tgico-largepause")}),this.addAudioListener("timeupdate",()=>{l.default.isSafariBuffering(t)||(M.innerText=n())}),this.addAudioListener("pause",()=>{i.classList.remove("tgico-largepause")}),this.addAudioListener("playing",a)};if(i)this.preloader.attach(v,!1);else{let s=this.preloader;if(t){let t;const i=a=>{a&&p.cancelEvent(a),t?t.cancel():(s||(s=new r.default(null,!0)),t=n.default.downloadDoc(e),s.attach(v,!0,t),t.then(()=>{v.remove(),p.detachClickEvent(this,i),_()}).catch(e=>{"AbortError"===e.name&&(t=null)}).finally(()=>{v.classList.remove("downloading")}),v.classList.add("downloading"))};p.attachClickEvent(this,i),i(null)}else{_(!1);const e=e=>{this.audio.src||(l.default.resolveWaitingForLoadMedia(this.message.peerId,this.message.mid),l.default.willBePlayed(this.audio),s||(s=new r.default(null,!1)),f.isSafari&&(this.audio.autoplay=!0,this.audio.play().catch(()=>{})),s.attach(v,!1),this.append(v),new Promise(e=>{this.audio.readyState>=2?e():this.addAudioListener("canplay",e)}).then(()=>{v.remove(),l.default.willBePlayedMedia===this.audio&&(this.audio.play(),l.default.willBePlayedMedia=null)}))};this.audio.src||p.attachClickEvent(this,e,{once:!0,capture:!0,passive:!1})}}}addAudioListener(e,t){this.attachedHandlers[e]||(this.attachedHandlers[e]=[]),this.attachedHandlers[e].push(t),this.audio.addEventListener(e,t)}disconnectedCallback(){this.onTypeDisconnect&&(this.onTypeDisconnect(),this.onTypeDisconnect=null);for(let e in this.attachedHandlers){for(let t of this.attachedHandlers[e])this.audio.removeEventListener(e,t);delete this.attachedHandlers[e]}this.preloader=null}}t.default=b,customElements.define("audio-element",b)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Layouter=t.RectPart=void 0;const i=s(134),n=s(26);t.RectPart={None:0,Top:1,Right:2,Bottom:4,Left:8};class a{constructor(e,t,s,n,o=t){this.sizes=e,this.maxWidth=t,this.minWidth=s,this.spacing=n,this.maxHeight=o,this.count=e.length,this.ratios=a.countRatios(e),this.proportions=a.countProportions(this.ratios),this.averageRatio=i.accumulate(this.ratios,1)/this.count,this.maxSizeRatio=t/this.maxHeight}layout(){return this.count?this.count>=5||this.ratios.find(e=>e>2)?new o(this.ratios,this.averageRatio,this.maxWidth,this.minWidth,this.spacing).layout():2==this.count?this.layoutTwo():3==this.count?this.layoutThree():this.layoutFour():[]}layoutTwo(){return"ww"==this.proportions&&this.averageRatio>1.4*this.maxSizeRatio&&this.ratios[1]-this.ratios[0]<.2?this.layoutTwoTopBottom():"ww"==this.proportions||"qq"==this.proportions?this.layoutTwoLeftRightEqual():this.layoutTwoLeftRight()}layoutThree(){return"n"==this.proportions[0]?this.layoutThreeLeftAndOther():this.layoutThreeTopAndOther()}layoutFour(){return"w"==this.proportions[0]?this.layoutFourTopAndOther():this.layoutFourLeftAndOther()}layoutTwoTopBottom(){const e=this.maxWidth,s=Math.round(Math.min(e/this.ratios[0],Math.min(e/this.ratios[1],(this.maxHeight-this.spacing)/2)));return[{geometry:{x:0,y:0,width:e,height:s},sides:t.RectPart.Left|t.RectPart.Top|t.RectPart.Right},{geometry:{x:0,y:s+this.spacing,width:e,height:s},sides:t.RectPart.Left|t.RectPart.Bottom|t.RectPart.Right}]}layoutTwoLeftRightEqual(){const e=(this.maxWidth-this.spacing)/2,s=Math.round(Math.min(e/this.ratios[0],Math.min(e/this.ratios[1],1*this.maxHeight)));return[{geometry:{x:0,y:0,width:e,height:s},sides:t.RectPart.Top|t.RectPart.Left|t.RectPart.Bottom},{geometry:{x:e+this.spacing,y:0,width:e,height:s},sides:t.RectPart.Top|t.RectPart.Right|t.RectPart.Bottom}]}layoutTwoLeftRight(){const e=Math.round(1.5*this.minWidth),s=Math.min(Math.round(Math.max(.4*(this.maxWidth-this.spacing),(this.maxWidth-this.spacing)/this.ratios[0]/(1/this.ratios[0]+1/this.ratios[1]))),this.maxWidth-this.spacing-e),i=this.maxWidth-s-this.spacing,n=Math.min(this.maxHeight,Math.round(Math.min(i/this.ratios[0],s/this.ratios[1])));return[{geometry:{x:0,y:0,width:i,height:n},sides:t.RectPart.Top|t.RectPart.Left|t.RectPart.Bottom},{geometry:{x:i+this.spacing,y:0,width:s,height:n},sides:t.RectPart.Top|t.RectPart.Right|t.RectPart.Bottom}]}layoutThreeLeftAndOther(){const e=this.maxHeight,s=Math.round(Math.min((this.maxHeight-this.spacing)/2,this.ratios[1]*(this.maxWidth-this.spacing)/(this.ratios[2]+this.ratios[1]))),i=e-s-this.spacing,n=Math.max(this.minWidth,Math.round(Math.min((this.maxWidth-this.spacing)/2,Math.min(s*this.ratios[2],i*this.ratios[1])))),a=Math.min(Math.round(e*this.ratios[0]),this.maxWidth-this.spacing-n);return[{geometry:{x:0,y:0,width:a,height:e},sides:t.RectPart.Top|t.RectPart.Left|t.RectPart.Bottom},{geometry:{x:a+this.spacing,y:0,width:n,height:i},sides:t.RectPart.Top|t.RectPart.Right},{geometry:{x:a+this.spacing,y:i+this.spacing,width:n,height:s},sides:t.RectPart.Bottom|t.RectPart.Right}]}layoutThreeTopAndOther(){const e=this.maxWidth,s=Math.round(Math.min(e/this.ratios[0],.66*(this.maxHeight-this.spacing))),i=(this.maxWidth-this.spacing)/2,n=Math.min(this.maxHeight-s-this.spacing,Math.round(Math.min(i/this.ratios[1],i/this.ratios[2]))),a=e-i-this.spacing;return[{geometry:{x:0,y:0,width:e,height:s},sides:t.RectPart.Left|t.RectPart.Top|t.RectPart.Right},{geometry:{x:0,y:s+this.spacing,width:i,height:n},sides:t.RectPart.Bottom|t.RectPart.Left},{geometry:{x:i+this.spacing,y:s+this.spacing,width:a,height:n},sides:t.RectPart.Bottom|t.RectPart.Right}]}layoutFourTopAndOther(){const e=this.maxWidth,s=Math.round(Math.min(e/this.ratios[0],.66*(this.maxHeight-this.spacing))),i=Math.round((this.maxWidth-2*this.spacing)/(this.ratios[1]+this.ratios[2]+this.ratios[3])),n=Math.max(this.minWidth,Math.round(Math.min(.4*(this.maxWidth-2*this.spacing),i*this.ratios[1]))),a=Math.round(Math.max(Math.max(1*this.minWidth,.33*(this.maxWidth-2*this.spacing)),i*this.ratios[3])),o=e-n-a-2*this.spacing,r=Math.min(this.maxHeight-s-this.spacing,i);return[{geometry:{x:0,y:0,width:e,height:s},sides:t.RectPart.Left|t.RectPart.Top|t.RectPart.Right},{geometry:{x:0,y:s+this.spacing,width:n,height:r},sides:t.RectPart.Bottom|t.RectPart.Left},{geometry:{x:n+this.spacing,y:s+this.spacing,width:o,height:r},sides:t.RectPart.Bottom},{geometry:{x:n+this.spacing+o+this.spacing,y:s+this.spacing,width:a,height:r},sides:t.RectPart.Right|t.RectPart.Bottom}]}layoutFourLeftAndOther(){const e=this.maxHeight,s=Math.round(Math.min(e*this.ratios[0],.6*(this.maxWidth-this.spacing))),i=Math.round((this.maxHeight-2*this.spacing)/(1/this.ratios[1]+1/this.ratios[2]+1/this.ratios[3])),n=Math.round(i/this.ratios[1]),a=Math.round(i/this.ratios[2]),o=e-n-a-2*this.spacing,r=Math.max(this.minWidth,Math.min(this.maxWidth-s-this.spacing,i));return[{geometry:{x:0,y:0,width:s,height:e},sides:t.RectPart.Top|t.RectPart.Left|t.RectPart.Bottom},{geometry:{x:s+this.spacing,y:0,width:r,height:n},sides:t.RectPart.Top|t.RectPart.Right},{geometry:{x:s+this.spacing,y:n+this.spacing,width:r,height:a},sides:t.RectPart.Right},{geometry:{x:s+this.spacing,y:n+a+2*this.spacing,width:r,height:o},sides:t.RectPart.Bottom|t.RectPart.Right}]}static countRatios(e){return e.map(e=>e.w/e.h)}static countProportions(e){return e.map(e=>e>1.2?"w":e<.8?"n":"q").join("")}}t.Layouter=a;class o{constructor(e,t,s,i,n,a=4*s/3){this.averageRatio=t,this.maxWidth=s,this.minWidth=i,this.spacing=n,this.maxHeight=a,this.ratios=o.cropRatios(e,t),this.count=e.length}static cropRatios(e,t){return e.map(e=>t>1.1?n.clamp(e,1,2.75):n.clamp(e,.6667,1))}layout(){let e=new Array(this.count),s=[];const n=(e,t)=>{const s=this.ratios.slice(e,e+t),n=i.accumulate(s,0);return(this.maxWidth-(t-1)*this.spacing)/n},a=e=>{let t=[],i=0;for(let s of e)t.push(n(i,s)),i+=s;s.push({lineCounts:e,heights:t})};for(let e=1;e!=this.count;++e){const t=this.count-e;e>3||t>3||a([e,t])}for(let e=1;e!=this.count-1;++e)for(let t=1;t!=this.count-e;++t){const s=this.count-e-t;e>3||t>(this.averageRatio<.85?4:3)||s>3||a([e,t,s])}for(let e=1;e!=this.count-1;++e)for(let t=1;t!=this.count-e;++t)for(let s=1;s!=this.count-e-t;++s){const i=this.count-e-t-s;e>3||t>3||s>3||i>3||a([e,t,s,i])}let o=null,r=0;for(const e of s){const{heights:t,lineCounts:s}=e,n=s.length,a=i.accumulate(t,0)+this.spacing*(n-1),d=Math.min(...t),l=(Math.max(...t),d<this.minWidth?1.5:1),c=(()=>{for(let e=1;e!=n;++e)if(s[e-1]>s[e])return 1.5;return 1})(),f=Math.abs(a-this.maxHeight)*l*c;(!o||f<r)&&(o=e,r=f)}const d=o.lineCounts,l=o.heights,c=d.length;let f=0,h=0;for(let s=0;s!=c;++s){const i=d[s],n=l[s],a=Math.round(n);let o=0;for(let r=0;r!=i;++r){const d=t.RectPart.None|(0==s?t.RectPart.Top:t.RectPart.None)|(s==c-1?t.RectPart.Bottom:t.RectPart.None)|(0==r?t.RectPart.Left:t.RectPart.None)|(r==i-1?t.RectPart.Right:t.RectPart.None),l=this.ratios[f],u=r==i-1?this.maxWidth-o:Math.round(l*n);e[f]={geometry:{x:o,y:h,width:u,height:a},sides:d},o+=u+this.spacing,++f}h+=a+this.spacing}return e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.accumulate=t.listMergeSorted=void 0;const i=s(14);t.listMergeSorted=function(e=[],t=[]){const s=i.copy(e),n=e.length?e[e.length-1]:4294967295;for(let e=0;e<t.length;e++)t[e]<n&&s.push(t[e]);return s},t.accumulate=(e,t)=>e.reduce((e,t)=>e+t,t)},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(s(43)),d=o(s(6)),l=o(s(25)),c=s(0),f=o(s(15)),h=o(s(51)),u=o(s(94)),p=o(s(22)),g=s(3),m=s(24),b=a(s(29));t.default=class{constructor(){this.container=document.getElementById("stickers-container"),this.contentDiv=this.container.querySelector(".sidebar-content"),this.backBtn=this.container.querySelector(".sidebar-close-button"),this.setsDiv=this.contentDiv.firstElementChild,this.scrollable=new d.default(this.contentDiv,"STICKERS-SEARCH"),this.lazyLoadQueue=new l.default,this.inputSearch=new r.default("Search Stickers",e=>{this.search(e)}),this.backBtn.parentElement.append(this.inputSearch.container),this.setsDiv.addEventListener("click",e=>{const t=c.findUpClassName(e.target,"sticker-set-sticker");if(t){const e=t.dataset.docId;return void f.default.chat.input.sendMessageWithDocument(e)}const s=c.findUpClassName(e.target,"sticker-set");if(!s)return;const i=s.dataset.stickerSet,n=s.dataset.stickerSet,a=c.findUpClassName(e.target,"sticker-set-button");a?(e.preventDefault(),e.cancelBubble=!0,a.setAttribute("disabled","true"),h.default.getStickerSet({id:i,access_hash:n}).then(e=>{h.default.toggleStickerSet(e.set).then(t=>{t&&(a.innerText=e.set.installed_date?"Added":"Add",a.classList.toggle("gray",!!e.set.installed_date))}).finally(()=>{a.removeAttribute("disabled")})})):h.default.getStickerSet({id:i,access_hash:n}).then(e=>{new u.default(e.set).show()})})}onCloseAfterTimeout(){this.setsDiv.innerHTML="",this.inputSearch.value="",p.default.checkAnimations(void 0,"STICKERS-SEARCH")}renderSet(e){const t=document.createElement("div");t.classList.add("sticker-set");const s=document.createElement("div");s.classList.add("sticker-set-header");const i=document.createElement("div");i.classList.add("sticker-set-details"),i.innerHTML=`\n      <div class="sticker-set-name">${g.RichTextProcessor.wrapEmojiText(e.title)}</div>\n      <div class="sticker-set-count">${e.count} stickers</div>\n    `;const n=document.createElement("button");n.classList.add("btn-primary","sticker-set-button"),n.innerText=e.installed_date?"Added":"Add",e.installed_date&&n.classList.add("gray"),s.append(i,n);const a=document.createElement("div");a.classList.add("sticker-set-stickers");const o=Math.min(5,e.count);for(let e=0;e<o;++e){const e=document.createElement("div");e.classList.add("sticker-set-sticker"),a.append(e)}h.default.getStickerSet(e).then(e=>{for(let t=0;t<o;++t){const s=a.children[t],i=e.documents[t];"documentEmpty"!=i._&&m.wrapSticker({doc:i,div:s,lazyLoadQueue:this.lazyLoadQueue,group:"STICKERS-SEARCH",play:!0,loop:!0,width:68,height:68})}}),t.dataset.stickerSet=e.id,t.dataset.access_hash=e.access_hash,t.dataset.title=e.title,t.append(s,a),this.setsDiv.append(t)}init(){b.default.selectTab(b.AppSidebarRight.SLIDERITEMSIDS.stickers),b.default.toggleSidebar(!0).then(()=>{this.renderFeatured()})}renderFeatured(){return h.default.getFeaturedStickers().then(e=>{this.inputSearch.value||(e=this.filterRendered("",e)).forEach(e=>{this.renderSet(e.set)})})}filterRendered(e,t){t=t.slice();return Array.from(this.setsDiv.children).forEachReverse(s=>{const i=s.dataset.stickerSet,n=t.findIndex(e=>e.set.id==i);-1!==n?t.splice(n,1):e&&s.dataset.title.toLowerCase().includes(e.toLowerCase())||s.remove()}),p.default.checkAnimations(void 0,"STICKERS-SEARCH"),t}search(e){return e?h.default.searchStickerSets(e,!1).then(t=>{this.inputSearch.value==e&&(t=this.filterRendered(e,t)).forEach(e=>{this.renderSet(e.set)})}):this.renderFeatured()}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(s(6)),d=a(s(29)),l=o(s(58)),c=s(93),f=s(3),h=o(s(23)),u=s(17);t.default=class{constructor(){this.container=document.getElementById("poll-results-container"),this.contentDiv=this.container.querySelector(".sidebar-content"),this.closeBtn=this.container.querySelector(".sidebar-close-button"),this.resultsDiv=this.contentDiv.firstElementChild,this.scrollable=new r.default(this.contentDiv,"POLL-RESULTS")}cleanup(){this.resultsDiv.innerHTML="",this.message=void 0}onCloseAfterTimeout(){this.cleanup()}init(e){if(this.message===e)return;this.cleanup(),this.message=e,d.default.selectTab(d.AppSidebarRight.SLIDERITEMSIDS.pollResults);const t=l.default.getPoll(e.media.poll.id),s=document.createElement("h3");s.innerHTML=t.poll.rQuestion;const i=t.results.results.map(e=>e.voters/t.results.total_voters*100);c.roundPercents(i);const n=document.createDocumentFragment();t.results.results.forEach((s,a)=>{if(!s.voters)return;const o=document.createElement("hr"),r=t.poll.answers[a],c=document.createElement("div");c.classList.add("poll-results-answer");const p=document.createElement("div");p.innerHTML=f.RichTextProcessor.wrapEmojiText(r.text);const g=document.createElement("div");g.innerText=Math.round(i[a])+"%",c.append(p,g);const m=document.createElement("ul");m.classList.add("poll-results-voters"),h.default.setListClickListener(m,()=>{d.default.closeTab(d.AppSidebarRight.SLIDERITEMSIDS.pollResults)},void 0,!0),m.style.minHeight=50*Math.min(s.voters,4)+"px",n.append(o,c,m);let b,v=4,y=!1,M=s.voters-4;const _=()=>{y||(y=!0,l.default.getVotes(e,r.option,b,v).then(e=>{e.votes.forEach(e=>{const{dom:t}=h.default.addDialogNew({dialog:e.user_id,container:m,drawStatus:!1,rippleEnabled:!1,meAsSaved:!1,avatarSize:32});t.lastMessageSpan.parentElement.remove()}),b&&(M-=e.votes.length,w.lastElementChild.innerText=`Show ${Math.min(20,M)} more voter${M>1?"s":""}`),b=e.next_offset,v=20,M&&e.votes.length||w.remove()}).finally(()=>{y=!1}))};if(_(),M<=0)return;const w=document.createElement("div");w.classList.add("poll-results-more","show-more"),w.addEventListener("click",_),w.innerHTML=`<div class="tgico-down"></div><div>Show ${Math.min(20,M)} more voter${M>1?"s":""}</div>`,u.ripple(w),n.append(w)}),this.resultsDiv.append(s,n),d.default.toggleSidebar(!0).then(()=>{})}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=r(s(43)),l=r(s(6)),c=r(s(22)),f=a(s(29)),h=r(s(8)),u=r(s(95)),p=r(s(96)),g=s(0),m=r(s(15)),b=r(s(9));t.default=class{constructor(){this.container=document.getElementById("search-gifs-container"),this.contentDiv=this.container.querySelector(".sidebar-content"),this.backBtn=this.container.querySelector(".sidebar-close-button"),this.gifsDiv=this.contentDiv.firstElementChild,this.nextOffset="",this.loadedAll=!1,this.onGifsClick=e=>{const t=g.findUpClassName(e.target,"gif");if(!t)return;const s=t.dataset.docId;m.default.chat.input.sendMessageWithDocument(s)?b.default.isMobile&&f.default.closeTab(f.AppSidebarRight.SLIDERITEMSIDS.gifs):console.warn("got no doc by id:",s)},this.scrollable=new l.default(this.contentDiv,"GIFS-SEARCH"),this.masonry=new p.default(this.gifsDiv,"GIFS-SEARCH",this.scrollable),this.inputSearch=new d.default("Search GIFs",e=>{this.reset(),this.search(e)}),this.gifsDiv.addEventListener("click",this.onGifsClick),this.backBtn.parentElement.append(this.inputSearch.container)}onClose(){this.scrollable.onScrolledBottom=()=>{}}onCloseAfterTimeout(){this.reset(),this.gifsDiv.innerHTML="",this.inputSearch.value="",c.default.checkAnimations(void 0,"GIFS-SEARCH")}reset(){this.searchPromise=null,this.nextOffset="",this.loadedAll=!1,this.masonry.lazyLoadQueue.clear()}init(){f.default.selectTab(f.AppSidebarRight.SLIDERITEMSIDS.gifs),f.default.toggleSidebar(!0).then(()=>{this.search("",!0),this.reset(),this.scrollable.onScrolledBottom=()=>{this.search(this.inputSearch.value,!1)}})}search(e,t=!0){return o(this,void 0,void 0,(function*(){if(!this.searchPromise&&!this.loadedAll){this.gifBotPeerId||(this.gifBotPeerId=(yield h.default.resolveUsername("gif")).id);try{this.searchPromise=u.default.getInlineResults(0,this.gifBotPeerId,e,this.nextOffset);const{results:s,next_offset:i}=yield this.searchPromise;if(this.inputSearch.value!=e)return;this.searchPromise=null,this.nextOffset=i,t&&(this.gifsDiv.innerHTML=""),s.length?s.forEach(e=>{"botInlineMediaResult"===e._&&e.document&&this.masonry.add(e.document)}):this.loadedAll=!0,this.scrollable.onScroll()}catch(e){throw this.searchPromise=null,new Error(JSON.stringify(e))}}}))}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(s(29)),d=a(s(49)),l=o(s(43));t.default=class{constructor(){this.peerId=0,this.threadId=0}onOpenAfterTimeout(){this.appSearch.beginSearch(this.peerId,this.threadId)}onCloseAfterTimeout(){this.peerId=0,this.threadId=0,this.appSearch.reset()}init(){this.container=document.getElementById("search-private-container"),this.closeBtn=this.container.querySelector(".sidebar-close-button"),this.inputSearch=new l.default("Search"),this.closeBtn.parentElement.append(this.inputSearch.container),this.appSearch=new d.default(this.container.querySelector(".chatlist-container"),this.inputSearch,{messages:new d.SearchGroup("Private Search","messages")})}open(e,t){this.init&&(this.init(),this.init=null),0===this.peerId?(this.peerId=e,this.threadId=t,r.default.selectTab(r.AppSidebarRight.SLIDERITEMSIDS.search),r.default.toggleSidebar(!0)):this.appSearch.beginSearch(this.peerId,this.threadId)}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(15)),a=i(s(7)),o=i(s(10)),r=i(s(39)),d=i(s(8)),l=s(16),c=s(3),f=i(s(1)),h=i(s(90)),u=i(s(6));let p=(e,t)=>{window.requestAnimationFrame(()=>{t.childElementCount>1&&t.firstElementChild.remove();let s=document.createElement("p");s.innerHTML=e,t.prepend(s),t.style.display=""})};t.default=class{constructor(){this.peerId=0,this.threadId=0,this.profileElements={},this.historiesStorage={},this.scroll=null,this.log=l.logger("SM"),this.setPeerStatus=(e=!1)=>{if(!this.peerId)return;const t=this.peerId;e&&(this.profileElements.subtitle.innerHTML=""),n.default.getPeerStatus(this.peerId).then(e=>{t==this.peerId&&(this.profileElements.subtitle.innerHTML=e)})}}init(){this.container=document.getElementById("shared-media-container"),this.closeBtn=this.container.querySelector(".sidebar-close-button"),this.profileContentEl=this.container.querySelector(".profile-content"),this.profileElements={avatar:this.profileContentEl.querySelector(".profile-avatar"),name:this.profileContentEl.querySelector(".profile-name"),subtitle:this.profileContentEl.querySelector(".profile-subtitle"),bio:this.profileContentEl.querySelector(".profile-row-bio"),username:this.profileContentEl.querySelector(".profile-row-username"),phone:this.profileContentEl.querySelector(".profile-row-phone"),notificationsRow:this.profileContentEl.querySelector(".profile-row-notifications"),notificationsCheckbox:this.profileContentEl.querySelector("#profile-notifications"),notificationsStatus:this.profileContentEl.querySelector(".profile-row-notifications > p")},this.scroll=new u.default(this.container,"SR",400),this.profileElements.notificationsCheckbox.addEventListener("change",()=>{a.default.mutePeer(this.peerId)}),f.default.on("dialog_notify_settings",e=>{if(this.peerId==e.detail){const e=a.default.isPeerMuted(this.peerId);this.profileElements.notificationsCheckbox.checked=!e,this.profileElements.notificationsStatus.innerText=e?"Disabled":"Enabled"}}),f.default.on("peer_typings",e=>{const{peerId:t}=e.detail;this.peerId==t&&this.setPeerStatus()}),f.default.on("user_update",e=>{const t=e.detail;this.peerId==t&&this.setPeerStatus()}),this.setPeerStatusInterval=window.setInterval(this.setPeerStatus,6e4),this.searchSuper=new h.default([{inputFilter:"inputMessagesFilterPhotoVideo",name:"Media"},{inputFilter:"inputMessagesFilterDocument",name:"Files"},{inputFilter:"inputMessagesFilterUrl",name:"Links"},{inputFilter:"inputMessagesFilterMusic",name:"Music"}],this.scroll),this.profileContentEl.append(this.searchSuper.container)}renderNewMessages(e,t){if(!this.init&&this.historiesStorage[e]){t=t.slice().reverse();for(const s of this.searchSuper.types){const i=s.inputFilter,n=this.searchSuper.filterMessagesByType(t.map(t=>a.default.getMessageByPeer(e,t)),i);if(n.length){this.historiesStorage[e][i]&&this.historiesStorage[e][i].unshift(...n.map(e=>({mid:e.mid,peerId:e.peerId}))),this.peerId==e&&-1!==this.searchSuper.usedFromHistory[i]&&(this.searchSuper.usedFromHistory[i]+=n.length,this.searchSuper.performSearchResult(n,i,!1));break}}}}deleteDeletedMessages(e,t){if(!this.init&&this.historiesStorage[e]){for(const s of t)for(const t of this.searchSuper.types){const i=t.inputFilter;if(!this.historiesStorage[e][i])continue;const n=this.historiesStorage[e][i],a=n.findIndex(e=>e.mid===s);if(-1!==a){if(n.splice(a,1),this.peerId==e){const t=this.searchSuper.tabs[i].querySelector(`div[data-mid="${s}"][data-peer-id="${e}"]`);t&&t.remove(),this.searchSuper.usedFromHistory[i]>=a+1&&this.searchSuper.usedFromHistory[i]--}break}}this.scroll.onScroll()}}cleanupHTML(){this.profileElements.bio.style.display="none",this.profileElements.phone.style.display="none",this.profileElements.username.style.display="none",this.profileElements.notificationsRow.style.display="",this.profileElements.notificationsCheckbox.checked=!0,this.profileElements.notificationsStatus.innerText="Enabled",this.searchSuper.cleanupHTML(),this.searchSuper.selectTab(0,!1)}setLoadMutex(e){this.searchSuper.loadMutex=e}setPeer(e,t=0){var s;this.peerId===e&&this.threadId===e||(this.init&&(this.init(),this.init=null),this.peerId=e,this.threadId=t,this.searchSuper.setQuery({peerId:e,historyStorage:null!==(s=this.historiesStorage[e])&&void 0!==s?s:this.historiesStorage[e]={}}),this.cleaned=!0)}loadSidebarMedia(e){this.searchSuper.load(e)}fillProfileElements(){if(!this.cleaned)return;this.cleaned=!1;const e=this.peerId,t=this.threadId;if(this.cleanupHTML(),this.profileElements.avatar.setAttribute("peer",""+e),e!=f.default.myId){o.default.getPeerUsername(e)&&p(o.default.getPeerUsername(e),this.profileElements.username);const t=a.default.isPeerMuted(e);this.profileElements.notificationsCheckbox.checked=!t,this.profileElements.notificationsStatus.innerText=t?"Disabled":"Enabled"}else window.requestAnimationFrame(()=>{this.profileElements.notificationsRow.style.display="none"});if(e>0){let s=d.default.getUser(e);s.phone&&e!=f.default.myId&&p(s.rPhone,this.profileElements.phone),r.default.getProfile(e).then(s=>{this.peerId===e&&this.threadId===t?s.rAbout&&e!=f.default.myId&&p(s.rAbout,this.profileElements.bio):this.log.warn("peer changed")})}else{let s=o.default.getPeer(e);r.default.getChatFull(s.id).then(s=>{this.peerId===e&&this.threadId===t?s.about&&p(c.RichTextProcessor.wrapRichText(s.about),this.profileElements.bio):this.log.warn("peer changed")})}let s;s=e==f.default.myId?"Saved Messages":o.default.getPeerTitle(e),this.profileElements.name.innerHTML=s,this.setPeerStatus(!0)}onOpenAfterTimeout(){this.scroll.onScroll()}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(s(54)),d=s(16),l=o(s(1)),c=a(s(29)),f=o(s(141)),h=o(s(145)),u=o(s(147)),p=o(s(155)),g=o(s(156)),m=s(2);class b extends r.default{constructor(e,t,s,i,n,a,o,r,l,c,f,h,u){super(),this.appImManager=e,this.appChatsManager=t,this.appDocsManager=s,this.appInlineBotsManager=i,this.appMessagesManager=n,this.appPeersManager=a,this.appPhotosManager=o,this.appProfileManager=r,this.appStickersManager=l,this.appUsersManager=c,this.appWebPagesManager=f,this.appPollsManager=h,this.apiManager=u,this.peerId=0,this.type="chat",this.container=document.createElement("div"),this.container.classList.add("chat"),this.backgroundEl=document.createElement("div"),this.backgroundEl.classList.add("chat-background"),this.log=d.logger("CHAT",d.LogLevels.log|d.LogLevels.warn|d.LogLevels.debug|d.LogLevels.error),this.container.append(this.backgroundEl),this.appImManager.chatsContainer.append(this.container)}setType(e){this.type=e,"scheduled"===this.type&&(this.getMessagesStorage=()=>this.appMessagesManager.getScheduledMessagesStorage(this.peerId))}init(){this.topbar=new g.default(this,c.default,this.appMessagesManager,this.appPeersManager,this.appChatsManager),this.bubbles=new f.default(this,this.appMessagesManager,this.appStickersManager,this.appUsersManager,this.appInlineBotsManager,this.appPhotosManager,this.appDocsManager,this.appPeersManager,this.appChatsManager),this.input=new u.default(this,this.appMessagesManager,this.appDocsManager,this.appChatsManager,this.appPeersManager,this.appWebPagesManager,this.appImManager),this.selection=new p.default(this,this.bubbles,this.input,this.appMessagesManager),this.contextMenu=new h.default(this.bubbles.bubblesContainer,this,this.appMessagesManager,this.appChatsManager,this.appPeersManager,this.appPollsManager),"chat"===this.type?(this.topbar.constructUtils(),this.topbar.constructPeerHelpers()):"pinned"===this.type?this.topbar.constructPinnedHelpers():"discussion"===this.type&&(this.topbar.constructUtils(),this.topbar.constructDiscussionHelpers()),this.topbar.construct(),this.input.construct(),"chat"===this.type?(this.bubbles.constructPeerHelpers(),this.input.constructPeerHelpers()):"pinned"===this.type?(this.bubbles.constructPinnedHelpers(),this.input.constructPinnedHelpers()):"scheduled"===this.type?(this.bubbles.constructScheduledHelpers(),this.input.constructPeerHelpers()):"discussion"===this.type&&(this.bubbles.constructPeerHelpers(),this.input.constructPeerHelpers()),this.container.classList.add("type-"+this.type),this.container.append(this.topbar.container,this.bubbles.bubblesContainer,this.input.chatInput)}destroy(){this.topbar.destroy(),this.bubbles.destroy(),this.input.destroy(),delete this.topbar,delete this.bubbles,delete this.input,delete this.selection,delete this.contextMenu,this.container.remove()}cleanup(){this.input.cleanup(),this.selection.cleanup(),this.peerChanged=!1}setPeer(e,t){if(this.init&&(this.init(),this.init=null),0==e)return c.default.toggleSidebar(!1),this.peerId=e,this.cleanup(),this.topbar.setPeer(e),this.bubbles.setPeer(e),void l.default.broadcast("peer_changed",e);this.peerId==e?this.peerChanged=!0:(c.default.historyTabIds[c.default.historyTabIds.length-1]==c.AppSidebarRight.SLIDERITEMSIDS.search&&c.default.closeTab(c.AppSidebarRight.SLIDERITEMSIDS.search),this.peerId=e,c.default.sharedMediaTab.setPeer(e,this.threadId),this.cleanup());const s=this.bubbles.setPeer(e,t);if(!s)return;const{promise:i}=s;return this.setPeerPromise=i.finally(()=>{this.peerId==e&&(this.setPeerPromise=null)}),c.default.sharedMediaTab.setLoadMutex(this.setPeerPromise),c.default.sharedMediaTab.loadSidebarMedia(!0),s}finishPeerChange(e,t,s){if(this.peerChanged)return;let i=this.peerId;this.peerChanged=!0,this.topbar.setPeer(i),this.topbar.finishPeerChange(e,t,s),this.bubbles.finishPeerChange(),this.input.finishPeerChange(),c.default.sharedMediaTab.fillProfileElements(),this.log.setPrefix("CHAT-"+i+"-"+this.type),l.default.broadcast("peer_changed",i)}getMessagesStorage(){return this.appMessagesManager.getMessagesStorage(this.peerId)}getMessage(e){return this.appMessagesManager.getMessageFromStorage(this.getMessagesStorage(),e)}getMidsByMid(e){return this.appMessagesManager.getMidsByMessage(this.getMessage(e))}isAnyGroup(){return this.peerId===l.default.myId||this.peerId===m.REPLIES_PEER_ID||this.appPeersManager.isAnyGroup(this.peerId)}}t.default=b},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(15),a=s(0),o=s(14),r=s(11),d=i(s(1)),l=i(s(71)),c=i(s(142)),f=i(s(75)),h=i(s(52)),u=i(s(94)),p=i(s(46)),g=i(s(6)),m=i(s(97)),b=i(s(22)),v=s(18),y=i(s(3)),M=i(s(9)),_=s(12),w=s(84),S=i(s(42)),I=s(4),L=s(17),E=s(24),C=s(143),T=i(s(25)),P=i(s(60)),k=s(2),x=["messageActionHistoryClear"];let A=void 0,D=0;t.default=class{constructor(e,t,s,i,n,g,b,v,y){this.chat=e,this.appMessagesManager=t,this.appStickersManager=s,this.appUsersManager=i,this.appInlineBotsManager=n,this.appPhotosManager=g,this.appDocsManager=b,this.appPeersManager=v,this.appChatsManager=y,this.peerId=0,this.unreadOut=new Set,this.needUpdate=[],this.bubbles={},this.dateMessages={},this.scrolledDown=!0,this.isScrollingTimeout=0,this.unreaded=[],this.preloader=null,this.loadedTopTimes=0,this.loadedBottomTimes=0,this.messagesQueuePromise=null,this.messagesQueue=[],this.messagesQueueOnRender=null,this.firstUnreadBubble=null,this.cleanupObj={cleaned:!1},this.replyFollowHistory=[],this.onBubblesClick=e=>{var t,s;let i=e.target,n=null;try{n=a.findUpClassName(i,"bubble")}catch(e){}if(!n)return;if(n.classList.contains("is-date")&&a.findUpClassName(i,"bubble__container")){if(n.classList.contains("is-sticky")&&!this.chatInner.classList.contains("is-scrolling"))return;for(const e in this.dateMessages){if(this.dateMessages[e].div==n){new f.default(new Date(+e),this.onDatePick).show();break}}return}if(this.chat.selection.isSelecting&&e.isTrusted){if(n.classList.contains("service")&&void 0===n.dataset.mid)return;return a.cancelEvent(e),r.isTouchSupported&&this.chat.selection.selectedText?void(this.chat.selection.selectedText=void 0):void this.chat.selection.toggleByBubble(a.findUpClassName(i,"grouped-item")||n)}const o=a.findUpClassName(i,"contact");if(o)return void this.chat.appImManager.setInnerPeer(+o.dataset.peerId);if(a.findUpClassName(i,"replies")){const e=+n.dataset.mid;if(this.peerId===k.REPLIES_PEER_ID){const t=this.chat.getMessage(e),s=this.appPeersManager.getPeerId(t.reply_to.reply_to_peer_id),i=t.reply_to.reply_to_top_id;this.appMessagesManager.wrapSingleMessage(s,i).then(()=>{this.appMessagesManager.generateThreadServiceStartMessage(this.appMessagesManager.getMessageByPeer(s,i)),this.chat.appImManager.setInnerPeer(s,t.fwd_from.saved_from_msg_id,"discussion",i)})}else{const t=this.appMessagesManager.filterMessages(this.chat.getMessage(e),e=>!!e.replies)[0],s=t.replies;s&&this.appMessagesManager.getDiscussionMessage(this.peerId,t.mid).then(e=>{this.chat.appImManager.setInnerPeer(-s.channel_id,void 0,"discussion",e.mid)})}return}const d="SPAN"==i.tagName;if(n.classList.contains("sticker")&&i.parentElement.classList.contains("attachment")){const e=+n.dataset.mid,s=null===(t=this.chat.getMessage(e).media)||void 0===t?void 0:t.document;(null==s?void 0:s.stickerSetInput)&&new u.default(s.stickerSetInput).show()}else{if("IMG"==i.tagName&&!i.classList.contains("emoji")&&"AVATAR-ELEMENT"!=i.parentElement.tagName&&!i.classList.contains("document-thumb")||i.classList.contains("album-item")||d||"VIDEO"==i.tagName&&!n.classList.contains("round")){let t=+(null===(s=a.findUpClassName(i,"album-item"))||void 0===s?void 0:s.dataset.mid)||+n.dataset.mid,o=this.chat.getMessage(t);if(!o)return void this.log.warn("no message by messageId:",t);let r=[],d=Object.keys(this.bubbles).map(e=>+e).filter(e=>{let t=this.chat.getMessage(e);return t.media&&(t.media.photo||t.media.document&&("video"==t.media.document.type||"gif"==t.media.document.type)||t.media.webpage&&(t.media.webpage.document||t.media.webpage.photo))}).sort((e,t)=>e-t);d.forEach(e=>{let t=".album-item img, .album-item video, .preview img, .preview video, ";t+=this.bubbles[e].classList.contains("with-media-tail")?".bubble__media-container":".attachment img, .attachment video";let s=this.bubbles[e].querySelectorAll(t);Array.from(s).forEach(t=>{let s=a.findUpClassName(t,"album-item");r.push({element:t,mid:+(null==s?void 0:s.dataset.mid)||e,peerId:this.peerId})})}),r.sort((e,t)=>e.mid-t.mid);let c=r.findIndex(e=>e.mid==t);return this.log("open mediaViewer single with ids:",d,c,r),r[c]?((new l.default).setSearchContext({threadId:this.chat.threadId,peerId:this.peerId,inputFilter:"inputMessagesFilterPhotoVideo"}).openMedia(o,r[c].element,0,!0,r.slice(0,c),r.slice(c+1)),void a.cancelEvent(e)):void this.log("no target for media viewer!",i)}if(-1===["IMG","DIV","AVATAR-ELEMENT"].indexOf(i.tagName)&&(i=a.findUpTag(i,"DIV")),"DIV"==i.tagName||"AVATAR-ELEMENT"==i.tagName){if(i.classList.contains("goto-original")){const e=n.dataset.savedFrom.split("_"),t=+e[0],s=+e[1];return void this.chat.appImManager.setInnerPeer(t,s)}if(i.classList.contains("forward")){const e=+n.dataset.mid;return void new h.default(this.peerId,[e])}if(i.classList.contains("name")){const e=+i.dataset.peerId;return void(e&&this.chat.appImManager.setInnerPeer(e))}if("AVATAR-ELEMENT"==i.tagName){const e=+i.getAttribute("peer");return void(e&&this.chat.appImManager.setInnerPeer(e))}let t=!1;try{t=!!a.findUpClassName(e.target,"reply")}catch(e){}if(t&&n.classList.contains("is-reply")){const e=+n.dataset.mid;this.replyFollowHistory.push(e);const t=this.chat.getMessage(e),s=t.reply_to.reply_to_peer_id?this.appPeersManager.getPeerId(t.reply_to.reply_to_peer_id):this.peerId,i=t.reply_to.reply_to_msg_id;this.chat.appImManager.setInnerPeer(s,i,this.chat.type,this.chat.threadId)}}else if("IMG"==i.tagName&&"AVATAR-ELEMENT"==i.parentElement.tagName){let e=+i.parentElement.getAttribute("peer");e&&this.chat.appImManager.setInnerPeer(e)}}},this.onScroll=()=>{this.scrollable.scrollLocked&&this.scrolledDown||(r.isTouchSupported||(this.isScrollingTimeout?clearTimeout(this.isScrollingTimeout):this.chatInner.classList.contains("is-scrolling")||this.chatInner.classList.add("is-scrolling"),this.isScrollingTimeout=window.setTimeout(()=>{this.chatInner.classList.remove("is-scrolling"),this.isScrollingTimeout=0},1350)),this.scrollable.isScrolledDown?(this.bubblesContainer.classList.add("scrolled-down"),this.scrolledDown=!0):this.bubblesContainer.classList.contains("scrolled-down")&&(this.bubblesContainer.classList.remove("scrolled-down"),this.scrolledDown=!1),this.chat.topbar.pinnedMessage&&this.chat.topbar.pinnedMessage.setCorrectIndex(this.scrollable.lastScrollDirection))},this.onDatePick=e=>{const t=this.peerId;this.appMessagesManager.requestHistory(t,0,2,-1,e,this.chat.threadId).then(e=>{var s;(null===(s=null==e?void 0:e.messages)||void 0===s?void 0:s.length)?this.peerId==t&&this.chat.setPeer(this.peerId,e.messages[0].mid):this.log.error("no history!")})},this.listenerSetter=new P.default,this.bubblesContainer=document.createElement("div"),this.bubblesContainer.classList.add("bubbles","scrolled-down"),this.chatInner=document.createElement("div"),this.chatInner.classList.add("bubbles-inner"),this.bubblesContainer.append(this.chatInner),this.setScroll(),this.log=this.chat.log,this.bubbleGroups=new c.default(this.chat),this.preloader=new p.default(null,!1),this.lazyLoadQueue=new T.default,this.lazyLoadQueue.queueId=++D,this.listenerSetter.add(d.default,"history_update",e=>{const{storage:t,peerId:s,mid:i}=e.detail;if(i&&s==this.peerId&&this.chat.getMessagesStorage()===t){const e=this.bubbles[i];if(!e)return;const t=this.chat.getMessage(i);this.bubbleGroups.removeBubble(e,t.mid),this.setBubblePosition(e,t,!1),this.bubbleGroups.addBubble(e,t,!1)}}),this.listenerSetter.add(d.default,"dialog_flush",e=>{let t=e.detail.peerId;this.peerId==t&&this.deleteMessagesByIds(Object.keys(this.bubbles).map(e=>+e))}),this.listenerSetter.add(d.default,"message_sent",e=>{var t,s,i,n;const{storage:a,tempId:o,tempMessage:r,mid:l}=e.detail;if(this.chat.getMessagesStorage()!==a)return;this.log("message_sent",e.detail);const c=this.getMountedBubble(o,r)||this.getMountedBubble(l);if(c){const e=this.chat.getMessage(l),a=c.bubble;if((null===(t=e.media)||void 0===t?void 0:t.document)&&!e.media.document.type){const t=a.querySelector(`.document-container[data-mid="${o}"] .document`);t&&t.replaceWith(E.wrapDocument({message:e}))}if(e.grouped_id){(a.querySelector(`.grouped-item[data-mid="${o}"]`)||a).dataset.mid=""+l}if(null===(s=e.media)||void 0===s?void 0:s.poll){const t=e.media.poll,s=a.querySelector("poll-element");s&&(s.message=e,s.setAttribute("poll-id",t.id),s.setAttribute("message-id",""+l))}if((null===(i=e.media)||void 0===i?void 0:i.document)&&["audio","voice"].includes(e.media.document.type)){const t=a.querySelector(`audio-element[message-id="${o}"]`);t.setAttribute("doc-id",e.media.document.id),t.setAttribute("message-id",""+l),t.message=e}(null===(n=e.media)||void 0===n?void 0:n.webpage)&&!a.querySelector(".web")&&this.renderMessage(e,!0,!1,a,!1)}else this.log.warn("message_sent there is no bubble",e.detail);if(this.bubbles[o]){const e=this.bubbles[o];this.bubbles[l]=e,delete this.bubbles[o],e.classList.remove("is-sending"),e.classList.add(this.peerId===d.default.myId&&"scheduled"!==this.chat.type?"is-read":"is-sent"),e.dataset.mid=""+l,this.bubbleGroups.removeBubble(e,o)}if(this.unreadOut.has(o)&&(this.unreadOut.delete(o),this.unreadOut.add(l)),"scheduled"===this.chat.type){const e=Date.now()/1e3|0,t=r.date-10;this.log("scheduled timing:",e,t),e>=t&&this.deleteMessagesByIds([l])}}),this.listenerSetter.add(d.default,"message_edit",e=>{const{storage:t,peerId:s,mid:i}=e.detail;if(s!=this.peerId||t!==this.chat.getMessagesStorage())return;const n=this.getMountedBubble(i);if(!n)return;const a="scheduled"===this.chat.type;this.renderMessage(n.message,!0,!1,n.bubble,a),a&&(this.messagesQueuePromise||Promise.resolve()).then(()=>{this.deleteEmptyDateGroups()})}),this.listenerSetter.add(d.default,"album_edit",e=>{const{peerId:t,groupId:s,deletedMids:i}=e.detail;if(t!=this.peerId)return;const n=this.appMessagesManager.getMidsByAlbum(s).concat(i).find(e=>this.bubbles[e]);if(!n)return;const a=o.getObjectKeysAndSort(this.appMessagesManager.groupedMessagesStorage[s],"asc").pop();this.renderMessage(this.chat.getMessage(a),!0,!1,this.bubbles[n],!1)}),this.listenerSetter.add(d.default,"messages_downloaded",e=>{const{peerId:t,mids:s}=e.detail;s.forEach(e=>{this.needUpdate.forEachReverse((e,s)=>{if(e.replyMid,e.replyToPeerId===t){const{mid:t,replyMid:i}=this.needUpdate.splice(s,1)[0],n=this.bubbles[t];if(!n)return;const a=this.chat.getMessage(t);this.appMessagesManager.getMessageByPeer(e.replyToPeerId,i).deleted&&delete a.reply_to_mid,this.renderMessage(a,!0,!1,n,!1)}})})}),this.listenerSetter.add(d.default,"dialog_drop",e=>{e.detail.peerId==this.peerId&&this.chat.appImManager.setPeer(0)}),this.listenerSetter.add(this.bubblesContainer,"click",this.onBubblesClick),k.DEBUG&&this.listenerSetter.add(this.bubblesContainer,"dblclick",e=>{const t=a.findUpClassName(e.target,"grouped-item")||a.findUpClassName(e.target,"bubble");if(t){const e=+t.dataset.mid;this.log("debug message:",this.chat.getMessage(e)),this.chat.bubbles.highlightBubble(t)}}),this.stickyIntersector=new m.default(this.scrollable.container,(e,t)=>{for(const s in this.dateMessages){const i=this.dateMessages[s];if(i.container==t){i.div.classList.toggle("is-sticky",e);break}}})}constructPeerHelpers(){this.listenerSetter.add(d.default,"history_append",e=>{let t=e.detail;this.scrolledAllDown?this.renderNewMessagesByIds([t.messageId],!0):this.chat.setPeer(this.peerId,0)}),this.listenerSetter.add(d.default,"history_multiappend",e=>{const t=e.detail;if(!(this.peerId in t))return;const s=t[this.peerId];this.renderNewMessagesByIds(s)}),this.listenerSetter.add(d.default,"history_delete",e=>{const{peerId:t,msgs:s}=e.detail,i=Object.keys(s).map(e=>+e);t===this.peerId&&this.deleteMessagesByIds(i)}),this.listenerSetter.add(d.default,"dialog_unread",e=>{e.detail.peerId===this.peerId&&(this.chat.input.setUnreadCount(),this.updateUnreadByDialog())}),this.listenerSetter.add(d.default,"dialogs_multiupdate",e=>{e.detail[this.peerId]&&this.chat.input.setUnreadCount()}),this.listenerSetter.add(d.default,"dialog_notify_settings",e=>{const t=e.detail;this.peerId===t&&this.chat.input.setUnreadCount()}),this.unreadedObserver=new IntersectionObserver(e=>{if(this.chat.appImManager.offline)return;const t=[];if(e.forEach(e=>{if(e.isIntersecting){const s=e.target,i=+s.dataset.mid;t.push(i),this.unreadedObserver.unobserve(s),this.unreaded.findAndSplice(e=>e==i)}}),t.length){const e=Math.max(...t);let s=t.length;for(let t=this.unreaded.length-1;t>=0;--t){this.unreaded[t]<e&&(s++,this.unreaded.splice(t,1))}this.log("will readHistory by ids:",e,s),this.appMessagesManager.readHistory(this.peerId,e,this.chat.threadId).catch(t=>{this.log.error("readHistory err:",t),this.appMessagesManager.readHistory(this.peerId,e,this.chat.threadId)})}})}constructPinnedHelpers(){this.listenerSetter.add(d.default,"peer_pinned_messages",e=>{const{peerId:t,mids:s,pinned:i}=e.detail;t===this.peerId&&s&&(i||this.deleteMessagesByIds(s))})}constructScheduledHelpers(){const e=()=>{this.chat.topbar.setTitle(Object.keys(this.appMessagesManager.getScheduledMessagesStorage(this.peerId)).length)};this.listenerSetter.add(d.default,"scheduled_new",t=>{const{peerId:s,mid:i}=t.detail;s===this.peerId&&(this.renderNewMessagesByIds([i]),e())}),this.listenerSetter.add(d.default,"scheduled_delete",t=>{const{peerId:s,mids:i}=t.detail;s===this.peerId&&(this.deleteMessagesByIds(i),e())})}onGoDownClick(){if(this.replyFollowHistory.length){this.replyFollowHistory.forEachReverse((e,t)=>{const s=this.bubbles[e];let i=!0;if(s){const e=s.getBoundingClientRect();i=this.appPhotosManager.windowH/2>e.top}else{this.chat.getMessage(e).deleted||(i=!1)}i&&this.replyFollowHistory.splice(t,1)}),this.replyFollowHistory.sort((e,t)=>t-e);const e=this.replyFollowHistory.pop();this.chat.setPeer(this.peerId,e)}else this.chat.setPeer(this.peerId)}getGroupedBubble(e){const t=this.appMessagesManager.groupedMessagesStorage[e];for(const e in t)if(this.bubbles[e]){const s=Math.max(...Object.keys(t).map(e=>+e));return{bubble:this.bubbles[e],mid:+e,message:this.chat.getMessage(s)}}return null}getBubbleGroupedItems(e){return Array.from(e.querySelectorAll(".grouped-item"))}getMountedBubble(e,t=this.chat.getMessage(e)){if(t.grouped_id&&this.appMessagesManager.getMidsByAlbum(t.grouped_id).length>1){const s=this.getGroupedBubble(t.grouped_id);if(s)return s.bubble=s.bubble.querySelector(`.document-container[data-mid="${e}"]`)||s.bubble,s}const s=this.bubbles[e];if(s)return{bubble:s,mid:e,message:t}}findNextMountedBubbleByMsgId(e){return this.bubbles[o.getObjectKeysAndSort(this.bubbles).find(t=>{var s;return!(t<e)&&!!(null===(s=this.bubbles[t])||void 0===s?void 0:s.parentElement)})]}loadMoreHistory(e,t=!1){if(!this.peerId||this.chat.setPeerPromise||e&&this.getHistoryTopPromise||!e&&this.getHistoryBottomPromise)return;const s=Object.keys(this.bubbles).map(e=>+e).sort((e,t)=>e-t);if(!s.length)return;if(e&&!this.scrolledAll&&(this.log("Will load more (up) history by id:",s[0],"maxId:",s[s.length-1],s),this.getHistory(s[0],!0,void 0,void 0,t)),this.scrolledAllDown)return;const i=this.appMessagesManager.getHistoryStorage(this.peerId,this.chat.threadId);e||-1!==s.indexOf(i.maxId)||(this.log("Will load more (down) history by maxId:",s[s.length-1],s),this.getHistory(s[s.length-1],!1,!0,void 0,t))}setScroll(){this.scrollable=new g.default(this.bubblesContainer,"IM",300),this.scroll=this.scrollable.container,this.scrollable.onAdditionalScroll=this.onScroll,this.scrollable.onScrolledTop=()=>this.loadMoreHistory(!0),this.scrollable.onScrolledBottom=()=>this.loadMoreHistory(!1),this.bubblesContainer.classList.add("scrolled-down"),r.isTouchSupported&&(this.scroll.addEventListener("touchmove",()=>{this.isScrollingTimeout?clearTimeout(this.isScrollingTimeout):this.chatInner.classList.contains("is-scrolling")||this.chatInner.classList.add("is-scrolling")},{passive:!0}),this.scroll.addEventListener("touchend",()=>{this.chatInner.classList.contains("is-scrolling")&&(this.isScrollingTimeout&&clearTimeout(this.isScrollingTimeout),this.isScrollingTimeout=window.setTimeout(()=>{this.chatInner.classList.remove("is-scrolling"),this.isScrollingTimeout=0},1350))},{passive:!0}))}updateUnreadByDialog(){const e=this.appMessagesManager.getHistoryStorage(this.peerId,this.chat.threadId),t=this.peerId==d.default.myId?e.readMaxId:e.readOutboxMaxId;for(const e of this.unreadOut)if(e>0&&e<=t){const t=this.bubbles[e];t&&(t.classList.remove("is-sent"),t.classList.add("is-read")),this.unreadOut.delete(e)}}deleteMessagesByIds(e,t=!0){e.forEach(e=>{if(!(e in this.bubbles))return;const t=this.bubbles[e];delete this.bubbles[e],this.firstUnreadBubble==t&&(this.firstUnreadBubble=null),this.bubbleGroups.removeBubble(t,e),this.unreadedObserver&&this.unreadedObserver.unobserve(t),t.remove()}),t&&this.chat.selection.isSelecting&&this.chat.selection.deleteSelectedMids(e),b.default.checkAnimations(!1,n.CHAT_ANIMATION_GROUP),this.deleteEmptyDateGroups()}renderNewMessagesByIds(e,t=this.scrolledDown){this.scrolledAllDown?(this.chat.threadId&&(e=e.filter(e=>{const t=this.chat.getMessage(e).reply_to;return t&&(t.reply_to_top_id||t.reply_to_msg_id)===this.chat.threadId})),(e=e.filter(e=>!this.bubbles[e])).forEach(e=>{const t=this.chat.getMessage(e);this.renderMessage(t)}),this.messagesQueuePromise&&t&&(this.scrollable.isScrolledDown&&!this.scrollable.scrollLocked&&this.scrollable.scrollTo(this.scrollable.scrollHeight-1,"top",!1,!0),this.messagesQueuePromise.then(()=>{this.scrollable.scrollTo(this.scrollable.scrollHeight,"top",!0,!0)}))):this.log("seems search is active, skipping render:",e)}highlightBubble(e){const t="highlightTimeout";e.dataset[t]&&(clearTimeout(+e.dataset[t]),e.classList.remove("is-highlighted"),e.offsetWidth),e.classList.add("is-highlighted"),e.dataset[t]=""+setTimeout(()=>{e.classList.remove("is-highlighted"),delete e.dataset[t]},2e3)}getDateContainerByMessage(e,t){const s=new Date(1e3*e.date);s.setHours(0,0,0);const i=s.getTime();if(!(i in this.dateMessages)){let e="";const t=new Date;t.setHours(0,0,0,0),t.getTime()==s.getTime()?e="Today":(e=v.months[s.getMonth()]+" "+s.getDate(),s.getFullYear()!=t.getFullYear()&&(e+=", "+s.getFullYear())),"scheduled"===this.chat.type&&(e="Scheduled for "+e);const n=document.createElement("div");n.className="bubble service is-date",n.innerHTML=`<div class="bubble__container"><div class="service-msg">${e}</div></div>`;const r=document.createElement("div");r.className="bubbles-date-group";const d=o.getObjectKeysAndSort(this.dateMessages,"asc");let l=0;for(;l<d.length;++l){if(i<d[l])break}this.dateMessages[i]={div:n,container:r,firstTimestamp:s.getTime()},r.append(n),a.positionElementByIndex(r,this.chatInner,l),this.stickyIntersector&&this.stickyIntersector.observeStickyHeaderChanges(r)}return this.dateMessages[i]}destroy(){this.scrollable.onScrolledTop=this.scrollable.onScrolledBottom=this.scrollable.onAdditionalScroll=null,this.listenerSetter.removeAll(),this.lazyLoadQueue.clear(),this.unreadedObserver&&this.unreadedObserver.disconnect(),this.stickyIntersector&&this.stickyIntersector.disconnect(),delete this.lazyLoadQueue,this.unreadedObserver&&delete this.unreadedObserver,this.stickyIntersector&&delete this.stickyIntersector}cleanup(e=!1){this.scrolledAll=!1,this.scrolledAllDown=!1,void 0!==A&&(A=void 0),this.bubbles={},this.dateMessages={},this.bubbleGroups.cleanup(),this.unreadOut.clear(),this.needUpdate.length=0,e&&(this.scrollable.container.innerHTML=""),this.firstUnreadBubble=null,this.attachedUnreadBubble=!1,this.messagesQueue.length=0,this.messagesQueuePromise=null,this.getHistoryTopPromise=this.getHistoryBottomPromise=void 0,this.stickyIntersector&&this.stickyIntersector.disconnect(),this.unreadedObserver&&(this.unreadedObserver.disconnect(),this.unreaded.length=0),this.loadedTopTimes=this.loadedBottomTimes=0,this.cleanupObj.cleaned=!0,this.cleanupObj={cleaned:!1}}setPeer(e,t){var s;if(0==e)return this.cleanup(!0),this.peerId=0,null;const i=this.peerId==e,o=this.appMessagesManager.getHistoryStorage(e,this.chat.threadId);let r="pinned"===this.chat.type?this.appMessagesManager.pinnedMessages[e].maxId:null!==(s=o.maxId)&&void 0!==s?s:0;const d=void 0!==t;if("pinned"!==this.chat.type&&r&&!o.history.includes(r)&&(r=0),!d&&r){const s=this.appMessagesManager.isHistoryUnread(e,this.chat.threadId);t=s&&!i?o.readMaxId:r}const l=t!==r;if(i){const e=this.getMountedBubble(t);if(e)return d?(this.scrollable.scrollIntoView(e.bubble),this.highlightBubble(e.bubble),this.chat.setListenerResult("setPeer",t,!1)):r&&!l&&(this.scroll.scrollTop=this.scroll.scrollHeight,this.chat.setListenerResult("setPeer",t,!0)),null}else this.peerId&&(this.lazyLoadQueue.queueId=++D,this.chat.apiManager.setQueueId(this.chat.bubbles.lazyLoadQueue.queueId)),this.peerId=e,this.replyFollowHistory.length=0;this.log("setPeer peerId:",this.peerId,o,t,r);const c=l||"scheduled"===this.chat.type?0:r;let f=0;if(i){let e=a.getElementByPoint(this.chat.bubbles.scrollable.container,"bottom");e&&(e=a.findUpClassName(e,"bubble"),e&&(f=+e.dataset.mid)),f<=0&&(f=Math.max(...Object.keys(this.bubbles).map(e=>+e)))}const h=this.chatInner;this.cleanup(),this.chatInner=document.createElement("div"),this.chatInner.className=h.className,this.chatInner.classList.add("disable-hover","is-scrolling"),i||this.lazyLoadQueue.clear(),this.lazyLoadQueue.lock();const{promise:u,cached:p}=this.getHistory(t,!0,l,c);p||(this.scrollable.container.innerHTML="",i||this.chat.finishPeerChange(d,l,t),this.preloader.attach(this.bubblesContainer)),b.default.lockGroup(n.CHAT_ANIMATION_GROUP);const g=u.then(()=>{if(p?(i||this.chat.finishPeerChange(d,l,t),this.scrollable.container.innerHTML=""):this.preloader.detach(),this.scrollable.container.append(this.chatInner),b.default.unlockGroup(n.CHAT_ANIMATION_GROUP),b.default.checkAnimations(!1,n.CHAT_ANIMATION_GROUP),this.lazyLoadQueue.unlock(),r&&l||d){this.scrollable.scrollLocked&&(clearTimeout(this.scrollable.scrollLocked),this.scrollable.scrollLocked=0);const e=f>0&&(f<t||t<0),s=o.readMaxId===t&&!d;e||!i&&!s?e&&(this.scrollable.scrollTop=0):this.scrollable.scrollTop=this.scrollable.scrollHeight;const n=this.getMountedBubble(t);let a=s&&this.firstUnreadBubble||(null==n?void 0:n.bubble);(null==a?void 0:a.parentElement)||(a=this.findNextMountedBubbleByMsgId(t)),a&&(this.scrollable.scrollIntoView(a,i),s||this.highlightBubble(a))}else this.scrollable.scrollTop=this.scrollable.scrollHeight;if(this.chat.setListenerResult("setPeer",t,!l),t&&!this.bubbles[r]&&t!=r||(this.scrolledAllDown=!0),this.log("scrolledAllDown:",this.scrolledAllDown),this.scrolledAllDown&&r&&this.appMessagesManager.readHistory(e,r,this.chat.threadId),"chat"===this.chat.type){const t=this.appMessagesManager.getDialogByPeerId(e)[0];(null==t?void 0:t.pFlags.unread_mark)&&this.appMessagesManager.markDialogUnread(e,!0)}this.chatInner.classList.remove("disable-hover","is-scrolling")}).catch(e=>{throw this.log.error("getHistory promise error:",e),this.preloader.detach(),e});return{cached:p,promise:g}}finishPeerChange(){const e=this.peerId,t=this.appPeersManager.isChannel(e),s=this.appMessagesManager.canWriteToPeer(e);this.chatInner.classList.toggle("has-rights",s),this.bubblesContainer.classList.toggle("is-chat-input-hidden",!s),this.chatInner.classList.toggle("is-chat",this.chat.isAnyGroup()),this.chatInner.classList.toggle("is-channel",t)}renderMessagesQueue(e,t,s){let i=[];Array.from(t.querySelectorAll("img, video")).forEach(e=>{if(e instanceof HTMLVideoElement){if(!e.src)return;if(e.readyState>=4)return}else if(e.complete||!e.src)return;let t=new Promise((t,s)=>{let i,n=()=>{clearTimeout(o),t(),e.removeEventListener(e instanceof HTMLVideoElement?"canplay":"load",n)};e instanceof HTMLVideoElement?(e.addEventListener("canplay",n),i=()=>e.readyState>=1):(e.addEventListener("load",n),i=()=>e.complete);let a=()=>i()?n():window.requestAnimationFrame(a);window.requestAnimationFrame(a);let o=setTimeout(()=>{t()},1500)});i.push(t)}),this.messagesQueue.push({message:e,bubble:t,reverse:s,promises:i}),this.messagesQueuePromise||(this.messagesQueuePromise=new Promise((e,t)=>{setTimeout(()=>{const s=this.chatInner,i=this.messagesQueue.slice();this.messagesQueue.length=0;const n=i.reduce((e,{promises:t})=>e.concat(t),[]);this.scrollable.scrollLocked&&n.push(this.scrollable.scrollLockedPromise),Promise.all(n).then(()=>{if(this.chatInner!=s)return t("chatInner changed!");this.messagesQueueOnRender&&this.messagesQueueOnRender(),i.forEach(({message:e,bubble:t,reverse:s})=>{this.setBubblePosition(t,e,s)}),e(),this.messagesQueuePromise=null},t)},0)}))}setBubblePosition(e,t,s){const i=this.getDateContainerByMessage(t,s);if("scheduled"===this.chat.type||"pinned"===this.chat.type){let s=Array.from(i.container.children).slice(2),n=0,o=0;for(;n<s.length;++n){const e=s[n],i=+e.dataset.timestamp;if(t.date<i)break;if(t.date===i&&(o=+e.dataset.mid),o&&t.mid<o)break}let r=2+n;a.positionElementByIndex(e,i.container,r)}else s?i.container.insertBefore(e,i.container.children[1].nextSibling):i.container.append(e)}getMiddleware(){const e=this.cleanupObj;return()=>!e.cleaned}renderMessage(e,t=!1,s=!1,i=null,o=!0){var r;this.log.debug("message to render:",e);const l="pinned"!==this.chat.type;if(e.deleted)return;if(e.grouped_id&&l){const t=this.appMessagesManager.groupedMessagesStorage[e.grouped_id],s=Math.max(...Object.keys(t).map(e=>+e));if(e.mid<s)return}const c=this.peerId,f=e.fromId==d.default.myId||e.pFlags.out&&this.appPeersManager.isMegagroup(this.peerId),h=document.createElement("div");let u;if(h.classList.add("message"),i){const s=["is-highlighted"],n=i.className.split(" "),a=["bubble"].concat(s.filter(e=>n.includes(e)));i.className=a.join(" "),u=i.lastElementChild,u.innerHTML="",u.style.cssText="",i==this.firstUnreadBubble&&i.classList.add("is-first-unread");const r=+i.dataset.mid,d=+e.mid==r;d&&!o||this.bubbleGroups.removeBubble(i,r),d||(delete this.bubbles[r],o||this.bubbleGroups.addBubble(i,e,t))}else u=document.createElement("div"),u.classList.add("bubble__container"),(i=document.createElement("div")).classList.add("bubble"),i.appendChild(u),f||e.pFlags.out||e.pFlags.unread&&this.unreadedObserver&&(this.unreadedObserver.observe(i),this.unreaded.indexOf(e.mid)||this.unreaded.push(e.mid));if(this.bubbles[+e.mid]=i,i.dataset.mid=e.mid,i.dataset.timestamp=e.date,"messageService"===e._){let s=e.action._;return x.includes(s)||w.langPack.hasOwnProperty(s)&&!w.langPack[s]||(i.className="bubble service",u.innerHTML=`<div class="service-msg">${e.rReply}</div>`,o&&this.renderMessagesQueue(e,i,t)),i}let p,g,m=e.media;if((null==m?void 0:m.document)&&!["video","gif"].includes(m.document.type));else if(e.grouped_id&&l){const t=this.appMessagesManager.getAlbumText(e.grouped_id);p=t.message,g=t.totalEntities}else"sticker"!==(null===(r=null==m?void 0:m.document)||void 0===r?void 0:r.type)&&(p=e.message,g=e.totalEntities);let b=y.default.wrapRichText(p,{entities:g});if(g&&!m){let e=g.filter(e=>"messageEntityEmoji"==e._),t=p.length;if(e.reduce((e,t)=>e+t.length,0)==t&&e.length<=3){let t=this.appStickersManager.getAnimatedEmojiSticker(p);if(1==e.length&&!m&&t)m={_:"messageMediaDocument",document:t};else{let t=document.createElement("div");t.classList.add("attachment"),t.innerHTML=b,i.classList.add("emoji-"+e.length+"x"),u.append(t)}i.classList.add("is-message-empty","emoji-big")}else h.innerHTML=b}else h.innerHTML=b;const v=C.MessageRender.setTime(this.chat,e,i,u,h);if(u.prepend(h),e.reply_markup&&"replyInlineMarkup"==e.reply_markup._&&e.reply_markup.rows&&e.reply_markup.rows.length){const t=e.reply_markup.rows,s=document.createElement("div");s.classList.add("reply-markup"),t.forEach(t=>{const i=t.buttons;if(!i||!i.length)return;const n=document.createElement("div");n.classList.add("reply-markup-row"),i.forEach(t=>{const s=y.default.wrapRichText(t.text,{noLinks:!0,noLinebreaks:!0});let i;switch(t._){case"keyboardButtonUrl":{const s=this.appUsersManager.getUser(e.fromId),n=!(s&&s.pFlags&&s.pFlags.verified),a=y.default.wrapUrl(t.url,n);i=document.createElement("a"),i.href=a,i.rel="noopener noreferrer",i.target="_blank",i.classList.add("is-link","tgico");break}default:i=document.createElement("button")}i.classList.add("reply-markup-button","rp"),i.innerHTML=s,L.ripple(i),n.append(i)}),s.append(n)}),a.attachClickEvent(s,s=>{a.cancelEvent(s);let i=s.target;if(i.classList.contains("reply-markup-button")||(i=a.findUpClassName(i,"reply-markup-button")),!i)return;const n=a.whichChild(i),o=t[a.whichChild(i.parentElement)];if(!o.buttons||!o.buttons[n])return void this.log.warn("no such button",o,n,e);const r=o.buttons[n];this.appInlineBotsManager.callbackButtonClick(this.peerId,e.mid,r)});const i=45*t.length+"px";u.style.marginBottom=i,s.style.bottom="-"+i,u.prepend(s)}const T=e.pFlags.is_outgoing;if(f){(e.pFlags.unread||T)&&this.unreadOut.add(e.mid);let t="";t=T?"is-sending":e.pFlags.unread?"is-sent":"is-read",i.classList.add(t)}let P,A;this.peerId===k.REPLIES_PEER_ID?(P=e,A=!0):(P=this.appMessagesManager.filterMessages(e,e=>!!e.replies)[0],A=P&&P.replies&&P.replies.pFlags.comments&&777!==P.replies.channel_id),A&&i.classList.add("with-replies");const D=f&&(!e.fwd_from||this.peerId!=d.default.myId);let X=u;if(m){let t=document.createElement("div");t.classList.add("attachment"),p||i.classList.add("is-message-empty");let s=!1;switch(m._){case"messageMediaPhoto":{const s=m.photo;i.classList.add("hide-name","photo");const n=this.appMessagesManager.groupedMessagesStorage[e.grouped_id];if(e.grouped_id&&1!=Object.keys(n).length&&l){i.classList.add("is-album","is-grouped"),E.wrapAlbum({groupId:e.grouped_id,attachmentDiv:t,middleware:this.getMiddleware(),isOut:f,lazyLoadQueue:this.lazyLoadQueue,chat:this.chat});break}const a=!_.isAndroid&&!e.message&&!A;a&&i.classList.add("with-media-tail"),E.wrapPhoto({photo:s,message:e,container:t,withTail:a,isOut:D,lazyLoadQueue:this.lazyLoadQueue,middleware:this.getMiddleware()});break}case"messageMediaWebPage":{s=!0;let t=m.webpage;if("webPageEmpty"==t._)break;i.classList.add("webpage");let a=document.createElement("div");a.classList.add("web");let o,r,d=document.createElement("div");d.classList.add("quote"),(t.photo||t.document)&&(o=document.createElement("div"),o.classList.add("preview-resizer"),r=document.createElement("div"),r.classList.add("preview"),o.append(r));let l=null;if(t.document)if(l=t.document,"gif"==l.type||"video"==l.type)i.classList.add("video"),E.wrapVideo({doc:l,container:r,message:e,boxWidth:M.default.active.webpage.width,boxHeight:M.default.active.webpage.height,lazyLoadQueue:this.lazyLoadQueue,middleware:this.getMiddleware(),isOut:D,group:n.CHAT_ANIMATION_GROUP});else{const t=E.wrapDocument({message:e});r.append(t),r.classList.add("preview-with-document")}o&&d.append(o);let c=document.createElement("div");if(c.classList.add("quote-text"),t.site_name){let e=document.createElement("a");e.classList.add("name"),e.setAttribute("target","_blank"),e.href=t.url||"#",e.innerHTML=y.default.wrapEmojiText(t.site_name),c.append(e)}if(t.rTitle){let e=document.createElement("div");e.classList.add("title"),e.innerHTML=t.rTitle,c.append(e)}if(t.rDescription){let e=document.createElement("div");e.classList.add("text"),e.innerHTML=t.rDescription,c.append(e)}if(d.append(c),t.photo&&!l){i.classList.add("photo");const s=t.photo.sizes[t.photo.sizes.length-1];s.w==s.h&&c.childElementCount?i.classList.add("is-square-photo"):s.h>s.w&&i.classList.add("is-vertical-photo"),E.wrapPhoto({photo:t.photo,message:e,container:r,boxWidth:M.default.active.webpage.width,boxHeight:M.default.active.webpage.height,isOut:D,lazyLoadQueue:this.lazyLoadQueue,middleware:this.getMiddleware()})}a.append(d),h.insertBefore(a,h.lastElementChild);break}case"messageMediaDocument":{let a=m.document;if(a.sticker){i.classList.add("sticker"),a.animated&&i.classList.add("sticker-animated");let e=i.classList.contains("emoji-big")?140:200;this.appPhotosManager.setAttachmentSize(a,t,e,e,!0),u.style.height=t.style.height,u.style.width=t.style.width,E.wrapSticker({doc:a,div:t,middleware:this.getMiddleware(),lazyLoadQueue:this.lazyLoadQueue,group:n.CHAT_ANIMATION_GROUP,play:!0,loop:!0,emoji:i.classList.contains("emoji-big")?p:void 0,withThumb:!0});break}if("video"==a.type||"gif"==a.type||"round"==a.type){i.classList.add("hide-name","round"==a.type?"round":"video");const s=this.appMessagesManager.groupedMessagesStorage[e.grouped_id];if(e.grouped_id&&1!=Object.keys(s).length&&l)i.classList.add("is-album","is-grouped"),E.wrapAlbum({groupId:e.grouped_id,attachmentDiv:t,middleware:this.getMiddleware(),isOut:f,lazyLoadQueue:this.lazyLoadQueue,chat:this.chat});else{const s=!(_.isAndroid||_.isApple||"round"==a.type||e.message||A);s&&i.classList.add("with-media-tail"),E.wrapVideo({doc:a,container:t,message:e,boxWidth:M.default.active.regular.width,boxHeight:M.default.active.regular.height,withTail:s,isOut:D,lazyLoadQueue:this.lazyLoadQueue,middleware:this.getMiddleware(),group:n.CHAT_ANIMATION_GROUP})}break}{const t=E.wrapGroupedDocuments({albumMustBeRenderedFull:l,message:e,bubble:i,messageDiv:h,chat:this.chat});t&&(X=t);const n=h.lastElementChild.querySelector(".document-size, .audio");n&&n.append(v.cloneNode(!0)),i.classList.remove("is-message-empty"),h.classList.add(("photo"!=a.type&&a.type||"document")+"-message"),s=!0;break}}case"messageMediaContact":{const t=document.createElement("div");t.classList.add("contact"),t.dataset.peerId=""+m.user_id,h.classList.add("contact-message"),s=!0;const n=[];e.media.first_name&&n.push(y.default.wrapEmojiText(e.media.first_name)),e.media.last_name&&n.push(y.default.wrapEmojiText(e.media.last_name)),t.innerHTML=`\n            <div class="contact-details">\n              <div class="contact-name">${n.join(" ")}</div>\n              <div class="contact-number">${e.media.phone_number?"+"+I.formatPhoneNumber(e.media.phone_number).formatted:"Unknown phone number"}</div>\n            </div>`;const a=new S.default;a.setAttribute("peer",""+e.media.user_id),a.classList.add("contact-avatar","avatar-54"),t.prepend(a),i.classList.remove("is-message-empty"),h.classList.add("contact-message"),h.append(t);break}case"messageMediaPoll":{i.classList.remove("is-message-empty");const t=E.wrapPoll(e);h.prepend(t),h.classList.add("poll-message");break}default:i.classList.remove("is-message-empty"),h.innerHTML="unrecognized media type: "+e.media._,h.append(v),this.log.warn("unrecognized media type:",e.media._,e)}s||u.append(t)}this.chat.selection.isSelecting&&this.chat.selection.toggleBubbleCheckbox(i,!0);let F="";const O=c<0&&(c!=e.fromId||f)&&e.fromId!==d.default.myId;if(O||e.fwd_from||e.reply_to_mid){let t=this.appPeersManager.getPeerTitle(e.fwdFromId||e.fromId);const s=e.from_id&&"peerChannel"==e.from_id._&&e.fromId==e.fwdFromId;if(e.fwd_from&&!e.fwd_from.from_id&&!e.fwd_from.channel_id&&(t=y.default.wrapEmojiText(e.fwd_from.from_name),i.classList.add("hidden-profile")),e.fwdFromId||e.fwd_from){if(this.peerId==d.default.myId||s||i.classList.add("forwarded"),e.savedFrom&&(F=e.savedFrom),!i.classList.contains("sticker")){let i=document.createElement("div");i.classList.add("name"),i.dataset.peerId=e.fwdFromId,this.peerId===d.default.myId||this.peerId===k.REPLIES_PEER_ID||s?(i.style.color=this.appPeersManager.getPeerColorById(e.fwdFromId,!1),i.innerHTML=t):i.innerHTML="Forwarded from "+t,X.append(i)}}else if(!i.classList.contains("sticker")&&O){let s=document.createElement("div");s.classList.add("name"),s.innerHTML=t,f||(s.style.color=this.appPeersManager.getPeerColorById(e.fromId,!1)),s.dataset.peerId=e.fromId,X.append(s)}else i.classList.add("hide-name");if(e.reply_to_mid&&e.reply_to_mid!==this.chat.threadId){const t=e.reply_to.reply_to_peer_id?this.appPeersManager.getPeerId(e.reply_to.reply_to_peer_id):this.peerId;let s,n=this.appMessagesManager.getMessageByPeer(t,e.reply_to_mid);"messageEmpty"==n._?(this.appMessagesManager.wrapSingleMessage(t,e.reply_to_mid),this.needUpdate.push({replyToPeerId:t,replyMid:e.reply_to_mid,mid:e.mid}),s="Loading..."):s=this.appPeersManager.getPeerTitle(n.fromId||n.fwdFromId,!0)||"";const a=E.wrapReply(s,n.message||"",n);u.append(a),i.classList.add("is-reply")}if(this.chat.isAnyGroup()&&!D){let t=new S.default;t.classList.add("user-avatar","avatar-40"),!e.fwdFromId&&e.fwd_from&&e.fwd_from.from_name&&t.setAttribute("peer-title",e.fwd_from.from_name),t.setAttribute("peer",""+((e.fwd_from&&(this.peerId===d.default.myId||this.peerId===k.REPLIES_PEER_ID)||s?e.fwdFromId:e.fromId)||0)),t.update(),u.append(t)}}else i.classList.add("hide-name");if("pinned"===this.chat.type&&(F=`${this.chat.peerId}_${e.mid}`),P&&P.mid===this.chat.threadId&&i.classList.add("is-thread-starter"),F&&this.peerId!==k.REPLIES_PEER_ID){const e=document.createElement("div");e.classList.add("bubble-beside-button","goto-original","tgico-arrow-next"),u.append(e),i.dataset.savedFrom=F,i.classList.add("with-beside-button")}return i.classList.add(D?"is-out":"is-in"),o?(this.bubbleGroups.addBubble(i,e,t),this.renderMessagesQueue(e,i,t)):this.bubbleGroups.updateGroupByMessageId(e.mid),A&&C.MessageRender.renderReplies({bubble:i,bubbleContainer:u,message:P,messageDiv:h}),i}performHistoryResult(e,t,s,i){e.length||(s?this.scrolledAllDown=!0:this.scrolledAll=!0),e=e.slice(),i&&e.unshift(i);const n=this.appMessagesManager.getHistoryStorage(this.peerId,this.chat.threadId);return e.includes(n.maxId)&&(this.scrolledAllDown=!0),new Promise((s,i)=>{const n=(t?e.shift:e.pop).bind(e);let a;for(this.scrollable.container.childElementCount>0&&(t||_.isSafari)&&(this.messagesQueueOnRender=()=>{const{scrollTop:e,scrollHeight:s}=this.scrollable;a=t?s-e:e,this.messagesQueueOnRender=void 0});e.length;){let e=this.chat.getMessage(n());this.renderMessage(e,t,!0)}(this.messagesQueuePromise||Promise.resolve()).then(()=>{if(void 0!==a){const e=t?this.scrollable.scrollHeight-a:a;r.isTouchSupported&&_.isApple&&(this.scrollable.container.style.overflow="hidden"),this.scrollable.scrollTop=e,r.isTouchSupported&&_.isApple&&(this.scrollable.container.style.overflow="")}s(!0)},i)}).then(()=>!0)}requestHistory(e,t,s){if("chat"===this.chat.type||"discussion"===this.chat.type)return this.appMessagesManager.getHistory(this.peerId,e,t,s,this.chat.threadId);if("pinned"===this.chat.type){return this.appMessagesManager.getSearch({peerId:this.peerId,inputFilter:{_:"inputMessagesFilterPinned"},maxId:e,limit:t,backLimit:s}).then(e=>({history:e.history.map(e=>e.mid)}))}return"scheduled"===this.chat.type?this.appMessagesManager.getScheduledMessages(this.peerId).then(e=>(this.scrolledAll=!0,this.scrolledAllDown=!0,{history:e.slice().reverse()})):void 0}getHistory(e=0,t=!1,s=!1,i=0,n=!1){const a=this.peerId,r=this.appPhotosManager.windowH/38|0,d=r;let l=d;if(void 0!==A){if(!A)return{cached:!1,promise:Promise.resolve(!0)};Object.keys(this.bubbles).length>0&&--A}let c,f=0;if(s&&(f=l,t||(l=0,e=this.appMessagesManager.incrementMessageId(e,1))),i&&!s)if("pinned"===this.chat.type)c=[i];else{const t=this.appMessagesManager.getHistoryStorage(a,this.chat.threadId);if(t.history.length<l){c=t.history.slice();for(let e=c.length-1;e>=0;--e){if(!this.chat.getMessage(c[e]).grouped_id)break;c.splice(e,1)}e=c[c.length-1]||e}}let h,u=this.requestHistory(e,l,f);const p=null==c?void 0:c.length;p&&(h=u,u={history:c});const g=e=>{if("discussion"===this.chat.type&&"offsetIdOffset"in e){const t=e.offsetIdOffset>=e.count-l;if(this.log("discussion got history",l,f,e,t),t){const t=this.appMessagesManager.threadsServiceMessagesIdsStorage[this.peerId+"_"+this.chat.threadId];t&&e.history.push(t),e.history.push(...this.chat.getMidsByMid(this.chat.threadId).reverse()),this.scrolledAll=!0}}},m=o=>{const r=o.then(o=>(this.log("getHistory not cached result by maxId:",e,t,s,o,a,n),n?(this.scrollable.onScroll(),!0):this.peerId!=a||this.getHistoryTopPromise!=r&&this.getHistoryBottomPromise!=r?(this.log.warn("peer changed"),Promise.reject()):(g(o),this.performHistoryResult(o.history||[],t,s,!p&&i))),e=>(this.log.error("getHistory error:",e),!1));return r};let b,v;if(u instanceof Promise)v=!1,b=m(u);else{if(n)return null;v=!0,this.log("getHistory cached result by maxId:",e,t,s,u,a,n),g(u),b=this.performHistoryResult(u.history||[],t,s,!p&&i)}const y=p?m(h):b;return p&&y.then(()=>{o.getObjectKeysAndSort(this.bubbles,"desc").filter(e=>!c.includes(e)).forEach((e,t)=>{const s=this.bubbles[e];s.style.animationDelay=10*(t||.1)+"ms",s.classList.add("zoom-fade"),s.addEventListener("animationend",()=>{s.style.animationDelay="",s.classList.remove("zoom-fade")},{once:!0})}),setTimeout(()=>{this.loadMoreHistory(!0,!0)},0)}),t?this.getHistoryTopPromise=y:this.getHistoryBottomPromise=y,y.finally(()=>{t?this.getHistoryTopPromise=void 0:this.getHistoryBottomPromise=void 0}),n?null:(!p&&b.then(()=>{let s;t?(this.loadedTopTimes++,this.loadedBottomTimes=Math.max(0,--this.loadedBottomTimes)):(this.loadedBottomTimes++,this.loadedTopTimes=Math.max(0,--this.loadedTopTimes)),(t&&this.loadedTopTimes>2||!t&&this.loadedBottomTimes>2)&&(s=o.getObjectKeysAndSort(this.bubbles));const i=2*d;if(this.log("getHistory: slice loadedTimes:",t,r,this.loadedTopTimes,this.loadedBottomTimes,null==s?void 0:s.length,i),s&&s.length>i&&(t?(s=s.slice(i),this.scrolledAllDown=!1,this.log("getHistory: slice bottom messages:",s.length,l)):(s=s.slice(0,s.length-i),this.scrolledAll=!1,this.log("getHistory: slice up messages:",s.length,l)),this.log("getHistory: will slice ids:",s,t),this.deleteMessagesByIds(s,!1)),this.setUnreadDelimiter(),"chat"===this.chat.type){-1!==this.appMessagesManager.getHistoryStorage(a,this.chat.threadId).history.indexOf(e)&&setTimeout(()=>{t?this.loadMoreHistory(!0,!0):this.loadMoreHistory(!1,!0)},0)}}),{cached:v,promise:b})}setUnreadDelimiter(){if(this.attachedUnreadBubble)return;const e=this.appMessagesManager.getHistoryStorage(this.peerId,this.chat.threadId);if(!this.appMessagesManager.isHistoryUnread(this.peerId,this.chat.threadId))return;let t=e.readMaxId;if(t=Object.keys(this.bubbles).filter(e=>!this.bubbles[e].classList.contains("is-out")).map(e=>+e).sort((e,t)=>e-t).find(e=>e>t),t&&this.bubbles[t]){let s=this.bubbles[t];this.firstUnreadBubble&&this.firstUnreadBubble!=s&&(this.firstUnreadBubble.classList.remove("is-first-unread"),this.firstUnreadBubble=null),t!==e.maxId&&s.classList.add("is-first-unread"),this.firstUnreadBubble=s,this.attachedUnreadBubble=!0}}deleteEmptyDateGroups(){for(let e in this.dateMessages){let t=this.dateMessages[e];2==t.container.childElementCount&&(t.container.remove(),this.stickyIntersector&&this.stickyIntersector.unobserve(t.container,t.div),delete this.dateMessages[e])}}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(1)),a=s(0);t.default=class{constructor(e){this.chat=e,this.bubbles=[],this.groups=[],this.newGroupDiff=121}removeBubble(e,t){const s=this.bubbles.findAndSplice(e=>e.mid===t);s&&s.group.length&&(s.group.findAndSplice(t=>t.bubble===e),s.group.length?this.updateGroup(s.group):this.groups.findAndSplice(e=>e===s.group))}addBubble(e,t,s){const i=t.date,a=t.mid;let o,r=t.fromId;r===n.default.myId&&t.peerId===n.default.myId&&t.fwdFromId===r&&(r=-r);const d={bubble:e,mid:a,timestamp:i};if(this.bubbles.length){let e,t=-1;for(let e=0;e<this.bubbles.length;++e){const s=this.bubbles[e],n=Math.abs(s.timestamp-i);if(s.fromId===r&&n<=this.newGroupDiff){if(t=e,"scheduled"===this.chat.type)break}else t=-1;if("scheduled"!==this.chat.type&&a>s.mid)break}if(-1!==t&&(e=this.bubbles[t]),e){o=e.group;let t=0,s=0;for(;t<o.length;++t){const e=o[t].timestamp,n=o[t].mid;if(i<e)break;if(i===e&&(s=n),s&&a<s)break}o.splice(t,0,d)}else this.groups.push(o=[d])}else this.groups.push(o=[d]);if(a>0){let e=0;for(;e<this.bubbles.length&&!(this.bubbles[e].mid<a);++e);this.bubbles.splice(e,0,{timestamp:i,fromId:r,mid:t.mid,group:o})}else this.bubbles.unshift({timestamp:i,fromId:r,mid:t.mid,group:o});this.updateGroup(o)}setClipIfNeeded(e,t=!1){const s=e.className;if(s.includes("is-message-empty")&&(s.includes("photo")||s.includes("video"))){let i=e.querySelector(".bubble__media-container");if(!i)return;try{Array.from(i.children).forEach(e=>{if(!(e instanceof SVGDefsElement))if(t)e.removeAttributeNS(null,"clip-path");else{let t,n,o=i.dataset.clipId,r=i.firstElementChild.firstElementChild.lastElementChild,d=+e.getAttributeNS(null,"width"),l=+e.getAttributeNS(null,"height"),c=s.includes("is-out"),f=s.includes("is-reply"),h="";s.includes("forwarded")||f?t=n=0:c?(t=s.includes("is-group-first")?12:6,n=12):(t=12,n=s.includes("is-group-first")?12:6),h=c?a.generatePathData(0,0,d-9,l,n,t,0,12):a.generatePathData(9,0,d-9,l,n,t,12,0),r.setAttributeNS(null,"d",h),e.setAttributeNS(null,"clip-path","url(#"+o+")")}})}catch(e){}}}updateGroup(e){if(!e.length)return;const t=e[0].bubble;if(1==e.length)return t.classList.add("is-group-first","is-group-last"),void this.setClipIfNeeded(t);t.classList.remove("is-group-last"),t.classList.add("is-group-first"),this.setClipIfNeeded(t,!0);const s=e.length-1;for(let t=1;t<s;++t){const s=e[t].bubble;s.classList.remove("is-group-last","is-group-first"),this.setClipIfNeeded(s,!0)}const i=e[e.length-1].bubble;i.classList.remove("is-group-first"),i.classList.add("is-group-last"),this.setClipIfNeeded(i)}updateGroupByMessageId(e){const t=this.bubbles.find(t=>t.mid==e);t&&this.updateGroup(t.group)}cleanup(){this.bubbles=[],this.groups=[]}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageRender=void 0;const n=s(18),a=s(26),o=i(s(3)),r=i(s(144));!function(e){e.setTime=(e,t,s,i,r)=>{var d;const l=new Date(1e3*t.date);let c=("0"+l.getHours()).slice(-2)+":"+("0"+l.getMinutes()).slice(-2);if(t.views){const e=t.post_author||(null===(d=t.fwd_from)||void 0===d?void 0:d.post_author);if(s.classList.add("channel-post"),c=a.formatNumber(t.views,1)+' <i class="tgico-channelviews time-icon"></i> '+(e?o.default.wrapEmojiText(e)+", ":"")+c,!t.savedFrom){const e=document.createElement("div");e.classList.add("bubble-beside-button","forward"),e.innerHTML='\n        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24">\n          <defs>\n            <path d="M13.55 3.24L13.64 3.25L13.73 3.27L13.81 3.29L13.9 3.32L13.98 3.35L14.06 3.39L14.14 3.43L14.22 3.48L14.29 3.53L14.36 3.59L14.43 3.64L22.23 10.85L22.36 10.99L22.48 11.15L22.57 11.31L22.64 11.48L22.69 11.66L22.72 11.85L22.73 12.04L22.71 12.22L22.67 12.41L22.61 12.59L22.53 12.76L22.42 12.93L22.29 13.09L22.23 13.15L14.43 20.36L14.28 20.48L14.12 20.58L13.95 20.66L13.77 20.72L13.58 20.76L13.4 20.77L13.22 20.76L13.03 20.73L12.85 20.68L12.68 20.61L12.52 20.52L12.36 20.4L12.22 20.27L12.16 20.2L12.1 20.13L12.05 20.05L12.01 19.98L11.96 19.9L11.93 19.82L11.89 19.73L11.87 19.65L11.84 19.56L11.83 19.47L11.81 19.39L11.81 19.3L11.8 19.2L11.8 16.42L11 16.49L10.23 16.58L9.51 16.71L8.82 16.88L8.18 17.09L7.57 17.33L7.01 17.6L6.48 17.91L5.99 18.26L5.55 18.64L5.14 19.05L4.77 19.51L4.43 19.99L4.29 20.23L4.21 20.35L4.11 20.47L4 20.57L3.88 20.65L3.75 20.72L3.62 20.78L3.48 20.82L3.33 20.84L3.19 20.84L3.04 20.83L2.9 20.79L2.75 20.74L2.62 20.68L2.53 20.62L2.45 20.56L2.38 20.5L2.31 20.43L2.25 20.36L2.2 20.28L2.15 20.19L2.11 20.11L2.07 20.02L2.04 19.92L2.02 19.83L2.01 19.73L2 19.63L2.04 17.99L2.19 16.46L2.46 15.05L2.85 13.75L3.35 12.58L3.97 11.53L4.7 10.6L5.55 9.8L6.51 9.12L7.59 8.56L8.77 8.13L10.07 7.83L11.48 7.65L11.8 7.63L11.8 4.8L11.91 4.56L12.02 4.35L12.14 4.16L12.25 3.98L12.37 3.82L12.48 3.68L12.61 3.56L12.73 3.46L12.85 3.38L12.98 3.31L13.11 3.27L13.24 3.24L13.37 3.23L13.46 3.23L13.55 3.24Z" id="b13RmHDQtl"></path>\n          </defs>\n          <use xlink:href="#b13RmHDQtl" opacity="1" fill="#fff" fill-opacity="1"></use>\n        </svg>',i.append(e),s.classList.add("with-beside-button")}}t.edit_date&&(s.classList.add("is-edited"),c='<i class="edited">edited</i> '+c),"pinned"!=e.type&&t.pFlags.pinned&&(s.classList.add("is-pinned"),c='<i class="tgico-pinnedchat time-icon"></i>'+c);const f=n.getFullDate(l)+(t.edit_date?"\nEdited: "+n.getFullDate(new Date(1e3*t.edit_date)):"")+(t.fwd_from?"\nOriginal: "+n.getFullDate(new Date(1e3*t.fwd_from.date)):""),h=document.createElement("span");return h.classList.add("time","tgico"),h.title=f,h.innerHTML=`${c}<div class="inner tgico" title="${f}">${c}</div>`,r.append(h),h},e.renderReplies=({bubble:e,bubbleContainer:t,message:s,messageDiv:i})=>{const n=!e.classList.contains("sticker")&&!e.classList.contains("emoji-big"),a=new r.default;a.message=s,a.type=n?"footer":"beside",t.prepend(a)}}(t.MessageRender||(t.MessageRender={}))},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(26),a=i(s(7)),o=i(s(10)),r=i(s(1)),d=s(17);r.default.on("replies_updated",e=>{const t=e.detail;Array.from(document.querySelectorAll(`replies-element[data-post-key="${t.peerId}_${t.mid}"]`)).forEach(e=>{e.message=t,e.render()})});class l extends HTMLElement{constructor(){super(),this.updated=!1}connectedCallback(){this.render(),this.dataset.postKey=this.message.peerId+"_"+this.message.mid,this.classList.add("replies","replies-"+this.type)}render(){const e=this.message.replies;if("footer"===this.type){let t,s="",i="";if(null==e?void 0:e.recent_repliers){s+='<div class="replies-footer-avatars">';let t=[];e.recent_repliers.forEach((e,s)=>{i=0==s?"":`style="transform: translateX(-${14*s}px);"`,t.push(`<avatar-element class="avatar-34" dialog="0" peer="${o.default.getPeerId(e)}" ${i}></avatar-element>`)}),s+=t.reverse().join("")+"</div>"}else s='<span class="tgico-comments"></span>';if(t=e?e.replies?e.replies+" "+(e.replies>1?"Comments":"Comment"):"Leave a Comment":"View in chat",e){const t=a.default.getHistoryStorage(-e.channel_id);this.classList.toggle("is-unread",e.read_max_id<e.max_id&&(!t.readMaxId||t.readMaxId<e.max_id))}this.innerHTML=`${s}<span class="replies-footer-text" ${i}>${t}</span><span class="tgico-next"></span>`;const n=document.createElement("div");this.append(n),d.ripple(n)}else this.classList.add("bubble-beside-button"),this.innerHTML=`<span class="tgico-commentssticker"></span><span class="replies-beside-text">${(null==e?void 0:e.replies)?n.formatNumber(e.replies,0):""}</span>`;e&&!this.updated&&(a.default.subscribeRepliesThread(this.message.peerId,this.message.mid),a.default.updateMessage(this.message.peerId,this.message.mid,"replies_updated"),this.updated=!0)}}t.default=l,customElements.define("replies-element",l)},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(11),a=s(0),o=i(s(61)),r=s(4),d=i(s(98)),l=i(s(52)),c=i(s(76)),f=s(146),h=i(s(99));t.default=class{constructor(e,t,s,i,o,u){this.attachTo=e,this.chat=t,this.appMessagesManager=s,this.appChatsManager=i,this.appPeersManager=o,this.appPollsManager=u,this.onSendScheduledClick=()=>{this.chat.selection.isSelecting?this.chat.selection.selectionSendNowBtn.click():new h.default(this.peerId,this.chat.getMidsByMid(this.mid))},this.onReplyClick=()=>{const e=this.chat.getMessage(this.mid),t=this.chat.input,s=()=>{t.setTopInfo("reply",s,this.appPeersManager.getPeerTitle(e.fromId,!0),e.message,void 0,e),t.replyToMsgId=this.mid};s()},this.onEditClick=()=>{this.chat.input.initMessageEditing(this.mid)},this.onCopyClick=()=>{const e=(this.chat.selection.isSelecting?[...this.chat.selection.selectedMids]:[this.mid]).reduce((e,t)=>{const s=this.chat.getMessage(t);return e+((null==s?void 0:s.message)?s.message+"\n":"")},"").trim();f.copyTextToClipboard(e)},this.onPinClick=()=>{new c.default(this.peerId,this.mid)},this.onUnpinClick=()=>{new c.default(this.peerId,this.mid,!0)},this.onRetractVote=()=>{this.appPollsManager.sendVote(this.message,[])},this.onStopPoll=()=>{this.appPollsManager.stopPoll(this.message)},this.onForwardClick=()=>{this.chat.selection.isSelecting?this.chat.selection.selectionForwardBtn.click():new l.default(this.peerId,this.isTargetAGroupedItem?[this.mid]:this.chat.getMidsByMid(this.mid))},this.onSelectClick=()=>{this.chat.selection.toggleByBubble(a.findUpClassName(this.target,"grouped-item")||a.findUpClassName(this.target,"bubble"))},this.onClearSelectionClick=()=>{this.chat.selection.cancelSelection()},this.onDeleteClick=()=>{this.chat.selection.isSelecting?this.chat.selection.selectionDeleteBtn.click():new d.default(this.peerId,this.isTargetAGroupedItem?[this.mid]:this.chat.getMidsByMid(this.mid),this.chat.type)};const p=e=>{let s,i;this.init&&(this.init(),this.init=null);try{i=a.findUpClassName(e.target,"bubble__container"),s=i?i.parentElement:a.findUpClassName(e.target,"bubble")}catch(e){}if(!s)return;if(e instanceof MouseEvent&&e.preventDefault(),this.element.classList.contains("active"))return!1;e instanceof MouseEvent&&(e.cancelBubble=!0);let o=+s.dataset.mid;if(!o)return;if(t.selection.isSelecting&&!i){const e=this.chat.getMidsByMid(o);if(e.length>1){const s=t.selection.selectedMids.has(o)?o:e.find(e=>t.selection.selectedMids.has(e));s&&(o=s)}}this.isSelectable=this.chat.selection.canSelectBubble(s),this.peerId=this.chat.peerId,this.target=e.target;const d=a.findUpClassName(this.target,"grouped-item");this.isTargetAGroupedItem=!!d,this.mid=d?+d.dataset.mid:o,this.message=this.chat.getMessage(this.mid),this.buttons.forEach(e=>{let s;s=!(t.selection.isSelecting&&!e.withSelection)&&(i||n.isTouchSupported?e.verify():e.notDirect&&e.verify()&&e.notDirect()),e.element.classList.toggle("hide",!s)});const l=s.classList.contains("is-in")?"left":"right";r.positionMenu(e,this.element,l),r.openBtnMenu(this.element,()=>{this.peerId=this.mid=0,this.target=null})};n.isTouchSupported?(a.attachClickEvent(e,e=>{if(t.selection.isSelecting)return;const s=e.target.className;if(!s||!s.includes)return;t.log("touchend",e);["bubble","bubble__container","message","time","inner"].find(e=>s.match(new RegExp(e+"($|\\s)")))&&(a.cancelEvent(e),p(e.changedTouches?e.changedTouches[0]:e))},{listenerSetter:this.chat.bubbles.listenerSetter}),r.attachContextMenuListener(e,s=>{if(t.selection.isSelecting)return;document.body.classList.add("no-select"),e.addEventListener("touchend",e=>{a.cancelEvent(e),document.body.classList.remove("no-select")},{once:!0,capture:!0}),a.cancelSelection();const i=a.findUpClassName(s.target,"grouped-item")||a.findUpClassName(s.target,"bubble");i&&t.selection.toggleByBubble(i)},this.chat.bubbles.listenerSetter)):r.attachContextMenuListener(e,p,this.chat.bubbles.listenerSetter)}init(){this.buttons=[{icon:"send2",text:"Send Now",onClick:this.onSendScheduledClick,verify:()=>"scheduled"===this.chat.type&&!this.message.pFlags.is_outgoing},{icon:"send2",text:"Send Now selected",onClick:this.onSendScheduledClick,verify:()=>"scheduled"===this.chat.type&&this.chat.selection.selectedMids.has(this.mid)&&!this.chat.selection.selectionSendNowBtn.hasAttribute("disabled"),notDirect:()=>!0,withSelection:!0},{icon:"schedule",text:"Reschedule",onClick:()=>{this.chat.input.scheduleSending(()=>{this.appMessagesManager.editMessage(this.message,this.message.message,{scheduleDate:this.chat.input.scheduleDate,entities:this.message.entities}),this.chat.input.onMessageSent(!1,!1)},new Date(1e3*this.message.date))},verify:()=>"scheduled"===this.chat.type},{icon:"reply",text:"Reply",onClick:this.onReplyClick,verify:()=>(this.peerId>0||this.appChatsManager.hasRights(-this.peerId,"send"))&&!this.message.pFlags.is_outgoing&&!!this.chat.input.messageInput&&"scheduled"!==this.chat.type},{icon:"edit",text:"Edit",onClick:this.onEditClick,verify:()=>this.appMessagesManager.canEditMessage(this.message,"text")&&!!this.chat.input.messageInput},{icon:"copy",text:"Copy",onClick:this.onCopyClick,verify:()=>!!this.message.message},{icon:"copy",text:"Copy selected",onClick:this.onCopyClick,verify:()=>this.chat.selection.selectedMids.has(this.mid)&&!![...this.chat.selection.selectedMids].find(e=>!!this.chat.getMessage(e).message),notDirect:()=>!0,withSelection:!0},{icon:"pin",text:"Pin",onClick:this.onPinClick,verify:()=>!this.message.pFlags.is_outgoing&&"messageService"!=this.message._&&!this.message.pFlags.pinned&&this.appPeersManager.canPinMessage(this.peerId)&&"scheduled"!==this.chat.type},{icon:"unpin",text:"Unpin",onClick:this.onUnpinClick,verify:()=>this.message.pFlags.pinned&&this.appPeersManager.canPinMessage(this.peerId)},{icon:"revote",text:"Revote",onClick:this.onRetractVote,verify:()=>{var e;const t=null===(e=this.message.media)||void 0===e?void 0:e.poll;return t&&t.chosenIndexes.length&&!t.pFlags.closed&&!t.pFlags.quiz}},{icon:"stop",text:"Stop poll",onClick:this.onStopPoll,verify:()=>{var e;const t=null===(e=this.message.media)||void 0===e?void 0:e.poll;return this.appMessagesManager.canEditMessage(this.message,"poll")&&t&&!t.pFlags.closed&&!this.message.pFlags.is_outgoing}},{icon:"forward",text:"Forward",onClick:this.onForwardClick,verify:()=>"scheduled"!==this.chat.type&&!this.message.pFlags.is_outgoing},{icon:"forward",text:"Forward selected",onClick:this.onForwardClick,verify:()=>this.chat.selection.selectionForwardBtn&&this.chat.selection.selectedMids.has(this.mid)&&!this.chat.selection.selectionForwardBtn.hasAttribute("disabled"),notDirect:()=>!0,withSelection:!0},{icon:"select",text:"Select",onClick:this.onSelectClick,verify:()=>!this.message.action&&!this.chat.selection.selectedMids.has(this.mid)&&this.isSelectable,notDirect:()=>!0,withSelection:!0},{icon:"select",text:"Clear selection",onClick:this.onClearSelectionClick,verify:()=>this.chat.selection.selectedMids.has(this.mid),notDirect:()=>!0,withSelection:!0},{icon:"delete danger",text:"Delete",onClick:this.onDeleteClick,verify:()=>this.appMessagesManager.canDeleteMessage(this.message)},{icon:"delete danger",text:"Delete selected",onClick:this.onDeleteClick,verify:()=>this.chat.selection.selectedMids.has(this.mid)&&!this.chat.selection.selectionDeleteBtn.hasAttribute("disabled"),notDirect:()=>!0,withSelection:!0}],this.element=o.default(this.buttons,this.chat.bubbles.listenerSetter),this.element.id="bubble-contextmenu",this.chat.container.append(this.element)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copyTextToClipboard=void 0,t.copyTextToClipboard=function(e){navigator.clipboard?navigator.clipboard.writeText(e):function(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}catch(e){}document.body.removeChild(t)}(e)}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(148)),a=s(11),o=i(s(5)),r=i(s(85)),d=i(s(3)),l=s(0),c=i(s(53)),f=i(s(151)),h=i(s(52)),u=i(s(101)),p=i(s(6)),g=s(36),m=s(24),b=i(s(28)),v=i(s(153)),y=i(s(38)),M=i(s(74)),_=i(s(64)),w=i(s(60)),S=i(s(32)),I=i(s(154)),L=i(s(78)),E=i(s(1)),C=i(s(76));t.default=class{constructor(e,t,s,i,n,c,f){this.chat=e,this.appMessagesManager=t,this.appDocsManager=s,this.appChatsManager=i,this.appPeersManager=n,this.appWebPagesManager=c,this.appImManager=f,this.pageEl=document.getElementById("page-chats"),this.btnSend=document.getElementById("btn-send"),this.lastUrl="",this.lastTimeType=0,this.replyElements={},this.willSendWebPage=null,this.forwardingMids=[],this.forwardingFromPeerId=0,this.recording=!1,this.recordCanceled=!1,this.recordStartTime=0,this.scrollTop=0,this.scrollOffsetTop=0,this.scrollDiff=0,this.lockRedo=!1,this.canRedoFromHTML="",this.undoHistory=[],this.executedHistory=[],this.canUndoFromHTML="",this.onCancelRecordClick=e=>{e&&l.cancelEvent(e),this.recordCanceled=!0,this.recorder.stop(),r.default.setKeepAlive(!1)},this.onEmoticonsOpen=()=>{const e=a.isTouchSupported?"flip-icon":"active";this.btnToggleEmoticons.classList.toggle(e,!0)},this.onEmoticonsClose=()=>{const e=a.isTouchSupported?"flip-icon":"active";this.btnToggleEmoticons.classList.toggle(e,!1)},this.scheduleSending=(e=this.sendMessage.bind(this,!0),t=new Date)=>{new I.default(t,t=>{t<=10+(Date.now()/1e3|0)&&(t=void 0),this.scheduleDate=t,e(),"scheduled"!==this.chat.type&&t&&this.appImManager.openScheduled(this.chat.peerId)}).show()},this.prepareDocumentExecute=()=>(this.executedHistory.push(this.messageInput.innerHTML),()=>this.canUndoFromHTML=this.messageInput.innerHTML),this.undoRedo=(e,t,s)=>{l.cancelEvent(e);let i=this.messageInput.innerHTML;if(i&&i!=s){this.lockRedo=!0;let e=0;do{document.execCommand(t,!1,null);const s=this.messageInput.innerHTML;if(i==s){if(++e>2)break}else e=0;i=s}while(i!=s);this.lockRedo=!1}},this.handleMarkdownShortcut=e=>{const t={B:"bold",I:"italic",U:"underline",S:"strikethrough",M:"monospace",K:"link"};if(document.getSelection().toString().trim().length)for(const s in t){if(e.code=="Key"+s){if("K"===s){this.appImManager.markupTooltip.showLinkEditor(),l.cancelEvent(e);break}this.applyMarkdown(t[s]),l.cancelEvent(e);break}}if("KeyZ"==e.code){const t=this.messageInput.innerHTML;if(e.shiftKey){if(this.undoHistory.length){this.executedHistory.push(this.messageInput.innerHTML);const t=this.undoHistory.pop();this.undoRedo(e,"redo",t),this.canRedoFromHTML=this.undoHistory.length?this.messageInput.innerHTML:"",this.canUndoFromHTML=this.messageInput.innerHTML}}else if(this.executedHistory.length&&(!this.canUndoFromHTML||t==this.canUndoFromHTML)){this.undoHistory.push(this.messageInput.innerHTML);const t=this.executedHistory.pop();this.undoRedo(e,"undo",t),this.canUndoFromHTML=this.canRedoFromHTML=this.messageInput.innerHTML}}},this.onMessageInput=e=>{const t=[],s=l.getRichValue(this.messageInputField.input,t),i=d.default.parseMarkdown(s,t),n=d.default.mergeEntities(t,d.default.parseEntities(i));if(this.stickersHelper&&(this.chat.peerId>0||this.appChatsManager.hasRights(this.chat.peerId,"send","send_stickers"))){let e="";if(n.length&&"messageEntityEmoji"==n[0]._){const t=n[0];t.length!=s.length||t.offset||(e=s)}this.stickersHelper.checkEmoticon(e)}s.trim()||this.appImManager.markupTooltip.hide();const a=this.messageInput.innerHTML;this.canRedoFromHTML&&a!=this.canRedoFromHTML&&!this.lockRedo&&(this.canRedoFromHTML="",this.undoHistory.length=0);const r=n.filter(e=>"messageEntityUrl"==e._||"messageEntityTextUrl"==e._);if(r.length)for(const e of r){let t;if("messageEntityTextUrl"===e._)t=e.url;else if(t=s.slice(e.offset,e.offset+e.length),!t.includes("http://")&&!t.includes("https://"))continue;this.lastUrl!=t&&(this.lastUrl=t,this.willSendWebPage=null,o.default.invokeApi("messages.getWebPage",{url:t,hash:0}).then(e=>{if("webPage"==(e=this.appWebPagesManager.saveWebPage(e))._){if(this.lastUrl!=t)return;this.setTopInfo("webpage",()=>{},e.site_name||e.title||"Webpage",e.description||e.url||""),delete this.noWebPage,this.willSendWebPage=e}}));break}else this.lastUrl&&(this.lastUrl="",delete this.noWebPage,this.willSendWebPage=null,this.helperType?this.helperFunc():this.clearHelper());if(s.trim()||l.serializeNodes(Array.from(this.messageInput.childNodes)).trim()){const e=Date.now();e-this.lastTimeType>=6e3&&(this.lastTimeType=e,this.appMessagesManager.setTyping(this.chat.peerId,"sendMessageTypingAction"))}else this.messageInput.innerHTML="",this.appMessagesManager.setTyping(this.chat.peerId,"sendMessageCancelAction");this.updateSendBtn()},this.onBtnSendClick=e=>{if(l.cancelEvent(e),!this.recorder||this.recording||!this.isInputEmpty()||this.forwardingMids.length||this.editMsgId)this.recording?Date.now()-this.recordStartTime<500?this.onCancelRecordClick():this.recorder.stop():this.sendMessage();else{if(this.chat.peerId<0&&!this.appChatsManager.hasRights(this.chat.peerId,"send","send_media"))return void g.toast("Posting media content isn't allowed in this group.");this.chatInput.classList.add("is-locked"),l.blurActiveElement(),this.recorder.start().then(()=>{this.recordCanceled=!1,this.chatInput.classList.add("is-recording"),this.recording=!0,this.updateSendBtn(),r.default.setKeepAlive(!0),this.recordStartTime=Date.now();const e=this.recorder.sourceNode,t=e.context.createAnalyser();e.connect(t),t.fftSize=32;const s=new Uint8Array(t.frequencyBinCount),i=255*s.length;let n=()=>{if(!this.recording)return;t.getByteFrequencyData(s);let e=0;s.forEach(t=>{e+=t});let a=Math.min(1,e/i+.36);this.recordRippleEl.style.transform=`scale(${a})`;let o=Date.now()-this.recordStartTime,r=o%1e3,d=(""+o/1e3).toHHMMSS()+","+("00"+Math.round(r/10)).slice(-2);this.recordTimeEl.innerText=d,window.requestAnimationFrame(n)};n()}).catch(e=>{switch(e.name){case"NotAllowedError":g.toast("Please allow access to your microphone");break;case"NotReadableError":g.toast(e.message);break;default:console.error("Recorder start error:",e,e.name,e.message),g.toast(e.message)}this.chatInput.classList.remove("is-recording","is-locked")})}},this.onHelperCancel=e=>{if(l.cancelEvent(e),this.willSendWebPage){const e=this.lastUrl;let t=!1;if(this.helperType&&(this.helperFunc(),t=!0),this.lastUrl=e,this.noWebPage=!0,this.willSendWebPage=null,t)return}this.clearHelper(),this.updateSendBtn()},this.onHelperClick=e=>{if(l.cancelEvent(e),l.findUpClassName(e.target,"reply-wrapper"))if("forward"==this.helperType){if(this.helperWaitingForward)return;this.helperWaitingForward=!0;const e=this.forwardingFromPeerId,t=this.forwardingMids.slice(),s=this.helperFunc;this.clearHelper();let i=!1;new h.default(e,t,()=>{i=!0},()=>{this.helperWaitingForward=!1,i||s()})}else"reply"==this.helperType?this.chat.setPeer(this.chat.peerId,this.replyToMsgId):"edit"==this.helperType&&this.chat.setPeer(this.chat.peerId,this.editMsgId)},this.listenerSetter=new w.default}construct(){this.chatInput=document.createElement("div"),this.chatInput.classList.add("chat-input"),this.chatInput.style.display="none",this.inputContainer=document.createElement("div"),this.inputContainer.classList.add("chat-input-container"),this.rowsWrapper=document.createElement("div"),this.rowsWrapper.classList.add("rows-wrapper"),this.inputContainer.append(this.rowsWrapper),this.chatInput.append(this.inputContainer),this.goDownBtn=S.default("bubbles-go-down btn-corner btn-circle z-depth-1 hide",{icon:"arrow-down"}),this.goDownUnreadBadge=document.createElement("span"),this.goDownUnreadBadge.classList.add("badge","badge-24","badge-green"),this.goDownBtn.append(this.goDownUnreadBadge),this.chatInput.append(this.goDownBtn),l.attachClickEvent(this.goDownBtn,e=>{l.cancelEvent(e),this.chat.bubbles.onGoDownClick()},{listenerSetter:this.listenerSetter})}constructPeerHelpers(){this.replyElements.container=document.createElement("div"),this.replyElements.container.classList.add("reply-wrapper"),this.replyElements.cancelBtn=y.default("close reply-cancel");const e=new M.default("reply");this.replyElements.titleEl=e.title,this.replyElements.subtitleEl=e.subtitle,this.replyElements.container.append(this.replyElements.cancelBtn,e.container),this.newMessageWrapper=document.createElement("div"),this.newMessageWrapper.classList.add("new-message-wrapper"),this.btnToggleEmoticons=y.default("none toggle-emoticons",{noRipple:!0}),this.inputMessageContainer=document.createElement("div"),this.inputMessageContainer.classList.add("input-message-container"),this.inputScroll=new p.default(this.inputMessageContainer),"chat"===this.chat.type&&(this.btnScheduled=y.default("schedule",{noRipple:!0}),this.btnScheduled.classList.add("btn-scheduled","hide"),l.attachClickEvent(this.btnScheduled,e=>{this.appImManager.openScheduled(this.chat.peerId)},{listenerSetter:this.listenerSetter}),this.listenerSetter.add(E.default,"scheduled_new",e=>{const t=e.detail.peerId;this.chat.peerId===t&&this.btnScheduled.classList.remove("hide")}),this.listenerSetter.add(E.default,"scheduled_delete",e=>{const t=e.detail.peerId;this.chat.peerId===t&&this.appMessagesManager.getScheduledMessages(this.chat.peerId).then(e=>{this.btnScheduled.classList.toggle("hide",!e.length)})})),this.attachMenuButtons=[{icon:"photo",text:"Photo or Video",onClick:()=>{this.fileInput.value="",this.fileInput.setAttribute("accept","image/*, video/*"),this.willAttachType="media",this.fileInput.click()},verify:e=>e>0||this.appChatsManager.hasRights(e,"send","send_media")},{icon:"document",text:"Document",onClick:()=>{this.fileInput.value="",this.fileInput.removeAttribute("accept"),this.willAttachType="document",this.fileInput.click()},verify:e=>e>0||this.appChatsManager.hasRights(e,"send","send_media")},{icon:"poll",text:"Poll",onClick:()=>{new f.default(this.chat).show()},verify:e=>e<0&&this.appChatsManager.hasRights(e,"send","send_polls")}],this.attachMenu=_.default({noRipple:!0,listenerSetter:this.listenerSetter},"top-left",this.attachMenuButtons),this.attachMenu.classList.add("attach-file","tgico-attach"),this.attachMenu.classList.remove("tgico-more"),this.recordTimeEl=document.createElement("div"),this.recordTimeEl.classList.add("record-time"),this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.multiple=!0,this.fileInput.style.display="none",this.newMessageWrapper.append(...[this.btnToggleEmoticons,this.inputMessageContainer,this.btnScheduled,this.attachMenu,this.recordTimeEl,this.fileInput].filter(Boolean)),this.rowsWrapper.append(this.replyElements.container,this.newMessageWrapper),this.btnCancelRecord=y.default("delete danger btn-circle z-depth-1 btn-record-cancel"),this.btnSendContainer=document.createElement("div"),this.btnSendContainer.classList.add("btn-send-container"),this.recordRippleEl=document.createElement("div"),this.recordRippleEl.classList.add("record-ripple"),this.btnSend=y.default("none btn-circle z-depth-1 btn-send"),this.btnSend.insertAdjacentHTML("afterbegin",'\n    <span class="tgico tgico-send"></span>\n    <span class="tgico tgico-schedule"></span>\n    <span class="tgico tgico-check"></span>\n    <span class="tgico tgico-microphone2"></span>\n    '),this.btnSendContainer.append(this.recordRippleEl,this.btnSend),"scheduled"!==this.chat.type&&(this.sendMenu=new L.default({onSilentClick:()=>{this.sendSilent=!0,this.sendMessage()},onScheduleClick:()=>{this.scheduleSending(void 0)},listenerSetter:this.listenerSetter,openSide:"top-left",onContextElement:this.btnSend,onOpen:()=>!this.isInputEmpty()}),this.btnSendContainer.append(this.sendMenu.sendMenu)),this.inputContainer.append(this.btnCancelRecord,this.btnSendContainer),c.default.attachButtonListener(this.btnToggleEmoticons),c.default.events.onOpen.push(this.onEmoticonsOpen),c.default.events.onClose.push(this.onEmoticonsClose),this.attachMessageInputField(),this.stickersHelper=new v.default(this.rowsWrapper);try{this.recorder=new n.default({encoderSampleRate:48e3,monitorGain:0,numberOfChannels:1,recordingGain:1,reuseWorker:!0})}catch(e){console.error("Recorder constructor error:",e)}this.updateSendBtn(),this.listenerSetter.add(this.fileInput,"change",e=>{let t=e.target.files;t.length&&(new u.default(this.chat,Array.from(t).slice(),this.willAttachType),this.fileInput.value="")},!1),l.attachClickEvent(this.btnSend,this.onBtnSendClick,{listenerSetter:this.listenerSetter,touchMouseDown:!0}),this.recorder&&(l.attachClickEvent(this.btnCancelRecord,this.onCancelRecordClick,{listenerSetter:this.listenerSetter}),this.recorder.onstop=()=>{this.recording=!1,this.chatInput.classList.remove("is-recording","is-locked"),this.updateSendBtn(),this.recordRippleEl.style.transform=""},this.recorder.ondataavailable=e=>{if(this.recordCanceled)return;const t=(Date.now()-this.recordStartTime)/1e3|0,s=new Blob([e],{type:"audio/ogg"});r.default.decode(e,!0).then(e=>{r.default.setKeepAlive(!1);let i=this.chat.peerId;this.appMessagesManager.sendFile(i,s,{isVoiceMessage:!0,isMedia:!0,duration:t,waveform:e.waveform,objectURL:e.url,replyToMsgId:this.replyToMsgId,threadId:this.chat.threadId}),this.onMessageSent(!1,!0)})}),l.attachClickEvent(this.replyElements.cancelBtn,this.onHelperCancel,{listenerSetter:this.listenerSetter}),l.attachClickEvent(this.replyElements.container,this.onHelperClick,{listenerSetter:this.listenerSetter})}constructPinnedHelpers(){const e=document.createElement("div");e.classList.add("pinned-container"),this.pinnedControlBtn=S.default("btn-primary btn-transparent pinned-container-button",{icon:"unpin"}),e.append(this.pinnedControlBtn),this.listenerSetter.add(this.pinnedControlBtn,"click",()=>{const e=this.chat.peerId;new C.default(e,0,!0,()=>{this.chat.appImManager.setPeer(0);const e=this.chat.appImManager.chat;e.topbar.pinnedMessage&&e.topbar.pinnedMessage.pinnedMessageContainer.toggle(!0)})}),this.rowsWrapper.append(e),this.chatInput.classList.add("type-pinned"),this.rowsWrapper.classList.add("is-centered")}setUnreadCount(){const e=this.appMessagesManager.getDialogByPeerId(this.chat.peerId)[0],t=null==e?void 0:e.unread_count;this.goDownUnreadBadge.innerText=""+(t||""),this.goDownUnreadBadge.classList.toggle("badge-gray",this.appMessagesManager.isPeerMuted(this.chat.peerId))}destroy(){c.default.events.onOpen.findAndSplice(e=>e==this.onEmoticonsOpen),c.default.events.onClose.findAndSplice(e=>e==this.onEmoticonsClose),this.listenerSetter.removeAll()}cleanup(){this.chat.peerId||(this.chatInput.style.display="none",this.goDownBtn.classList.add("hide")),l.cancelSelection(),this.messageInput&&(this.clearInput(),this.clearHelper())}finishPeerChange(){const e=this.chat.peerId;this.chatInput.style.display="";const t=this.appPeersManager.isBroadcast(e);if(this.goDownBtn.classList.toggle("is-broadcast",t),this.goDownBtn.classList.remove("hide"),this.goDownUnreadBadge&&this.setUnreadCount(),"pinned"===this.chat.type&&this.chatInput.classList.toggle("can-pin",this.appPeersManager.canPinMessage(e)),this.btnScheduled){this.btnScheduled.classList.add("hide");const t=this.chat.bubbles.getMiddleware();this.appMessagesManager.getScheduledMessages(e).then(e=>{t()&&this.btnScheduled.classList.toggle("hide",!e.length)})}if(this.sendMenu&&this.sendMenu.setPeerId(e),this.messageInput){const t=this.appMessagesManager.canWriteToPeer(e);this.chatInput.classList.add("no-transition"),this.chatInput.classList.toggle("is-hidden",!t),this.chatInput.offsetLeft,this.chatInput.classList.remove("no-transition");const s=this.attachMenuButtons.filter(t=>{const s=t.verify(e);return t.element.classList.toggle("hide",!s),s});t?this.messageInput.setAttribute("contenteditable","true"):this.messageInput.removeAttribute("contenteditable"),this.attachMenu.toggleAttribute("disabled",!s.length),this.updateSendBtn()}else this.pinnedControlBtn&&this.pinnedControlBtn.append(this.appPeersManager.canPinMessage(this.chat.peerId)?"Unpin all messages":"Don't show pinned messages")}attachMessageInputField(){var e;const t=null===(e=this.messageInputField)||void 0===e?void 0:e.input;this.messageInputField=new b.default({placeholder:"Message",name:"message"}),this.messageInputField.input.className="input-message-input",this.messageInput=this.messageInputField.input,this.attachMessageInputListeners();const s=this.inputScroll.container;t?t.replaceWith(this.messageInputField.input):s.append(this.messageInputField.input)}attachMessageInputListeners(){this.listenerSetter.add(this.messageInput,"keydown",e=>{if("Enter"!=e.key||a.isTouchSupported)(e.ctrlKey||e.metaKey)&&this.handleMarkdownShortcut(e);else{if(e.shiftKey||e.ctrlKey||e.metaKey)return;this.sendMessage()}}),a.isTouchSupported&&(l.attachClickEvent(this.messageInput,e=>{this.appImManager.selectTab(1),this.saveScroll(),c.default.toggle(!1)},{listenerSetter:this.listenerSetter}),this.listenerSetter.add(window,"resize",()=>{this.restoreScroll()})),this.listenerSetter.add(this.messageInput,"input",this.onMessageInput)}applyMarkdown(e,t){const s={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",monospace:()=>document.execCommand("fontName",!1,"monospace"),link:t?()=>document.execCommand("createLink",!1,t):()=>document.execCommand("unlink",!1,null)};if(!s[e])return!1;const i=s[e],n=this.prepareDocumentExecute(),a=[];if(a.push(document.execCommand("styleWithCSS",!1,"true")),"monospace"===e){let t=!1;const s=window.getSelection();if(!s.isCollapsed){const i=s.getRangeAt(0),n=l.markdownTags[e],a=i.commonAncestorContainer;(a.parentNode.matches(n.match)||a instanceof HTMLElement&&a.matches(n.match))&&(t=!0)}t?a.push(document.execCommand("fontName",!1,"Roboto")):a.push("function"==typeof i?i():document.execCommand(i,!1,null))}else a.push("function"==typeof i?i():document.execCommand(i,!1,null));return a.push(document.execCommand("styleWithCSS",!1,"false")),n(),this.appImManager.markupTooltip&&this.appImManager.markupTooltip.setActiveMarkupButton(),!0}clearInput(){a.isTouchSupported?this.messageInput.innerText="":(this.attachMessageInputField(),this.canRedoFromHTML="",this.undoHistory.length=0,this.executedHistory.length=0,this.canUndoFromHTML=""),this.onMessageInput()}isInputEmpty(){return l.isInputEmpty(this.messageInput)}updateSendBtn(){let e;e=this.editMsgId?"edit":!this.recorder||this.recording||!this.isInputEmpty()||this.forwardingMids.length?"scheduled"===this.chat.type?"schedule":"send":"record",["send","record","edit","schedule"].forEach(t=>{this.btnSend.classList.toggle(t,e===t)})}onMessageSent(e=!0,t){if("scheduled"!==this.chat.type){const e=this.appMessagesManager.getHistoryStorage(this.chat.peerId,this.chat.threadId);e.maxId&&this.appMessagesManager.readHistory(this.chat.peerId,e.maxId,this.chat.threadId)}this.scheduleDate=void 0,this.sendSilent=void 0,e&&(this.lastUrl="",delete this.noWebPage,this.willSendWebPage=null,this.clearInput()),(t||e)&&this.clearHelper(),this.updateSendBtn()}sendMessage(e=!1){if("scheduled"===this.chat.type&&!e&&!this.editMsgId)return void this.scheduleSending();const t=[],s=l.getRichValue(this.messageInputField.input,t);if(this.editMsgId?this.appMessagesManager.editMessage(this.chat.getMessage(this.editMsgId),s,{entities:t,noWebPage:this.noWebPage}):this.appMessagesManager.sendText(this.chat.peerId,s,{entities:t,replyToMsgId:this.replyToMsgId,threadId:this.chat.threadId,noWebPage:this.noWebPage,webPage:this.willSendWebPage,scheduleDate:this.scheduleDate,silent:this.sendSilent}),this.forwardingMids.length){const e=this.forwardingMids.slice(),t=this.forwardingFromPeerId,s=this.chat.peerId,i=this.sendSilent,n=this.scheduleDate;setTimeout(()=>{this.appMessagesManager.forwardMessages(s,t,e,{silent:i,scheduleDate:n})},0)}this.onMessageSent()}sendMessageWithDocument(e,t=!1){var s;const i="sticker"===(e=this.appDocsManager.getDoc(e)).type?"send_stickers":"gif"===e.type?"send_gifs":"send_media";if(!(this.chat.peerId<0)||this.appChatsManager.hasRights(this.chat.peerId,"send",i))return"scheduled"!==this.chat.type||t?!!e&&(this.appMessagesManager.sendFile(this.chat.peerId,e,{isMedia:!0,replyToMsgId:this.replyToMsgId,threadId:this.chat.threadId,silent:this.sendSilent,scheduleDate:this.scheduleDate}),this.onMessageSent(!1,!0),"sticker"==e.type&&(null===(s=c.default.stickersTab)||void 0===s||s.pushRecentSticker(e)),!0):(this.scheduleSending(()=>this.sendMessageWithDocument(e,!0)),!1);g.toast("Posting media content isn't allowed in this group.")}initMessageEditing(e){const t=this.chat.getMessage(e);let s=d.default.wrapDraftText(t.message,{entities:t.totalEntities});const i=()=>{const n=this.appMessagesManager.getRichReplyText(t,void 0,[t.mid]);this.setTopInfo("edit",i,"Editing",void 0,s,t);this.replyElements.container.querySelector(".reply-subtitle").innerHTML=n,this.editMsgId=e,s=void 0};i()}initMessagesForward(e,t){const s=()=>{const i=new Set(t.map(t=>{const s=this.appMessagesManager.getMessageByPeer(e,t);return s.fwd_from&&s.fwd_from.from_name&&!s.fromId&&!s.fwdFromId?s.fwd_from.from_name:s.fromId})),n=i.size>1,a=[...i].map(e=>"number"==typeof e?this.appPeersManager.getPeerTitle(e,!0,n):n?e.split(" ")[0]:e),o=a.length<3?a.join(" and "):a[0]+" and "+(a.length-1)+" others",r=this.appMessagesManager.getMessageByPeer(e,t[0]),d=this.appMessagesManager.getRichReplyText(r,void 0,t);if(d.includes("Album")||1===t.length){this.setTopInfo("forward",s,o);this.replyElements.container.querySelector(".reply-subtitle").innerHTML=d}else this.setTopInfo("forward",s,o,t.length+" "+(t.length>1?"forwarded messages":"forwarded message"));this.forwardingMids=t.slice(),this.forwardingFromPeerId=e};s()}clearHelper(e){"edit"==this.helperType&&"edit"!=e&&this.clearInput(),e&&(this.lastUrl="",delete this.noWebPage,this.willSendWebPage=null),this.replyToMsgId=this.chat.threadId,this.forwardingMids.length=0,this.forwardingFromPeerId=0,this.editMsgId=void 0,this.helperType=this.helperFunc=void 0,this.chat.container.classList.remove("is-helper-active")}setTopInfo(e,t,s="",i="",n,a){"webpage"!=e&&(this.clearHelper(e),this.helperType=e,this.helperFunc=t),"DIV"==this.replyElements.container.lastElementChild.tagName&&(this.replyElements.container.lastElementChild.remove(),this.replyElements.container.append(m.wrapReply(s,i,a))),this.chat.container.classList.add("is-helper-active"),void 0!==n&&(this.clearInput(),this.messageInput.innerHTML=n||"",this.onMessageInput(),window.requestAnimationFrame(()=>{l.placeCaretAtEnd(this.messageInput),this.inputScroll.scrollTop=this.inputScroll.scrollHeight})),setTimeout(()=>{this.updateSendBtn()},0)}saveScroll(){this.scrollTop=this.chat.bubbles.scrollable.container.scrollTop,this.scrollOffsetTop=this.chatInput.offsetTop}restoreScroll(){if(this.chatInput.style.display)return;let e=this.chatInput.offsetTop,t=this.chat.bubbles.scrollable.container,s=t.scrollTop,i=t.clientHeight,n=t.scrollHeight;if(e<this.scrollOffsetTop)this.scrollDiff=this.scrollOffsetTop-e,t.scrollTop+=this.scrollDiff;else if(s!=this.scrollTop){n-(s+i)<this.scrollDiff||(t.scrollTop-=this.scrollDiff)}}}},function(e,t,s){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";(function(t){var s=t.AudioContext||t.webkitAudioContext,i=function(e){if(!i.isRecordingSupported())throw new Error("Recording is not supported in this browser");e||(e={}),this.state="inactive",this.config=Object.assign({bufferLength:4096,encoderApplication:2049,encoderFrameSize:20,encoderPath:"encoderWorker.min.js",encoderSampleRate:48e3,maxFramesPerPage:40,mediaTrackConstraints:!0,monitorGain:0,numberOfChannels:1,recordingGain:1,resampleQuality:3,streamPages:!1,reuseWorker:!1,wavBitDepth:16},e),this.encodedSamplePosition=0};i.isRecordingSupported=function(){return s&&t.navigator&&t.navigator.mediaDevices&&t.navigator.mediaDevices.getUserMedia&&t.WebAssembly},i.prototype.clearStream=function(){this.stream&&(this.stream.getTracks?this.stream.getTracks().forEach((function(e){e.stop()})):this.stream.stop(),delete this.stream),this.audioContext&&this.closeAudioContext&&(this.audioContext.close(),delete this.audioContext)},i.prototype.encodeBuffers=function(e){if("recording"===this.state){for(var t=[],s=0;s<e.numberOfChannels;s++)t[s]=e.getChannelData(s);this.encoder.postMessage({command:"encode",buffers:t})}},i.prototype.initAudioContext=function(e){return e&&e.context?(this.audioContext=e.context,this.closeAudioContext=!1):(this.audioContext=new s,this.closeAudioContext=!0),this.audioContext},i.prototype.initAudioGraph=function(){this.encodeBuffers=function(){delete this.encodeBuffers},this.scriptProcessorNode=this.audioContext.createScriptProcessor(this.config.bufferLength,this.config.numberOfChannels,this.config.numberOfChannels),this.scriptProcessorNode.connect(this.audioContext.destination),this.scriptProcessorNode.onaudioprocess=e=>{this.encodeBuffers(e.inputBuffer)},this.monitorGainNode=this.audioContext.createGain(),this.setMonitorGain(this.config.monitorGain),this.monitorGainNode.connect(this.audioContext.destination),this.recordingGainNode=this.audioContext.createGain(),this.setRecordingGain(this.config.recordingGain),this.recordingGainNode.connect(this.scriptProcessorNode)},i.prototype.initSourceNode=function(e){return e&&e.context?t.Promise.resolve(e):t.navigator.mediaDevices.getUserMedia({audio:this.config.mediaTrackConstraints}).then(e=>(this.stream=e,this.audioContext.createMediaStreamSource(e)))},i.prototype.loadWorker=function(){this.encoder||(this.encoder=new t.Worker(this.config.encoderPath))},i.prototype.initWorker=function(){var e=(this.config.streamPages?this.streamPage:this.storePage).bind(this);return this.recordedPages=[],this.totalLength=0,this.loadWorker(),new Promise((t,s)=>{var i=s=>{switch(s.data.message){case"ready":t();break;case"page":this.encodedSamplePosition=s.data.samplePosition,e(s.data.page);break;case"done":this.encoder.removeEventListener("message",i),this.finish()}};this.encoder.addEventListener("message",i),this.encoder.postMessage(Object.assign({command:"init",originalSampleRate:this.audioContext.sampleRate,wavSampleRate:this.audioContext.sampleRate},this.config))})},i.prototype.pause=function(e){if("recording"===this.state){if(this.state="paused",e&&this.config.streamPages){var t=this.encoder;return new Promise((e,s)=>{var i=s=>{"flushed"===s.data.message&&(t.removeEventListener("message",i),this.onpause(),e())};t.addEventListener("message",i),t.postMessage({command:"flush"})})}return this.onpause(),Promise.resolve()}},i.prototype.resume=function(){"paused"===this.state&&(this.state="recording",this.onresume())},i.prototype.setRecordingGain=function(e){this.config.recordingGain=e,this.recordingGainNode&&this.audioContext&&this.recordingGainNode.gain.setTargetAtTime(e,this.audioContext.currentTime,.01)},i.prototype.setMonitorGain=function(e){this.config.monitorGain=e,this.monitorGainNode&&this.audioContext&&this.monitorGainNode.gain.setTargetAtTime(e,this.audioContext.currentTime,.01)},i.prototype.start=function(e){if("inactive"===this.state)return this.initAudioContext(e),this.initAudioGraph(),this.encodedSamplePosition=0,this.initWorker().then(()=>this.initSourceNode(e)).then(e=>{this.sourceNode=e,this.state="recording",this.onstart(),this.encoder.postMessage({command:"getHeaderPages"}),this.sourceNode.connect(this.monitorGainNode),this.sourceNode.connect(this.recordingGainNode)})},i.prototype.stop=function(){if("inactive"!==this.state){this.state="inactive",this.monitorGainNode.disconnect(),this.scriptProcessorNode.disconnect(),this.recordingGainNode.disconnect(),this.sourceNode.disconnect(),this.clearStream();var e=this.encoder;return new Promise(t=>{var s=i=>{"done"===i.data.message&&(e.removeEventListener("message",s),t())};e.addEventListener("message",s),e.postMessage({command:"done"}),this.config.reuseWorker||e.postMessage({command:"close"})})}return Promise.resolve()},i.prototype.destroyWorker=function(){"inactive"===this.state&&this.encoder&&(this.encoder.postMessage({command:"close"}),delete this.encoder)},i.prototype.storePage=function(e){this.recordedPages.push(e),this.totalLength+=e.length},i.prototype.streamPage=function(e){this.ondataavailable(e)},i.prototype.finish=function(){if(!this.config.streamPages){var e=new Uint8Array(this.totalLength);this.recordedPages.reduce((function(t,s){return e.set(s,t),t+s.length}),0),this.ondataavailable(e)}this.onstop(),this.config.reuseWorker||delete this.encoder},i.prototype.ondataavailable=function(){},i.prototype.onpause=function(){},i.prototype.onresume=function(){},i.prototype.onstart=function(){},i.prototype.onstop=function(){},e.exports=i}).call(this,s(1))},function(e,t){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(e){"object"==typeof window&&(s=window)}e.exports=s}])},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(53),a=i(s(15)),o=i(s(13)),r=i(s(67)),d=s(3),l=s(4),c=i(s(6));t.default=class{constructor(){this.recent=[],this.onContentClick=e=>{let t=e.target;if("SPAN"!=t.tagName||t.classList.contains("emoji")){if("DIV"==t.tagName)return}else t=t.firstElementChild;a.default.chat.input.messageInput.innerHTML+=t.outerHTML;const s=this.getEmojiFromElement(t);Array.from(this.recentItemsDiv.children).forEach((e,t)=>{const i=this.getEmojiFromElement(e);s==i&&e.remove()});this.recentItemsDiv.scrollHeight;this.appendEmoji(s,this.recentItemsDiv,!0),this.recent.findAndSplice(e=>e==s),this.recent.unshift(s),this.recent.length>36&&(this.recent.length=36),o.default.pushToState("recentEmoji",this.recent);const i=new Event("input",{bubbles:!0,cancelable:!0});a.default.chat.input.messageInput.dispatchEvent(i)}}init(){this.content=document.getElementById("content-emoji");const e=["Smileys & Emotion","Animals & Nature","Food & Drink","Travel & Places","Activities","Objects","Flags","Skin Tones"],t={},s={Recent:[]};for(const t in r.default.Emoji){const i=""+r.default.Emoji[t],n=e[+i[0]-1];n&&(s[n]||(s[n]=[]),s[n][+i.slice(1)||0]=t)}e.pop(),delete s["Skin Tones"];for(const e in s){const i=document.createElement("div");i.classList.add("emoji-category");const n=document.createElement("div");n.classList.add("category-title"),n.innerText=e;const a=document.createElement("div");a.classList.add("category-items"),i.append(n,a);s[e].forEach(e=>{e=e.split("-").reduce((e,t)=>e+String.fromCodePoint(parseInt(t,16)),""),this.appendEmoji(e,a,!1)}),t[e]=i}const i=this.content.previousElementSibling,a=this.scroll=new c.default(this.content,"EMOJI"),d=l.putPreloader(this.content,!0);Promise.all([new Promise(e=>setTimeout(e,200)),o.default.getState().then(e=>{Array.isArray(e.recentEmoji)&&(this.recent=e.recentEmoji)})]).then(()=>{d.remove(),this.recentItemsDiv=t.Recent.querySelector(".category-items");for(const e of this.recent)this.appendEmoji(e,this.recentItemsDiv);e.unshift("Recent"),e.map(e=>{const s=t[e];return s||console.error("no div by category:",e),a.container.append(s),this.stickyIntersector.observeStickyHeaderChanges(s),s})}),this.content.addEventListener("click",this.onContentClick),this.stickyIntersector=n.EmoticonsDropdown.menuOnClick(i,a),this.init=null}appendEmoji(e,t,s=!1){const i=document.createElement("span");let n;if(i.classList.add("category-item"),n=d.RichTextProcessor.wrapEmojiText(e),i.innerHTML=n,i.children.length>1){const e=i.firstElementChild;i.innerHTML="",i.append(e)}i.firstElementChild&&i.firstElementChild.setAttribute("loading","lazy"),s?t.prepend(i):t.appendChild(i)}getEmojiFromElement(e){return"SPAN"!=e.tagName||e.classList.contains("emoji")||(e=e.firstElementChild),e.getAttribute("alt")||e.innerText}onClose(){}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(s(53)),d=o(s(96)),l=o(s(6)),c=s(4),f=o(s(5)),h=o(s(21));t.default=class{init(){this.content=document.getElementById("content-gifs");const e=this.content.firstElementChild;e.addEventListener("click",r.EmoticonsDropdown.onMediaClick);const t=new l.default(this.content,"GIFS"),s=new d.default(e,r.EMOTICONSSTICKERGROUP,t),i=c.putPreloader(this.content,!0);f.default.invokeApi("messages.getSavedGifs",{hash:0}).then(e=>{"messages.savedGifs"==e._&&e.gifs.forEach((t,i)=>{e.gifs[i]=t=h.default.saveDoc(t),s.add(t)}),i.remove()}),r.default.addLazyLoadQueueRepeat(s.lazyLoadQueue,s.processInvisibleDiv),this.init=null}onClose(){}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(37)),a=s(0),o=i(s(77)),r=i(s(28)),d=i(s(152)),l=i(s(6)),c=s(36),f=i(s(78));class h extends n.default{constructor(e){if(super("popup-create-poll popup-new-media",null,{closable:!0,withConfirm:"CREATE",body:!0}),this.chat=e,this.tempId=0,this.onSubmitClick=()=>{this.send()},this.onInput=e=>{const t=e.target,s=a.findUpTag(t,"LABEL"),i=a.isInputEmpty(t);i||(t.parentElement.classList.add("is-filled"),s.classList.remove("hidden-widget"),s.firstElementChild.removeAttribute("disabled"));!s.nextElementSibling&&!i&&this.questions.childElementCount<10&&this.appendMoreField()},this.onDeleteClick=e=>{const t=e.target;a.findUpTag(t,"LABEL").remove(),Array.from(this.questions.children).forEach((e,t)=>{e.querySelector("label").innerText="Option "+(t+1)})},this.title.innerText="New Poll",this.questionInputField=new r.default({placeholder:"Ask a Question",label:"Ask a Question",name:"question",maxLength:255}),"scheduled"!==this.chat.type){const e=new f.default({onSilentClick:()=>{this.chat.input.sendSilent=!0,this.send()},onScheduleClick:()=>{this.chat.input.scheduleSending(()=>{this.send()})},openSide:"bottom-left",onContextElement:this.btnConfirm});e.setPeerId(this.chat.peerId),this.header.append(e.sendMenu)}this.header.append(this.questionInputField.container);const t=document.createElement("hr"),s=document.createElement("div");s.classList.add("caption"),s.innerText="Options",this.questions=document.createElement("form"),this.questions.classList.add("poll-create-questions");const i=document.createElement("div");i.classList.add("poll-create-settings");const n=document.createElement("div");n.classList.add("caption"),n.innerText="Settings",this.chat.appPeersManager.isBroadcast(this.chat.peerId)||(this.anonymousCheckboxField=o.default("Anonymous Voting","anonymous"),this.anonymousCheckboxField.input.checked=!0,i.append(this.anonymousCheckboxField.label)),this.multipleCheckboxField=o.default("Multiple Answers","multiple"),this.quizCheckboxField=o.default("Quiz Mode","quiz"),this.multipleCheckboxField.input.addEventListener("change",()=>{const e=this.multipleCheckboxField.input.checked;this.quizCheckboxField.input.toggleAttribute("disabled",e)}),this.quizCheckboxField.input.addEventListener("change",()=>{const e=this.quizCheckboxField.input.checked;Array.from(this.questions.children).map(t=>{t.classList.toggle("radio-field",e)}),d.forEach(t=>t.classList.toggle("hide",!e)),this.multipleCheckboxField.input.toggleAttribute("disabled",e)}),i.append(this.multipleCheckboxField.label,this.quizCheckboxField.label);const d=[],c=document.createElement("div");c.classList.add("caption"),c.innerText="Explanation";const h=document.createElement("hr"),u=document.createElement("div");u.classList.add("poll-create-questions"),this.quizSolutionField=new r.default({placeholder:"Add a Comment (Optional)",label:"Add a Comment (Optional)",name:"solution",maxLength:200});const p=document.createElement("div");p.classList.add("subtitle"),p.innerText="Users will see this comment after choosing a wrong answer, good for educational purposes.",u.append(this.quizSolutionField.container,p),d.push(h,c,u),d.forEach(e=>e.classList.add("hide")),this.body.parentElement.insertBefore(t,this.body),this.body.append(s,this.questions,document.createElement("hr"),n,i,...d),this.btnConfirm.addEventListener("click",this.onSubmitClick),this.scrollable=new l.default(this.body),this.appendMoreField(),this.onEscape=()=>!this.getFilledAnswers().length}getFilledAnswers(){return Array.from(this.questions.children).map((e,t)=>{const s=e.querySelector(".input-field-input");return s instanceof HTMLInputElement?s.value:a.getRichValue(s)}).filter(e=>!!e.trim())}send(e=!1){var t;const s=this.questionInputField.value;if(!s)return void c.toast("Please enter a question.");if(s.length>255)return void c.toast("Question is too long.");if(this.quizCheckboxField.input.checked&&!(null===(t=this.correctAnswers)||void 0===t?void 0:t.length))return void c.toast("Please choose the correct answer.");const i=this.getFilledAnswers();if(i.length<2)return void c.toast("Please enter at least two options.");if(i.find(e=>e.length>100))return void c.toast("Option is too long.");const n=[],o=a.getRichValue(this.quizSolutionField.input,n)||void 0;if((null==o?void 0:o.length)>200)return void c.toast("Explanation is too long.");if("scheduled"===this.chat.type&&!e)return void this.chat.input.scheduleSending(()=>{this.send(!0)});this.btnClose.click(),this.btnConfirm.removeEventListener("click",this.onSubmitClick);const r={};this.anonymousCheckboxField&&!this.anonymousCheckboxField.input.checked&&(r.public_voters=!0),this.multipleCheckboxField.input.checked&&(r.multiple_choice=!0),this.quizCheckboxField.input.checked&&(r.quiz=!0);const d={_:"poll",pFlags:r,question:s,answers:i.map((e,t)=>({_:"pollAnswer",text:e,option:new Uint8Array([t])})),id:void 0},l=this.chat.appPollsManager.getInputMediaPoll(d,this.correctAnswers,o,n);this.chat.appMessagesManager.sendOther(this.chat.peerId,l,{threadId:this.chat.threadId,replyToMsgId:this.chat.input.replyToMsgId,scheduleDate:this.chat.input.scheduleDate,silent:this.chat.input.sendSilent}),"reply"===this.chat.input.helperType&&this.chat.input.clearHelper(),this.chat.input.onMessageSent(!1,!1)}appendMoreField(){const e=this.tempId++,t=this.questions.childElementCount+1,s=new r.default({placeholder:"Add an Option",label:"Option "+t,name:"question-"+e,maxLength:100});s.input.addEventListener("input",this.onInput);const i=d.default("","question");i.main.append(s.container),i.main.addEventListener("click",a.cancelEvent),i.label.classList.add("hidden-widget"),i.input.disabled=!0,this.quizCheckboxField.input.checked||i.label.classList.remove("radio-field"),i.input.addEventListener("change",()=>{if(i.input.checked){const e=a.whichChild(i.label);this.correctAnswers=[new Uint8Array([e])]}});const n=document.createElement("span");n.classList.add("btn-icon","tgico-close"),s.container.append(n),n.addEventListener("click",this.onDeleteClick,{once:!0}),this.questions.append(i.label),this.scrollable.scrollIntoView(this.questions.lastElementChild,!0)}}t.default=h},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=(e,t)=>{const s=document.createElement("label");s.classList.add("radio-field");const i=document.createElement("input");i.type="radio",i.id=i.name="input-radio-"+t;const n=document.createElement("div");return n.classList.add("radio-field-main"),n.innerText=e,s.append(i,n),{label:s,input:i,main:n}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),d=a(s(15)),l=o(s(51)),c=s(53),f=s(100),h=o(s(25)),u=o(s(6)),p=o(s(63));t.default=class{constructor(e){this.appendTo=e,this.lastEmoticon=""}checkEmoticon(e){this.lastEmoticon!=e&&(this.lastEmoticon&&!e&&this.container&&p.default(this.container,"is-visible",!1,200),this.lastEmoticon=e,this.lazyLoadQueue&&this.lazyLoadQueue.clear(),e&&l.default.getStickersByEmoticon(e).then(t=>{this.lastEmoticon==e&&(this.init&&(this.init(),this.init=null),this.stickersContainer.innerHTML="",this.lazyLoadQueue.clear(),t.length&&t.forEach(e=>{this.stickersContainer.append(this.superStickerRenderer.renderSticker(e))}),p.default(this.container,"is-visible",!0,200),this.scrollable.scrollTop=0)}))}init(){this.container=document.createElement("div"),this.container.classList.add("stickers-helper","z-depth-1"),this.stickersContainer=document.createElement("div"),this.stickersContainer.classList.add("stickers-helper-stickers","super-stickers"),this.stickersContainer.addEventListener("click",e=>{r.findUpClassName(e.target,"super-sticker")&&(d.default.chat.input.clearInput(),c.EmoticonsDropdown.onMediaClick(e))}),this.container.append(this.stickersContainer),this.scrollable=new u.default(this.container),this.lazyLoadQueue=new h.default,this.superStickerRenderer=new f.SuperStickerRenderer(this.lazyLoadQueue,d.CHAT_ANIMATION_GROUP),this.appendTo.append(this.container)}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(75)),a=()=>{const e=new Date;return e.setHours(0,0,0,0),e};class o extends n.default{constructor(e,t){super(e,t,{noButtons:!0,noTitle:!0,closable:!0,withConfirm:"Send Today",minDate:a(),maxDate:(()=>{const e=new Date;return e.setFullYear(e.getFullYear()+1),e.setDate(e.getDate()-1),e})(),withTime:!0,showOverflowMonths:!0}),this.element.classList.add("popup-schedule"),this.header.append(this.controlsDiv),this.title.replaceWith(this.monthTitle),this.body.append(this.btnConfirm)}}t.default=o},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(11),a=s(0),o=i(s(32)),r=i(s(38)),d=i(s(77)),l=i(s(98)),c=i(s(52)),f=s(36),h=i(s(63)),u=i(s(99));t.default=class{constructor(e,t,s,i){this.chat=e,this.bubbles=t,this.input=s,this.appMessagesManager=i,this.selectedMids=new Set,this.isSelecting=!1,this.cancelSelection=()=>{for(const e of this.selectedMids){const t=this.bubbles.getMountedBubble(e);t&&this.toggleByBubble(t.bubble)}this.selectedMids.clear(),this.toggleSelection(),a.cancelSelection()},this.toggleByBubble=e=>{if(!this.canSelectBubble(e))return;const t=+e.dataset.mid;if(e.classList.contains("is-grouped")){if(!this.isGroupedBubbleSelected(e)){this.chat.getMidsByMid(t).forEach(e=>this.selectedMids.delete(e))}return void this.bubbles.getBubbleGroupedItems(e).forEach(this.toggleByBubble)}const s=this.selectedMids.has(t);if(s)this.selectedMids.delete(t);else{if(100-this.selectedMids.size-1<0)return void f.toast("Max selection count reached.");this.selectedMids.add(t)}if(e.classList.contains("grouped-item")){const s=a.findUpClassName(e,"bubble"),i=this.isGroupedBubbleSelected(s),n=this.isGroupedMidsSelected(t);(n||i)&&this.updateBubbleSelection(s,n)}this.updateBubbleSelection(e,!s)};const o=t.bubblesContainer;this.listenerSetter=t.listenerSetter,n.isTouchSupported?this.listenerSetter.add(o,"touchend",e=>{this.isSelecting&&(this.selectedText=a.getSelectedText())}):this.listenerSetter.add(o,"mousedown",e=>{const t=a.findUpClassName(e.target,"bubble");if(0!=e.button||!this.selectedMids.size&&!e.target.classList.contains("bubble")&&!e.target.classList.contains("document-selection")&&t)return;const s=new Set;let i,n=!1;const r=e=>{n||(a.cancelSelection(),n=!0);const t=a.findUpClassName(e.target,"grouped-item")||a.findUpClassName(e.target,"bubble");if(!t)return;const c=+t.dataset.mid;if(c){if(e.target!=t&&!e.target.classList.contains("document-selection")&&void 0===i&&!this.selectedMids.size)return this.listenerSetter.removeManual(o,"mousemove",r),void this.listenerSetter.removeManual(document,"mouseup",d,l);if(!s.has(c)){const e=this.selectedMids.has(c);void 0===i&&(i=!e),s.add(c),(i&&!e||!i&&e)&&(this.selectedMids.size?this.toggleByBubble(t):2==s.size&&[...s].forEach(e=>{const t=this.bubbles.getMountedBubble(e);t&&this.toggleByBubble(t.bubble)}))}}},d=e=>{s.size&&window.addEventListener("click",e=>{a.cancelEvent(e)},{capture:!0,once:!0,passive:!1}),this.listenerSetter.removeManual(o,"mousemove",r),a.cancelSelection()},l={once:!0};this.listenerSetter.add(o,"mousemove",r),this.listenerSetter.add(document,"mouseup",d,l)})}toggleBubbleCheckbox(e,t){if(!this.canSelectBubble(e))return;const s=!!this.getCheckboxInputFromBubble(e),i=e.classList.contains("is-grouped");if(t){if(s)return;const t=d.default("",e.dataset.mid,!0);t.label.classList.add("bubble-select-checkbox");const n=+e.dataset.mid;!this.selectedMids.has(n)||i&&!this.isGroupedMidsSelected(n)||(t.input.checked=!0,e.classList.add("is-selected")),e.classList.contains("document-container")?e.querySelector(".document, audio-element").append(t.label):e.prepend(t.label)}else s&&this.getCheckboxInputFromBubble(e).parentElement.remove();i&&this.bubbles.getBubbleGroupedItems(e).forEach(e=>this.toggleBubbleCheckbox(e,t))}getCheckboxInputFromBubble(e){return e.classList.contains("document-container")?e.querySelector("label input"):"LABEL"==e.firstElementChild.tagName&&e.firstElementChild.firstElementChild}updateContainer(e=!1){if(!this.selectedMids.size&&!e)return;this.selectionCountEl.innerText=this.selectedMids.size+" Message"+(1==this.selectedMids.size?"":"s");let t=!this.selectedMids.size,s=!this.selectedMids.size,i=!this.selectedMids.size;for(const e of this.selectedMids.values()){const i=this.appMessagesManager.getMessageByPeer(this.bubbles.peerId,e);if(t||i.action&&(t=!0),!s){this.appMessagesManager.canDeleteMessage(this.chat.getMessage(e))||(s=!0)}if(t&&s)break}this.selectionSendNowBtn&&this.selectionSendNowBtn.toggleAttribute("disabled",i),this.selectionForwardBtn&&this.selectionForwardBtn.toggleAttribute("disabled",t),this.selectionDeleteBtn.toggleAttribute("disabled",s)}toggleSelection(e=!0,t=!1){const s=this.isSelecting;if(this.isSelecting=this.selectedMids.size>0||t,s==this.isSelecting)return;const i=this.bubbles.bubblesContainer;n.isTouchSupported||(i.classList.toggle("no-select",this.isSelecting),s&&a.cancelSelection()),a.blurActiveElement();const d=!!this.selectedMids.size||t;if(h.default(this.input.rowsWrapper,"is-centering",d,200),h.default(i,"is-selecting",d,200,()=>{this.isSelecting||(this.selectionContainer.remove(),this.selectionContainer=this.selectionSendNowBtn=this.selectionForwardBtn=this.selectionDeleteBtn=null,this.selectedText=void 0),window.requestAnimationFrame(()=>{this.bubbles.onScroll()})}),this.isSelecting&&!this.selectionContainer){this.selectionContainer=document.createElement("div"),this.selectionContainer.classList.add("selection-container");const e=r.default("close",{noRipple:!0});this.listenerSetter.add(e,"click",this.cancelSelection,{once:!0}),this.selectionCountEl=document.createElement("div"),this.selectionCountEl.classList.add("selection-container-count"),"scheduled"===this.chat.type?(this.selectionSendNowBtn=o.default("btn-primary btn-transparent selection-container-send",{icon:"send2"}),this.selectionSendNowBtn.append("Send Now"),this.listenerSetter.add(this.selectionSendNowBtn,"click",()=>{new u.default(this.bubbles.peerId,[...this.selectedMids],()=>{this.cancelSelection()})})):(this.selectionForwardBtn=o.default("btn-primary btn-transparent selection-container-forward",{icon:"forward"}),this.selectionForwardBtn.append("Forward"),this.listenerSetter.add(this.selectionForwardBtn,"click",()=>{new c.default(this.bubbles.peerId,[...this.selectedMids],()=>{this.cancelSelection()})})),this.selectionDeleteBtn=o.default("btn-primary btn-transparent danger selection-container-delete",{icon:"delete"}),this.selectionDeleteBtn.append("Delete"),this.listenerSetter.add(this.selectionDeleteBtn,"click",()=>{new l.default(this.bubbles.peerId,[...this.selectedMids],this.chat.type,()=>{this.cancelSelection()})}),this.selectionContainer.append(...[e,this.selectionCountEl,this.selectionSendNowBtn,this.selectionForwardBtn,this.selectionDeleteBtn].filter(Boolean)),this.input.rowsWrapper.append(this.selectionContainer)}if(e)for(const e in this.bubbles.bubbles){const t=this.bubbles.bubbles[e];this.toggleBubbleCheckbox(t,this.isSelecting)}t&&this.updateContainer(t)}cleanup(){this.selectedMids.clear(),this.toggleSelection(!1)}updateBubbleSelection(e,t){this.toggleBubbleCheckbox(e,!0);this.getCheckboxInputFromBubble(e).checked=t,this.toggleSelection(),this.updateContainer(),h.default(e,"is-selected",t,200)}isGroupedBubbleSelected(e){const t=this.getCheckboxInputFromBubble(e);return null==t?void 0:t.checked}isGroupedMidsSelected(e){const t=this.chat.getMidsByMid(e),s=t.filter(e=>this.selectedMids.has(e));return t.length==s.length}deleteSelectedMids(e){e.forEach(e=>{this.selectedMids.delete(e)}),this.updateContainer(),this.toggleSelection()}canSelectBubble(e){return!e.classList.contains("service")&&!e.classList.contains("is-sending")}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),d=a(s(9)),l=s(12),c=o(s(1)),f=o(s(42)),h=o(s(32)),u=o(s(38)),p=o(s(64)),g=o(s(157)),m=o(s(158)),b=o(s(160)),v=o(s(60)),y=o(s(13)),M=o(s(103));t.default=class{constructor(e,t,s,i,n){this.chat=e,this.appSidebarRight=t,this.appMessagesManager=s,this.appPeersManager=i,this.appChatsManager=n,this.menuButtons=[],this.onResize=()=>{this.setUtilsWidth(!0)},this.onChangeScreen=(e,t)=>{this.chatAudio&&this.chatAudio.divAndCaption.container.classList.toggle("is-floating",t==d.ScreenSize.mobile),this.pinnedMessage&&this.pinnedMessage.onChangeScreen(e,t),this.setUtilsWidth(!0)},this.setUtilsWidth=(e=!1)=>{this.setUtilsRAF&&window.cancelAnimationFrame(this.setUtilsRAF),l.isSafari&&e&&this.chatUtils.classList.add("hide"),this.setUtilsRAF=window.requestAnimationFrame(()=>{l.isSafari&&e&&this.chatUtils.classList.remove("hide");const t=this.chatUtils.getBoundingClientRect().width;this.chat.log("utils width:",t),this.chatInfo.style.setProperty("--utils-width",t+"px"),this.setUtilsRAF=0})},this.setPeerStatus=(e=!1)=>{if(!this.subtitle)return;const t=this.peerId;e&&(this.subtitle.innerHTML=""),this.chat.appImManager.getPeerStatus(this.peerId).then(e=>{t==this.peerId&&(this.subtitle.innerHTML=e)})},this.listenerSetter=new v.default}construct(){this.container=document.createElement("div"),this.container.classList.add("sidebar-header","topbar"),this.btnBack=u.default("back sidebar-close-button",{noRipple:!0}),this.chatInfo=document.createElement("div"),this.chatInfo.classList.add("chat-info");const e=document.createElement("div");e.classList.add("person");const t=document.createElement("div");t.classList.add("content");const s=document.createElement("div");s.classList.add("top"),this.title=document.createElement("div"),this.title.classList.add("user-title"),s.append(this.title);const i=document.createElement("div");i.classList.add("bottom"),this.subtitle&&i.append(this.subtitle),t.append(s,i),this.avatarElement&&e.append(this.avatarElement),e.append(t),this.chatInfo.append(e),this.chatUtils=document.createElement("div"),this.chatUtils.classList.add("chat-utils"),this.chatAudio=new g.default(this,this.chat,this.appMessagesManager,this.appPeersManager),this.menuButtons.length&&(this.btnMore=p.default({listenerSetter:this.listenerSetter},"bottom-left",this.menuButtons,e=>{r.cancelEvent(e),this.menuButtons.forEach(e=>{e.element.classList.toggle("hide",!e.verify())}),this.menuButtons[this.menuButtons.length-1].element.firstChild.nodeValue=this.appPeersManager.getDeleteButtonText(this.peerId)})),this.chatUtils.append(...[this.chatAudio?this.chatAudio.divAndCaption.container:null,this.pinnedMessage?this.pinnedMessage.pinnedMessageContainer.divAndCaption.container:null,this.btnJoin,this.btnPinned,this.btnMute,this.btnSearch,this.btnMore].filter(Boolean)),this.container.append(this.btnBack,this.chatInfo,this.chatUtils),this.listenerSetter.add(window,"resize",this.onResize),d.default.addListener("changeScreen",this.onChangeScreen),r.attachClickEvent(this.container,e=>{const t=r.findUpClassName(e.target,"pinned-container");if(r.blurActiveElement(),t){r.cancelEvent(e);const s=+t.dataset.mid,i=+t.dataset.peerId;t.classList.contains("pinned-message")?this.pinnedMessage.followPinnedMessage(s):this.chat.appImManager.setInnerPeer(i,s)}else this.appSidebarRight.toggleSidebar(!0)},{listenerSetter:this.listenerSetter}),r.attachClickEvent(this.btnBack,e=>{r.cancelEvent(e),this.chat.appImManager.setPeer(0),r.blurActiveElement()},{listenerSetter:this.listenerSetter})}constructUtils(){this.menuButtons=[{icon:"search",text:"Search",onClick:()=>{new b.default(this,this.chat)},verify:()=>d.default.isMobile},{icon:"mute",text:"Mute",onClick:()=>{this.appMessagesManager.mutePeer(this.peerId)},verify:()=>"chat"===this.chat.type&&c.default.myId!=this.peerId&&!this.appMessagesManager.isPeerMuted(this.peerId)},{icon:"unmute",text:"Unmute",onClick:()=>{this.appMessagesManager.mutePeer(this.peerId)},verify:()=>"chat"===this.chat.type&&c.default.myId!=this.peerId&&this.appMessagesManager.isPeerMuted(this.peerId)},{icon:"select",text:"Select Messages",onClick:()=>{this.chat.selection.toggleSelection(!0,!0)},verify:()=>!this.chat.selection.isSelecting&&!!Object.keys(this.chat.bubbles.bubbles).length},{icon:"select",text:"Clear Selection",onClick:()=>{this.chat.selection.cancelSelection()},verify:()=>this.chat.selection.isSelecting},{icon:"delete danger",text:"Delete",onClick:()=>{new M.default(this.peerId)},verify:()=>"chat"===this.chat.type&&!!this.appMessagesManager.getDialogByPeerId(this.peerId)[0]}],this.btnSearch=u.default("search"),r.attachClickEvent(this.btnSearch,e=>{r.cancelEvent(e),this.peerId&&this.appSidebarRight.searchTab.open(this.peerId,this.chat.threadId)},{listenerSetter:this.listenerSetter})}constructPeerHelpers(){return this.avatarElement=new f.default,this.avatarElement.setAttribute("dialog","1"),this.avatarElement.setAttribute("clickable",""),this.avatarElement.classList.add("avatar-40","person-avatar"),this.subtitle=document.createElement("div"),this.subtitle.classList.add("info"),this.pinnedMessage=new m.default(this,this.chat,this.appMessagesManager,this.appPeersManager),this.btnJoin=h.default("btn-primary chat-join hide"),this.btnJoin.append("SUBSCRIBE"),this.btnPinned=u.default("pinlist"),this.btnMute=u.default("mute"),r.attachClickEvent(this.btnPinned,e=>{r.cancelEvent(e),r.blurActiveElement(),this.openPinned(!0)},{listenerSetter:this.listenerSetter}),r.attachClickEvent(this.btnMute,e=>{r.cancelEvent(e),r.blurActiveElement(),this.appMessagesManager.mutePeer(this.peerId)},{listenerSetter:this.listenerSetter}),r.attachClickEvent(this.btnJoin,e=>{r.cancelEvent(e),r.blurActiveElement(),this.btnJoin.setAttribute("disabled","true"),this.appChatsManager.joinChannel(-this.peerId).finally(()=>{this.btnJoin.removeAttribute("disabled")})},{listenerSetter:this.listenerSetter}),this.listenerSetter.add(c.default,"chat_update",e=>{var t,s;const i=e.detail;if(this.peerId==-i){const e=this.appChatsManager.getChat(i);this.btnJoin.classList.toggle("hide",!(null===(s=null===(t=e)||void 0===t?void 0:t.pFlags)||void 0===s?void 0:s.left)),this.setUtilsWidth()}}),this.listenerSetter.add(c.default,"dialog_notify_settings",e=>{e.detail==this.peerId&&this.setMutedState()}),this.listenerSetter.add(c.default,"peer_typings",e=>{const{peerId:t}=e.detail;this.peerId==t&&this.setPeerStatus()}),this.listenerSetter.add(c.default,"user_update",e=>{const t=e.detail;this.peerId==t&&this.setPeerStatus()}),this.pinnedMessage&&this.chat.addListener("setPeer",(e,t)=>{const s=this.chat.bubbles.getMiddleware();y.default.getState().then(i=>{s()&&(this.pinnedMessage.hidden=!!i.hiddenPinnedMessages[this.chat.peerId],t?(this.pinnedMessage.unsetScrollDownListener(),this.pinnedMessage.testMid(e,0)):this.pinnedMessage.locked||(this.pinnedMessage.handleFollowingPinnedMessage(),this.pinnedMessage.testMid(e)))})}),this.setPeerStatusInterval=window.setInterval(this.setPeerStatus,6e4),this}constructPinnedHelpers(){this.listenerSetter.add(c.default,"peer_pinned_messages",e=>{const{peerId:t,mids:s,pinned:i}=e.detail;t===this.peerId&&s&&this.setTitle()})}constructDiscussionHelpers(){this.pinnedMessage=new m.default(this,this.chat,this.appMessagesManager,this.appPeersManager)}openPinned(e){this.chat.appImManager.setInnerPeer(this.peerId,e?+this.pinnedMessage.pinnedMessageContainer.divAndCaption.container.dataset.mid:0,"pinned")}destroy(){this.listenerSetter.removeAll(),d.default.removeListener("changeScreen",this.onChangeScreen),window.clearInterval(this.setPeerStatusInterval),this.pinnedMessage&&this.pinnedMessage.destroy(),delete this.chatAudio,delete this.pinnedMessage}setPeer(e){this.wasPeerId=this.peerId,this.peerId=e,this.container.style.display=e?"":"none"}finishPeerChange(e,t,s){var i,n;const a=this.peerId;this.avatarElement&&(this.avatarElement.setAttribute("peer",""+a),this.avatarElement.update());const o=this.appPeersManager.isBroadcast(a);this.btnMute&&this.btnMute.classList.toggle("hide",!o),this.btnJoin&&this.btnJoin.classList.toggle("hide",!(null===(n=null===(i=this.appChatsManager.getChat(-a))||void 0===i?void 0:i.pFlags)||void 0===n?void 0:n.left)),this.setUtilsWidth();const r=this.chat.bubbles.getMiddleware();if(this.pinnedMessage)if("chat"===this.chat.type){if(this.wasPeerId){const e=new m.default(this,this.chat,this.appMessagesManager,this.appPeersManager);this.pinnedMessage.pinnedMessageContainer.divAndCaption.container.replaceWith(e.pinnedMessageContainer.divAndCaption.container),this.pinnedMessage.destroy(),this.pinnedMessage=e}y.default.getState().then(t=>{r()&&(this.pinnedMessage.hidden=!!t.hiddenPinnedMessages[a],e||this.pinnedMessage.setCorrectIndex(0))})}else"discussion"===this.chat.type&&(this.pinnedMessage.pinnedMid=this.chat.threadId,this.pinnedMessage.count=1,this.pinnedMessage.pinnedIndex=0,this.pinnedMessage._setPinnedMessage());window.requestAnimationFrame(()=>{this.setTitle(),this.setPeerStatus(!0),this.setMutedState()})}setTitle(e){let t="";"pinned"===this.chat.type?(t=[e>1&&e,"Pinned Messages"].filter(Boolean).join(" "),void 0===e&&this.appMessagesManager.getSearchCounters(this.peerId,[{_:"inputMessagesFilterPinned"}]).then(e=>{const t=e[0].count;if(this.setTitle(t),!t){this.chat.appImManager.setPeer(0);const e=this.chat.appImManager.chat;e.topbar.pinnedMessage&&e.topbar.pinnedMessage.pinnedMessageContainer.toggle(!0)}})):"scheduled"===this.chat.type?(t=this.peerId===c.default.myId?[e>1&&e,"Reminders"].filter(Boolean).join(" "):[e>1&&e,"Scheduled Messages"].filter(Boolean).join(" "),void 0===e&&this.appMessagesManager.getScheduledMessages(this.peerId).then(e=>{this.setTitle(e.length)})):"discussion"===this.chat.type?(t=[e>1&&e,"Comments"].filter(Boolean).join(" "),void 0===e&&Promise.all([this.appMessagesManager.getHistory(this.peerId,0,1,0,this.chat.threadId),Promise.resolve()]).then(()=>{this.setTitle(this.appMessagesManager.getHistoryStorage(this.peerId,this.chat.threadId).count)})):"chat"===this.chat.type&&(t=this.peerId==c.default.myId?"Saved Messages":this.appPeersManager.getPeerTitle(this.peerId)),this.title.innerHTML=t}setMutedState(){if(!this.btnMute)return;const e=this.peerId;let t=this.appMessagesManager.isPeerMuted(e);this.appPeersManager.isBroadcast(e)?(this.btnMute.classList.remove("tgico-mute","tgico-unmute"),this.btnMute.classList.add(t?"tgico-unmute":"tgico-mute"),this.btnMute.style.display=""):this.btnMute.style.display="none"}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(3),a=i(s(1)),o=s(0),r=i(s(50)),d=i(s(74)),l=s(24),c=i(s(102));class f extends c.default{constructor(e,t,s,i){super(e,t,e.listenerSetter,"audio",new d.default("pinned-audio",(e,t)=>{this.divAndCaption.title.innerHTML=e,this.divAndCaption.subtitle.innerHTML=t}),()=>{this.toggleEl.classList.contains("flip-icon")&&r.default.toggle()}),this.topbar=e,this.chat=t,this.appMessagesManager=s,this.appPeersManager=i,this.divAndCaption.border.remove(),this.toggleEl=document.createElement("button"),this.toggleEl.classList.add("pinned-audio-ico","tgico","btn-icon"),o.attachClickEvent(this.toggleEl,e=>{o.cancelEvent(e),r.default.toggle()},{listenerSetter:this.topbar.listenerSetter}),this.wrapper.prepend(this.toggleEl),this.topbar.listenerSetter.add(a.default,"audio_play",e=>{const{doc:t,mid:a,peerId:o}=e.detail;let r,d;const c=s.getMessageByPeer(o,a);"voice"==t.type||"round"==t.type?(r=i.getPeerTitle(c.fromId,!1,!0),d=l.formatDate(c.date,!1,!1)):(r=t.audioTitle||t.file_name,d=t.audioPerformer?n.RichTextProcessor.wrapPlainText(t.audioPerformer):"Unknown Artist"),this.fill(r,d,c),this.toggleEl.classList.add("flip-icon"),this.toggle(!1)}),this.topbar.listenerSetter.add(a.default,"audio_pause",()=>{this.toggleEl.classList.remove("flip-icon")})}}t.default=f},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=s(9),l=r(s(76)),c=r(s(102)),f=r(s(159)),h=a(s(92)),u=r(s(1)),p=s(0),g=r(s(60)),m=r(s(38)),b=s(34);class v{constructor(){this.rows={},this.container=document.createElement("div"),this.container.className=v.BASE_CLASS}getRow(e,t=!1){if(this.rows[e])return this.rows[e].element;const s=document.createElement("div"),i=!Object.keys(this.rows).length&&!t;return s.className=v.BASE_CLASS+"-row"+(i?"":" is-hiding hide"),this.rows[e]={element:s,new:!0},this.container.append(s),s}clearRow(e){this.rows[e]&&(this.rows[e].element.remove(),delete this.rows[e])}clearRows(e){this.clearTimeout&&clearTimeout(this.clearTimeout),this.clearTimeout=window.setTimeout(()=>{for(const t in this.rows)+t!==e&&this.clearRow(+t)},v.DURATION)}setNewRow(e,t=!1){const s=this.rows[e];s.new&&(t?(s.element.classList.remove("hide"),s.element.offsetLeft):s.element.classList.remove("is-hiding","hide"),delete s.new),this.clearRows(e)}animate(e,t,s=e>t,i=!1){if(e===t)return this.setNewRow(e);const n=this.rows[e],a=this.rows[t];if(!a&&!i)return this.setNewRow(e);const o=["from-top","from-bottom"];s||o.reverse(),n.element.classList.add(o[0]),n.element.classList.remove(o[1]),a&&(a.element.classList.add(o[1]),a.element.classList.remove(o[0])),n.new&&this.setNewRow(e,!0),n.element.classList.toggle("is-hiding",!1),a&&a.element.classList.toggle("is-hiding",!0),this.clearRows(e)}}v.DURATION=200,v.BASE_CLASS="animated-super";class y{constructor(e=!1){this.reverse=e,this.decimals=[],this.previousNumber=0,this.container=document.createElement("div"),this.container.className=y.BASE_CLASS}getDecimal(e){if(this.decimals[e])return this.decimals[e];const t=document.createElement("div");t.className=y.BASE_CLASS+"-decimal";const s=document.createElement("div");s.className=y.BASE_CLASS+"-decimal-placeholder";const i=new v;return i.container.className=y.BASE_CLASS+"-decimal-wrapper",t.append(s,i.container),this.container.append(t),this.decimals[e]={container:t,placeholder:s,animatedSuper:i}}clear(e){this.clearTimeout&&clearTimeout(this.clearTimeout);const t=(""+e).length;t>=this.decimals.length||(this.clearTimeout=window.setTimeout(()=>{this.decimals.splice(t,this.decimals.length-t).forEach(e=>{e.container.remove()})},v.DURATION))}hideLeft(e){const t=(""+e).length;this.decimals.slice(t).forEach(t=>{const s=+t.placeholder.innerText||0;t.animatedSuper.getRow(y.EMPTY_INDEX,!0);t.animatedSuper.animate(y.EMPTY_INDEX,s,this.reverse?e<this.previousNumber:e>this.previousNumber,!0)}),this.clear(e)}setCount(e){const t=Array.from(""+this.previousNumber).map(e=>+e);Array.from(""+e).map(e=>+e).forEach((s,i)=>{var n;const a=this.getDecimal(i),o=a.animatedSuper.getRow(s,!0),r=null!==(n=t[i])&&void 0!==n?n:y.EMPTY_INDEX;o.innerText=a.placeholder.innerText=""+s,a.animatedSuper.animate(s,r,this.reverse?e<this.previousNumber:e>this.previousNumber,!0)}),this.hideLeft(e),this.previousNumber=e}}y.EMPTY_INDEX=-1,y.BASE_CLASS="animated-counter";class M{constructor(e,t,s,i){this.topbar=e,this.chat=t,this.appMessagesManager=s,this.appPeersManager=i,this.pinnedMaxMid=0,this.pinnedMid=0,this.pinnedIndex=-1,this.wasPinnedIndex=0,this.wasPinnedMediaIndex=0,this.locked=!1,this.waitForScrollBottom=!1,this.count=0,this.mids=[],this.offsetIndex=0,this.loading=!1,this.loadedBottom=!1,this.loadedTop=!1,this.scrollDownListenerSetter=null,this.hidden=!1,this.getCurrentIndexPromise=null,this.isStatic=!1,this.listenerSetter=new g.default,this.pinnedMessageContainer=new c.default(e,t,this.listenerSetter,"message",new h.default("pinned-message"),()=>o(this,void 0,void 0,(function*(){return i.canPinMessage(this.topbar.peerId)?new l.default(this.topbar.peerId,this.pinnedMid,!0):new l.default(this.topbar.peerId,0,!0),!1}))),this.pinnedMessageBorder=new f.default,this.pinnedMessageContainer.divAndCaption.border.replaceWith(this.pinnedMessageBorder.render(1,0)),this.animatedSubtitle=new v,this.pinnedMessageContainer.divAndCaption.subtitle.append(this.animatedSubtitle.container),this.animatedMedia=new v,this.animatedMedia.container.classList.add("pinned-message-media-container"),this.pinnedMessageContainer.divAndCaption.content.prepend(this.animatedMedia.container),this.animatedCounter=new y(!0),this.pinnedMessageContainer.divAndCaption.title.innerHTML="Pinned Message ",this.pinnedMessageContainer.divAndCaption.title.append(this.animatedCounter.container),this.btnOpen=m.default("pinlist pinned-container-close pinned-message-pinlist",{noRipple:!0}),this.pinnedMessageContainer.divAndCaption.container.prepend(this.btnOpen),p.attachClickEvent(this.btnOpen,e=>{p.cancelEvent(e),this.topbar.openPinned(!0)},{listenerSetter:this.listenerSetter}),this.listenerSetter.add(u.default,"peer_pinned_messages",e=>{e.detail.peerId==this.topbar.peerId&&(this.hidden&&this.pinnedMessageContainer.toggle(this.hidden=!1),this.loadedTop=this.loadedBottom=!1,this.pinnedIndex=-1,this.pinnedMid=0,this.count=0,this.mids=[],this.offsetIndex=0,this.pinnedMaxMid=0,this.setCorrectIndex(0))}),this.listenerSetter.add(u.default,"peer_pinned_hidden",e=>{const{peerId:t,maxId:s}=e.detail;t==this.topbar.peerId&&this.pinnedMessageContainer.toggle(this.hidden=!0)}),this.setPinnedMessage=b.debounce(()=>this._setPinnedMessage(),100,!0,!0),this.isStatic="discussion"===this.chat.type}destroy(){this.pinnedMessageContainer.divAndCaption.container.remove(),this.pinnedMessageContainer.toggle(!0),this.listenerSetter.removeAll(),this.unsetScrollDownListener(!1)}setCorrectIndex(e){if(this.isStatic)return;if(this.locked||this.hidden)return;if((this.loadedBottom||this.loadedTop)&&!this.count)return;let t=p.getElementByPoint(this.chat.bubbles.scrollable.container,"bottom");if(!t)return;if(t=p.findUpClassName(t,"bubble"),!t)return;const s=t.dataset.mid;t&&void 0!==s&&this.testMid(+s,e)}testMid(e,t){if(this.isStatic)return;if(this.hidden)return;let s=this.mids.findIndex(t=>t<=e);if(-1===s||this.isNeededMore(s)){if(!(this.loadedTop&&e<this.mids[this.mids.length-1]))return void(this.getCurrentIndexPromise||(this.getCurrentIndexPromise=this.getCurrentIndex(e,void 0!==t)));s=this.mids.length-1+this.offsetIndex}else s+=this.offsetIndex;if(this.pinnedIndex!=s){if(this.waitForScrollBottom&&void 0!==t&&(0===this.pinnedIndex||this.pinnedIndex>s))return;this.pinnedIndex=s,this.pinnedMid=this.mids.find(t=>t<=e)||this.mids[this.mids.length-1],this.setPinnedMessage()}}isNeededMore(e){return this.count>M.LOAD_COUNT&&(!this.loadedBottom&&e<=M.LOAD_OFFSET||!this.loadedTop&&this.count-1-e<=M.LOAD_OFFSET)}getCurrentIndex(e,t=!0){return o(this,void 0,void 0,(function*(){if(!this.loading){this.loading=!0;try{let s=!1;const i=[this.appMessagesManager.getSearch({peerId:this.topbar.peerId,inputFilter:{_:"inputMessagesFilterPinned"},maxId:e,limit:M.LOAD_COUNT,backLimit:M.LOAD_COUNT}).then(e=>(s=!0,e))];if(!this.pinnedMaxMid){const e=this.appMessagesManager.getPinnedMessage(this.topbar.peerId).then(e=>{e.maxId&&(this.pinnedMaxMid=e.maxId,!s&&t&&(this.mids=[this.pinnedMaxMid],this.count=e.count,this.pinnedIndex=0,this.pinnedMid=this.mids[0],this.setPinnedMessage()))});i.push(e)}const n=(yield Promise.all(i))[0];let a=n.history.findIndex(t=>t.mid<=e);-1===a&&(a=n.history.length),this.offsetIndex=n.offset_id_offset?n.offset_id_offset-a:0,this.mids=n.history.map(e=>e.mid).slice(),this.count=n.count,this.count||this.pinnedMessageContainer.toggle(!0),this.loadedTop=this.offsetIndex+this.mids.length==this.count,this.loadedBottom=!this.offsetIndex,this.chat.log("[PM]: getCurrentIndex result:",e,n,a,this.offsetIndex,this.loadedTop,this.loadedBottom)}catch(e){this.chat.log.error("[PM]: getCurrentIndex error",e)}this.loading=!1,this.locked?this.testMid(e):t&&this.setCorrectIndex(0),this.getCurrentIndexPromise=null}}))}setScrollDownListener(){this.waitForScrollBottom=!0,this.scrollDownListenerSetter||(this.scrollDownListenerSetter=new g.default,p.handleScrollSideEvent(this.chat.bubbles.scrollable.container,"bottom",()=>{this.unsetScrollDownListener()},this.scrollDownListenerSetter))}unsetScrollDownListener(e=!0){this.waitForScrollBottom=!1,this.scrollDownListenerSetter&&(this.scrollDownListenerSetter.removeAll(),this.scrollDownListenerSetter=null),e&&this.setCorrectIndex(0)}handleFollowingPinnedMessage(){return o(this,void 0,void 0,(function*(){this.locked=!0,this.chat.log("[PM]: handleFollowingPinnedMessage");try{this.setScrollDownListener();const e=this.chat.setPeerPromise;e instanceof Promise&&(yield e),yield this.chat.bubbles.scrollable.scrollLockedPromise,this.getCurrentIndexPromise&&(yield this.getCurrentIndexPromise),this.chat.log("[PM]: handleFollowingPinnedMessage: unlock"),this.locked=!1}catch(e){this.chat.log.error("[PM]: handleFollowingPinnedMessage error:",e),this.locked=!1,this.waitForScrollBottom=!1,this.setCorrectIndex(0)}}))}followPinnedMessage(e){return o(this,void 0,void 0,(function*(){const t=this.chat.getMessage(e);t&&!t.deleted&&(this.chat.setPeer(this.topbar.peerId,e),(this.chat.setPeerPromise||Promise.resolve()).then(()=>{this.handleFollowingPinnedMessage(),this.testMid(this.pinnedIndex>=this.count-1?this.pinnedMaxMid:e-1)}))}))}onChangeScreen(e,t){this.pinnedMessageContainer.divAndCaption.container.classList.toggle("is-floating",t==d.ScreenSize.mobile)}_setPinnedMessage(){const e=this.count;if(e){const t=this.pinnedIndex,s=this.chat.getMessage(this.pinnedMid),i=0===t;this.animatedCounter.container.classList.toggle("is-last",i),i||this.animatedCounter.setCount(e-t),this.pinnedMessageContainer.toggle(!1);const n=t>this.wasPinnedIndex;this.chat.log("[PM]: setPinnedMessage: fromTop",n,t,this.wasPinnedIndex);const a=this.animatedSubtitle.getRow(t),o=this.animatedMedia.getRow(t);o.classList.add("pinned-message-media");const r=h.wrapReplyDivAndCaption({title:void 0,titleEl:null,subtitle:s.message,subtitleEl:a,message:s,mediaEl:o});this.pinnedMessageContainer.divAndCaption.container.classList.toggle("is-media",r),this.animatedSubtitle.animate(t,this.wasPinnedIndex),r?(this.animatedMedia.animate(t,this.wasPinnedMediaIndex),this.wasPinnedMediaIndex=t):this.animatedMedia.clearRows(),this.pinnedMessageBorder.render(e,e-t-1),this.wasPinnedIndex=t,this.pinnedMessageContainer.divAndCaption.container.dataset.mid=""+s.mid}else this.pinnedMessageContainer.toggle(!0),this.wasPinnedIndex=0;this.pinnedMessageContainer.divAndCaption.container.classList.toggle("is-many",this.count>1)}}t.default=M,M.LOAD_COUNT=50,M.LOAD_OFFSET=5},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.drawRect=(e,t,s,i,n)=>`M${e},${t+n}a${n},${n},0,0,1,${s},0v${i-2*n}a${n},${n},0,0,1,${-s},0Z`,this.getClipPath=(e,t,s)=>{let i="";if(3===s)i=this.drawRect(0,0,2,t,1)+this.drawRect(0,11,2,t+1,1)+this.drawRect(0,23,2,t,1);else for(let e=0;e<s;e++)i+=this.drawRect(0,(t+2)*e,2,t,1);return this.clipPath||(this.clipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.clipPath.append(this.path)),this.clipPath.id=e,this.path.setAttributeNS(null,"d",i),this.clipPath},this.getBarHeight=(e,t)=>{let s=32;return 1===e?s=32:2===e?s=15:3===e?s=9:(4===e||e>3)&&(s=7),s},this.getMarkHeight=(e,t)=>{let s=32;return 1===e?s=32:2===e?s=15:3===e?s=1===t?10:9:(4===e||e>3)&&(s=7),s},this.getMarkTranslateY=(e,t,s)=>1===s?0:2===s?0===e?0:t+2:3===s?0===e?0:1===e?11:23:(t+2)*e,this.getTrackTranslateY=(e,t,s,i)=>t<=4||e<=1?0:e>=t-2?i-32:(s+4)/2+(e-2)*(s+2),this.getTrackHeight=(e,t)=>e<=3?32:t*e+2*(e-1)}render(e,t){if(this.border||(this.border=document.createElement("div"),this.border.classList.add("pinned-message-border"),this.wrapper=document.createElement("div"),this.border.append(this.wrapper)),1===e)return this.count!==e&&(this.wrapper.className="pinned-message-border-wrapper-1",this.border.classList.remove("pinned-message-border-mask"),this.wrapper.innerHTML=this.wrapper.style.cssText=""),this.border;const s=this.getBarHeight(e,t),i=this.getMarkHeight(e,t),n=this.getTrackHeight(e,s),a="clipPath_"+e,o=this.getClipPath(a,s,e),r=this.getMarkTranslateY(t,s,e),d=this.getTrackTranslateY(t,e,s,n);return this.border.classList.toggle("pinned-message-border-mask",e>4),this.wrapper.className="pinned-message-border-wrapper",this.wrapper.style.cssText=`clip-path: url(#${a}); width: 2px; height: ${n}px; transform: translateY(-${d}px);`,this.svg||(this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttributeNS(null,"height","0"),this.svg.setAttributeNS(null,"width","0"),this.defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this.defs.append(o),this.svg.append(this.defs),this.mark=document.createElement("div"),this.mark.classList.add("pinned-message-border-mark")),this.svg.parentElement||this.wrapper.append(this.svg,this.mark),this.mark.style.cssText=`height: ${i}px; transform: translateY(${r}px);`,this.count=e,this.index=t,this.border}}},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),d=a(s(49)),l=o(s(75)),c=s(17),f=o(s(43));t.default=class{constructor(e,t){this.topbar=e,this.chat=t,this.foundCount=0,this.selectedIndex=0,this.onDateClick=e=>{r.cancelEvent(e),new l.default(new Date,this.chat.bubbles.onDatePick).show()},this.selectResult=e=>{if(this.setPeerPromise)return this.setPeerPromise;const t=+e.getAttribute("data-peerId"),s=+e.dataset.mid||void 0,i=r.whichChild(e);i==this.foundCount-1?this.upBtn.setAttribute("disabled","true"):this.upBtn.removeAttribute("disabled"),i?this.downBtn.removeAttribute("disabled"):this.downBtn.setAttribute("disabled","true"),this.results.classList.remove("active"),this.chat.bubbles.bubblesContainer.classList.remove("search-results-active");const n=this.chat.setPeer(t,s);this.setPeerPromise=(n instanceof Promise?n:Promise.resolve(n)).then(()=>{this.selectedIndex=i,this.foundCountEl.innerText=`${i+1} of ${this.foundCount}`;const e=this.searchGroup.list.childElementCount;this.selectedIndex>=e-6&&this.appSearch.searchMore()}).finally(()=>{this.setPeerPromise=null})},this.onResultsClick=e=>{const t=r.findUpTag(e.target,"LI");t&&this.selectResult(t)},this.onFooterClick=e=>{this.foundCount&&(this.chat.bubbles.bubblesContainer.classList.toggle("search-results-active"),this.results.classList.toggle("active"))},this.onUpClick=e=>{r.cancelEvent(e),this.selectResult(this.searchGroup.list.children[this.selectedIndex+1])},this.onDownClick=e=>{r.cancelEvent(e),this.selectResult(this.searchGroup.list.children[this.selectedIndex-1])},this.element=document.createElement("div"),this.element.classList.add("sidebar-header","chat-search","chatlist-container"),this.backBtn=document.createElement("button"),this.backBtn.classList.add("btn-icon","tgico-back","sidebar-close-button"),c.ripple(this.backBtn),this.backBtn.addEventListener("click",()=>{this.topbar.container.classList.remove("hide-pinned"),this.element.remove(),this.inputSearch.remove(),this.results.remove(),this.footer.remove(),this.footer.removeEventListener("click",this.onFooterClick),this.dateBtn.removeEventListener("click",this.onDateClick),this.upBtn.removeEventListener("click",this.onUpClick),this.downBtn.removeEventListener("click",this.onDownClick),this.searchGroup.list.removeEventListener("click",this.onResultsClick),this.chat.bubbles.bubblesContainer.classList.remove("search-results-active")},{once:!0}),this.inputSearch=new f.default("Search"),this.results=document.createElement("div"),this.results.classList.add("chat-search-results","chatlist-container"),this.searchGroup=new d.SearchGroup("","messages",void 0,"",!1),this.searchGroup.list.addEventListener("click",this.onResultsClick),this.appSearch=new d.default(this.results,this.inputSearch,{messages:this.searchGroup},e=>{this.foundCount=e,this.foundCount?this.selectResult(this.searchGroup.list.children[0]):(this.foundCountEl.innerText=this.inputSearch.value?"No results":"",this.results.classList.remove("active"),this.chat.bubbles.bubblesContainer.classList.remove("search-results-active"),this.upBtn.setAttribute("disabled","true"),this.downBtn.setAttribute("disabled","true"))}),this.appSearch.beginSearch(this.chat.peerId,this.chat.threadId),this.chat.bubbles.bubblesContainer.append(this.results),this.footer=document.createElement("div"),this.footer.classList.add("chat-search-footer"),this.footer.addEventListener("click",this.onFooterClick),c.ripple(this.footer),this.foundCountEl=document.createElement("span"),this.foundCountEl.classList.add("chat-search-count"),this.dateBtn=document.createElement("button"),this.dateBtn.classList.add("btn-icon","tgico-calendar"),this.controls=document.createElement("div"),this.controls.classList.add("chat-search-controls"),this.upBtn=document.createElement("button"),this.upBtn.classList.add("btn-icon","tgico-up"),this.downBtn=document.createElement("button"),this.downBtn.classList.add("btn-icon","tgico-down"),this.upBtn.setAttribute("disabled","true"),this.downBtn.setAttribute("disabled","true"),this.dateBtn.addEventListener("click",this.onDateClick),this.upBtn.addEventListener("click",this.onUpClick),this.downBtn.addEventListener("click",this.onDownClick),this.controls.append(this.upBtn,this.downBtn),this.footer.append(this.foundCountEl,this.dateBtn,this.controls),this.topbar.container.parentElement.insertBefore(this.footer,t.input.chatInput),this.element.append(this.backBtn,this.inputSearch.container),this.topbar.container.classList.add("hide-pinned"),this.topbar.container.parentElement.append(this.element),this.inputSearch.input.focus()}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),a=i(s(3)),o=i(s(38)),r=s(26),d=s(11),l=s(12);t.default=class{constructor(e){this.appImManager=e,this.buttons={},this.addedListener=!1,this.waitingForMouseUp=!1,this.mouseUpCounter=0,this.onMouseUpSingle=e=>{if(this.waitingForMouseUp=!1,d.isTouchSupported){if(n.cancelEvent(e),0!=this.mouseUpCounter++)return void this.hide();this.resetSelection(this.savedRange)}this.show()}
//!isTouchSupported && document.addEventListener('mouseup', this.onMouseUp);
}init(){this.container=document.createElement("div"),this.container.classList.add("markup-tooltip","z-depth-1","hide"),this.wrapper=document.createElement("div"),this.wrapper.classList.add("markup-tooltip-wrapper");const e=document.createElement("div"),t=document.createElement("div");e.classList.add("markup-tooltip-tools"),t.classList.add("markup-tooltip-tools");["bold","italic","underline","strikethrough","monospace","link"].forEach(t=>{const s=o.default(t,{noRipple:!0});e.append(this.buttons[t]=s),"link"!==t?s.addEventListener("mousedown",e=>{n.cancelEvent(e),this.appImManager.chat.input.applyMarkdown(t),this.cancelClosening()}):n.attachClickEvent(s,e=>{n.cancelEvent(e),this.showLinkEditor(),this.cancelClosening()})}),this.linkBackButton=o.default("back",{noRipple:!0}),this.linkInput=document.createElement("input"),this.linkInput.placeholder="Enter URL...",this.linkInput.classList.add("input-clear"),this.linkInput.addEventListener("keydown",e=>{const t=!this.linkInput.value.length||!!a.default.matchUrl(this.linkInput.value);"Enter"==e.code&&(t?this.applyLink(e):(this.linkInput.classList.contains("error")&&(this.linkInput.classList.remove("error"),this.linkInput.offsetLeft),this.linkInput.classList.add("error")))}),this.linkInput.addEventListener("input",e=>{const t=this.isLinkValid();this.linkInput.classList.toggle("is-valid",t),this.linkInput.classList.remove("error")}),this.linkBackButton.addEventListener("mousedown",e=>{n.cancelEvent(e),this.container.classList.remove("is-link"),this.resetSelection(),this.setTooltipPosition(),this.cancelClosening()}),this.linkApplyButton=o.default("check markup-tooltip-link-apply",{noRipple:!0}),this.linkApplyButton.addEventListener("mousedown",e=>{this.applyLink(e)});const s=document.createElement("div");s.classList.add("markup-tooltip-link-apply-container");const i=document.createElement("span"),r=document.createElement("span"),d=document.createElement("span");i.classList.add("markup-tooltip-delimiter"),r.classList.add("markup-tooltip-delimiter"),d.classList.add("markup-tooltip-delimiter"),e.insertBefore(i,this.buttons.link),s.append(d,this.linkApplyButton),t.append(this.linkBackButton,r,this.linkInput,s),this.wrapper.append(e,t),this.container.append(this.wrapper),document.body.append(this.container),window.addEventListener("resize",()=>{this.hide()})}showLinkEditor(){const e=this.buttons.link;this.container.classList.add("is-link");const t=document.getSelection();if(this.savedRange=t.getRangeAt(0),e.classList.contains("active")){const e=this.savedRange.startContainer.parentElement;this.linkInput.value=e.href}else this.linkInput.value="";this.setTooltipPosition(!0),setTimeout(()=>{this.linkInput.focus()},200),this.linkInput.classList.toggle("is-valid",this.isLinkValid())}applyLink(e){n.cancelEvent(e),this.resetSelection(),this.appImManager.chat.input.applyMarkdown("link",this.linkInput.value),setTimeout(()=>{this.hide()},0)}isLinkValid(){return!this.linkInput.value.length||!!a.default.matchUrl(this.linkInput.value)}resetSelection(e=this.savedRange){const t=window.getSelection();t.removeAllRanges(),t.addRange(e),this.appImManager.chat.input.messageInput.focus()}hide(){this.init||(this.container.classList.remove("is-visible"),document.removeEventListener("mouseup",this.onMouseUpSingle),this.waitingForMouseUp=!1,this.hideTimeout&&clearTimeout(this.hideTimeout),this.hideTimeout=window.setTimeout(()=>{this.hideTimeout=void 0,this.container.classList.add("hide"),this.container.classList.remove("is-link")},200))}getActiveMarkupButton(){const e=n.getSelectedNodes(),t=[...new Set(e.map(e=>e.parentNode))],s=new Set;return t.forEach(e=>{for(const t in n.markdownTags){const i=n.markdownTags[t];e.closest(i.match+", [contenteditable]")!==this.appImManager.chat.input.messageInput&&s.add(this.buttons[t])}}),[...s]}setActiveMarkupButton(){const e=this.getActiveMarkupButton();for(const t in this.buttons){const s=this.buttons[t];s.classList.toggle("active",e.includes(s))}}setTooltipPosition(e=!1){const t=document.getSelection().getRangeAt(0),s=document.body.getBoundingClientRect(),i=t.getBoundingClientRect(),n=this.appImManager.chat.input.rowsWrapper.getBoundingClientRect();this.container.style.maxWidth=n.width+"px";const a=i.top+-1*s.top,o=(this.container.classList.contains("is-link")?this.wrapper.lastElementChild:this.wrapper.firstElementChild).getBoundingClientRect(),d=a-o.height-8,l=n.left,c=n.left+n.width-Math.min(n.width,o.width);let f;if(e){const e=this.container.getBoundingClientRect();f=r.clamp(e.left,l,c)}else{const e=i.left+(i.width-o.width)/2;f=r.clamp(e,l,c)}this.container.style.transform=`translate3d(${f}px, ${d}px, 0)`}show(){this.init&&(this.init(),this.init=null);if(!document.getSelection().toString().trim().length)return void this.hide();if(void 0!==this.hideTimeout&&clearTimeout(this.hideTimeout),this.container.classList.contains("is-visible"))return;this.setActiveMarkupButton(),this.container.classList.remove("is-link");const e=this.container.classList.contains("hide");e&&(this.container.classList.remove("hide"),this.container.classList.add("no-transition")),this.setTooltipPosition(),e&&(this.container.offsetLeft,this.container.classList.remove("no-transition")),this.container.classList.add("is-visible")}setMouseUpEvent(){this.waitingForMouseUp||(this.waitingForMouseUp=!0,document.addEventListener("mouseup",this.onMouseUpSingle,{once:!0}))}cancelClosening(){d.isTouchSupported&&!l.isApple&&(document.removeEventListener("mouseup",this.onMouseUpSingle),document.addEventListener("mouseup",e=>{n.cancelEvent(e),this.mouseUpCounter=1,this.waitingForMouseUp=!1,this.setMouseUpEvent()},{once:!0}))}handleSelection(){this.addedListener||(this.addedListener=!0,document.addEventListener("selectionchange",e=>{if(document.activeElement===this.linkInput)return;if(document.activeElement!==this.appImManager.chat.input.messageInput)return void this.hide();const t=document.getSelection();if(t.toString().trim().length)if(d.isTouchSupported)if(l.isApple)this.show(),this.setTooltipPosition();else{if(2==this.mouseUpCounter)return void(this.mouseUpCounter=0);this.savedRange=t.getRangeAt(0),this.setMouseUpEvent()}else this.setMouseUpEvent();else this.hide()}))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0);t.default=class{constructor(e,t){this.options=t,this.onDragOver=e=>{this.container.classList.add("is-dragover")},this.onDragLeave=e=>{this.container.classList.remove("is-dragover")},this.onDrop=e=>{this.options.onDrop(e)},this.container=document.createElement("div"),this.container.classList.add("drop","z-depth-1"),this.outlineWrapper=document.createElement("div"),this.outlineWrapper.classList.add("drop-outline-wrapper"),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.classList.add("drop-outline"),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.classList.add("drop-outline-path");const s=document.createElement("div");s.classList.add("drop-icon","tgico-"+t.icon);const i=document.createElement("div");i.classList.add("drop-header"),i.innerHTML=t.header;const n=document.createElement("div");n.classList.add("drop-subtitle"),n.innerHTML=t.subtitle,this.svg.append(this.path),this.outlineWrapper.append(this.svg),this.container.append(this.outlineWrapper,s,i,n),e.append(this.container),this.container.addEventListener("dragover",this.onDragOver),this.container.addEventListener("dragleave",this.onDragLeave),this.container.addEventListener("drop",this.onDrop)}destroy(){delete this.options,this.container.remove(),this.container.removeEventListener("dragover",this.onDragOver),this.container.removeEventListener("dragleave",this.onDragLeave),this.container.removeEventListener("drop",this.onDrop)}setPath(){const e=this.outlineWrapper.getBoundingClientRect();this.svg.setAttributeNS(null,"preserveAspectRatio","none"),this.svg.setAttributeNS(null,"viewBox",`0 0 ${e.width} ${e.height}`),this.svg.setAttributeNS(null,"width",""+e.width),this.svg.setAttributeNS(null,"height",""+e.height);const t=e.width-10,s=e.height-10,n=i.generatePathData(5,5,t,s,10,10,10,10);this.path.setAttributeNS(null,"d",n)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,s){this.onSwipe=t,this.verifyTouchTarget=s,this.handleTouchStart=e=>{if(this.verifyTouchTarget&&!this.verifyTouchTarget(e))return void(this.xDown=this.yDown=null);const t=e.touches[0];this.xDown=t.clientX,this.yDown=t.clientY},this.handleTouchMove=e=>{if(null==this.xDown||null==this.yDown)return;const t=e.touches[0].clientX,s=e.touches[0].clientY,i=this.xDown-t,n=this.yDown-s;this.onSwipe(i,n)&&(this.xDown=null,this.yDown=null)},e.addEventListener("touchstart",this.handleTouchStart,!1),e.addEventListener("touchmove",this.handleTouchMove,!1)}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(23)),a=i(s(7)),o=i(s(10)),r=i(s(1)),d=s(0),l=s(4),c=i(s(61)),f=i(s(103));t.default=class{constructor(){this.onArchiveClick=()=>{let e=a.default.getDialogByPeerId(this.selectedId)[0];e&&a.default.editPeerFolders([e.peerId],+!e.folder_id)},this.onPinClick=()=>{a.default.toggleDialogPin(this.selectedId,this.filterId)},this.onMuteClick=()=>{a.default.mutePeer(this.selectedId)},this.onUnreadClick=()=>{const e=a.default.getDialogByPeerId(this.selectedId)[0];e&&(e.unread_count?(a.default.readHistory(this.selectedId,e.top_message),a.default.markDialogUnread(this.selectedId,!0)):a.default.markDialogUnread(this.selectedId))},this.onDeleteClick=()=>{new f.default(this.selectedId)},this.onContextMenu=e=>{this.init&&(this.init(),this.init=null);let t=null;try{t=d.findUpTag(e.target,"LI")}catch(e){}if(t){if(e instanceof MouseEvent&&e.preventDefault(),this.element.classList.contains("active"))return!1;e instanceof MouseEvent&&(e.cancelBubble=!0),this.filterId=n.default.filterId,this.selectedId=+t.getAttribute("data-peerId"),this.dialog=a.default.getDialogByPeerId(this.selectedId)[0],this.buttons.forEach(e=>{const t=e.verify();e.element.classList.toggle("hide",!t)}),this.buttons[this.buttons.length-1].element.firstChild.nodeValue=o.default.getDeleteButtonText(this.selectedId),t.classList.add("menu-open"),l.positionMenu(e,this.element),l.openBtnMenu(this.element,()=>{t.classList.remove("menu-open"),this.selectedId=this.dialog=this.filterId=void 0})}}}init(){this.buttons=[{icon:"unread",text:"Mark as unread",onClick:this.onUnreadClick,verify:()=>{var e;return!!(!(null===(e=this.dialog.pFlags)||void 0===e?void 0:e.unread_mark)&&!this.dialog.unread_count)}},{icon:"readchats",text:"Mark as read",onClick:this.onUnreadClick,verify:()=>{var e;return!(!(null===(e=this.dialog.pFlags)||void 0===e?void 0:e.unread_mark)&&!this.dialog.unread_count)}},{icon:"pin",text:"Pin",onClick:this.onPinClick,verify:()=>{var e;return!(this.filterId>1?a.default.filtersStorage.filters[this.filterId].pinned_peers.includes(this.dialog.peerId):!!(null===(e=this.dialog.pFlags)||void 0===e?void 0:e.pinned))}},{icon:"unpin",text:"Unpin",onClick:this.onPinClick,verify:()=>{var e;return this.filterId>1?a.default.filtersStorage.filters[this.filterId].pinned_peers.includes(this.dialog.peerId):!!(null===(e=this.dialog.pFlags)||void 0===e?void 0:e.pinned)}},{icon:"mute",text:"Mute",onClick:this.onMuteClick,verify:()=>!(this.dialog.notify_settings&&this.dialog.notify_settings.mute_until>(Date.now()/1e3|0))&&this.selectedId!=r.default.myId},{icon:"unmute",text:"Unmute",onClick:this.onMuteClick,verify:()=>this.dialog.notify_settings&&this.dialog.notify_settings.mute_until>(Date.now()/1e3|0)&&this.selectedId!=r.default.myId},{icon:"archive",text:"Archive",onClick:this.onArchiveClick,verify:()=>0==this.filterId&&this.selectedId!=r.default.myId},{icon:"unarchive",text:"Unarchive",onClick:this.onArchiveClick,verify:()=>1==this.filterId&&this.selectedId!=r.default.myId},{icon:"delete danger",text:"Delete",onClick:this.onDeleteClick,verify:()=>!0}],this.element=c.default(this.buttons),this.element.id="dialogs-contextmenu",document.getElementById("page-chats").append(this.element)}}},function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PasswordManager=void 0;const n=i(s(5)),a=s(2);class o{getState(){return n.default.invokeApi("account.getPassword").then(e=>e)}check(e,t,s={}){return n.default.computeSRP(e,t).then(e=>n.default.invokeApi("auth.checkPassword",{password:e},s))}}t.PasswordManager=o;const r=new o;a.MOUNT_CLASS_TO&&(a.MOUNT_CLASS_TO.passwordManager=r),t.default=r},function(e,t,s){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[s]}})}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)"default"!==s&&Object.hasOwnProperty.call(e,s)&&i(t,e,s);return n(t,e),t},o=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(n,a){function o(e){try{d(i.next(e))}catch(e){a(e)}}function r(e){try{d(i.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const d=r(s(5)),l=r(s(41)),c=r(s(48)),f=r(s(79)),h=r(s(66)),u=s(2),p=r(s(57)),g=s(44),m=s(34);let b;const v=new l.default("page-signQR",!0,()=>b,()=>{b||(b=o(void 0,void 0,void 0,(function*(){const e=v.pageEl.querySelector(".auth-image");v.pageEl.querySelector(".a-qr").addEventListener("click",()=>{h.default.mount(),i=!0});const t=(yield Promise.all([Promise.resolve().then(()=>a(s(167)))]))[0].default;let i=!1;document.addEventListener("user_auth",()=>{i=!0,b=null},{once:!0});let n,r={ignoreErrors:!0};return()=>o(void 0,void 0,void 0,(function*(){for(i=!1;!i;)try{let s=yield d.default.invokeApi("auth.exportLoginToken",{api_id:u.App.id,api_hash:u.App.hash,except_ids:[]},{ignoreErrors:!0});if("auth.loginTokenMigrateTo"==s._&&(r.dcId||(r.dcId=s.dc_id,d.default.setBaseDcId(s.dc_id)),s=yield d.default.invokeApi("auth.importLoginToken",{token:s.token},r)),"auth.loginTokenSuccess"==s._){const e=s.authorization;d.default.setUserAuth(e.user.id),c.default.mount();break}if(!n||!g.bytesCmp(n,s.token)){n=s.token;let i="tg://login?token="+g.bytesToBase64(s.token).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"");e.innerHTML="",new t({width:166,height:166,data:i,image:"assets/img/logo_padded.svg",dotsOptions:{color:"#000000",type:"rounded"},imageOptions:{imageSize:.75},backgroundOptions:{color:"#ffffff"},qrOptions:{errorCorrectionLevel:"L"}}).append(e)}let i=Date.now()/1e3,a=s.expires-i-p.default.serverTimeOffset;yield m.pause(a>5?5e3:1e3*a|0)}catch(e){switch(e.type){case"SESSION_PASSWORD_NEEDED":console.warn("pageSignQR: SESSION_PASSWORD_NEEDED"),e.handled=!0,f.default.mount(),i=!0,b=null;break;default:console.error("pageSignQR: default error:",e)}}}))}))),b.then(e=>{e()})});t.default=v},function(e,t,s){window,e.exports=function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e,t,s){var i,n,a=function(){var e=function(e,t){var s=e,i=n[t],o=null,p=0,g=null,b=[],v={},y=function(e,t){o=function(e){for(var t=new Array(e),s=0;s<e;s+=1){t[s]=new Array(e);for(var i=0;i<e;i+=1)t[s][i]=null}return t}(p=4*s+17),M(0,0),M(p-7,0),M(0,p-7),w(),_(),I(e,t),s>=7&&S(e),null==g&&(g=E(s,i,b)),L(g,t)},M=function(e,t){for(var s=-1;s<=7;s+=1)if(!(e+s<=-1||p<=e+s))for(var i=-1;i<=7;i+=1)t+i<=-1||p<=t+i||(o[e+s][t+i]=0<=s&&s<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==s||6==s)||2<=s&&s<=4&&2<=i&&i<=4)},_=function(){for(var e=8;e<p-8;e+=1)null==o[e][6]&&(o[e][6]=e%2==0);for(var t=8;t<p-8;t+=1)null==o[6][t]&&(o[6][t]=t%2==0)},w=function(){for(var e=a.getPatternPosition(s),t=0;t<e.length;t+=1)for(var i=0;i<e.length;i+=1){var n=e[t],r=e[i];if(null==o[n][r])for(var d=-2;d<=2;d+=1)for(var l=-2;l<=2;l+=1)o[n+d][r+l]=-2==d||2==d||-2==l||2==l||0==d&&0==l}},S=function(e){for(var t=a.getBCHTypeNumber(s),i=0;i<18;i+=1){var n=!e&&1==(t>>i&1);o[Math.floor(i/3)][i%3+p-8-3]=n}for(i=0;i<18;i+=1)n=!e&&1==(t>>i&1),o[i%3+p-8-3][Math.floor(i/3)]=n},I=function(e,t){for(var s=i<<3|t,n=a.getBCHTypeInfo(s),r=0;r<15;r+=1){var d=!e&&1==(n>>r&1);r<6?o[r][8]=d:r<8?o[r+1][8]=d:o[p-15+r][8]=d}for(r=0;r<15;r+=1)d=!e&&1==(n>>r&1),r<8?o[8][p-r-1]=d:r<9?o[8][15-r-1+1]=d:o[8][15-r-1]=d;o[p-8][8]=!e},L=function(e,t){for(var s=-1,i=p-1,n=7,r=0,d=a.getMaskFunction(t),l=p-1;l>0;l-=2)for(6==l&&(l-=1);;){for(var c=0;c<2;c+=1)if(null==o[i][l-c]){var f=!1;r<e.length&&(f=1==(e[r]>>>n&1)),d(i,l-c)&&(f=!f),o[i][l-c]=f,-1==(n-=1)&&(r+=1,n=7)}if((i+=s)<0||p<=i){i-=s,s=-s;break}}},E=function(e,t,s){for(var i=d.getRSBlocks(e,t),n=l(),o=0;o<s.length;o+=1){var c=s[o];n.put(c.getMode(),4),n.put(c.getLength(),a.getLengthInBits(c.getMode(),e)),c.write(n)}var f=0;for(o=0;o<i.length;o+=1)f+=i[o].dataCount;if(n.getLengthInBits()>8*f)throw"code length overflow. ("+n.getLengthInBits()+">"+8*f+")";for(n.getLengthInBits()+4<=8*f&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*f||(n.put(236,8),n.getLengthInBits()>=8*f));)n.put(17,8);return function(e,t){for(var s=0,i=0,n=0,o=new Array(t.length),d=new Array(t.length),l=0;l<t.length;l+=1){var c=t[l].dataCount,f=t[l].totalCount-c;i=Math.max(i,c),n=Math.max(n,f),o[l]=new Array(c);for(var h=0;h<o[l].length;h+=1)o[l][h]=255&e.getBuffer()[h+s];s+=c;var u=a.getErrorCorrectPolynomial(f),p=r(o[l],u.getLength()-1).mod(u);for(d[l]=new Array(u.getLength()-1),h=0;h<d[l].length;h+=1){var g=h+p.getLength()-d[l].length;d[l][h]=g>=0?p.getAt(g):0}}var m=0;for(h=0;h<t.length;h+=1)m+=t[h].totalCount;var b=new Array(m),v=0;for(h=0;h<i;h+=1)for(l=0;l<t.length;l+=1)h<o[l].length&&(b[v]=o[l][h],v+=1);for(h=0;h<n;h+=1)for(l=0;l<t.length;l+=1)h<d[l].length&&(b[v]=d[l][h],v+=1);return b}(n,i)};v.addData=function(e,t){var s=null;switch(t=t||"Byte"){case"Numeric":s=c(e);break;case"Alphanumeric":s=f(e);break;case"Byte":s=h(e);break;case"Kanji":s=u(e);break;default:throw"mode:"+t}b.push(s),g=null},v.isDark=function(e,t){if(e<0||p<=e||t<0||p<=t)throw e+","+t;return o[e][t]},v.getModuleCount=function(){return p},v.make=function(){if(s<1){for(var e=1;e<40;e++){for(var t=d.getRSBlocks(e,i),n=l(),o=0;o<b.length;o++){var r=b[o];n.put(r.getMode(),4),n.put(r.getLength(),a.getLengthInBits(r.getMode(),e)),r.write(n)}var c=0;for(o=0;o<t.length;o++)c+=t[o].dataCount;if(n.getLengthInBits()<=8*c)break}s=e}y(!1,function(){for(var e=0,t=0,s=0;s<8;s+=1){y(!0,s);var i=a.getLostPoint(v);(0==s||e>i)&&(e=i,t=s)}return t}())},v.createTableTag=function(e,t){e=e||2;var s="";s+='<table style="',s+=" border-width: 0px; border-style: none;",s+=" border-collapse: collapse;",s+=" padding: 0px; margin: "+(t=void 0===t?4*e:t)+"px;",s+='">',s+="<tbody>";for(var i=0;i<v.getModuleCount();i+=1){s+="<tr>";for(var n=0;n<v.getModuleCount();n+=1)s+='<td style="',s+=" border-width: 0px; border-style: none;",s+=" border-collapse: collapse;",s+=" padding: 0px; margin: 0px;",s+=" width: "+e+"px;",s+=" height: "+e+"px;",s+=" background-color: ",s+=v.isDark(i,n)?"#000000":"#ffffff",s+=";",s+='"/>';s+="</tr>"}return(s+="</tbody>")+"</table>"},v.createSvgTag=function(e,t,s,i){var n={};"object"==typeof arguments[0]&&(e=(n=arguments[0]).cellSize,t=n.margin,s=n.alt,i=n.title),e=e||2,t=void 0===t?4*e:t,(s="string"==typeof s?{text:s}:s||{}).text=s.text||null,s.id=s.text?s.id||"qrcode-description":null,(i="string"==typeof i?{text:i}:i||{}).text=i.text||null,i.id=i.text?i.id||"qrcode-title":null;var a,o,r,d,l=v.getModuleCount()*e+2*t,c="";for(d="l"+e+",0 0,"+e+" -"+e+",0 0,-"+e+"z ",c+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',c+=n.scalable?"":' width="'+l+'px" height="'+l+'px"',c+=' viewBox="0 0 '+l+" "+l+'" ',c+=' preserveAspectRatio="xMinYMin meet"',c+=i.text||s.text?' role="img" aria-labelledby="'+C([i.id,s.id].join(" ").trim())+'"':"",c+=">",c+=i.text?'<title id="'+C(i.id)+'">'+C(i.text)+"</title>":"",c+=s.text?'<description id="'+C(s.id)+'">'+C(s.text)+"</description>":"",c+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',c+='<path d="',o=0;o<v.getModuleCount();o+=1)for(r=o*e+t,a=0;a<v.getModuleCount();a+=1)v.isDark(o,a)&&(c+="M"+(a*e+t)+","+r+d);return(c+='" stroke="transparent" fill="black"/>')+"</svg>"},v.createDataURL=function(e,t){e=e||2,t=void 0===t?4*e:t;var s=v.getModuleCount()*e+2*t,i=t,n=s-t;return m(s,s,(function(t,s){if(i<=t&&t<n&&i<=s&&s<n){var a=Math.floor((t-i)/e),o=Math.floor((s-i)/e);return v.isDark(o,a)?0:1}return 1}))},v.createImgTag=function(e,t,s){e=e||2,t=void 0===t?4*e:t;var i=v.getModuleCount()*e+2*t,n="";return n+="<img",n+=' src="',n+=v.createDataURL(e,t),n+='"',n+=' width="',n+=i,n+='"',n+=' height="',n+=i,n+='"',s&&(n+=' alt="',n+=C(s),n+='"'),n+"/>"};var C=function(e){for(var t="",s=0;s<e.length;s+=1){var i=e.charAt(s);switch(i){case"<":t+="&lt;";break;case">":t+="&gt;";break;case"&":t+="&amp;";break;case'"':t+="&quot;";break;default:t+=i}}return t};return v.createASCII=function(e,t){if((e=e||1)<2)return function(e){e=void 0===e?2:e;var t,s,i,n,a,o=1*v.getModuleCount()+2*e,r=e,d=o-e,l={"██":"█","█ ":"▀"," █":"▄","  ":" "},c={"██":"▀","█ ":"▀"," █":" ","  ":" "},f="";for(t=0;t<o;t+=2){for(i=Math.floor((t-r)/1),n=Math.floor((t+1-r)/1),s=0;s<o;s+=1)a="█",r<=s&&s<d&&r<=t&&t<d&&v.isDark(i,Math.floor((s-r)/1))&&(a=" "),r<=s&&s<d&&r<=t+1&&t+1<d&&v.isDark(n,Math.floor((s-r)/1))?a+=" ":a+="█",f+=e<1&&t+1>=d?c[a]:l[a];f+="\n"}return o%2&&e>0?f.substring(0,f.length-o-1)+Array(o+1).join("▀"):f.substring(0,f.length-1)}(t);e-=1,t=void 0===t?2*e:t;var s,i,n,a,o=v.getModuleCount()*e+2*t,r=t,d=o-t,l=Array(e+1).join("██"),c=Array(e+1).join("  "),f="",h="";for(s=0;s<o;s+=1){for(n=Math.floor((s-r)/e),h="",i=0;i<o;i+=1)a=1,r<=i&&i<d&&r<=s&&s<d&&v.isDark(n,Math.floor((i-r)/e))&&(a=0),h+=a?l:c;for(n=0;n<e;n+=1)f+=h+"\n"}return f.substring(0,f.length-1)},v.renderTo2dContext=function(e,t){t=t||2;for(var s=v.getModuleCount(),i=0;i<s;i++)for(var n=0;n<s;n++)e.fillStyle=v.isDark(i,n)?"black":"white",e.fillRect(i*t,n*t,t,t)},v};e.stringToBytes=(e.stringToBytesFuncs={default:function(e){for(var t=[],s=0;s<e.length;s+=1){var i=e.charCodeAt(s);t.push(255&i)}return t}}).default,e.createStringToBytes=function(e,t){var s=function(){for(var s=g(e),i=function(){var e=s.read();if(-1==e)throw"eof";return e},n=0,a={};;){var o=s.read();if(-1==o)break;var r=i(),d=i()<<8|i();a[String.fromCharCode(o<<8|r)]=d,n+=1}if(n!=t)throw n+" != "+t;return a}(),i="?".charCodeAt(0);return function(e){for(var t=[],n=0;n<e.length;n+=1){var a=e.charCodeAt(n);if(a<128)t.push(a);else{var o=s[e.charAt(n)];"number"==typeof o?(255&o)==o?t.push(o):(t.push(o>>>8),t.push(255&o)):t.push(i)}}return t}};var t,s,i,n={L:1,M:0,Q:3,H:2},a=(t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],i=function(e){for(var t=0;0!=e;)t+=1,e>>>=1;return t},(s={}).getBCHTypeInfo=function(e){for(var t=e<<10;i(t)-i(1335)>=0;)t^=1335<<i(t)-i(1335);return 21522^(e<<10|t)},s.getBCHTypeNumber=function(e){for(var t=e<<12;i(t)-i(7973)>=0;)t^=7973<<i(t)-i(7973);return e<<12|t},s.getPatternPosition=function(e){return t[e-1]},s.getMaskFunction=function(e){switch(e){case 0:return function(e,t){return(e+t)%2==0};case 1:return function(e,t){return e%2==0};case 2:return function(e,t){return t%3==0};case 3:return function(e,t){return(e+t)%3==0};case 4:return function(e,t){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case 5:return function(e,t){return e*t%2+e*t%3==0};case 6:return function(e,t){return(e*t%2+e*t%3)%2==0};case 7:return function(e,t){return(e*t%3+(e+t)%2)%2==0};default:throw"bad maskPattern:"+e}},s.getErrorCorrectPolynomial=function(e){for(var t=r([1],0),s=0;s<e;s+=1)t=t.multiply(r([1,o.gexp(s)],0));return t},s.getLengthInBits=function(e,t){if(1<=t&&t<10)switch(e){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+e}else if(t<27)switch(e){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+e}else{if(!(t<41))throw"type:"+t;switch(e){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+e}}},s.getLostPoint=function(e){for(var t=e.getModuleCount(),s=0,i=0;i<t;i+=1)for(var n=0;n<t;n+=1){for(var a=0,o=e.isDark(i,n),r=-1;r<=1;r+=1)if(!(i+r<0||t<=i+r))for(var d=-1;d<=1;d+=1)n+d<0||t<=n+d||0==r&&0==d||o==e.isDark(i+r,n+d)&&(a+=1);a>5&&(s+=3+a-5)}for(i=0;i<t-1;i+=1)for(n=0;n<t-1;n+=1){var l=0;e.isDark(i,n)&&(l+=1),e.isDark(i+1,n)&&(l+=1),e.isDark(i,n+1)&&(l+=1),e.isDark(i+1,n+1)&&(l+=1),0!=l&&4!=l||(s+=3)}for(i=0;i<t;i+=1)for(n=0;n<t-6;n+=1)e.isDark(i,n)&&!e.isDark(i,n+1)&&e.isDark(i,n+2)&&e.isDark(i,n+3)&&e.isDark(i,n+4)&&!e.isDark(i,n+5)&&e.isDark(i,n+6)&&(s+=40);for(n=0;n<t;n+=1)for(i=0;i<t-6;i+=1)e.isDark(i,n)&&!e.isDark(i+1,n)&&e.isDark(i+2,n)&&e.isDark(i+3,n)&&e.isDark(i+4,n)&&!e.isDark(i+5,n)&&e.isDark(i+6,n)&&(s+=40);var c=0;for(n=0;n<t;n+=1)for(i=0;i<t;i+=1)e.isDark(i,n)&&(c+=1);return s+Math.abs(100*c/t/t-50)/5*10},s),o=function(){for(var e=new Array(256),t=new Array(256),s=0;s<8;s+=1)e[s]=1<<s;for(s=8;s<256;s+=1)e[s]=e[s-4]^e[s-5]^e[s-6]^e[s-8];for(s=0;s<255;s+=1)t[e[s]]=s;return{glog:function(e){if(e<1)throw"glog("+e+")";return t[e]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e[t]}}}();function r(e,t){if(void 0===e.length)throw e.length+"/"+t;var s=function(){for(var s=0;s<e.length&&0==e[s];)s+=1;for(var i=new Array(e.length-s+t),n=0;n<e.length-s;n+=1)i[n]=e[n+s];return i}(),i={getAt:function(e){return s[e]},getLength:function(){return s.length},multiply:function(e){for(var t=new Array(i.getLength()+e.getLength()-1),s=0;s<i.getLength();s+=1)for(var n=0;n<e.getLength();n+=1)t[s+n]^=o.gexp(o.glog(i.getAt(s))+o.glog(e.getAt(n)));return r(t,0)},mod:function(e){if(i.getLength()-e.getLength()<0)return i;for(var t=o.glog(i.getAt(0))-o.glog(e.getAt(0)),s=new Array(i.getLength()),n=0;n<i.getLength();n+=1)s[n]=i.getAt(n);for(n=0;n<e.getLength();n+=1)s[n]^=o.gexp(o.glog(e.getAt(n))+t);return r(s,0).mod(e)}};return i}var d=function(){var e=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t=function(e,t){var s={};return s.totalCount=e,s.dataCount=t,s},s={getRSBlocks:function(s,i){var a=function(t,s){switch(s){case n.L:return e[4*(t-1)+0];case n.M:return e[4*(t-1)+1];case n.Q:return e[4*(t-1)+2];case n.H:return e[4*(t-1)+3];default:return}}(s,i);if(void 0===a)throw"bad rs block @ typeNumber:"+s+"/errorCorrectionLevel:"+i;for(var o=a.length/3,r=[],d=0;d<o;d+=1)for(var l=a[3*d+0],c=a[3*d+1],f=a[3*d+2],h=0;h<l;h+=1)r.push(t(c,f));return r}};return s}(),l=function(){var e=[],t=0,s={getBuffer:function(){return e},getAt:function(t){var s=Math.floor(t/8);return 1==(e[s]>>>7-t%8&1)},put:function(e,t){for(var i=0;i<t;i+=1)s.putBit(1==(e>>>t-i-1&1))},getLengthInBits:function(){return t},putBit:function(s){var i=Math.floor(t/8);e.length<=i&&e.push(0),s&&(e[i]|=128>>>t%8),t+=1}};return s},c=function(e){var t=e,s={getMode:function(){return 1},getLength:function(e){return t.length},write:function(e){for(var s=t,n=0;n+2<s.length;)e.put(i(s.substring(n,n+3)),10),n+=3;n<s.length&&(s.length-n==1?e.put(i(s.substring(n,n+1)),4):s.length-n==2&&e.put(i(s.substring(n,n+2)),7))}},i=function(e){for(var t=0,s=0;s<e.length;s+=1)t=10*t+n(e.charAt(s));return t},n=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+e};return s},f=function(e){var t=e,s={getMode:function(){return 2},getLength:function(e){return t.length},write:function(e){for(var s=t,n=0;n+1<s.length;)e.put(45*i(s.charAt(n))+i(s.charAt(n+1)),11),n+=2;n<s.length&&e.put(i(s.charAt(n)),6)}},i=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);if("A"<=e&&e<="Z")return e.charCodeAt(0)-"A".charCodeAt(0)+10;switch(e){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+e}};return s},h=function(t){var s=e.stringToBytes(t);return{getMode:function(){return 4},getLength:function(e){return s.length},write:function(e){for(var t=0;t<s.length;t+=1)e.put(s[t],8)}}},u=function(t){var s=e.stringToBytesFuncs.SJIS;if(!s)throw"sjis not supported.";!function(e,t){var i=s("友");if(2!=i.length||38726!=(i[0]<<8|i[1]))throw"sjis not supported."}();var i=s(t);return{getMode:function(){return 8},getLength:function(e){return~~(i.length/2)},write:function(e){for(var t=i,s=0;s+1<t.length;){var n=(255&t[s])<<8|255&t[s+1];if(33088<=n&&n<=40956)n-=33088;else{if(!(57408<=n&&n<=60351))throw"illegal char at "+(s+1)+"/"+n;n-=49472}n=192*(n>>>8&255)+(255&n),e.put(n,13),s+=2}if(s<t.length)throw"illegal char at "+(s+1)}}},p=function(){var e=[],t={writeByte:function(t){e.push(255&t)},writeShort:function(e){t.writeByte(e),t.writeByte(e>>>8)},writeBytes:function(e,s,i){s=s||0,i=i||e.length;for(var n=0;n<i;n+=1)t.writeByte(e[n+s])},writeString:function(e){for(var s=0;s<e.length;s+=1)t.writeByte(e.charCodeAt(s))},toByteArray:function(){return e},toString:function(){var t="";t+="[";for(var s=0;s<e.length;s+=1)s>0&&(t+=","),t+=e[s];return t+"]"}};return t},g=function(e){var t=e,s=0,i=0,n=0,a={read:function(){for(;n<8;){if(s>=t.length){if(0==n)return-1;throw"unexpected end of file./"+n}var e=t.charAt(s);if(s+=1,"="==e)return n=0,-1;e.match(/^\s$/)||(i=i<<6|o(e.charCodeAt(0)),n+=6)}var a=i>>>n-8&255;return n-=8,a}},o=function(e){if(65<=e&&e<=90)return e-65;if(97<=e&&e<=122)return e-97+26;if(48<=e&&e<=57)return e-48+52;if(43==e)return 62;if(47==e)return 63;throw"c:"+e};return a},m=function(e,t,s){for(var i=function(e,t){var s=e,i=t,n=new Array(e*t),a={setPixel:function(e,t,i){n[t*s+e]=i},write:function(e){e.writeString("GIF87a"),e.writeShort(s),e.writeShort(i),e.writeByte(128),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(255),e.writeByte(255),e.writeByte(255),e.writeString(","),e.writeShort(0),e.writeShort(0),e.writeShort(s),e.writeShort(i),e.writeByte(0);var t=o(2);e.writeByte(2);for(var n=0;t.length-n>255;)e.writeByte(255),e.writeBytes(t,n,255),n+=255;e.writeByte(t.length-n),e.writeBytes(t,n,t.length-n),e.writeByte(0),e.writeString(";")}},o=function(e){for(var t=1<<e,s=1+(1<<e),i=e+1,a=r(),o=0;o<t;o+=1)a.add(String.fromCharCode(o));a.add(String.fromCharCode(t)),a.add(String.fromCharCode(s));var d=p(),l=function(e){var t=e,s=0,i=0;return{write:function(e,n){if(e>>>n!=0)throw"length over";for(;s+n>=8;)t.writeByte(255&(e<<s|i)),n-=8-s,e>>>=8-s,i=0,s=0;i|=e<<s,s+=n},flush:function(){s>0&&t.writeByte(i)}}}(d);l.write(t,i);var c=0,f=String.fromCharCode(n[c]);for(c+=1;c<n.length;){var h=String.fromCharCode(n[c]);c+=1,a.contains(f+h)?f+=h:(l.write(a.indexOf(f),i),a.size()<4095&&(a.size()==1<<i&&(i+=1),a.add(f+h)),f=h)}return l.write(a.indexOf(f),i),l.write(s,i),l.flush(),d.toByteArray()},r=function(){var e={},t=0,s={add:function(i){if(s.contains(i))throw"dup key:"+i;e[i]=t,t+=1},size:function(){return t},indexOf:function(t){return e[t]},contains:function(t){return void 0!==e[t]}};return s};return a}(e,t),n=0;n<t;n+=1)for(var a=0;a<e;a+=1)i.setPixel(a,n,s(a,n));var o=p();i.write(o);for(var r=function(){var e=0,t=0,s=0,i="",n={},a=function(e){i+=String.fromCharCode(o(63&e))},o=function(e){if(e<0);else{if(e<26)return 65+e;if(e<52)return e-26+97;if(e<62)return e-52+48;if(62==e)return 43;if(63==e)return 47}throw"n:"+e};return n.writeByte=function(i){for(e=e<<8|255&i,t+=8,s+=1;t>=6;)a(e>>>t-6),t-=6},n.flush=function(){if(t>0&&(a(e<<6-t),e=0,t=0),s%3!=0)for(var n=3-s%3,o=0;o<n;o+=1)i+="="},n.toString=function(){return i},n}(),d=o.toByteArray(),l=0;l<d.length;l+=1)r.writeByte(d[l]);return r.flush(),"data:image/gif;base64,"+r};return e}();a.stringToBytesFuncs["UTF-8"]=function(e){return function(e){for(var t=[],s=0;s<e.length;s++){var i=e.charCodeAt(s);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(s++,i=65536+((1023&i)<<10|1023&e.charCodeAt(s)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}(e)},void 0===(n="function"==typeof(i=function(){return a})?i.apply(t,[]):i)||(e.exports=n)},function(e,t,s){"use strict";s.r(t);var i={numeric:"Numeric",alphanumeric:"Alphanumeric",byte:"Byte",kanji:"Kanji"},n=function(){return(n=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},a=function(){for(var e=0,t=0,s=arguments.length;t<s;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<s;t++)for(var a=arguments[t],o=0,r=a.length;o<r;o++,n++)i[n]=a[o];return i},o=function(e){return!!e&&"object"==typeof e&&!Array.isArray(e)};function r(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(!t.length)return e;var i=t.shift();return void 0!==i&&o(e)&&o(i)?(e=n({},e),Object.keys(i).forEach((function(t){var s=e[t],n=i[t];Array.isArray(s)&&Array.isArray(n)?e[t]=s.concat(n):o(s)&&o(n)?e[t]=r(Object.assign({},s),n):e[t]=n})),r.apply(void 0,a([e],t))):e}for(var d={L:.07,M:.15,Q:.25,H:.3},l=function(){function e(e){var t=e.context,s=e.type;this._context=t,this._type=s}return e.prototype.draw=function(e,t,s,i){var n,a=this._context;switch(this._type){case"dots":n=this._drawDots;break;case"rounded":n=this._drawRounded;break;case"square":default:n=this._drawSquare}n({x:e,y:t,size:s,context:a,getNeighbor:i})},e.prototype._drawDots=function(e){var t=e.x,s=e.y,i=e.size,n=e.context;n.beginPath(),n.arc(t+i/2,s+i/2,i/2,0,2*Math.PI),n.fill()},e.prototype._drawSquare=function(e){var t=e.x,s=e.y,i=e.size;e.context.fillRect(t,s,i,i)},e.prototype._drawRounded=function(e){var t=e.x,s=e.y,i=e.size,n=e.context,a=e.getNeighbor;n.beginPath(),n.moveTo(t,s+i/2),a(-1,0)||a(0,-1)?(n.lineTo(t,s),n.lineTo(t+i/2,s)):n.arc(t+i/2,s+i/2,i/2,-Math.PI,-Math.PI/2),a(0,-1)||a(1,0)?(n.lineTo(t+i,s),n.lineTo(t+i,s+i/2)):n.arc(t+i/2,s+i/2,i/2,-Math.PI/2,0),a(1,0)||a(0,1)?(n.lineTo(t+i,s+i),n.lineTo(t+i/2,s+i)):n.arc(t+i/2,s+i/2,i/2,0,Math.PI/2),a(0,1)||a(-1,0)?(n.lineTo(t,s+i),n.lineTo(t,s+i/2)):n.arc(t+i/2,s+i/2,i/2,Math.PI/2,Math.PI),n.fill()},e}(),c=function(){function e(e){this._canvas=document.createElement("canvas"),this._canvas.width=e.width,this._canvas.height=e.height,this._options=e}return Object.defineProperty(e.prototype,"context",{get:function(){return this._canvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._canvas.height},enumerable:!0,configurable:!0}),e.prototype.getCanvas=function(){return this._canvas},e.prototype.clear=function(){var e=this.context;e&&e.clearRect(0,0,this._canvas.width,this._canvas.height)},e.prototype.drawQR=function(e){return this.clear(),this.drawBackground(),this._qr=e,this._options.image?this.drawImageAndDots():(this.drawDots(),Promise.resolve())},e.prototype.drawBackground=function(){var e=this.context,t=this._options;e&&(e.fillStyle=t.backgroundOptions.color,e.fillRect(0,0,this._canvas.width,this._canvas.height))},e.prototype.drawDots=function(e){var t=this;if(!this._qr)throw"QR code is not defined";var s=this.context;if(!s)throw"QR code is not defined";var i=this._options,n=this._qr.getModuleCount();if(n>i.width||n>i.height)throw"The canvas is too small.";for(var a=Math.min(i.width,i.height),o=Math.floor(a/n),r=Math.floor((i.width-n*o)/2),d=Math.floor((i.height-n*o)/2),c=new l({context:s,type:i.dotsOptions.type}),f=function(a){for(var l=function(l){return e&&!e(a,l)?"continue":h._qr.isDark(a,l)?(s.fillStyle=i.dotsOptions.color,void c.draw(r+a*o,d+l*o,o,(function(s,i){return!(a+s<0||l+i<0||a+s>=n||l+i>=n)&&!(e&&!e(a+s,l+i))&&!!t._qr&&t._qr.isDark(a+s,l+i)}))):"continue"},f=0;f<n;f++)l(f)},h=this,u=0;u<n;u++)f(u)},e.prototype.drawImageAndDots=function(){var e=this;return new Promise((function(t,s){if(!e._qr)return s("QR code is not defined");var i=e.context;if(!i)return s("QR code is not defined");var n=e._options,a=e._qr.getModuleCount(),o=Math.min(n.width,n.height),r=Math.floor(o/a),l=Math.floor((n.width-a*r)/2),c=Math.floor((n.height-a*r)/2),f=new Image,h=n.imageOptions.imageSize*d[n.qrOptions.errorCorrectionLevel];if(!n.image)return s("Image is not defined");e._image=f,f.onload=function(){var s=Math.floor(h*a*a),o=function(e){var t=e.originalHeight,s=e.originalWidth,i=e.maxHiddenDots,n=e.maxHiddenAxisDots,a=e.dotSize,o={x:0,y:0},r={x:0,y:0};if(t<=0||s<=0||i<=0||a<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};var d=t/s;return o.x=Math.floor(Math.sqrt(i/d)),o.x<=0&&(o.x=1),n&&n<o.x&&(o.x=n),o.x%2==0&&o.x--,r.x=o.x*a,o.y=1+2*Math.ceil((o.x*d-1)/2),r.y=Math.round(r.x*d),(o.y*o.x>i||n&&n<o.y)&&(n&&n<o.y?(o.y=n,o.y%2==0&&o.x--):o.y-=2,r.y=o.y*a,o.x=1+2*Math.ceil((o.y/d-1)/2),r.x=Math.round(r.y/d)),{height:r.y,width:r.x,hideYDots:o.y,hideXDots:o.x}}({originalWidth:f.width,originalHeight:f.height,maxHiddenDots:s,maxHiddenAxisDots:a-14,dotSize:r}),d=o.width,u=o.height,p=o.hideXDots,g=o.hideYDots;e.drawDots((function(e,t){return!n.imageOptions.hideBackgroundDots||e<(a-p)/2||e>=(a+p)/2||t<(a-g)/2||t>=(a+g)/2})),i.drawImage(f,l+(a*r-d)/2,c+(a*r-u)/2,d,u),t()},f.src=n.image}))},e}(),f={},h=0;h<=40;h++)f[h]=h;var u=f,p={L:"L",M:"M",Q:"Q",H:"H"},g={width:300,height:300,data:void 0,image:void 0,qrOptions:{typeNumber:u[0],mode:void 0,errorCorrectionLevel:p.Q},imageOptions:{hideBackgroundDots:!0,imageSize:.4},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{color:"#fff"}},m=s(0),b=s.n(m),v=function(){function e(e){this._options=e?r(g,e):g,this.update()}return e._clearContainer=function(e){e&&(e.innerHTML="")},e.prototype.update=function(t){e._clearContainer(this._container),this._options=t?r(this._options,t):this._options,this._options.data&&(this._qr=b()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(e){switch(!0){case/^[0-9]*$/.test(e):return i.numeric;case/^[0-9A-Z $%*+\-.\/:]*$/.test(e):return i.alphanumeric;default:return i.byte}}(this._options.data)),this._qr.make(),this._canvas=new c(this._options),this._canvas.drawQR(this._qr),this.append(this._container))},e.prototype.append=function(e){if(e){if("function"!=typeof e.appendChild)throw"Container should be a single DOM node";this._canvas&&e.appendChild(this._canvas.getCanvas()),this._container=e}},e.prototype.download=function(e){var t,s,i;this._canvas&&(t=this._canvas.getCanvas().toDataURL(e?"image/"+e:void 0),s="qr."+(e||"png"),(i=document.createElement("a")).download=s,i.href=t,document.body.appendChild(i),i.click(),document.body.removeChild(i))},e}(),y={dots:"dots",rounded:"rounded",square:"square"};s.d(t,"dotTypes",(function(){return y})),s.d(t,"errorCorrectionLevels",(function(){return p})),s.d(t,"errorCorrectionPercents",(function(){return d})),s.d(t,"modes",(function(){return i})),s.d(t,"qrTypes",(function(){return u})),t.default=v}]).default}]);