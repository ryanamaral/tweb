(this.webpackJsonp=this.webpackJsonp||[]).push([[28],{72:function(e,t,n){"use strict";n.r(t);var a=n(16),o=n(32),i=n(51),s=n(15),l=n(12),c=n(13),r=n(7),d=n(28),u=n(19),p=n(38),h=n(14),b=n(0),m=n(35),v=n(18),g=n(2),f=n(42),L=n(8),y=n(25),E=n(20),j=n(47),O=n(1),w=n(36),k=n(58),T=n(66),C=n(79),S=n(68);let x,_=null;const N=new d.a("page-sign",!0,()=>{f.a.test&&(i.b.push({name:"Test Country",phoneCode:"999 66",code:"TC",emoji:"ðŸ¤”",pattern:"999 66 XXX XX"}),console.log("Added test country to list!"));const e=i.b.filter(e=>e.emoji).sort((e,t)=>e.name.localeCompare(t.name));let t=null;const d=document.createElement("div");d.classList.add("input-wrapper");const E=new u.b({label:"Login.CountrySelectorLabel",name:Object(w.b)(),plainText:!0});E.container.classList.add("input-select");const A=E.input;A.autocomplete=Object(w.b)();const R=document.createElement("div");R.classList.add("select-wrapper","z-depth-3","hide");const D=document.createElement("span");D.classList.add("arrow","arrow-down"),E.container.append(D);const I=document.createElement("ul");R.appendChild(I);new o.b(R);let P=()=>{P=null,e.forEach(e=>{const t=e.emoji,n=[];e.phoneCode.split(" and ").forEach(a=>{const o=document.createElement("li"),i=document.createElement("span"),s=c.a.wrapRichText(t);o.appendChild(i),i.outerHTML=s,o.append(e.name);const l=document.createElement("span");l.classList.add("phone-code"),l.innerText="+"+a,o.appendChild(l),n.push(o),I.append(o)}),e.li=n}),I.addEventListener("mousedown",e=>{if(0!==e.button)return;let t=e.target;"LI"!==t.tagName&&(t=Object(j.a)(t,"LI")),z(t)}),E.container.appendChild(R)};const z=n=>{const a=n.childNodes[1].textContent,o=n.querySelector(".phone-code").innerText;A.value=a,t=e.find(e=>e.name===a),J.value=B=o,W(),setTimeout(()=>J.focus(),0)};let K;P(),A.addEventListener("focus",(function(t){P?P():e.forEach(e=>{e.li.forEach(e=>e.style.display="")}),clearTimeout(K),K=void 0,R.classList.remove("hide"),R.offsetWidth,R.classList.add("active"),E.select(),Object(m.b)(N.pageEl.parentElement.parentElement,A,"start",4),setTimeout(()=>{X||(document.addEventListener("mousedown",M,{capture:!0}),X=!0)},0)}));let X=!1;const M=e=>{Object(O.a)(e.target,"input-select")||e.target!==A&&(W(),document.removeEventListener("mousedown",M,{capture:!0}),X=!1)},W=()=>{void 0===K&&(R.classList.remove("active"),K=window.setTimeout(()=>{R.classList.add("hide"),K=void 0},200))};A.addEventListener("keyup",(function(t){if(t.ctrlKey||"Control"===t.key)return!1;let n=this.value.toLowerCase(),a=[];e.forEach(e=>{let t=-1!==e.name.toLowerCase().indexOf(n);e.li.forEach(e=>e.style.display=t?"":"none"),t&&a.push(e)}),0===a.length?e.forEach(e=>{e.li.forEach(e=>e.style.display="")}):1===a.length&&"Enter"===t.key&&z(a[0].li[0])})),D.addEventListener("mousedown",(function(e){e.cancelBubble=!0,e.preventDefault(),A.matches(":focus")?A.blur():A.focus()}));let q=!1,B="";const H=new u.b({label:"Login.PhoneLabel",plainText:!0,name:"phone"});let J=H.input;J.type="tel",J.autocomplete="rr55RandomRR55",J.addEventListener("input",(function(e){this.classList.remove("error"),y.b.loadLottieWorkers();const n=this.value;let o,i;if(Math.abs(n.length-B.length)>1&&!q&&b.isAppleMobile&&(this.value=B+n),q=!1,H.setLabel(),"+"===this.value.replace(/\++/,"+"))this.value="+";else{const e=Object(a.c)(this.value);o=e.formatted,i=e.country,this.value=B=o?"+"+o:""}let s=i?i.name:"";s===A.value||t&&i&&t.phoneCode===i.phoneCode||(A.value=s,t=i),i||this.value.length-1>1?_.style.visibility="":_.style.visibility="hidden"})),J.addEventListener("paste",e=>{q=!0}),J.addEventListener("keypress",(function(e){return _.style.visibility||"Enter"!==e.key?!/\D/.test(e.key)||e.metaKey||e.ctrlKey||"+"===e.key&&e.shiftKey?void 0:(e.preventDefault(),!1):U()}));const Q=new p.a({text:"Login.KeepSigned",name:"keepSession",withRipple:!0});Q.input.addEventListener("change",()=>{const e=Q.checked;s.default.pushToState("keepSigned",e),k.a.toggleStorage(e),T.a.toggleStorage(e),l.a.toggleStorage(e)}),s.default.getState().then(e=>{s.default.storage.isAvailable()?Q.checked=e.keepSigned:(Q.checked=!1,Q.label.classList.add("checkbox-disabled"))}),_=Object(h.a)("btn-primary btn-color-primary",{text:"Login.Next"}),_.style.visibility="hidden";const U=e=>{e&&Object(r.f)(e);const t=Object(r.A)([_,x],!0);Object(r.z)(_,Object(L.i18n)("PleaseWait")),Object(a.f)(_);let o=J.value;l.a.invokeApi("auth.sendCode",{phone_number:o,api_id:g.a.id,api_hash:g.a.hash,settings:{_:"codeSettings"}}).then(e=>{Promise.all([n.e(3),n.e(5),n.e(19)]).then(n.bind(null,80)).then(t=>t.default.mount(Object.assign(e,{phone_number:o})))}).catch(e=>{switch(t(),e.type){case"PHONE_NUMBER_INVALID":H.setError(),Object(r.z)(H.label,Object(L.i18n)("Login.PhoneLabelInvalid")),J.classList.add("error"),Object(r.z)(_,Object(L.i18n)("Login.Next"));break;default:console.error("auth.sendCode error:",e),_.innerText=e.type}})};Object(r.b)(_,U),x=Object(h.a)("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"});x.addEventListener("click",()=>{C.default.mount()}),d.append(E.container,H.container,Q.label,_,x);const V=document.createElement("h4");Object(L._i18n)(V,"Login.Title");const F=document.createElement("div");F.classList.add("subtitle"),Object(L._i18n)(F,"Login.StartText"),N.pageEl.querySelector(".container").append(V,F,d);v.isTouchSupported||setTimeout(()=>{J.focus()},0),Object(S.a)(d),l.a.invokeApi("help.getNearestDc").then(e=>{const t=[1,2,3,4,5],n=[e.this_dc];let a;return e.nearest_dc!==e.this_dc&&(a=l.a.getNetworker(e.nearest_dc).then(()=>{n.push(e.nearest_dc)})),(a||Promise.resolve()).then(()=>{const e=()=>{const a=t.shift();a&&setTimeout(()=>{l.a.getNetworker(a,{fileDownload:!0}).finally(e)},n.includes(a)?0:3e3)};e()}),e}).then(n=>{let a=e.find(e=>e.code===n.country);a&&(A.value.length||J.value.length||(A.value=a.name,t=a,J.value=B="+"+a.phoneCode.split(" and ").shift()))})},()=>{_&&(Object(r.z)(_,Object(L.i18n)("Login.Next")),Object(E.ripple)(_,void 0,void 0,!0),_.removeAttribute("disabled")),x&&x.removeAttribute("disabled"),s.default.pushToState("authState",{_:"authStateSignIn"})});t.default=N}}]);
//# sourceMappingURL=28.8122429e69012b0b4169.chunk.js.map