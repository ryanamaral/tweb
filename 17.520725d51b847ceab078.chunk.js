(this.webpackJsonp=this.webpackJsonp||[]).push([[17,26,27],{19:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i(7),s=i(11),a=i(40),r=i(8),o=i(14);let l=()=>{document.addEventListener("paste",t=>{if(!t.target.hasAttribute("contenteditable")&&!t.target.parentElement.hasAttribute("contenteditable"))return;t.preventDefault();let e=(t.originalEvent||t).clipboardData.getData("text/plain"),i=o.b.parseEntities(e);i=i.filter(t=>"messageEntityEmoji"===t._||"messageEntityLinebreak"===t._),e=o.b.wrapRichText(e,{entities:i,noLinks:!0,wrappingDraft:!0}),window.document.execCommand("insertHTML",!1,e)}),l=null};const c=t=>{const e=(t instanceof HTMLInputElement?t.value:t.innerText)[0];let i="ltr";e&&Object(a.b)(e)&&(i="rtl"),t.style.direction=i};var u;!function(t){t[t.Neutral=0]="Neutral",t[t.Valid=1]="Valid",t[t.Error=2]="Error"}(u||(u={}));e.b=class{constructor(t={}){this.options=t,this.container=document.createElement("div"),this.container.classList.add("input-field"),t.maxLength&&(t.showLengthOn=Math.round(t.maxLength/3));const{placeholder:e,maxLength:i,showLengthOn:a,name:o,plainText:u}=t;let h,d,p=t.label||t.labelText;if(u)this.container.innerHTML=`\n      <input type="text" ${o?`name="${o}"`:""} autocomplete="off" ${p?'required=""':""} class="input-field-input">\n      `,h=this.container.firstElementChild,h.addEventListener("input",()=>c(h));else{l&&l(),this.container.innerHTML='\n      <div contenteditable="true" class="input-field-input"></div>\n      ',h=this.container.firstElementChild;const e=new MutationObserver(()=>{c(h),d&&d()});h.addEventListener("input",()=>{Object(n.s)(h)&&(h.innerHTML=""),this.inputFake&&(this.inputFake.innerHTML=h.innerHTML,this.onFakeInput())}),e.observe(h,{characterData:!0,childList:!0,subtree:!0}),t.animate&&(h.classList.add("scrollable","scrollable-y"),this.wasInputFakeClientHeight=0,this.showScrollDebounced=Object(s.a)(()=>this.input.classList.remove("no-scrollbar"),150,!1,!0),this.inputFake=document.createElement("div"),this.inputFake.setAttribute("contenteditable","true"),this.inputFake.className=h.className+" input-field-input-fake")}if(e&&(Object(r._i18n)(h,e,void 0,"placeholder"),this.inputFake&&Object(r._i18n)(this.inputFake,e,void 0,"placeholder")),p||e){const t=document.createElement("div");t.classList.add("input-field-border"),this.container.append(t)}if(p&&(this.label=document.createElement("label"),this.setLabel(),this.container.append(this.label)),i){const t=this.container.lastElementChild;let e=!1;d=()=>{const s=h.classList.contains("error"),r=u?h.value.length:[...Object(n.l)(h)].length,o=i-r,l=o<0;h.classList.toggle("error",l),l||o<=a?(this.setLabel(),t.append(` (${i-r})`),e||(e=!0)):(s&&!l||e)&&(this.setLabel(),e=!1)},h.addEventListener("input",d)}this.input=h}select(){this.input.value&&this.input.select()}setLabel(){this.label.textContent="",this.options.labelText?this.label.innerHTML=this.options.labelText:this.label.append(Object(r.i18n)(this.options.label,this.options.labelOptions))}onFakeInput(){const{scrollHeight:t,clientHeight:e}=this.inputFake;this.wasInputFakeClientHeight&&this.wasInputFakeClientHeight!==e&&(this.input.classList.add("no-scrollbar"),this.showScrollDebounced()),this.wasInputFakeClientHeight=e,this.input.style.height=t?t+"px":""}get value(){return this.options.plainText?this.input.value:Object(n.l)(this.input)}set value(t){this.setValueSilently(t,!1);const e=new Event("input",{bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)}setValueSilently(t,e=!0){this.options.plainText?this.input.value=t:(this.input.innerHTML=t,this.inputFake&&(this.inputFake.innerHTML=t,e&&this.onFakeInput()))}isValid(){return!this.input.classList.contains("error")&&this.value!==this.originalValue}setOriginalValue(t="",e=!1){this.originalValue=t,this.options.plainText||(t=o.b.wrapDraftText(t)),e?this.setValueSilently(t,!1):this.value=t}setState(t,e){e&&(this.label.textContent="",this.label.append(Object(r.i18n)(e,this.options.labelOptions))),this.input.classList.toggle("error",!!(t&u.Error)),this.input.classList.toggle("valid",!!(t&u.Valid))}setError(t){this.setState(u.Error,t)}}},36:function(t,e,i){"use strict";function n(t){return Math.floor(Math.random()*t)}function s(){return""+n(4294967295)+n(16777215)}i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return s}))},39:function(t,e,i){"use strict";i.r(e);var n=i(7),s=i(15),a=i(8),r=i(28),o=function(t,e,i,n){return new(i||(i=Promise))((function(s,a){function r(t){try{l(n.next(t))}catch(t){a(t)}}function o(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,o)}l((n=n.apply(t,e||[])).next())}))};const l=new r.a("page-chats",!1,()=>(s.default.pushToState("authState",{_:"authStateSignedIn"}),Promise.resolve().then(i.bind(null,9)).then(t=>{t.default.broadcast("im_mount")}),a.default.requestedServerLanguage||a.default.getCacheLangPack().then(t=>{t.local&&a.default.getLangPack(t.lang_code)}),Object(n.c)(),new Promise(t=>{window.requestAnimationFrame(()=>{Promise.all([i.e(3),i.e(6),i.e(5),i.e(16)]).then(i.bind(null,76)).finally(()=>o(void 0,void 0,void 0,(function*(){t()})))})})));e.default=l},55:function(t,e,i){"use strict";var n=i(10),s=i(24),a=i(13);const r=new class{getState(){return a.a.invokeApi("account.getPassword").then(t=>t)}updateSettings(t={}){return this.getState().then(e=>{let i,n;const s={password:null,new_settings:{_:"account.passwordInputSettings",hint:t.hint,email:t.email}};i=t.currentPassword?a.a.computeSRP(t.currentPassword,e):Promise.resolve({_:"inputCheckPasswordEmpty"});const r=e.new_algo,o=new Uint8Array(r.salt1.length+32);return o.randomize(),o.set(r.salt1,0),r.salt1=o,n=t.newPassword?a.a.computeSRP(t.newPassword,e,!0):Promise.resolve(new Uint8Array),Promise.all([i,n]).then(t=>(s.password=t[0],s.new_settings.new_algo=r,s.new_settings.new_password_hash=t[1],a.a.invokeApi("account.updatePasswordSettings",s)))})}check(t,e,i={}){return a.a.computeSRP(t,e).then(t=>a.a.invokeApi("auth.checkPassword",{password:t},i).then(t=>("auth.authorization"===t._&&(s.a.saveApiUser(t.user),a.a.setUserAuth(t.user.id)),t)))}confirmPasswordEmail(t){return a.a.invokeApi("account.confirmPasswordEmail",{code:t})}resendPasswordEmail(){return a.a.invokeApi("account.resendPasswordEmail")}cancelPasswordEmail(){return a.a.invokeApi("account.cancelPasswordEmail")}};n.a.passwordManager=r,e.a=r},57:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(8);class s{constructor(t){this.element=document.body.querySelector("."+t.className),this.container=document.createElement("div"),this.container.className="container center-align",this.imageDiv=document.createElement("div"),this.imageDiv.className="auth-image",this.title=document.createElement("h4"),t.titleLangKey&&this.title.append(Object(n.i18n)(t.titleLangKey)),this.subtitle=document.createElement("p"),this.subtitle.className="subtitle",t.subtitleLangKey&&this.subtitle.append(Object(n.i18n)(t.subtitleLangKey)),this.container.append(this.imageDiv,this.title,this.subtitle),t.withInputWrapper&&(this.inputWrapper=document.createElement("div"),this.inputWrapper.className="input-wrapper",this.container.append(this.inputWrapper)),this.element.append(this.container)}}},65:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(7),s=i(19);class a extends s.b{constructor(t={}){super(Object.assign({plainText:!0},t)),this.passwordVisible=!1,this.onVisibilityClick=t=>{Object(n.f)(t),this.passwordVisible=!this.passwordVisible,this.toggleVisible.classList.toggle("eye-hidden",this.passwordVisible),this.input.type=this.passwordVisible?"text":"password",this.onVisibilityClickAdditional&&this.onVisibilityClickAdditional()};const e=this.input;e.type="password",e.setAttribute("required",""),e.autocomplete="off";const i=document.createElement("input");i.classList.add("stealthy"),i.tabIndex=-1,i.type="password",e.parentElement.prepend(i),e.parentElement.insertBefore(i.cloneNode(),e.nextSibling);const s=this.toggleVisible=document.createElement("span");s.classList.add("toggle-visible","tgico"),this.container.classList.add("input-field-password"),this.container.append(s),s.addEventListener("click",this.onVisibilityClick),s.addEventListener("touchend",this.onVisibilityClick)}}},66:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i(42),s=i(46),a=function(t,e,i,n){return new(i||(i=Promise))((function(s,a){function r(t){try{l(n.next(t))}catch(t){a(t)}}function o(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,o)}l((n=n.apply(t,e||[])).next())}))};var r=new class{constructor(){this.blobSupported=!0;try{Object(s.a)([],"")}catch(t){this.blobSupported=!1}}isAvailable(){return this.blobSupported}write(t,e){return e instanceof Blob?new Promise((i,n)=>{let s=new FileReader;s.onload=function(e){let s=e.target.result,a=new Uint8Array(s);t.write(a).then(i,n)},s.readAsArrayBuffer(e)}):t.write(e)}getFakeFileWriter(t,e){const i=[];return{write:t=>a(this,void 0,void 0,(function*(){if(!this.blobSupported)throw!1;i.push(t)})),truncate:()=>{i.length=0},finalize:(n=!0)=>{const a=Object(s.a)(i,t);return n&&e&&e(a),a}}}},o=function(t,e,i,n){return new(i||(i=Promise))((function(s,a){function r(t){try{l(n.next(t))}catch(t){a(t)}}function o(t){try{l(n.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,o)}l((n=n.apply(t,e||[])).next())}))};class l{constructor(t){this.dbName=t,this.useStorage=!0,n.a.test&&(this.dbName+="_test"),this.openDatabase(),l.STORAGES.push(this)}openDatabase(){return this.openDbPromise?this.openDbPromise:this.openDbPromise=caches.open(this.dbName)}delete(t){return this.timeoutOperation(e=>e.delete("/"+t))}deleteAll(){return caches.delete(this.dbName)}save(t,e){return this.useStorage?this.timeoutOperation(i=>i.put("/"+t,e)):Promise.reject("STORAGE_OFFLINE")}saveFile(t,e){return this.useStorage?(e instanceof Blob||(e=Object(s.a)(e)),this.save(t,new Response(e)).then(()=>e)):Promise.reject("STORAGE_OFFLINE")}getFile(t,e="blob"){return this.useStorage?this.timeoutOperation(i=>o(this,void 0,void 0,(function*(){const n=yield i.match("/"+t);if(!n||!i)throw"NO_ENTRY_FOUND";return n[e]()}))):Promise.reject("STORAGE_OFFLINE")}timeoutOperation(t){return new Promise((e,i)=>o(this,void 0,void 0,(function*(){let n=!1;const s=setTimeout(()=>{i(),n=!0},15e3);try{const i=yield this.openDatabase();if(!i)throw"no cache?";const s=yield t(i);if(n)return;e(s)}catch(t){i(t)}clearTimeout(s)})))}getFileWriter(t,e){const i=r.getFakeFileWriter(e,e=>this.saveFile(t,e));return Promise.resolve(i)}static toggleStorage(t){return Promise.all(this.STORAGES.map(e=>{if(e.useStorage=t,!t)return e.deleteAll()}))}}l.STORAGES=[]},69:function(t,e,i){"use strict";i.r(e);var n=i(16),s=i(23),a=i(15),r=i(55),o=i(28),l=i(39),c=i(12),u=i(65),h=i(71),d=i(14),p=i(8),m=i(57),b=i(7);let w;const g=new o.a("page-password",!0,()=>{const t=new m.a({className:"page-password",withInputWrapper:!0,titleLangKey:"Login.Password.Title",subtitleLangKey:"Login.Password.Subtitle"}),e=Object(c.a)("btn-primary btn-color-primary"),i=new p.default.IntlElement({key:"Login.Next"});e.append(i.element);const a=new u.a({label:"LoginPassword",name:"password"});let o;w=a.input,t.inputWrapper.append(a.container,e);let g,f=()=>(o||(o=window.setInterval(f,1e4)),r.a.getState().then(t=>{g=t,g.hint?Object(b.z)(a.label,Object(b.q)(d.b.wrapEmojiText(g.hint))):a.setLabel()}));const v=t=>{if(t&&Object(b.f)(t),!w.value.length)return void w.classList.add("error");const s=Object(b.A)([w,e],!0);let c=w.value;i.update({key:"PleaseWait"});const u=Object(n.f)(e);r.a.check(c,g).then(t=>{switch(t._){case"auth.authorization":clearInterval(o),l.default.mount(),y&&y.remove();break;default:e.removeAttribute("disabled"),i.update({key:t._}),u.remove()}}).catch(t=>{s(),a.input.classList.add("error"),t.type,i.update({key:"PASSWORD_HASH_INVALID"}),w.select(),u.remove(),f()})};Object(b.b)(e,v),w.addEventListener("keypress",(function(t){if(this.classList.remove("error"),i.update({key:"Login.Next"}),"Enter"===t.key)return v()}));const L=s.b.isMobile?100:166,y=new h.a(a,L);return t.imageDiv.append(y.container),Promise.all([y.load(),f()])},null,()=>{w.focus(),a.default.pushToState("authState",{_:"authStatePassword"})});e.default=g},71:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(26);class s{constructor(t,e){this.passwordInputField=t,this.size=e,this.needFrame=0,this.container=document.createElement("div"),this.container.classList.add("media-sticker-wrapper")}load(){return this.loadPromise?this.loadPromise:this.loadPromise=n.b.loadAnimationFromURL({container:this.container,loop:!1,autoplay:!1,width:this.size,height:this.size,noCache:!0},"assets/img/TwoFactorSetupMonkeyPeek.tgs").then(t=>(this.animation=t,this.animation.addEventListener("enterFrame",t=>{(1===this.animation.direction&&t>=this.needFrame||-1===this.animation.direction&&t<=this.needFrame)&&(this.animation.setSpeed(1),this.animation.pause())}),this.passwordInputField.onVisibilityClickAdditional=()=>{this.passwordInputField.passwordVisible?(this.animation.setDirection(1),this.animation.curFrame=0,this.needFrame=16,this.animation.play()):(this.animation.setDirection(-1),this.animation.curFrame=16,this.needFrame=0,this.animation.play())},n.b.waitForFirstFrame(t)))}remove(){this.animation&&this.animation.remove()}}}}]);
//# sourceMappingURL=17.520725d51b847ceab078.chunk.js.map