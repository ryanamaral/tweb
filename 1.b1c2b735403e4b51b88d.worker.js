this.webpackChunk([1],{12:function(e,t,n){"use strict";n.r(t),n.d(t,"makePasswordHash",(function(){return s})),n.d(t,"computeSRP",(function(){return j}));var c=n(3),a=n(1),r=n(4),i=n(0),b=function(e,t,n,c){return new(n||(n=Promise))((function(a,r){function i(e){try{s(c.next(e))}catch(e){r(e)}}function b(e){try{s(c.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,b)}s((c=c.apply(e,t||[])).next())}))};Object(r.b)("SRP",r.a.Error);function s(e,t,n){return b(this,void 0,void 0,(function*(){let a=yield c.a.sha256Hash(Object(i.b)(t,(new TextEncoder).encode(e),t));a=Object(i.b)(n,a,n),a=yield c.a.sha256Hash(a);let r=yield c.a.pbkdf2(new Uint8Array(a),t,1e5);return r=Object(i.b)(n,r,n),a=yield c.a.sha256Hash(r),a}))}function j(e,t,n){return b(this,void 0,void 0,(function*(){const r=n?t.new_algo:t.current_algo,j=Object(a.y)(Object(i.g)(r.p),16),O=Object(a.y)(Object(i.g)(t.srp_B),16),o=Object(a.o)(r.g,32,256),h=yield s(e,new Uint8Array(r.salt1),new Uint8Array(r.salt2)),y=Object(a.y)(Object(i.g)(new Uint8Array(h)),16),d=function(e,t,n=0){return new Uint8Array(Array(t).fill(n).concat(e).slice(-t))},u=d(Object(i.e)(Object(a.d)(j,16)),256),l=d(Object(i.e)(Object(a.d)(o,16)),256),f=d(Object(i.e)(Object(a.d)(O,16)),256),w=Object(a.w)(o,y,j),A=e=>{const t=new Uint8Array(e.length);for(let n=0;n<e.length;n+=4)t[n]=e[n+3],t[n+1]=e[n+2],t[n+2]=e[n+1],t[n+3]=e[n];return t};if(n){return d(Object(i.e)(Object(a.d)(w,16)),256)}let U=yield c.a.sha256Hash(Object(i.a)(u,l));U=Object(a.y)(Object(i.g)(new Uint8Array(U)),16);const H=Object(a.r)(Object(a.s)(U,w),j),g=(e,t)=>{const n=Object(a.z)(t,e);return!(Object(a.t)(n)||Object(a.e)(n)<1984||Object(a.e)(e)<1984||Math.floor((Object(a.e)(e)+7)/8)>256)};let p,{a:_,a_for_hash:v,u:P}=yield(()=>b(this,void 0,void 0,(function*(){for(;;){const e=Object(a.y)(Object(i.g)(A(t.secure_random)),16),n=Object(a.w)(o,e,j);if(g(n,j)){const t=Object(i.e)(Object(a.d)(n,16)),r=yield c.a.sha256Hash(Object(i.a)(new Uint8Array(t),new Uint8Array(f))),b=Object(a.y)(Object(i.g)(new Uint8Array(r)),16);if(!Object(a.p)(b)&&!Object(a.t)(b))return{a:e,a_for_hash:t,u:b}}}})))();p=Object(a.n)(O,H)?O:Object(a.a)(O,j),p=Object(a.r)(Object(a.z)(p,H),j);let k=Object(a.s)(P,y),m=Object(a.a)(_,k),x=Object(a.w)(p,m,j),R=yield c.a.sha256Hash(d(Object(i.e)(Object(a.d)(x,16)),256)),S=yield c.a.sha256Hash(u),z=yield c.a.sha256Hash(l);S=Object(i.i)(new Uint8Array(S),new Uint8Array(z));let C=Object(i.b)(S,yield c.a.sha256Hash(r.salt1),yield c.a.sha256Hash(r.salt2),v,f,R),E=yield c.a.sha256Hash(C);return{_:"inputCheckPasswordSRP",srp_id:t.srp_id,A:new Uint8Array(v),M1:new Uint8Array(E)}}))}}});
//# sourceMappingURL=1.b1c2b735403e4b51b88d.worker.js.map